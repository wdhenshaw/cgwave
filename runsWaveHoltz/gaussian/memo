

*************************************************
**** Sat April 1, 2023

REORGANIZATION of cgwh ..

TESTS

IMP NP=2
cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 0.5 -y0=0.4 0.5 0.5 -nf=2 -freq=5 9.777 12.34 -amp=100 100 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -cfl=10000 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.239, CR-perPeriod=0.488, Time to solve = 8.11e-01(s) : CgWave= 7.79e-01(s) 95.96%, advance= 7.71e-01(s) 95.06%
 max-residual=1.32e-11 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=6.416e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=40, totalTimeStepsStaken=680, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   5.000, (adjusted=   4.896) T= 1.25664, Tbar= 2.51327, numPeriods=  2, Tbar(0)/T=  2.00
 freq= 1, omega=   9.777, (adjusted=   9.064) T= 0.64265, Tbar= 1.92795, numPeriods=  3, Tbar(0)/T=  3.91

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=2.001e-09.
CgWaveHoltz::residual: freq= 1, omega=   9.777, max-res=4.518e-09.
CgWaveHoltz: max-res=4.518e-09 (all frequencies)

Direct solve Helmholtz: cpu= 9.02e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=6.416e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.96e-11 for freq0 =   5.0000e+00, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=5.83e-10 for freq1 =   9.7770e+00, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=5.83e-10, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





EXP NP=4
cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 0.5 -y0=0.4 0.5 0.5 -nf=2 -freq=5 9.777 12.34 -amp=100 100 50 -beta=400 400 400 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.000, CR-perPeriod=0.111, Time to solve = 6.50e+00(s) : CgWave= 6.48e+00(s) 99.78%, advance= 6.48e+00(s) 99.73%
 max-residual=1.23e-14 (WaveHoltz its), numberOfIterations = 3 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=1.312e-03, minStepsPerPeriod=10, numberOfStepsPerSolve=3832, totalTimeStepsStaken=19160, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   5.000, (adjusted=   5.000) T= 1.25664, Tbar= 5.02655, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=   9.777, (adjusted=   9.777) T= 0.64265, Tbar= 4.49855, numPeriods=  7, Tbar(0)/T=  7.82

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=3.151e-10.
CgWaveHoltz::residual: freq= 1, omega=   9.777, max-res=6.479e-10.
CgWaveHoltz: max-res=6.479e-10 (all frequencies)

Direct solve Helmholtz: cpu= 9.00e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.312e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=6.56e-14 for freq0 =   5.0000e+00, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.53e-13 for freq1 =   9.7770e+00, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.53e-13, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************************
**** Mon March 6, 2023

MATCH TO MATLAB CODE
cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 -y0=0.4 0.5 -nf=2 -freq=5 11 -amp=100 100 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -cfl=10000 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2  -go=halt


=====
ADJUSTED: 
 freq=0 frequency=  4.914370688310e+00 period=  2.557066084626e+00, numberOfPeriods=2
 freq=1 frequency=  1.017092745063e+01 period=  2.471037312057e+00, numberOfPeriods=4

 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   5.000, (adjusted=   4.914) T= 1.25664, Tbar= 2.51327, numPeriods=  2, Tbar(0)/T=  2.00
 freq= 1, omega=  11.000, (adjusted=  10.171) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.40

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=4.563e-10.
CgWaveHoltz::residual: freq= 1, omega=  11.000, max-res=9.823e-10.
CgWaveHoltz: max-res=9.823e-10 (all frequencies)

Direct solve Helmholtz: cpu= 8.72e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.812e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=2.67e-11 for freq0 =   5.0000e+00, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.50e-10 for freq1 =   1.1000e+01, |v|_max= 1.89e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.50e-10, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



revisit multi-freq:
no adjust: -- looks broken?
cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 0.5 -y0=0.4 0.5 0.5 -nf=2 -freq=5 9.777 12.34 -amp=100 100 50 -beta=400 400 400 -adjustOmega=0 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -go=halt


cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 0.5 -y0=0.4 0.5 0.5 -nf=2 -freq=5 9.777 12.34 -amp=100 100 50 -beta=400 400 400 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -go=halt

 
 freq= 0, omega=   5.000, (adjusted=   5.000) T= 1.25664, Tbar= 5.02655, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=   9.777, (adjusted=   9.777) T= 0.64265, Tbar= 4.49855, numPeriods=  7, Tbar(0)/T=  7.82

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=3.151e-10.
CgWaveHoltz::residual: freq= 1, omega=   9.777, max-res=6.479e-10.
CgWaveHoltz: max-res=6.479e-10 (all frequencies)

Direct solve Helmholtz: cpu= 9.42e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.312e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=6.56e-14 for freq0 =   5.0000e+00, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.53e-13 for freq1 =   9.7770e+00, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.53e-13, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

*************************************************
**** Sun Feb 12, 2023


>>>>>>>>>  START TEST DEFLATION ODRER=4

**** DISK: 

cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.0 -y0=0.0 -nf=1 -freq=7  -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=4  -matlab=diskFreq7Np2G4Order4ImpDeflate4 -go=dfk > diskFreq7Np2G4Order4ImpDeflate4.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.094, CR-perPeriod=0.307, Time to solve = 3.74e-01(s) : CgWave= 3.66e-01(s) 97.77%, advance= 3.62e-01(s) 96.78%
 max-residual=1.54e-12 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.816e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=20, totalTimeStepsStaken=860, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=1, numToDeflate=8, eigenVectorFile=[diskG4O4Ev64.show]
 Estimated asymptotic convergence rate= 0.313.
 freq= 0, omega=   7.000, (adjusted=   6.401) T= 0.89760, Tbar= 1.79520, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=7.236e-05 (using omega), max-res=2.359e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=7.236e-05 (all frequencies)

Direct solve Helmholtz: cpu= 1.05e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=9.816e-02
CgWaveHoltz::saved results in matlab file=[diskFreq7Np2G4Order4ImpDeflate4Krylov.m]
cgwh: rel-max-diff=2.25e-05, |v|_max= 3.86e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




*********  SQUARE SEEMS TO ROUGHLY WORK

scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/square128O4Ev64.show .

cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=square128O4Ev64.show -matlab=square128Order4Freq9Np2Deflate2Imp -deflateWaveHoltz=1 -numToDeflate=2 -freq=9 -go=dfk > square128Order4Freq9Np3Deflate2Imp.out


cgwh gaussian.cmd -g=square128.order4.ng3 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=square128O4Ev64.show -matlab=square128O4Freq9Np2Deflate2Imp -deflateWaveHoltz=1 -numToDeflate=2 -freq=9 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.123, CR-perPeriod=0.350, Time to solve = 1.46e+00(s) : CgWave= 1.44e+00(s) 98.68%, advance= 1.44e+00(s) 98.29%
 max-residual=2.09e-12 (WaveHoltz its), numberOfIterations = 12 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=7.635e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=20, totalTimeStepsStaken=280, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=1, numToDeflate=3, eigenVectorFile=[square128O4Ev64.show]
 Estimated asymptotic convergence rate= 0.273.
 freq= 0, omega=   9.000, (adjusted=   8.230) T= 0.69813, Tbar= 1.39626, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   9.000, max-res=3.564e-02 (using omega), max-res=6.296e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.564e-02 (all frequencies)

Direct solve Helmholtz: cpu= 2.99e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=7.635e-02
CgWaveHoltz::saved results in matlab file=[square128O4Freq9Np2Deflate2ImpKrylov.m]
cgwh: rel-max-diff=1.16e-05, |v|_max= 6.23e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


-----------------------------------------------



scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/shapesG4O2Ev300.show .
scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/shapesG4O2Ev150.show .

REVIST SHAPES + DEFLATE

FREQ=30 deflate 20
cgwh -noplot gaussian.cmd -g=shapese4.order2 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=30 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=20 -cfl=10000 -matlab=shapesG4O2freq30Np8Deflate20 -eigenVectorFile=shapesG4O2Ev300.show -deflateWaveHoltz=1 -numToDeflate=20 -go=dfk > shapesG4O2freq30Np8Deflate20.out


FREQ=30
cgwh -noplot gaussian.cmd -g=shapese4.order2 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=30 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=20 -cfl=10000 -matlab=shapesG4O2freq30Np8Deflate7 -eigenVectorFile=shapesG4O2Ev300.show -deflateWaveHoltz=1 -numToDeflate=7 -go=dfk > shapesG4O2freq30Np8Deflate7.out


FREQ=15 : OK ACR=.45
cgwh -noplot gaussian.cmd -g=shapese4.order2 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=15 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=20 -cfl=10000 -matlab=shapesG4O2freq15Np8Deflate5 -eigenVectorFile=shapesG4O2Ev150.show -deflateWaveHoltz=1 -numToDeflate=5 -go=dfk > shapesG4O2freq15Np8Deflate5.out



+++++++++++++++ PIPE ++++++++++++++++

plotStuff plotSolution3d -show=pipeOneFreq36G802.show -name=pipe -cf=2

plotStuff plotSolution3d -show=pipeOneFreq35G404.show -name=pipe -cf=2

plotStuff plotSolution3d -show=pipeOneFreq25G4O2.show -name=pipe -cf=2

plotStuff plotSolution3d -show=pipeTwoFreqNp4G4Order2Imp.show -name=pipe -cf=2

plotStuff plotSolution3d -show=pipeTwoFreqNp4G2Order4Imp.show -name=pipe

+++ PIPE: SHOWFILE: G8 O2 NP=8 OMEGA=36
setsid $cgwh -noplot gaussian.cmd -g=pipeze8.order2 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=36 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -matlab=pipeOneFreq36G802 -show=pipeOneFreq36G802.show -go=ks > pipeOneFreq36G802.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze8.order2.hdf
 Convergence rate CR=0.884, CR-perPeriod=0.985, Time to solve = 3.03e+03(s) : CgWave= 3.03e+03(s) 99.92%, advance= 3.03e+03(s) 99.90%
 max-residual=6.94e-05 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.909e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=80, totalTimeStepsStaken=4320, aveItsPerImplicitSolve=  4.8
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]



+++ PIPE: SHOWFILE: G4 O4
$cgwh -noplot gaussian.cmd -g=pipeze4.order4.ng3 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=35 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -matlab=pipeOneFreq35G404 -show=pipeOneFreq35G404.show -go=ks > pipeOneFreq35G404.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze4.order4.ng3.hdf
 Convergence rate CR=0.890, CR-perPeriod=0.971, Time to solve = 8.57e+02(s) : CgWave= 8.57e+02(s) 99.94%, advance= 8.56e+02(s) 99.92%
 max-residual=9.22e-05 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=50)

+++ PIPE: SHOWFILE: G4:
$cgwh -noplot gaussian.cmd -g=pipeze4.order2 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=25 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -show=pipeOneFreq25G4O2.show -go=ks > pipeOneFreq25G4O2.out

Convergence rate CR=0.891, CR-perPeriod=0.972, Time to solve = 1.67e+02(s) : CgWave= 1.66e+02(s) 99.77%, advance= 1.66e+02(s) 99.71%
 max-residual=1.90e-04 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=50)



+++ PIPE: SHOWFILE: G4:
$cgwh -noplot gaussian.cmd -g=pipeze4.order2 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -show=pipeTwoFreqNp4G4Order2Imp.show -go=ks > pipeTwoFreqNp4G4Order2ImpShow.out


++++ SPHERE -- showfile for plots

FINER GRID: 
$cgwh -noplot gaussian.cmd -g=spheree4.order2 -x0=-0.2 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=1 -freq=18 8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -show=sphereOneG4Freq18.show -go=ks > sphereOneG4Freq18.out



$cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=-0.2 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=1 -freq=18 8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -show=sphereOneFreq18.show -go=ks > sphereOneFreq18.out


omega=8.5
$cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -show=sphereOneFreqNp4G2Order4Imp.show -go=ks




+++ REVISIT SHAPES:
IMP NP=4 : OK 
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=shapesG4O4ThreeFreqNp4Imp -go=dfk > shapesG4O4ThreeFreqNp4Imp.out


IMP NP=2 --> ACR=1.1
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -cfl=10000 -matlab=shapesG4O4ThreeFreqNp2Imp -go=dfk > shapesG4O4ThreeFreqNp2Imp.out

+++ revisit pipe

NF=2, NP=4 IMP:  use direct solver: **TO RUN: 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -matlab=pipeTwoFreqNp4G2Order4Imp -go=dfk > pipeTwoFreqNp4G2Order4Imp.out


NF=1, NP=4 IMP: 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeOneFreqNp4G2Order4Imp -go=fk > pipeOneFreqNp4G2Order4Imp.out


*************************************************
**** Sat Feb 11, 2023



+++++++++++++++++++++++++++++
+++ Revisit sphere

SPHERE2 ODRER=4 EXP: **TO DO**
cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Exp -go=fk > sphereOneFreqNp4G2Order4Exp.out



G2 Order 4 NP=4 - IMP 
setsid $cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=fk > sphereOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/spheree2.order4.ng3.hdf
 Convergence rate CR=0.279, CR-perPeriod=0.727, Time to solve = 3.42e+02(s) : CgWave= 3.42e+02(s) 99.95%, advance= 3.42e+02(s) 99.92%
 max-residual=6.97e-11 (WaveHoltz its), numberOfIterations = 20 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=8.084e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=40, totalTimeStepsStaken=2880, aveItsPerImplicitSolve=  2.4
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   8.500, (adjusted=   7.773) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=6.765e-10 (using omega), max-res=1.250e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.765e-10 (all frequencies)
saveMatlab: dt=8.084e-02
CgWaveHoltz::saved results in matlab file=[sphereOneFreqNp4G2Order4ImpKrylov.m]


+++ REVISIT BOX:

******* CHECK FREQ=2: 

BUG FOUND -- z0 NOT INPUT CORRECTLY  : FIXED: "z0=f{1,}"=>\@z0

cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.5 0.5 -0.2 0.25 -y0=0.5 0.5 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=2 -freq=5.1 8.5  18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -go=halt



cgwh: rel-max-diff=4.05e-11 for freq0 =   1.2000e+01, |v|_max= 1.28e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.04e+02 for freq1 =   2.0000e+01, |v|_max= 6.65e-01 (between WaveHoltz and Direct Helmholtz solution)

cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.45 0.55 -0.2 0.25 -y0=0.55 0.5 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=2 -freq=12.1 19.6 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -go=halt


BOX TWO FREQ NP=8
cgwh -noplot gaussian.cmd -g=box2.order4.ng3 -x0=0.45 0.55 -0.2 0.25 -y0=.6 0.5 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=2 -freq=12.1 19.6 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=boxTwoFreqFreqNp8G2Order4Imp -go=dfk > boxTwoFreqFreqNp8G2Order4Imp.out


BOX TWO FREQ NP=4
cgwh -noplot gaussian.cmd -g=box2.order4.ng3 -x0=0.45 0.55 -0.2 0.25 -y0=.6 0.5 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=2 -freq=12.1 19.6 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=boxTwoFreqFreqNp4G2Order4Imp -go=dfk > boxTwoFreqFreqNp4G2Order4Imp.out




BOX IMP 
cgwh -noplot gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=boxOneFreqNp4G2Order4Imp -go=dfk > boxOneFreqNp4G2Order4Imp.out

BOX EXP 
cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15  -z0=0.5 0.5 0.5 0.5 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -matlab=boxOneFreqNp4G2Order4Exp -go=dfk



+++++++++ DISK FOUR FREQ + DEFLATE

>>>> TEST ORDER=4:   **TROUBLE**

scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/diskG4O4Ev64.show .
scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/diskG4O2Ev128.show .

cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=8 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=4  -matlab=diskFourFreqNp8G4Order4ImpDeflate4 -go=dfk > diskFourFreqNp8G4Order4ImpDeflate4.out


>> DEFLATE=5 ORDER=2
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=8 -cfl=10000 -eigenVectorFile=diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=5  -matlab=diskFourFreqNp8G4Order2ImpDeflate5 -go=dfk > diskFourFreqNp8G4Order2ImpDeflate5.out



>> DEFLATE=4 ORDER=2
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=8 -cfl=10000 -eigenVectorFile=diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=4  -matlab=diskFourFreqNp8G4Order2ImpDeflate4 -go=dfk > diskFourFreqNp8G4Order2ImpDeflate4.out


EXPLICIT NF=1, NP=1, O4, G8
cgwh -noplot gaussian.cmd -g=sice8.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -matlab=diskOneFreqNp1G8Order4Exp -go=dfk > diskOneFreqNp1G8Order4Exp.out

EXPLICIT NF=1, NP=4
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=0.95 -matlab=diskOneFreqNp4G4Order2Exp -go=dfk

*************************************************
**** Fri Feb 10, 2023


REVISIT DISK:

matlab=
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=diskOneFreqNp4G4Order4Imp -go=dfk > diskOneFreqNp4G4Order4Imp.out



TRY DEFLATION WITH Nf=12
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -eigenVectorFile=square128Ev64.show -deflateWaveHoltz=1 -numToDeflate=5 -matlab=squareFreq12G128O2Np8Deflate5 -go=dfk > squareFreq12G128O2Np8Deflate5.out


cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -eigenVectorFile=square128Ev64.show -deflateWaveHoltz=1 -numToDeflate=9 -matlab=squareFreq12G128O2Np8Deflate9 -go=dfk > squareFreq12G128O2Np8Deflate9.out

REDO -- NITS=10

OLD: NITS=5: NF=12 : IMP NP=8 ECR=.877  its=25, CPU=49.2  
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=squareFreq12G128Np8O4Imp -go=dfk > squareFreq12G128Np8O4Imp.out



*************************************************
**** Sat Feb 4, 2023

DEFLATION FOR A DISK 

scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/diskG4O2Ev64.show .


>>>>>>>> IMP: Deflate 9 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq11Np2Deflate9Imp -deflateWaveHoltz=1 -numToDeflate=9 -freq=11 -go=dfk > diskG4O2Freq11Np2Deflate9Imp.out




>>>>>>>> IMP: Deflate 5 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq11Np2Deflate5Imp -deflateWaveHoltz=1 -numToDeflate=5 -freq=11 -go=dfk > diskG4O2Freq11Np2Deflate5Imp.out


>>>>>>>> IMP: Deflate 3 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq11Np2Deflate3Imp -deflateWaveHoltz=1 -numToDeflate=3 -freq=11 -go=dfk > diskG4O2Freq11Np2Deflate3Imp.out







EXP: Deflate 3  -- **WORKS**
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq7Deflate3Exp -deflateWaveHoltz=1 -numToDeflate=3 -freq=7 -go=dfk > diskG4O2Freq7Deflate3Exp.out


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order2.hdf
 Convergence rate CR=0.192, CR-perPeriod=0.439, Time to solve = 2.30e-01(s) : CgWave= 2.21e-01(s) 96.02%, advance= 2.16e-01(s) 94.07%
 max-residual=1.80e-12 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.816e-02, numberOfStepsPerSolve=20, totalTimeStepsStaken=1080, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=1, numToDeflate=6, eigenVectorFile=[diskG4O2Ev64.show]
 Estimated asymptotic convergence rate= 0.455.
 freq= 0, omega=   7.000, (adjusted=   6.401) T= 0.89760, Tbar= 1.79520, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=2.816e-02 (using omega), max-res=1.174e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.816e-02 (all frequencies)

Direct solve Helmholtz: cpu= 1.92e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=9.816e-02
CgWaveHoltz::saved results in matlab file=[diskG4O2Freq11Np2Deflate3ImpKrylov.m]
cgwh: rel-max-diff=2.07e-04, |v|_max= 1.92e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...


Deflate 2 (2 double)
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq7Deflate2Exp -deflateWaveHoltz=1 -numToDeflate=2 -freq=7 -go=dfk > diskG4O2Freq7Deflate2Exp.out


*************************************************
**** Fri Feb 3, 2023

TRY implicit + deflation
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=3 -cfl=10000 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq9Np3Deflate2Imp -deflateWaveHoltz=1 -numToDeflate=2 -freq=9 -go=dfk > square128O2Freq9Np3Deflate2Imp.out


START ON FINDING PROPER COVERGENCE RATE FOR IMPLICIT TS

INCREASE MIN STEPS PER PERIOD
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -minStepsPerPeriod=10 -freq=5 -matlab=square128O2Freq5Np2Imp10 -go=dfk > square128O2Freq5ImpNp2Imp10.out


cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000  -freq=5 -matlab=square128O2Freq5Np2Imp -go=dfk > square128O2Freq5ImpNp2.out

----------------------- CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.979, CR-perPeriod=0.979, Time to solve = 5.30e-01(s) : CgWave= 5.15e-01(s) 97.26%, advance= 4.85e-01(s) 91.64%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 100 (FP) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.525e-01, numberOfStepsPerSolve=5, totalTimeStepsStaken=500, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   6.000, (adjusted=   3.565) T= 1.04720, Tbar= 1.04720, numPeriods=  1, Tbar(0)/T=  1.00




CONTINUE ON DEFLATION FOR MULTI-FREQ

Nf=2, Np=3, DEFLATE 2: 
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -amp=50 50 -beta=150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=3 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2TwoFreqNp3Deflate2Exp -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 9 -go=halt

cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -amp=50 50 -beta=150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=3 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2TwoFreqNp3Deflate2Exp -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 9 -go=dfk > square128O2TwoFreqNp3Deflate2Exp.out


 ---- SORTED by beta: freq(0)=  5.0000e+00
 i=   3: lambda=  8.8849e+00, |beta|=  9.9453e-01
 i=   0: lambda=  4.4428e+00, |beta|=  3.6699e-01
 i=   1: lambda=  7.0242e+00, |beta|=  2.0272e-01
 i=   2: lambda=  7.0242e+00, |beta|=  2.0272e-01
 i=   6: lambda=  1.1325e+01, |beta|=  7.4557e-02
 i=   7: lambda=  1.1325e+01, |beta|=  7.4557e-02


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.221, CR-perPeriod=0.605, Time to solve = 1.20e+01(s) : CgWave= 1.20e+01(s) 99.94%, advance= 1.19e+01(s) 99.88%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 17 (FP) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=1.748e-03, numberOfStepsPerSolve=2157, totalTimeStepsStaken=36669, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 deflateWaveHoltz=1, numToDeflate=2, eigenVectorFile=[square128Ev64.show]
 freq= 0, omega=   5.000, (adjusted=   5.000) T= 1.25664, Tbar= 3.76991, numPeriods=  3, Tbar(0)/T=  3.00
 freq= 1, omega=   9.000, (adjusted=   9.000) T= 0.69813, Tbar= 3.49066, numPeriods=  5, Tbar(0)/T=  5.40

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=4.168e-04.
CgWaveHoltz::residual: freq= 1, omega=   9.000, max-res=6.849e-04.
CgWaveHoltz: max-res=6.849e-04 (all frequencies)

Direct solve Helmholtz: cpu= 9.28e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.748e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]
cgwh: rel-max-diff=3.45e-08 for freq0 =   5.0000e+00, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.60e-08 for freq1 =   9.0000e+00, |v|_max= 6.20e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.60e-08, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************************
**** Thurs Feb 2, 2023

START ON DEFLATION FOR MULTI-FREQ

cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -deflateWaveHoltz=1 -numToDeflate=1 -freq=5 -go=halt

>>> NEW:
---- SORTED by beta: freq(0)=  5.0001e+00
 i= 0: lambda=  4.4428e+00, |beta|=  9.2363e-01
 i= 1: lambda=  7.0242e+00, |beta|=  2.2676e-01
 i= 2: lambda=  7.0242e+00, |beta|=  2.2676e-01
 i= 3: lambda=  8.8849e+00, |beta|=  2.1428e-01
 i= 6: lambda=  1.1325e+01, |beta|=  1.3882e-01
 i= 7: lambda=  1.1325e+01, |beta|=  1.3882e-01
 i=11: lambda=  1.4045e+01, |beta|=  9.4575e-02

>>> OLD:

 i=0: omega=  5.0001e+00, lambda=  4.4428e+00, |beta|=  9.2363e-01
 i=1: omega=  5.0001e+00, lambda=  7.0242e+00, |beta|=  2.2676e-01
 i=2: omega=  5.0001e+00, lambda=  7.0242e+00, |beta|=  2.2676e-01
 i=3: omega=  5.0001e+00, lambda=  8.8849e+00, |beta|=  2.1428e-01
 i=4: omega=  5.0001e+00, lambda=  9.9325e+00, |beta|=  1.4843e-02
 i=5: omega=  5.0001e+00, lambda=  9.9325e+00, |beta|=  1.4843e-02
 i=6: omega=  5.0001e+00, lambda=  1.1325e+01, |beta|=  1.3882e-01


*************************************************
**** Wed Feb 1, 2023

CONTINUE ON DEFLATION


FREQ=7 DEFLATE 3
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq7Deflate3Exp -deflateWaveHoltz=1 -numToDeflate=3 -freq=7 -go=dfk > square128O2Freq7Deflate3Exp.out


FREQ=7 DEFLATE 2
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq7Deflate2Exp -deflateWaveHoltz=1 -numToDeflate=2 -freq=7 -go=dfk > square128O2Freq7Deflate2Exp



FREQ=7 DEFLATE 1
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq7Deflate1Exp -deflateWaveHoltz=1 -numToDeflate=1 -freq=7 -go=dfk > square128O2Freq7Deflate1Exp

 Convergence rate CR=0.573, CR-perPeriod=0.573, Time to solve = 2.26e+00(s) : CgWave= 2.25e+00(s) 99.62%, advance= 2.23e+00(s) 98.99%
 CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=3.289e-04 (using omega), max-res=4.329e-02 (using omega from discrete symbol)
 cgwh: rel-max-diff=4.58e-09, |v|_max= 7.95e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

*************************************************
**** Tues Jan 31, 2023

CONTINUE ON DEFLATION

>>>> DEFLATION: EXPLICIT: **STARTS TO WORK ***


EASIER TEST:
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq5Deflate1Exp -deflateWaveHoltz=1 -numToDeflate=1 -freq=5 -go=halt


cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq5Deflate1Exp -deflateWaveHoltz=1 -numToDeflate=1 -freq=5 -go=dfk > square128O2Freq5Deflate1Exp.out


 i=0: omega=  5.0001e+00, lambda=  4.4428e+00, |beta|=  9.2363e-01
 i=1: omega=  5.0001e+00, lambda=  7.0242e+00, |beta|=  2.2676e-01
 i=2: omega=  5.0001e+00, lambda=  7.0242e+00, |beta|=  2.2676e-01
 i=3: omega=  5.0001e+00, lambda=  8.8849e+00, |beta|=  2.1428e-01
 i=4: omega=  5.0001e+00, lambda=  9.9325e+00, |beta|=  1.4843e-02
 i=5: omega=  5.0001e+00, lambda=  9.9325e+00, |beta|=  1.4843e-02
 i=6: omega=  5.0001e+00, lambda=  1.1325e+01, |beta|=  1.3882e-01



DEFLATE 3:



DEFLATE 2:
 

 i=0: omega=  7.0004e+00, lambda=  4.4428e+00, |beta|=  3.47e-01
 i=1: omega=  7.0004e+00, lambda=  7.0242e+00, |beta|=  1.00e+00
 i=2: omega=  7.0004e+00, lambda=  7.0242e+00, |beta|=  1.00e+00
 i=3: omega=  7.0004e+00, lambda=  8.8849e+00, |beta|=  5.94e-01
 i=4: omega=  7.0004e+00, lambda=  9.9325e+00, |beta|=  1.90e-01

>>>> freq=7 is close to a double eigenvalue
    VERY SLOW CR with no deflation
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -deflateWaveHoltz=1 -numToDeflate=1 -freq=7 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.573, CR-perPeriod=0.573, Time to solve = 2.24e+00(s) : CgWave= 2.23e+00(s) 99.63%, advance= 2.22e+00(s) 99.00%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 45 (FP) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=5.218e-03, numberOfStepsPerSolve=172, totalTimeStepsStaken=7740, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 freq= 0, omega=   7.000, (adjusted=   7.000) T= 0.89760, Tbar= 0.89760, numPeriods=  1, Tbar(0)/T=  1.00

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=3.289e-04 (using omega), max-res=4.329e-02 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.289e-04 (all frequencies)

Direct solve Helmholtz: cpu= 5.77e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.218e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]
cgwh: rel-max-diff=4.58e-09, |v|_max= 7.95e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





>>>>>>>> freq=5: 
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=1 -cfl=0.95 -deflateWaveHoltz=1 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -freq=5 -go=halt


 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.100, CR-perPeriod=0.100, Time to solve = 8.17e-01(s) : CgWave= 8.13e-01(s) 99.57%, advance= 8.09e-01(s) 99.06%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 11 (FP) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=5.236e-03, numberOfStepsPerSolve=240, totalTimeStepsStaken=2640, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 freq= 0, omega=   5.000, (adjusted=   5.000) T= 1.25664, Tbar= 1.25664, numPeriods=  1, Tbar(0)/T=  1.00

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=9.479e-05 (using omega), max-res=9.229e-04 (using omega from discrete symbol)
CgWaveHoltz: max-res=9.479e-05 (all frequencies)

Direct solve Helmholtz: cpu= 5.87e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.236e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]
cgwh: rel-max-diff=1.64e-08, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



*************************************************
**** Mon Jan 30, 2023

START ON DEFLATION

scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/square128Ev64.show .

>>>> DEFLATION: EXPLICIT: **STARTS TO WORK ***
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=5 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=1 -cfl=0.95 -deflateWaveHoltz=1 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -go=halt



>>>> DEFLATION: IMPLICIT >> slow to converge ! WHY??
     NOTE: IMP: NO DEFLATE: CR=1 !!! does NOT converge!!
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=5 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=1000 -deflateWaveHoltz=1 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -go=halt

KRYLOV:
Convergence rate CR=0.107, CR-perPeriod=0.107, Time to solve = 9.57e-02(s) : CgWave= 7.78e-02(s) 81.31%, advance= 7.31e-02(s) 76.42%

FPI
 Convergence rate CR=0.885, CR-perPeriod=0.885, Time to solve = 3.53e-01(s) : CgWave= 3.43e-01(s) 97.43%, advance= 3.28e-01(s) 93.11%


>>>> DEFLATION: **STARTS TO WORK ***
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=5 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=1 -cfl=0.95 -deflateWaveHoltz=1 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -go=halt


 Convergence rate CR=0.100, CR-perPeriod=0.100, Time to solve = 9.34e-01(s) : CgWave= 9.30e-01(s) 99.62%, advance= 7.39e-01(s) 79.13%
cgwh: rel-max-diff=1.64e-08, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>> NO DEFLATION
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=5 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=1 -cfl=0.95 -deflateWaveHoltz=0 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -go=halt

 Convergence rate CR=0.917, CR-perPeriod=0.917, Time to solve = 3.39e+00(s) : CgWave= 3.38e+00(s) 99.77%, advance= 3.37e+00(s) 99.31%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 50 (FP) (maximumNumberOfIterations=50)
cgwh: rel-max-diff=2.16e-14, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

**************************************************
**** Sat Jan 28, 2023


>>> TEST 3D DHS WITH Krylov



box 4: freq=15 : GMRES+ILU(20) - failed PETSC error -11

box2 : freq=15 : GMRES+ILU(50) - OK only 1 iteration needed, basically a direct solve

box2 : freq=15 : GMRES+ILU(5) : failed blew up 
                          (10) : PETSC failure -11 : PC failed
                          (20) : OK, 4 iterations

cgwh gaussian.cmd -g=box4.order4.ng3 -x0=0.5 0.5 -y0=0.5 -0.5 -z0=0.5 0.5 0.5 -nf=1 -freq=15 -amp=150 150 -beta=150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=40 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=halt

 
G4: GMRES+ILU(40) cpu=2000s     WH=140s
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box4.order4.ng3.hdf
 Convergence rate CR=0.343, CR-perPeriod=0.875, Time to solve = 1.38e+02(s) : CgWave= 1.38e+02(s) 99.91%, advance= 1.38e+02(s) 99.90%
 max-residual=5.41e-10 (WaveHoltz its), numberOfIterations = 18 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.410e-01, numberOfStepsPerSolve=40, totalTimeStepsStaken=800, aveItsPerImplicitSolve=  5.0
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=  15.000, (adjusted=   8.913) T= 0.41888, Tbar= 3.35103, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=3.864e-08 (using omega), max-res=3.516e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.864e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.96e+03(s), iterations=3 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(40) + reverse Cuthill-McKee ordering]
saveMatlab: dt=1.410e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=2.88e-09, |v|_max= 1.62e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



--------- BOX2 GMRES+ILU(20)  : WH=10s DHS=16s
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order4.ng3.hdf
 Convergence rate CR=0.319, CR-perPeriod=0.867, Time to solve = 1.01e+01(s) : CgWave= 1.01e+01(s) 99.77%, advance= 1.01e+01(s) 99.69%
 max-residual=2.34e-10 (WaveHoltz its), numberOfIterations = 19 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.410e-01, numberOfStepsPerSolve=40, totalTimeStepsStaken=840, aveItsPerImplicitSolve=  3.0
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=  15.000, (adjusted=   8.913) T= 0.41888, Tbar= 3.35103, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=1.606e-08 (using omega), max-res=3.659e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.606e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.57e+01(s), iterations=4 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(20) + reverse Cuthill-McKee ordering]
saveMatlab: dt=1.410e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=8.45e-09, |v|_max= 1.69e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




>>>>>>TRY TWO FREQ CLOSE TOGETHER?


TWO its=27 CPU=7.6
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=18 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -go=dk > squareFreqTwo.out


ONE: its=23, CPU=3.3
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=35 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -go=dk > squareFreqOne.out

TWO its=52 CPU=9.1
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=35 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -go=dk > squareFreqTwo.out

THREE its= CPU= 
  NP=8 *trouble*
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 0.5 -y0=0.5 0.55 0.55 -nf=3 -freq=34 35 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=16 -cfl=10000 -go=dk > squareFreqThree.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.631, CR-perPeriod=0.944, Time to solve = 9.14e+00(s) : CgWave= 9.04e+00(s) 98.91%, advance= 9.02e+00(s) 98.72%
 max-residual=2.54e-12 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=4.041e-02, numberOfStepsPerSolve=48, totalTimeStepsStaken=2592, aveItsPerImplicitSolve=  0.0



THIS CASE IS TOO EASY FOR THE LOWEST FREQ SINC FIRST EIG IS NEAR omega=5


>> KEEP FIRST AND LAST FREQ 
    NP=8 its=11 CPU=19.6 
    NP=4 its=13 CPU=11.6
    NP=2 its=19 CPU=8.2
    NP=1 its=33 CPU=6.9 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=3 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=squareFreq12Keep2G128Np1O4Imp -go=dk > squareFreq12G12Keep28Np1O4Imp.out



NF=12, NP=10 ECR=.89 its=22 CPU=54 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=10 -cfl=10000 -matlab=squareFreq12G128Np10O4Imp -go=dk > squareFreq12G128Np10O4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.311, CR-perPeriod=0.890, Time to solve = 5.41e+01(s) : CgWave= 5.38e+01(s) 99.48%, advance= 5.38e+01(s) 99.44%
 max-residual=4.49e-13 (WaveHoltz its), numberOfIterations = 22 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 12, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.499e-02, numberOfStepsPerSolve=600, totalTimeStepsStaken=14400, aveItsPerImplicitSolve=  0.0


NF=12, NP=4 ECR=.912 its=70, CPU=65.5 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=squareFreq12G128Np4O4Imp -go=dfk > squareFreq12G128Np4O4Imp.out


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.692, CR-perPeriod=0.912, Time to solve = 6.55e+01(s) : CgWave= 6.46e+01(s) 98.65%, advance= 6.45e+01(s) 98.53%
 max-residual=5.93e-13 (WaveHoltz its), numberOfIterations = 70 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 12, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.499e-02, numberOfStepsPerSolve=240, totalTimeStepsStaken=41280, aveItsPerImplicitSolve=  0.0


REDO FOR TIMING:
NF=12 : IMP NP=8 ECR=.877  its=25, CPU=49.2  
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000  -go=dk > squareFreq12G128Np8O4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.349, CR-perPeriod=0.877, Time to solve = 4.92e+01(s) : CgWave= 4.89e+01(s) 99.33%, advance= 4.89e+01(s) 99.26%
 max-residual=5.02e-13 (WaveHoltz its), numberOfIterations = 25 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 12, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.499e-02, numberOfStepsPerSolve=480, totalTimeStepsStaken=12960, aveItsPerImplicitSolve=  0.0


>> KEEP FIRST AND LAST FREQ CPU=19.6 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=3 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=squareFreq12Keep2G128Np8O4Imp -go=dfk > squareFreq12G12Keep28Np8O4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.084, CR-perPeriod=0.734, Time to solve = 1.96e+01(s) : CgWave= 1.96e+01(s) 99.89%, advance= 1.96e+01(s) 99.87%
 max-residual=6.59e-13 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.499e-02, numberOfStepsPerSolve=480, totalTimeStepsStaken=27360, aveItsPerImplicitSolve=  0.0


**************************************************
**** Fri Jan 27, 2023


>>>>>>> SQUARE WITH MANY FREQ's

>> KEEP FIRST AND LAST FREQ
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=3 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=squareFreq12Keep2G128Np8O4Imp -go=dfk > squareFreq12G12Keep28Np8O4Imp.out


>>>> nf=12
NF=12 : IMP 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=squareFreq12G128Np8O4Imp -go=dfk > squareFreq12G128Np8O4Imp.out

NF=12 EXP 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=0.95 -matlab=squareFreq12G128Np8O4Exp -go=dfk > squareFreq12G128Np8O4Exp.out



>>> Multiple low frequencies on SHAPES -- CHANGE source locations

FORCING:
plotStuff plotForcing.cmd -show=shapesG4O4ThreeFreqNp10 -name=shapesThreeFreqForcing -clines=1 -solution=1 -numFreq=3

plotStuff plotSolution.cmd -show=shapesG4O4ThreeFreqNp10 -name=shapesG4O4ThreeFreqNp10 -clines=1 -solution=1 -numFreq=3

FOR SHOW-FILE:
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=10 -cfl=10000 -show=shapesG4O4ThreeFreqNp10.show -go=dks > shapesG4O4ThreeFreqNp10.out


IMP NP=2  ECR = .948 
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=2 -cfl=10000 -matlab=shapesG4O4ThreeFreqNp2Imp -go=dfk > shapesG4O4ThreeFreqNp2Imp.out


IMP NP=10  
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=10 -cfl=10000 -matlab=shapesG4O4ThreeFreqNp10Imp -go=dfk > shapesG4O4ThreeFreqNp10Imp.out

EXP: (small dt) NP=2 
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=0.95 -matlab=shapesG4O4ThreeFreqNp2Exp -go=dfk > shapesG4O4ThreeFreqNp2Exp.out


NF=3 NP=10 : ECR=.863 its=14 CPU=26
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=10 -cfl=10000 -go=halt



**************************************************
**** Thus Jan 26, 2023

TRY Multiple low frequencies on SHAPES -- change source locations

NF=3 NP=12 : ECR=.861 its=13 CPU=34
NF=3 NP=10 : ECR=.863 its=14 CPU=26
NF=3 NP=8  : ECR=.875 its=18 CPU=28
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 0.3 -y0=-0.6 0.6 0.6 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=10 -cfl=10000 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.342, CR-perPeriod=0.875, Time to solve = 2.81e+01(s) : CgWave= 2.79e+01(s) 99.37%, advance= 2.78e+01(s) 99.19%
 max-residual=5.10e-10 (WaveHoltz its), numberOfIterations = 19 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.015e-01, numberOfStepsPerSolve=128, totalTimeStepsStaken=2688, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   4.000, (adjusted=   3.870) T= 1.57080, Tbar=12.56637, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   8.000, (adjusted=   7.090) T= 0.78540, Tbar=10.99557, numPeriods= 14, Tbar(0)/T= 16.00
 freq= 2, omega=  12.000, (adjusted=   9.451) T= 0.52360, Tbar= 9.94838, numPeriods= 19, Tbar(0)/T= 24.00

CgWaveHoltz::residual: freq= 0, omega=   4.000, max-res=3.461e-09.
CgWaveHoltz::residual: freq= 1, omega=   8.000, max-res=2.621e-09.
CgWaveHoltz::residual: freq= 2, omega=  12.000, max-res=7.006e-09.
CgWaveHoltz: max-res=7.006e-09 (all frequencies)

Direct solve Helmholtz: cpu= 1.97e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.015e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.18e-10 for freq0 =   4.0000e+00, |v|_max= 6.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.38e-10 for freq1 =   8.0000e+00, |v|_max= 3.14e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.37e-09 for freq2 =   1.2000e+01, |v|_max= 1.69e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.37e-09, |v|_max= 1.69e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



RUNS FOR PAPER -- make show files *** SCALE FORCING down : AMP=100 ***

plotStuff plotSolution.cmd -show=shapesG4O4freq45Np80 -name=shapesG4O4freq45Np80 -solution=1
plotStuff plotSolution.cmd -show=shapesG4O4freq44Np80 -name=shapesG4O4freq44Np80 -solution=1
plotStuff plotSolution.cmd -show=shapesG4O4freq43Np80 -name=shapesG4O4freq43Np80 -solution=1


vmax=1.81
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=45 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000 -matlab=shapesG4O4freq45Np80 -show=shapesG4O4freq45Np80.show -go=dks > shapesG4O4freq45Np80.out

cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=44 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000 -matlab=shapesG4O4freq44Np80 -show=shapesG4O4freq44Np80.show -go=dks > shapesG4O4freq44Np80.out

vmax=.2
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=43 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000 -matlab=shapesG4O4freq43Np80 -show=shapesG4O4freq43Np80.show -go=dks > shapesG4O4freq43Np80.out

--> plot forcing
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=43 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000 -go=halt

TWO AT ONCE:
f=43, 44:  NP=120 ECR=.99 worse
f=43, 44:  NP=100 ECR=.998   KSP residual=6.28e-07 (max-res=2.84e-06) (tol=1.00e-10) numIts=52 #######
f=43, 44:  NP=80  ECR=.998 .. converging ok

cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -y0=-0.6 -0.6 -nf=2 -freq=43 44 -amp=100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=halt


>>>>EVEN HIGHER FREQ: freq=44 -------------

TRY NEARBY FREQ:
freq=45 ECR=.992 its=31 CPU=305  cgwh: rel-max-diff=1.69e-10, |v|_max= 9.07e+00
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=45 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=og

freq=43 ECR=.992 its=33 CPU=322  cgwh: rel-max-diff=8.72e-09
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=43 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=og



TRY FINER GRID for paper:
freq=44 : ECR=.990 its=29 cpu=1.19e3 *same its as G4 cgwh: rel-max-diff=3.14e-11,
cgwh gaussian.cmd -g=shapese8.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=44 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=og


freq=44 Np=90  ECR=.991 its=26 CPU=314
freq=44 Np=80  ECR=.994 its=29 CPU=285 *best* cgwh: rel-max-diff=8.25e-11,
freq=44 Np=70  ECR=.994 its=45 CPU=316
freq=44 Np=60  ECR=.997 CPU= 
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=44 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=og

----------------------------------

>>>>EVEN HIGHER FREQ:
freq=33 Np=60 ECR=.985 better, its=26 CPU=192
freq=33 Np=50 ECR=.986 better, its=30 CPU=155
freq=33 Np=40  ECR=.995 CPU= *better
freq=33 Np=32  ECR=.995 CPU=  *poor*
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=33 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=60 -cfl=10000  -go=og

cgwh: rel-max-diff=2.53e-11, |v|_max= 1.71e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>> HIGHER FREQ:
freq=23 NP=32   *Better* ECR=.974   its=25 CPU=74.8
freq=23 NP=28   *Better* ECR=.973   its=30
freq=23 NP=24   *Better* ECR=.984
freq=23 NP=20   *OK* ECR=.99
freq=22 : NP=16 *bad*

cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=23 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=32 -cfl=10000  -go=og

NP=32: 
Convergence rate CR=0.426, CR-perPeriod=0.974, Time to solve = 7.49e+01(s) : CgWave= 7.48e+01(s) 99.89%, advance= 7.48e+01(s) 99.82%
 max-residual=3.62e-10 (WaveHoltz its), numberOfIterations = 25 (Krylov) (maximumNumberOfIterations=50)


freq=15 : NP=16 OK: ECR=.956 
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=15 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=16 -cfl=10000  -go=og



ORDER=4: LOWER freq, CHANGE POSITION to be further from boundary
    freq=10.9 NP=16 : converges, ECR=.94 **GOOD**
    freq=10.9 NP=20 : converges, ECR=.925 **GOOD**
    freq=10.9 NP=16 : converges, ECR=.91 **GOOD**
    freq=10.9 NP=14 : converges, ECR=.913 **GOOD**
    freq=10.9 NP=8 : converges, ECR=.98
    freq=11.1 NP=8 : converges slowly, ECR=.99
    freq=11  NP=4 : converges to DHS, slowly ECR=.987
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=10.9 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=14 -cfl=10000  -go=og

>>>>NP=32: *GOOD*
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.121, CR-perPeriod=0.936, Time to solve = 7.43e+01(s) : CgWave= 7.43e+01(s) 99.95%, advance= 7.42e+01(s) 99.89%
 max-residual=9.72e-11 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.105e-02, numberOfStepsPerSolve=608, totalTimeStepsStaken=7904, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  10.900, (adjusted=  10.649) T= 0.57644, Tbar=18.44605, numPeriods= 32, Tbar(0)/T= 32.00

CgWaveHoltz::residual: freq= 0, omega=  10.900, max-res=3.566e-10 (using omega), max-res=4.686e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.566e-10 (all frequencies)

Direct solve Helmholtz: cpu= 6.81e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=3.105e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=9.82e-12, |v|_max= 4.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>> NP=16 : ***GOOD**
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.237, CR-perPeriod=0.914, Time to solve = 2.67e+01(s) : CgWave= 2.66e+01(s) 99.82%, advance= 2.66e+01(s) 99.64%
 max-residual=4.22e-10 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=6.304e-02, numberOfStepsPerSolve=160, totalTimeStepsStaken=2720, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  10.900, (adjusted=   9.967) T= 0.57644, Tbar= 9.22302, numPeriods= 16, Tbar(0)/T= 16.00

CgWaveHoltz::residual: freq= 0, omega=  10.900, max-res=1.224e-09 (using omega), max-res=4.635e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.224e-09 (all frequencies)

Direct solve Helmholtz: cpu= 6.76e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=6.304e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.87e-10, |v|_max= 4.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>> omega=10.9, Np=8
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.824, CR-perPeriod=0.976, Time to solve = 1.74e+01(s) : CgWave= 7.83e+01(s) 450.79%, advance= 7.81e+01(s) 449.80%
 max-residual=3.83e-10 (WaveHoltz its), numberOfIterations = 45 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.940e-01, numberOfStepsPerSolve=40, totalTimeStepsStaken=8360, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  10.900, (adjusted=   6.477) T= 0.57644, Tbar= 4.61151, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=  10.900, max-res=6.519e-07 (using omega), max-res=4.635e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.519e-07 (all frequencies)

Direct solve Helmholtz: cpu= 6.72e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.940e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.84e-07, |v|_max= 4.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

'

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.948, CR-perPeriod=0.987, Time to solve = 9.82e+00(s) : CgWave= 6.02e+01(s) 612.60%, advance= 5.99e+01(s) 610.10%
 max-residual=2.19e-08 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.922e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=6480, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=2.483e-05 (using omega), max-res=4.371e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.483e-05 (all frequencies)

Direct solve Helmholtz: cpu= 6.76e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.922e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=6.13e-06, |v|_max= 3.82e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





REVISIT SHAPES:

FREQ=67.1 : NP=20 
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67.1 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=250 -numPeriods=20 -cfl=10000  -go=og



FREQ=67 : NP=8 STALLS 
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=250 -numPeriods=8 -cfl=10000  -go=og



FREQ=67 : NP=20
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=20 -cfl=10000  -go=og




FREQ=67 : NP=20 CFL=10
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=20 -cfl=10 -go=og


FREQ=67 : NP=40
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=40 -cfl=10000  -go=og


FREQ=67 : NP=20
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=20 -cfl=10000  -go=og


FREQ=67 : NP=8
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=8 -cfl=10000  -go=og




**************************************************
**** Wed Jan 25, 2023


------------------------------------------------
----------------------- PIPE -------------------
------------------------------------------------


>>> TWO FREQ PIPE -- QUESTION: what happeded to 2nd frequency?
    --> change source locations:
NP=8 IMP: 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 -.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeTwoFreqNp8G2Order4Imp -go=dfk > pipeTwoFreqNp8G2Order4Imp.out



------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze2.order4.ng3.hdf
 Convergence rate CR=0.411, CR-perPeriod=0.895, Time to solve = 1.55e+02(s) : CgWave= 4.05e+02(s) 261.96%, advance= 4.05e+02(s) 261.91%
 max-residual=2.16e-09 (WaveHoltz its), numberOfIterations = 29 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=8.084e-02, numberOfStepsPerSolve=80, totalTimeStepsStaken=6480, aveItsPerImplicitSolve=  3.0
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   7.773) T= 0.73920, Tbar= 5.91359, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  17.000, (adjusted=  12.749) T= 0.36960, Tbar= 4.80479, numPeriods= 13, Tbar(0)/T= 16.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=1.327e+02.
CgWaveHoltz::residual: freq= 1, omega=  17.000, max-res=1.327e+02.
CgWaveHoltz: max-res=1.327e+02 (all frequencies)

Direct solve Helmholtz: cpu= 6.31e+02(s), iterations=3 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(50) + reverse Cuthill-McKee ordering]
saveMatlab: dt=8.084e-02
CgWaveHoltz::saved results in matlab file=[pipeTwoFreqNp8G2Order4ImpKrylov.m]
cgwh: rel-max-diff=7.75e-09 for freq0 =   8.5000e+00, |v|_max= 3.55e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.35e-06 for freq1 =   1.7000e+01, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.35e-06, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...


NP=8 EXP: 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 -.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeTwoFreqNp8G2Order4Exp -go=fk > pipeTwoFreqNp8G2Order4Exp.out
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze2.order4.ng3.hdf
 Convergence rate CR=0.207, CR-perPeriod=0.821, Time to solve = 1.48e+02(s) : CgWave= 5.38e+02(s) 362.17%, advance= 5.38e+02(s) 362.12%
 max-residual=4.18e-13 (WaveHoltz its), numberOfIterations = 17 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=1.950e-03, numberOfStepsPerSolve=3032, totalTimeStepsStaken=209208, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 freq= 0, omega=   8.500, (adjusted=   8.500) T= 0.73920, Tbar= 5.91359, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  17.000, (adjusted=  17.001) T= 0.36960, Tbar= 5.91359, numPeriods= 16, Tbar(0)/T= 16.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=1.327e+02.
CgWaveHoltz::residual: freq= 1, omega=  17.000, max-res=1.327e+02.
CgWaveHoltz: max-res=1.327e+02 (all frequencies)







NP=4 -- not so good(?) --> SOURCE LOCATIONS BAD 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeTwoFreqNp4G2Order4Imp -go=dfk > pipeTwoFreqNp4G2Order4Imp.out

cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.2 -0.2 0.25 -y0=0.1 -0.2 -0.3 0.15 -z0=0.45 0.65 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeTwoFreqNp4G2Order4Exp -go=fk > pipeTwoFreqNp4G2Order4Exp.out



G2 O4 IMP
cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeOneFreqNp4G2Order4Imp -go=dfk > pipeOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze2.order4.ng3.hdf
 Convergence rate CR=0.378, CR-perPeriod=0.784, Time to solve = 5.32e+01(s) : CgWave= 1.44e+02(s) 269.96%, advance= 1.44e+02(s) 269.84%
 max-residual=7.50e-11 (WaveHoltz its), numberOfIterations = 25 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.488e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=1540, aveItsPerImplicitSolve=  5.4
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   5.051) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=1.327e+02 (using omega), max-res=1.349e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.327e+02 (all frequencies)

Direct solve Helmholtz: cpu= 3.15e+02(s), iterations=1 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(50) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.488e-01
CgWaveHoltz::saved results in matlab file=[pipeOneFreqNp4G2Order4ImpKrylov.m]
cgwh: rel-max-diff=2.86e-10, |v|_max= 3.55e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


G2 O4 EXP
cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeOneFreqNp4G2Order4Exp -go=fk > pipeOneFreqNp4G2Order4Exp.out


iluh=20: breakdown 
iluh=50: OK 

cgwh -noplot gaussian.cmd -g=pipeze2.order2 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeOneFreqNp4G2Order2Imp -go=dfk > pipeOneFreqNp4G2Order2Imp.out



------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze2.order2.hdf
 Convergence rate CR=0.357, CR-perPeriod=0.773, Time to solve = 9.36e+00(s) : CgWave= 9.33e+00(s) 99.62%, advance= 9.30e+00(s) 99.35%
 max-residual=1.91e-09 (WaveHoltz its), numberOfIterations = 26 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.488e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=560, aveItsPerImplicitSolve=  7.8
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   5.051) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=1.327e+02 (using omega), max-res=1.372e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.327e+02 (all frequencies)

Direct solve Helmholtz: cpu= 5.56e+01(s), iterations=1 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(50) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.488e-01
CgWaveHoltz::saved results in matlab file=[pipeOneFreqNp4G2Order4ImpKrylov.m]
cgwh: rel-max-diff=2.12e-08, |v|_max= 3.45e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





**************************************************
**** Tues Jan 24, 2023


------------------------------------------------
----------------------- SPHERE ------------------
------------------------------------------------


CHOOSE omega=8.5  (should be ok from exact eigs)

G2 Order 4 NP=4 - IMP  INCLUDE DIRECT SOLVE: 
setsid $cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=dfk > sphereOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/spheree2.order4.ng3.hdf
 Convergence rate CR=0.602, CR-perPeriod=0.881, Time to solve = 6.21e+02(s) : CgWave= 1.20e+03(s) 193.41%, advance= 1.20e+03(s) 193.34%
 max-residual=1.59e-10 (WaveHoltz its), numberOfIterations = 47 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.488e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=1980, aveItsPerImplicitSolve=  5.5
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   5.051) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=2.243e-08 (using omega), max-res=2.766e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.243e-08 (all frequencies)

Direct solve Helmholtz: cpu= 2.12e+04(s), iterations=2 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(100) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.488e-01
CgWaveHoltz::saved results in matlab file=[sphereOneFreqNp4G2Order4ImpKrylov.m]
cgwh: rel-max-diff=3.93e-09, |v|_max= 4.05e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




G2 Order 4 NP=8 - IMP  **QUESTION** WHY 48 STEPS??
cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp8G2Order4Imp -go=fk > sphereOneFreqNp8G2Order4Imp.out


 grid=/home/henshw/grids/spheree2.order4.ng3.hdf
 Convergence rate CR=0.207, CR-perPeriod=0.822, Time to solve = 4.48e+02(s) : CgWave= 1.35e+03(s) 300.34%, advance= 1.35e+03(s) 300.27%
 max-residual=6.05e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.664e-01, numberOfStepsPerSolve=48, totalTimeStepsStaken=3264, aveItsPerImplicitSolve=  3.1
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   6.294) T= 0.73920, Tbar= 5.91359, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=2.755e-07 (using omega), max-res=2.801e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.755e-07 (all frequencies)
saveMatlab: dt=1.664e-01





G2 Order 4 NP=4 - IMP  
cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=fk > sphereOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/spheree2.order4.ng3.hdf
 Convergence rate CR=0.602, CR-perPeriod=0.881, Time to solve = 6.33e+02(s) : CgWave= 1.22e+03(s) 193.33%, advance= 1.22e+03(s) 193.25%
 max-residual=1.59e-10 (WaveHoltz its), numberOfIterations = 47 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.488e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=1980, aveItsPerImplicitSolve=  5.5
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   5.051) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=2.243e-08 (using omega), max-res=2.766e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.243e-08 (all frequencies)
saveMatlab: dt=2.488e-01



G2 Order 4 - EXP 
cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Exp -go=fk > sphereOneFreqNp4G2Order4Exp.out



G2 Order 2
cgwh gaussian.cmd -g=spheree2.order2 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order2Imp -go=fk > sphereOneFreqNp4G2Order2Imp.out

G2 Order 2 - EXP 
cgwh gaussian.cmd -g=spheree2.order2 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order2Exp -go=fk > sphereOneFreqNp4G2Order2Exp.out




SPHERE2 ORDER=4 - IMP 
   DHS --GMRES + ILU(50) 
cgwh gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=halt dfk > sphereOneFreqNp4G2Order4Imp.out




BOX4 ORDER=4 
    ILU(20) -- NO GOOD 
cgwh gaussian.cmd -g=box4.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000  -solveri=cgs -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=20 -maxith=50000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=halt


BOX2 ORDER=4 
cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000  -solveri=cgs -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=20 -maxith=50000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order4.ng3.hdf
 Convergence rate CR=0.178, CR-perPeriod=0.650, Time to solve = 6.34e+00(s) : CgWave= 6.32e+00(s) 99.70%, advance= 6.31e+00(s) 99.60%
 max-residual=1.27e-12 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.611e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=340, aveItsPerImplicitSolve=  5.4
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.100, (adjusted=   4.813) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=3.746e-11 (using omega), max-res=7.882e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.746e-11 (all frequencies)

Direct solve Helmholtz: cpu= 1.57e+01(s), iterations=3 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(20) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.611e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.59e-11, |v|_max= 1.27e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



BOX2 IMP -- try GMRES for DHS
  ilu(10) -- break down
  ilu(20) -- OK
  ilu(50) -- OK
cgwh gaussian.cmd -g=box2.order2 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000  -solveri=cgs -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=20 -maxith=50000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order2.hdf
 Convergence rate CR=0.184, CR-perPeriod=0.655, Time to solve = 2.35e+00(s) : CgWave= 2.34e+00(s) 99.37%, advance= 2.33e+00(s) 99.12%
 max-residual=1.67e-12 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.611e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=340, aveItsPerImplicitSolve=  7.6
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.100, (adjusted=   4.813) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=2.916e-10 (using omega), max-res=7.913e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.916e-10 (all frequencies)

Direct solve Helmholtz: cpu= 3.13e+00(s), iterations=229 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(20) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.611e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=2.07e-08, |v|_max= 1.28e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



**************************************************
**** Mon Jan 23, 2023

------------------------------------------------
----------------------- SPHERE ------------------
------------------------------------------------

SPHERE - IMP --> trouble with GMRES for direct solve  --GMRES + ILU(100) OK 
cgwh gaussian.cmd -g=spheree2.order2 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order2Imp -go=halt dfk > sphereOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/spheree2.order2.hdf
 Convergence rate CR=0.785, CR-perPeriod=0.941, Time to solve = 1.77e+02(s) : CgWave= 1.76e+02(s) 99.65%, advance= 1.76e+02(s) 99.53%
 max-residual=2.50e-09 (WaveHoltz its), numberOfIterations = 94 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.611e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=1920, aveItsPerImplicitSolve=  7.0
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.100, (adjusted=   4.813) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=1.258e-06 (using omega), max-res=1.618e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.258e-06 (all frequencies)

Direct solve Helmholtz: cpu= 1.73e+03(s), iterations=2 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(100) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.611e-01
CgWaveHoltz::saved results in matlab file=[sphereOneFreqNp4G2Order2ImpKrylov.m]
cgwh: rel-max-diff=2.79e-06, |v|_max= 2.61e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


OLD: 
+++ SPHERE : NEED TO FIX ORDER=4 grid : sphere.cmd
cgwh gaussian.cmd -g=spheree4.order2 -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=100 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHSphereO2Omega8p1Krylov -tol=1e-8 -ad4=1 -imode=1 -maxIterations=100 -go=og



------------------------------------------------
------------------------ BOX ------------------
------------------------------------------------

BOX EXP 
cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -matlab=boxOneFreqNp4G2Order4Exp -go=dfk

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order4.ng3.hdf
 Convergence rate CR=0.090, CR-perPeriod=0.547, Time to solve = 2.63e+00(s) : CgWave= 1.93e+01(s) 733.97%, advance= 1.93e+01(s) 732.70%
 max-residual=1.04e-12 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=5.921e-03, numberOfStepsPerSolve=524, totalTimeStepsStaken=50304, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 freq= 0, omega=   8.100, (adjusted=   8.101) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=3.830e-12 (using omega), max-res=2.554e-02 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.830e-12 (all frequencies)

Direct solve Helmholtz: cpu= 1.46e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.921e-03
CgWaveHoltz::saved results in matlab file=[boxOneFreqNp4G2Order4ExpKrylov.m]
cgwh: rel-max-diff=7.66e-13, |v|_max= 1.27e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


BOX IMP 
cgwh -noplot gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=boxOneFreqNp4G2Order4Imp -go=dfk > boxOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order4.ng3.hdf
 Convergence rate CR=0.191, CR-perPeriod=0.661, Time to solve = 3.57e+00(s) : CgWave= 3.55e+00(s) 99.34%, advance= 3.54e+00(s) 99.15%
 max-residual=1.33e-12 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.611e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=360, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   8.100, (adjusted=   4.813) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=6.845e-11 (using omega), max-res=7.882e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.845e-11 (all frequencies)

Direct solve Helmholtz: cpu= 1.46e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=2.611e-01
CgWaveHoltz::saved results in matlab file=[boxOneFreqNp4G2Order4ImpKrylov.m]
cgwh: rel-max-diff=1.35e-11, |v|_max= 1.27e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


------------------------------------------------
------------------------ DISK ------------------
------------------------------------------------

FIVE FREQ< NP=6
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=6 -cfl=10000 -matlab=diskFourFreqNp4G4Order4Imp -go=halt dfk > diskFourFreqNp4G4Order4Imp.out


NF=1 COMPUTED HIGHEST FREQ:

NP=64 CPU=32.2
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=1 -freq=22 3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=10000 -numPeriods=64 -cfl=10000 -matlab=diskOneFreqNp8G4Order4Imp -go=halt 



NP=32 CPU=12
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=1 -freq=22 3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=10000 -numPeriods=32 -cfl=10000 -matlab=diskOneFreqNp8G4Order4Imp -go=halt dfk > diskOneFreqNp8G4Order4Imp.out


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.334, CR-perPeriod=0.966, Time to solve = 1.22e+01(s) : CgWave= 1.21e+01(s) 99.86%, advance= 1.21e+01(s) 99.77%
 max-residual=1.88e-12 (WaveHoltz its), numberOfIterations = 24 (Krylov) (maximumNumberOfIterations=10000)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.123e-02, numberOfStepsPerSolve=320, totalTimeStepsStaken=8320, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  22.000, (adjusted=  20.117) T= 0.28560, Tbar= 9.13918, numPeriods= 32, Tbar(0)/T= 32.00

CgWaveHoltz::residual: freq= 0, omega=  22.000, max-res=1.360e-11 (using omega), max-res=3.130e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.360e-11 (all frequencies)

Direct solve Helmholtz: cpu= 1.22e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=3.123e-02
CgWaveHoltz::saved results in matlab file=[diskOneFreqNp8G4Order4ImpKrylov.m]
cgwh: rel-max-diff=2.21e-12, |v|_max= 6.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




NP=16 *much faster than NP=8 CPU=14.6
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=1 -freq=22 3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=10000 -numPeriods=16 -cfl=10000 -matlab=diskOneFreqNp8G4Order4Imp -go=halt dfk > diskOneFreqNp8G4Order4Imp.out
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.809, CR-perPeriod=0.987, Time to solve = 1.46e+01(s) : CgWave= 1.45e+01(s) 99.57%, advance= 1.45e+01(s) 99.29%
 max-residual=2.75e-12 (WaveHoltz its), numberOfIterations = 117 (Krylov) (maximumNumberOfIterations=10000)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.612e-02, numberOfStepsPerSolve=80, totalTimeStepsStaken=9520, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  22.000, (adjusted=  13.073) T= 0.28560, Tbar= 4.56959, numPeriods= 16, Tbar(0)/T= 16.00

CgWaveHoltz::residual: freq= 0, omega=  22.000, max-res=2.564e-09 (using omega), max-res=3.130e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.564e-09 (all frequencies)

Direct solve Helmholtz: cpu= 1.24e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=9.612e-02
CgWaveHoltz::saved results in matlab file=[diskOneFreqNp8G4Order4ImpKrylov.m]
cgwh: rel-max-diff=2.05e-09, |v|_max= 6.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



NP=8
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=1 -freq=22 3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=10000 -numPeriods=8 -cfl=10000 -matlab=diskOneFreqNp8G4Order4Imp -go=halt dfk > diskFiveFreqNp8G4Order4Imp.out
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.987, CR-perPeriod=0.998, Time to solve = 1.06e+02(s) : CgWave= 1.05e+02(s) 99.16%, advance= 1.04e+02(s) 98.61%
 max-residual=3.12e-12 (WaveHoltz its), numberOfIterations = 1816 (Krylov) (maximumNumberOfIterations=10000)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.612e-02, numberOfStepsPerSolve=40, totalTimeStepsStaken=72720, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  22.000, (adjusted=  13.073) T= 0.28560, Tbar= 2.28479, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=  22.000, max-res=9.532e-08 (using omega), max-res=3.028e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=9.532e-08 (all frequencies)





**************************************************
**** Sun Jan 22, 2023

>>>>> NF=5 ADD an intermediate freq, COMPARE To 4 freq
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=5 -freq=3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=diskFiveFreqNp8G4Order4Imp -go=dfk > diskFiveFreqNp8G4Order4Imp.out



PLOTS FOR PAPER

plotStuff plotSolution -show=diskFourFreqNp8G4Order4.show -name=diskFourFreqNp8G4Order4 -solution=1 -numFreq=4

>>>>>>>>>>>>>>>> NF=4
SHOW FILE FOR PLOTS: 
cgwh gaussian.cmd -g=sice8.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -show=diskFourFreqNp8G8Order4.show -go=halt


SHOW FILE FOR PLOTS: 
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -show=diskFourFreqNp8G4Order4.show -go=halt


cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=diskFourFreqNp8G4Order4Imp -go=dfk > diskFourFreqNp8G4Order4Imp.out

NF=4 EXP G4 
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=.95 -matlab=diskFourFreqNp8G4Order4Exp -go=dfk > diskFourFreqNp8G4Order4Exp.out

NF=4 EXP G8 
cgwh -noplot gaussian.cmd -g=sice8.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=.95 -matlab=diskFourFreqNp8G8Order4Exp -go=dfk > diskFourFreqNp8G8Order4Exp.out


>>>>>>>>>>>>> NF=1
IMPLICIT NF=1
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=diskOneFreqNp4G4Order4Imp -go=dfk > diskOneFreqNp4G4Order4Imp.out

IMPLICIT NF=1, NP=1
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=diskOneFreqNp1G4Order4Imp -go=dfk > diskOneFreqNp1G4Order4Imp.out

IMPLICIT NF=1, NP=1, G8
cgwh -noplot gaussian.cmd -g=sice8.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=diskOneFreqNp1G8Order4Imp -go=dfk > diskOneFreqNp1G8Order4Imp.out


EXPLICIT NF=1, NP=1, O4, G8
cgwh -noplot gaussian.cmd -g=sice8.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -matlab=diskOneFreqNp1G8Order4Exp -go=dfk > diskOneFreqNp1G8Order4Exp.out

EXPLICIT NF=1, NP=1, O2, G8
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -matlab=diskOneFreqNp1G8Order2Exp -go=dfk



EXPLICIT NF=1, NP=1
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -matlab=diskOneFreqNp1G4Order2Exp -go=dfk

EXPLICIT NF=1, NP=4
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=0.95 -matlab=diskOneFreqNp4G4Order2Exp -go=dfk



**************************************************
**** Sat Jan 21, 2023

cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-.25 .3 -.2 .25 -y0=-.2 .25 -.3 .15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=diskFourFreqNp8G4Order4 -go=dfk

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.489, CR-perPeriod=0.915, Time to solve = 1.51e+01(s) : CgWave= 4.37e+01(s) 290.14%, advance= 4.37e+01(s) 289.84%
 max-residual=1.43e-10 (WaveHoltz its), numberOfIterations = 31 (Krylov) (maximumNumberOfIterations=30)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=5.695e-02, numberOfStepsPerSolve=296, totalTimeStepsStaken=28416, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.982) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   9.000, (adjusted=   8.546) T= 0.69813, Tbar=15.35890, numPeriods= 22, Tbar(0)/T= 24.00
 freq= 2, omega=  18.000, (adjusted=  15.029) T= 0.34907, Tbar=13.96263, numPeriods= 40, Tbar(0)/T= 48.00
 freq= 3, omega=  22.000, (adjusted=  17.140) T= 0.28560, Tbar=12.85197, numPeriods= 45, Tbar(0)/T= 58.67

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=1.302e-09.
CgWaveHoltz::residual: freq= 1, omega=   9.000, max-res=1.197e-09.
CgWaveHoltz::residual: freq= 2, omega=  18.000, max-res=1.955e-09.
CgWaveHoltz::residual: freq= 3, omega=  22.000, max-res=3.171e-09.
CgWaveHoltz: max-res=3.171e-09 (all frequencies)

Direct solve Helmholtz: cpu= 4.05e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.695e-02
CgWaveHoltz::saved results in matlab file=[diskFourFreqNp8G4Order4Krylov.m]
cgwh: rel-max-diff=5.45e-12 for freq0 =   3.0000e+00, |v|_max= 1.35e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.12e-11 for freq1 =   9.0000e+00, |v|_max= 9.51e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=5.00e-11 for freq2 =   1.8000e+01, |v|_max= 4.01e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.26e-09 for freq3 =   2.2000e+01, |v|_max= 5.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.26e-09, |v|_max= 4.01e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...



cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-.25 .3 -.2 .25 -y0=-.2 .25 -.3 .15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=-1 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=diskFourFreqNp8G4Order2 -go=dfk


>>>>>>>>>>>>> NF=1
IMPLICIT NF=1
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=diskOneFreqNp4G4Order2Imp -go=dfk


EXPLICIT NF=1
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=0.95 -matlab=diskOneFreqNp4G4Order2Exp -go=dfk




**** Thurs Jan 19, 2023

cgwh gaussian.cmd -g=square64.order4.ng3 -x0=0.5 0.5 -y0=0.4 0.45 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=1000 -matlab=squareGaussianOneFreqNp2 -go=og


Np=1
cgwh gaussian.cmd -g=square64.order4.ng3 -x0=0.5 0.5 -y0=0.4 0.45 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=1000 -matlab=squareGaussianOneFreqNp1 -go=og


**************************************************
**** Sat Jan 14, 2023

REVISIT CONVERGENCE PLOTS FOR PAPER --> plot using cgwave/doc/codes/plotResiduals


+++++++++++ SQUARE

cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWaveHoltzSquare64Order4Krylov -tol=1e-10 -ad4=0 -imode=1 -go=go

FP
cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWaveHoltzSquare64Order4FixedPoint -tol=1e-10 -ad4=0 -imode=1 -maxIterations=400 -go=go


+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



 -- GET MORE DETAILED TIMING:
  HOW MUCH TIME IS SPENT IN CGWAVE ON PROJECTIONS??

Nf=10 Np=32 -- twice as slow
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=500 -numPeriods=32 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og


Nf=10 Decrease -Np=1  -- trouble converging!!
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=500 -numPeriods=1 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og




>>>> nf=10  56/18 = 3.11
  time integral.....................  8.22e+00    1.03e-03    1.56e-08    15.069   8.220e+00   8.220e+00
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.324, CR-perPeriod=0.868, Time to solve = 5.68e+01(s) : CgWave= 5.60e+01(s) 98.69%, advance= 5.60e+01(s) 98.58%
 max-residual=5.13e-12 (WaveHoltz its), numberOfIterations = 18 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 10, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=400, totalTimeStepsStaken=8000, aveItsPerImplicitSolve=  0.0

              -------------------CgWave Summary----------------- 
                       Sat Jan 14 13:24:32 2023
               Grid:   /home/henshw/grids/square256.order2.hdf 
  ==== final time= 1.68e+01, numberOfStepsTaken =     8000, grids=1, gridpts =66049, interp pts=0, processors=1, clock=2.99 GHz ==== 
  ==== memory per-proc: [min=167.598,ave=167.598,max=167.598](Mb), max-recorded=0 (Mb), total=167.598 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  5.45e+01    6.82e-03    1.03e-07   100.000   5.455e+01   5.455e+01
setup and initialize................  9.24e-02    1.15e-05    1.75e-10     0.169   9.239e-02   9.239e-02
initialize BCs......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
initial conditions..................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
advance.............................  5.45e+01    6.81e-03    1.03e-07    99.886   5.448e+01   5.448e+01
  advance rectangular grids.........  5.92e+00    7.40e-04    1.12e-08    10.853   5.920e+00   5.920e+00
  advance curvilinear grids.........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
    implicit solve..................  3.50e+01    4.38e-03    6.63e-08    64.242   3.504e+01   3.504e+01
  add dissipation...................  4.46e+00    5.57e-04    8.44e-09     8.176   4.460e+00   4.460e+00
  boundary conditions...............  3.37e-01    4.21e-05    6.37e-10     0.617   3.367e-01   3.367e-01
  interpolation.....................  5.51e-02    6.88e-06    1.04e-10     0.101   5.507e-02   5.507e-02
  update ghost (parallel)...........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add forcing.......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  time integral.....................  8.22e+00    1.03e-03    1.56e-08    15.069   8.220e+00   8.220e+00
  get errors........................  1.97e-04    2.46e-08    3.73e-13     0.000   1.970e-04   1.970e-04
  plotting..........................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
output results......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
waiting (not counted)...............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
--------------------------------------------------------------------------------------------------------


>>>nf=8  34/14=2.4
  time integral.....................  4.41e+00    8.61e-04    1.30e-08    12.876   4.409e+00   4.409e+00

cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 -nf=8 -freq=3 6 9 12 15 18 21 24 -amp=50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=og

              -------------------CgWave Summary----------------- 
                       Sat Jan 14 13:28:51 2023
               Grid:   /home/henshw/grids/square256.order2.hdf 
  ==== final time= 1.68e+01, numberOfStepsTaken =     5120, grids=1, gridpts =66049, interp pts=0, processors=1, clock=3.00 GHz ==== 
  ==== memory per-proc: [min=158.062,ave=158.062,max=158.062](Mb), max-recorded=0 (Mb), total=158.062 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  3.43e+01    6.69e-03    1.01e-07   100.000   3.426e+01   3.426e+01
setup and initialize................  8.23e-02    1.61e-05    2.43e-10     0.240   8.229e-02   8.229e-02
initialize BCs......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
initial conditions..................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
advance.............................  3.42e+01    6.68e-03    1.01e-07    99.871   3.421e+01   3.421e+01
  advance rectangular grids.........  3.46e+00    6.75e-04    1.02e-08    10.092   3.457e+00   3.457e+00
  advance curvilinear grids.........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
    implicit solve..................  2.32e+01    4.52e-03    6.85e-08    67.623   2.317e+01   2.317e+01
  add dissipation...................  2.54e+00    4.96e-04    7.51e-09     7.418   2.541e+00   2.541e+00
  boundary conditions...............  2.14e-01    4.18e-05    6.33e-10     0.625   2.142e-01   2.142e-01
  interpolation.....................  3.63e-02    7.09e-06    1.07e-10     0.106   3.630e-02   3.630e-02
  update ghost (parallel)...........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add forcing.......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  time integral.....................  4.51e+00    8.81e-04    1.33e-08    13.161   4.509e+00   4.509e+00
  get errors........................  1.99e-04    3.89e-08    5.88e-13     0.001   1.990e-04   1.990e-04
  plotting..........................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
output results......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
waiting (not counted)...............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
--------------------------------------------------------------------------------------------------------

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.254, CR-perPeriod=0.843, Time to solve = 3.44e+01(s) : CgWave= 3.39e+01(s) 98.64%, advance= 3.39e+01(s) 98.51%
 max-residual=1.14e-11 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 8, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=320, totalTimeStepsStaken=5120, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]



TRY MORE SOLUTIONS
>>>> nf=10 TRY FP
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=32 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

FIXED POINT -- NP=16
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.627, CR-perPeriod=0.971, Time to solve = 1.24e+02(s)
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 23 (FP) (maximumNumberOfIterations=100)
 numberOfFrequencies= 10, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=800, totalTimeStepsStaken=18400, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.990) T= 2.09440, Tbar=33.51032, numPeriods= 16, Tbar(0)/T= 16.00
 freq= 1, omega=   6.000, (adjusted=   5.922) T= 1.04720, Tbar=32.46312, numPeriods= 31, Tbar(0)/T= 32.00
 freq= 2, omega=   9.000, (adjusted=   8.744) T= 0.69813, Tbar=32.11406, numPeriods= 46, Tbar(0)/T= 48.00
 freq= 3, omega=  12.000, (adjusted=  11.412) T= 0.52360, Tbar=31.93953, numPeriods= 61, Tbar(0)/T= 64.00
 freq= 4, omega=  15.000, (adjusted=  13.897) T= 0.41888, Tbar=30.99705, numPeriods= 74, Tbar(0)/T= 80.00
 freq= 5, omega=  18.000, (adjusted=  16.182) T= 0.34907, Tbar=30.01966, numPeriods= 86, Tbar(0)/T= 96.00
 freq= 6, omega=  21.000, (adjusted=  18.260) T= 0.29920, Tbar=29.02233, numPeriods= 97, Tbar(0)/T=112.00
 freq= 7, omega=  24.000, (adjusted=  20.135) T= 0.26180, Tbar=28.01253, numPeriods=107, Tbar(0)/T=128.00
 freq= 8, omega=  27.000, (adjusted=  21.815) T= 0.23271, Tbar=26.99443, numPeriods=116, Tbar(0)/T=144.00
 freq= 9, omega=  30.000, (adjusted=  23.315) T= 0.20944, Tbar=25.97050, numPeriods=124, Tbar(0)/T=160.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=6.144e-06.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=8.089e-05.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=7.522e-05.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=2.526e-04.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=1.621e-04.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=4.326e-04.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=4.176e-04.
CgWaveHoltz::residual: freq= 7, omega=  24.000, max-res=5.473e-04.
CgWaveHoltz::residual: freq= 8, omega=  27.000, max-res=6.471e-04.
CgWaveHoltz::residual: freq= 9, omega=  30.000, max-res=7.055e-04.
CgWaveHoltz: max-res=7.055e-04 (all frequencies)

Direct solve Helmholtz: cpu= 2.61e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=1.58e-08 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.56e-07 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.50e-07 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.15e-06 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.64e-06 for freq4 =   1.5000e+01, |v|_max= 1.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.72e-06 for freq5 =   1.8000e+01, |v|_max= 3.93e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.75e-06 for freq6 =   2.1000e+01, |v|_max= 8.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.71e-06 for freq7 =   2.4000e+01, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.95e-04 for freq8 =   2.7000e+01, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.57e-05 for freq9 =   3.0000e+01, |v|_max= 1.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.95e-04, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





>> nf=2 omega=33, 36
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=2 -freq=33 36 3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og



>> nf=2 omega=33, 36
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 0.55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=2 -freq=33 36 3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

>>>> nf=12
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.372, CR-perPeriod=0.884, Time to solve = 7.97e+01(s)
 max-residual=1.05e-11 (WaveHoltz its), numberOfIterations = 20 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 12, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=480, totalTimeStepsStaken=10560, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.993) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   6.000, (adjusted=   5.946) T= 1.04720, Tbar=15.70796, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=   9.000, (adjusted=   8.820) T= 0.69813, Tbar=16.05703, numPeriods= 23, Tbar(0)/T= 24.00
 freq= 3, omega=  12.000, (adjusted=  11.583) T= 0.52360, Tbar=15.70796, numPeriods= 30, Tbar(0)/T= 32.00
 freq= 4, omega=  15.000, (adjusted=  14.209) T= 0.41888, Tbar=15.49852, numPeriods= 37, Tbar(0)/T= 40.00
 freq= 5, omega=  18.000, (adjusted=  16.679) T= 0.34907, Tbar=15.35890, numPeriods= 44, Tbar(0)/T= 48.00
 freq= 6, omega=  21.000, (adjusted=  18.982) T= 0.29920, Tbar=14.95997, numPeriods= 50, Tbar(0)/T= 56.00
 freq= 7, omega=  24.000, (adjusted=  21.113) T= 0.26180, Tbar=14.66077, numPeriods= 56, Tbar(0)/T= 64.00
 freq= 8, omega=  27.000, (adjusted=  23.073) T= 0.23271, Tbar=14.19534, numPeriods= 61, Tbar(0)/T= 72.00
 freq= 9, omega=  30.000, (adjusted=  24.867) T= 0.20944, Tbar=13.82301, numPeriods= 66, Tbar(0)/T= 80.00
 freq=10, omega=  33.000, (adjusted=  26.502) T= 0.19040, Tbar=13.32797, numPeriods= 70, Tbar(0)/T= 88.00
 freq=11, omega=  36.000, (adjusted=  27.989) T= 0.17453, Tbar=12.91544, numPeriods= 74, Tbar(0)/T= 96.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=3.433e-09.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=4.250e-09.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=4.075e-09.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=5.305e-09.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=4.870e-09.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=6.111e-09.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=5.670e-09.
CgWaveHoltz::residual: freq= 7, omega=  24.000, max-res=5.086e-09.
CgWaveHoltz::residual: freq= 8, omega=  27.000, max-res=5.619e-09.
CgWaveHoltz::residual: freq= 9, omega=  30.000, max-res=7.566e-09.
CgWaveHoltz::residual: freq=10, omega=  33.000, max-res=7.594e-09.
CgWaveHoltz::residual: freq=11, omega=  36.000, max-res=7.576e-09.
CgWaveHoltz: max-res=7.594e-09 (all frequencies)

Direct solve Helmholtz: cpu= 3.13e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=2.70e-12 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=9.82e-12 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=7.22e-12 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.60e-11 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.23e-11 for freq4 =   1.5000e+01, |v|_max= 1.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.55e-11 for freq5 =   1.8000e+01, |v|_max= 3.93e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.91e-11 for freq6 =   2.1000e+01, |v|_max= 8.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.53e-11 for freq7 =   2.4000e+01, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.25e-10 for freq8 =   2.7000e+01, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.90e-10 for freq9 =   3.0000e+01, |v|_max= 1.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=9.94e-11 for freq10 =   3.3000e+01, |v|_max= 8.69e-02 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.13e-10 for freq11 =   3.6000e+01, |v|_max= 9.61e-02 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.25e-10, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




>>>> nf=10
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.324, CR-perPeriod=0.868, Time to solve = 5.71e+01(s)
 max-residual=5.13e-12 (WaveHoltz its), numberOfIterations = 18 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 10, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=400, totalTimeStepsStaken=8000, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.990) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   6.000, (adjusted=   5.922) T= 1.04720, Tbar=15.70796, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=   9.000, (adjusted=   8.744) T= 0.69813, Tbar=16.05703, numPeriods= 23, Tbar(0)/T= 24.00
 freq= 3, omega=  12.000, (adjusted=  11.412) T= 0.52360, Tbar=15.70796, numPeriods= 30, Tbar(0)/T= 32.00
 freq= 4, omega=  15.000, (adjusted=  13.897) T= 0.41888, Tbar=15.49852, numPeriods= 37, Tbar(0)/T= 40.00
 freq= 5, omega=  18.000, (adjusted=  16.182) T= 0.34907, Tbar=15.00983, numPeriods= 43, Tbar(0)/T= 48.00
 freq= 6, omega=  21.000, (adjusted=  18.260) T= 0.29920, Tbar=14.36157, numPeriods= 48, Tbar(0)/T= 56.00
 freq= 7, omega=  24.000, (adjusted=  20.135) T= 0.26180, Tbar=13.87537, numPeriods= 53, Tbar(0)/T= 64.00
 freq= 8, omega=  27.000, (adjusted=  21.815) T= 0.23271, Tbar=13.49721, numPeriods= 58, Tbar(0)/T= 72.00
 freq= 9, omega=  30.000, (adjusted=  23.315) T= 0.20944, Tbar=12.98525, numPeriods= 62, Tbar(0)/T= 80.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=2.182e-09.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=1.748e-09.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=3.760e-09.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=4.326e-09.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=4.071e-09.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=5.345e-09.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=5.025e-09.
CgWaveHoltz::residual: freq= 7, omega=  24.000, max-res=4.919e-09.
CgWaveHoltz::residual: freq= 8, omega=  27.000, max-res=5.306e-09.
CgWaveHoltz::residual: freq= 9, omega=  30.000, max-res=7.496e-09.
CgWaveHoltz: max-res=7.496e-09 (all frequencies)

Direct solve Helmholtz: cpu= 2.63e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=1.83e-12 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=9.82e-12 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.01e-11 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.60e-11 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.64e-11 for freq4 =   1.5000e+01, |v|_max= 1.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.82e-11 for freq5 =   1.8000e+01, |v|_max= 3.93e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.53e-11 for freq6 =   2.1000e+01, |v|_max= 8.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.42e-11 for freq7 =   2.4000e+01, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.90e-11 for freq8 =   2.7000e+01, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.88e-10 for freq9 =   3.0000e+01, |v|_max= 1.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.88e-10, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>> nf=8 
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 -nf=8 -freq=3 6 9 12 15 18 21 24 -amp=50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.254, CR-perPeriod=0.843, Time to solve = 3.42e+01(s)
 max-residual=1.14e-11 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 8, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=320, totalTimeStepsStaken=5120, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.985) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   6.000, (adjusted=   5.879) T= 1.04720, Tbar=15.70796, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=   9.000, (adjusted=   8.607) T= 0.69813, Tbar=16.05703, numPeriods= 23, Tbar(0)/T= 24.00
 freq= 3, omega=  12.000, (adjusted=  11.115) T= 0.52360, Tbar=15.18436, numPeriods= 29, Tbar(0)/T= 32.00
 freq= 4, omega=  15.000, (adjusted=  13.372) T= 0.41888, Tbar=14.66077, numPeriods= 35, Tbar(0)/T= 40.00
 freq= 5, omega=  18.000, (adjusted=  15.370) T= 0.34907, Tbar=14.31170, numPeriods= 41, Tbar(0)/T= 48.00
 freq= 6, omega=  21.000, (adjusted=  17.119) T= 0.29920, Tbar=13.46397, numPeriods= 45, Tbar(0)/T= 56.00
 freq= 7, omega=  24.000, (adjusted=  18.638) T= 0.26180, Tbar=12.82817, numPeriods= 49, Tbar(0)/T= 64.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=5.343e-09.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=4.992e-09.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=8.368e-09.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=1.016e-08.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=7.855e-09.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=9.617e-09.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=1.182e-08.
CgWaveHoltz::residual: freq= 7, omega=  24.000, max-res=1.442e-08.
CgWaveHoltz: max-res=1.442e-08 (all frequencies)

Direct solve Helmholtz: cpu= 2.12e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=2.21e-12 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=9.82e-12 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.21e-11 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.23e-11 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.33e-11 for freq4 =   1.5000e+01, |v|_max= 1.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.12e-11 for freq5 =   1.8000e+01, |v|_max= 3.93e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.03e-10 for freq6 =   2.1000e+01, |v|_max= 8.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.73e-10 for freq7 =   2.4000e+01, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.73e-10, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.156, CR-perPeriod=0.793, Time to solve = 2.96e+01(s)
 max-residual=1.46e-10 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 7, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=280, totalTimeStepsStaken=4480, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.980) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   6.000, (adjusted=   5.843) T= 1.04720, Tbar=15.70796, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=   9.000, (adjusted=   8.496) T= 0.69813, Tbar=15.35890, numPeriods= 22, Tbar(0)/T= 24.00
 freq= 3, omega=  12.000, (adjusted=  10.878) T= 0.52360, Tbar=15.18436, numPeriods= 29, Tbar(0)/T= 32.00
 freq= 4, omega=  15.000, (adjusted=  12.967) T= 0.41888, Tbar=14.24189, numPeriods= 34, Tbar(0)/T= 40.00
 freq= 5, omega=  18.000, (adjusted=  14.766) T= 0.34907, Tbar=13.61357, numPeriods= 39, Tbar(0)/T= 48.00
 freq= 6, omega=  21.000, (adjusted=  16.298) T= 0.29920, Tbar=12.86557, numPeriods= 43, Tbar(0)/T= 56.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=1.456e-08.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=2.291e-08.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=4.020e-08.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=4.182e-08.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=6.766e-08.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=7.547e-08.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=8.346e-08.
CgWaveHoltz: max-res=8.346e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.85e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=1.63e-11 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.69e-11 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.47e-11 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.65e-11 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.34e+03 for freq4 =   1.5000e+01, |v|_max= 3.73e-02 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.09e+02 for freq5 =   1.8000e+01, |v|_max= 6.18e-02 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=7.67e+02 for freq6 =   2.1000e+01, |v|_max= 1.43e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.34e+03, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...






>> WHAT HAPPENS WITH frequencies are multiples of f0 ? --> WORKS 
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 .5 -y0=0.5 0.55 0.45 .45 -nf=4 -freq=5.0 10 15 20 -amp=50 50 50 50 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.248, CR-perPeriod=0.840, Time to solve = 1.51e+01(s)
 max-residual=4.42e-11 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=160, totalTimeStepsStaken=2560, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   5.000, (adjusted=   4.896) T= 1.25664, Tbar=10.05310, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  10.000, (adjusted=   9.241) T= 0.62832, Tbar= 9.42478, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=  15.000, (adjusted=  12.754) T= 0.41888, Tbar= 8.37758, numPeriods= 20, Tbar(0)/T= 24.00
 freq= 3, omega=  20.000, (adjusted=  15.434) T= 0.31416, Tbar= 7.85398, numPeriods= 25, Tbar(0)/T= 32.00

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=5.406e-09.
CgWaveHoltz::residual: freq= 1, omega=  10.000, max-res=1.942e-08.
CgWaveHoltz::residual: freq= 2, omega=  15.000, max-res=3.652e-08.
CgWaveHoltz::residual: freq= 3, omega=  20.000, max-res=3.702e-08.
CgWaveHoltz: max-res=3.702e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.07e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=1.34e-11 for freq0 =   5.0000e+00, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.24e-11 for freq1 =   1.0000e+01, |v|_max= 4.73e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.06e-11 for freq2 =   1.5000e+01, |v|_max= 2.26e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.50e-10 for freq3 =   2.0000e+01, |v|_max= 3.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.50e-10, |v|_max= 4.73e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...





>>>>>> NF=4 : OK 
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 .5 -y0=0.5 0.55 0.45 .45 -nf=4 -freq=5.0 11 17 27 -amp=50 50 50 50 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.312, CR-perPeriod=0.864, Time to solve = 2.42e+01(s)
 max-residual=2.12e-11 (WaveHoltz its), numberOfIterations = 17 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=216, totalTimeStepsStaken=4104, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   5.000, (adjusted=   4.943) T= 1.25664, Tbar=10.05310, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  11.000, (adjusted=  10.434) T= 0.57120, Tbar= 9.13918, numPeriods= 16, Tbar(0)/T= 17.60
 freq= 2, omega=  17.000, (adjusted=  15.112) T= 0.36960, Tbar= 8.87038, numPeriods= 24, Tbar(0)/T= 27.20
 freq= 3, omega=  27.000, (adjusted=  20.916) T= 0.23271, Tbar= 7.67945, numPeriods= 33, Tbar(0)/T= 43.20

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=1.669e-08.
CgWaveHoltz::residual: freq= 1, omega=  11.000, max-res=2.507e-08.
CgWaveHoltz::residual: freq= 2, omega=  17.000, max-res=9.088e-09.
CgWaveHoltz::residual: freq= 3, omega=  27.000, max-res=5.295e-08.
CgWaveHoltz: max-res=5.295e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.07e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=3.53e-11 for freq0 =   5.0000e+00, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.89e-11 for freq1 =   1.1000e+01, |v|_max= 4.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.69e-11 for freq2 =   1.7000e+01, |v|_max= 4.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.62e-08 for freq3 =   2.7000e+01, |v|_max= 1.49e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.62e-08, |v|_max= 1.49e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




>>>>>> NF=3 : OK 
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 -y0=0.5 0.55 0.45 -nf=3 -freq=5.0 11 17 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.176, CR-perPeriod=0.805, Time to solve = 1.03e+01(s)
 max-residual=1.23e-11 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=136, totalTimeStepsStaken=1768, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   5.000, (adjusted=   4.856) T= 1.25664, Tbar=10.05310, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  11.000, (adjusted=   9.683) T= 0.57120, Tbar= 8.56798, numPeriods= 15, Tbar(0)/T= 17.60
 freq= 2, omega=  17.000, (adjusted=  13.075) T= 0.36960, Tbar= 7.76158, numPeriods= 21, Tbar(0)/T= 27.20

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=1.800e-09.
CgWaveHoltz::residual: freq= 1, omega=  11.000, max-res=8.513e-09.
CgWaveHoltz::residual: freq= 2, omega=  17.000, max-res=2.694e-08.
CgWaveHoltz: max-res=2.694e-08 (all frequencies)

Direct solve Helmholtz: cpu= 8.07e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=6.37e-12 for freq0 =   5.0000e+00, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=7.42e-12 for freq1 =   1.1000e+01, |v|_max= 4.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.99e-10 for freq2 =   1.7000e+01, |v|_max= 4.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.99e-10, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)







**************************************************
**** Fri Jan 13, 2023

DIRECT HELMHOLTZ : increase ILU levels helps convergence

**CHECK AVERAGE NUMBER OF ITS NEEDED BY MG SOLVER**


G32: 
cgwh gaussian.cmd -g=sice16.order2.ml4 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=1000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice16.order2.ml4.hdf
 Convergence rate CR=0.143, CR-perPeriod=0.784, Time to solve = 4.73e+01(s)
 max-residual=1.26e-09 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1000.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=672, aveItsPerImplicitSolve=  5.6
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.424e-05 (using omega), max-res=2.205e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.424e-05 (all frequencies)

Direct solve Helmholtz: cpu= 1.38e+00(s), iterations=98 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=8.70e-10, |v|_max= 3.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>>>>>>>> G128

cgwh gaussian.cmd -g=sice128.order2.ml6 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice128.order2.ml6.hdf
 Convergence rate CR=0.149, CR-perPeriod=0.788, Time to solve = 2.44e+03(s)
 max-residual=5.57e-09 (WaveHoltz its), numberOfIterations = 9 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=616, aveItsPerImplicitSolve=  7.1
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=6.533e-03 (using omega), max-res=2.204e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.533e-03 (all frequencies)

Direct solve Helmholtz: cpu= 5.17e+03(s), iterations=6055 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=1.42e-09, |v|_max= 3.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>>>>>>>> G64: 1.4M pts

G64: numPeriods=2 ... about the same solve time as numPeriods=8

cgwh gaussian.cmd -g=sice64.order2.ml5 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=2000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice64.order2.ml5.hdf
 Convergence rate CR=0.782, CR-perPeriod=0.884, Time to solve = 5.35e+02(s)
 max-residual=4.10e-10 (WaveHoltz its), numberOfIterations = 78 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=2000.00, numberOfStepsPerSolve=10, totalTimeStepsStaken=800, aveItsPerImplicitSolve=  6.3
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   4.754) T= 0.78540, Tbar= 1.57080, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.960e-06 (using omega), max-res=9.554e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.960e-06 (all frequencies)



G64: numPeriods=8
cgwh gaussian.cmd -g=sice64.order2.ml5 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=2000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice64.order2.ml5.hdf
 Convergence rate CR=0.148, CR-perPeriod=0.787, Time to solve = 5.41e+02(s)
 max-residual=5.80e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=2000.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=672, aveItsPerImplicitSolve=  6.5
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.853e-04 (using omega), max-res=2.204e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.853e-04 (all frequencies)

Direct solve Helmholtz: cpu= 4.65e+02(s), iterations=2348 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.48e-10, |v|_max= 3.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



G32: 
cgwh gaussian.cmd -g=sice32.order2.ml4 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=1000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice32.order2.ml4.hdf
 Convergence rate CR=0.151, CR-perPeriod=0.789, Time to solve = 1.34e+02(s)
 max-residual=7.68e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1000.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=672, aveItsPerImplicitSolve=  6.1
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=5.975e-05 (using omega), max-res=2.204e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=5.975e-05 (all frequencies)

Direct solve Helmholtz: cpu= 2.91e+01(s), iterations=609 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.70e-10, |v|_max= 3.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




REDUCE MG CONVERGENCE TOL:
cgwh gaussian.cmd -g=sice4.order2.ml3 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=728, aveItsPerImplicitSolve=  4.6




>>> Base initial guess on solution being periodic: not much better
  ISSUE COULD BE THAT GMRES ITERATES ARE NOT CONVERGING TO THE PERIODIC SOLUTION

  Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=728, aveItsPerImplicitSolve=  6.4 


>>> START: 6.8 its/solve (MG)

cgwh gaussian.cmd -g=sice4.order2.ml3 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order2.ml3.hdf
 Convergence rate CR=0.159, CR-perPeriod=0.794, Time to solve = 7.86e+00(s)
 max-residual=2.20e-10 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=728, aveItsPerImplicitSolve=  6.8
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.950e-07 (using omega), max-res=2.225e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.950e-07 (all frequencies)

Direct solve Helmholtz: cpu= 1.60e-01(s), iterations=179 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.86e-06, |v|_max= 3.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


TRY MG WITH DISK
>>>>>>>> DISK G16
cgwh gaussian.cmd -g=sice16.order2.ml4 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=800 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice16.order2.ml4.hdf
 Convergence rate CR=0.143, CR-perPeriod=0.784, Time to solve = 8.49e+01(s)
 max-residual=7.16e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=800.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=672
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.425e-05 (using omega), max-res=2.205e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.425e-05 (all frequencies)

Direct solve Helmholtz: cpu= 4.97e+00(s), iterations=520 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=2.37e-10, |v|_max= 3.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>>> DISK G8 -- **TODO** INCREASE CFL
cgwh gaussian.cmd -g=sice8.order2.ml3 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice8.order2.ml3.hdf
 Convergence rate CR=0.119, CR-perPeriod=0.766, Time to solve = 1.94e+01(s)
 max-residual=1.10e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=64, totalTimeStepsStaken=768
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.903) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=4.584e-07 (using omega), max-res=2.243e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=4.584e-07 (all frequencies)

Direct solve Helmholtz: cpu= 2.05e-01(s), iterations=58 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=2.69e-11, |v|_max= 3.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>>>>> DISK G4
cgwh gaussian.cmd -g=sice4.order2.ml3 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order2.ml3.hdf
 Convergence rate CR=0.159, CR-perPeriod=0.794, Time to solve = 8.05e+00(s)
 max-residual=2.13e-10 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=728
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.949e-07 (using omega), max-res=2.225e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.949e-07 (all frequencies)

Direct solve Helmholtz: cpu= 1.64e-01(s), iterations=179 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.86e-06, |v|_max= 3.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

>>>>>>>>>>>>>> DISK G2
cgwh gaussian.cmd -g=sice2.order2.ml2 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice2.order2.ml2.hdf
 Convergence rate CR=0.184, CR-perPeriod=0.809, Time to solve = 4.33e+00(s)
 max-residual=4.07e-10 (WaveHoltz its), numberOfIterations = 12 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=784
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.283e-07 (using omega), max-res=2.323e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.283e-07 (all frequencies)

Direct solve Helmholtz: cpu= 6.96e-02(s), iterations=189 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=9.17e-08, |v|_max= 3.68e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...



**************************************************
**** Tues Jan 10, 2023

>>>>>> G2048: increase CFL
cgwh gaussian.cmd -g=square2048.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square2048.order2.hdf
 Convergence rate CR=0.313, CR-perPeriod=0.748, Time to solve = 4.04e+02(s)
 max-residual=1.41e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=360
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00




>>>>>> G1024: increase CFL
cgwh gaussian.cmd -g=square1024.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=1600 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square1024.order2.hdf
 Convergence rate CR=0.313, CR-perPeriod=0.748, Time to solve = 9.18e+01(s)
 max-residual=1.40e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1600.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=360
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00



------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square1024.order2.hdf
 Convergence rate CR=0.313, CR-perPeriod=0.748, Time to solve = 9.18e+01(s)
 max-residual=1.40e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1600.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=360
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=2.158e-07 (using omega), max-res=3.977e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.158e-07 (all frequencies)
cgwh: max-err =0.00e+00 (between WaveHoltz and known solution, all frequencies)



>>>>>> G1024: D=2,300s   WH=105s
cgwh gaussian.cmd -g=square1024.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=800 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og

 === Direct Helmholtz Solver:
 PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
 =====

*** freq=0: omega=11, max residual=9.98e-11, time for direct Helmholtz solve = 2.31e+03 (s) (iterations=29680) ***
CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=1.195e-07 (using omega), max-res=2.389e+01 (using omega from discrete symbol)
CgWaveHoltz: omega=1.100e+01, max-res=1.195e-07 (direct Helmholtz solution)
cgwh: max-err =0.00e+00 (between WaveHoltz and known solution, all frequencies)
cgwh: rel-max-diff=0.00e+00, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.193, CR-perPeriod=0.663, Time to solve = 1.05e+02(s)
 max-residual=4.39e-09 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=36, totalTimeStepsStaken=468
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   9.826) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=2.186e-07 (using omega), max-res=2.114e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.186e-07 (all frequencies)

Direct solve Helmholtz: cpu= 2.31e+03(s), iterations=29680 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=4.12e-09, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





USE MG to solve IMP equations: Direct=57s WH=24s 
cgwh gaussian.cmd -g=square512.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og


 === Direct Helmholtz Solver:
 PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
 =====

*** freq=0: omega=11, max residual=9.94e-11, time for direct Helmholtz solve = 5.78e+01 (s) (iterations=3189) ***

cgWave:FD22 t=2.307e+00 (12 steps) dt=1.922e-01 ||u||= 2.81e-01, cpu= 7.51e-01(s)
cgWave:FD22 t=2.691e+00 (14 steps) dt=1.922e-01 ||u||= 1.07e-01, cpu= 8.85e-01(s)
cgWave:FD22 t=3.268e+00 (17 steps) dt=1.922e-01 ||u||= 2.81e-01, cpu= 1.09e+00(s)
cgWave:FD22 t=3.845e+00 (20 steps) dt=1.922e-01 ||u||= 3.48e-01, cpu= 1.30e+00(s)
it=-3:  max(residual) = max(|v-vOld|)=1.39e-09, tol=1e-08

 ######## DONE KYRLOV ITERATIONS -- KSP residual=2.58e-10 (max-res=1.39e-09) (tol=1.00e-08) numIts=16 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.313, CR-perPeriod=0.748, Time to solve = 2.35e+01(s)
 max-residual=1.39e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=360
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=2.141e-07 (using omega), max-res=3.978e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.141e-07 (all frequencies)

Direct solve Helmholtz: cpu= 5.69e+01(s), iterations=3189 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=1.94e-09, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



OK: MG starts to work:
cgwh gaussian.cmd -g=square64.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=5 -numPeriods=4 -cfl=10 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og


**************************************************
**** Sun Jan 8, 2023

MULTIGRID??  NEED TO FIX MG PARAMETERS

cgwh gaussian.cmd -g=square64.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=5 -numPeriods=4 -cfl=10 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og



>>> SQUARE512
cgwh gaussian.cmd -g=square512.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-6 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-6 -atolh=1.0e-6 -maxith=10000 -solveri=bcgs -rtoli=1e-4 -atoli=1e-4 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.552, CR-perPeriod=0.862, Time to solve = 2.16e+02(s)
 max-residual=4.67e-05 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=150)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=260
    implicit solver : PETSc, solver=[bi-conjugate gradient stabilized + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=7.726e-02 (using omega), max-res=3.980e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=7.726e-02 (all frequencies)

Direct solve Helmholtz: cpu= 3.09e+01(s), iterations=1727 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.51e-04, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh gaussian.cmd -g=square128.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-8 -atolh=1.0e-8 -maxith=1000 -solveri=bcgs -go=og


**************************************************
**** Sat Jan 7, 2023

ADD OPTION TO USE PETSC FOR DIRECT HELMHOLTZ SOLVER


ADD OPTION TO USE PETSC FOR IMPLICIT TIME_STEPPING


cgwh gaussian.cmd -g=square256.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=1000 -solveri=bcgs -go=og



>>>> WH (12s) is faster than GMRES (44s) but slower than Yale (2s)
cgwh gaussian.cmd -g=square512.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-8  -atolh=1.0e-8 -maxith=5000 -go=og

=== Solver:
 PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
 =====

*** freq=0: omega=11, max residual=1.00e-08, time for direct Helmholtz solve = 4.41e+01 (s) (iterations=2446) ***

 ######## DONE KYRLOV ITERATIONS -- KSP residual=2.73e-11 (max-res=1.31e-10) (tol=1.00e-10) numIts=17 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.374, CR-perPeriod=0.782, Time to solve = 1.17e+01(s)
 max-residual=1.31e-10 (WaveHoltz its), numberOfIterations = 17 (Krylov) (maximumNumberOfIterations=150)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=380
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=6.588e-06 (using omega), max-res=3.978e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.588e-06 (all frequencies)
cgwh: rel-max-diff=1.74e-07, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




cgwh gaussian.cmd -g=square256.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=1000 -go=og


cgwh gaussian.cmd -g=square1024.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -go=og

 ######## DONE KYRLOV ITERATIONS -- KSP residual=8.60e-11 (max-res=3.38e-10) (tol=1.00e-10) numIts=10 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.235, CR-perPeriod=0.696, Time to solve = 6.90e+01(s)
 max-residual=3.38e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=150)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=36, totalTimeStepsStaken=432
 freq= 0, omega=  11.000, (adjusted=   9.826) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=1.077e-05 (using omega), max-res=2.114e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.077e-05 (all frequencies)
cgwh: rel-max-diff=3.75e-10, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





cgwh gaussian.cmd -g=square128.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -go=og

--- square 128:
 ######## DONE KYRLOV ITERATIONS -- KSP residual=7.49e-11 (max-res=2.72e-10) (tol=1.00e-10) numIts=17 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.352, CR-perPeriod=0.771, Time to solve = 5.55e-01(s)
 max-residual=2.72e-10 (WaveHoltz its), numberOfIterations = 17 (Krylov) (maximumNumberOfIterations=150)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=380
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=4.490e-08 (using omega), max-res=3.995e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=4.490e-08 (all frequencies)
cgwh: rel-max-diff=4.43e-10, |v|_max= 3.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





**************************************************
**** Fri Dec 30, 2022

FREQ=70
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=70 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega70.show -go=og


FREQ=69
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=69 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega69.show -go=og


FREQ=68
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=68 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega68.show -go=og

FREQ=67
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega67.show -go=og

FREQ=66
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=66 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega66.show -go=og




Higher freq: 
cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=33 9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

 ######## DONE KYRLOV ITERATIONS -- KSP residual=8.03e-09 (max-res=2.95e-08) (tol=1.00e-10) numIts=104 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.879, CR-perPeriod=0.968, Time to solve = 6.62e+00(s)
 max-residual=2.95e-08 (WaveHoltz its), numberOfIterations = 104 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=4240
 freq= 0, omega=  33.000, (adjusted=  19.609) T= 0.19040, Tbar= 0.76160, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  33.000, max-res=1.950e-03 (using omega), max-res=8.401e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.950e-03 (all frequencies)
cgwh: max-diff=2.38e-04 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


**************************************************
**** Thurs Dec 29, 2022

RETURN TO WAVE-HOLTZ


OK: increase Frequency:
cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=15 9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

 ######## DONE KYRLOV ITERATIONS -- KSP residual=2.49e-08 (max-res=1.22e-07) (tol=1.00e-10) numIts=104 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.866, CR-perPeriod=0.965, Time to solve = 7.77e+00(s)
 max-residual=1.22e-07 (WaveHoltz its), numberOfIterations = 104 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=24, totalTimeStepsStaken=5088
 freq= 0, omega=  15.000, (adjusted=  11.107) T= 0.41888, Tbar= 1.67552, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=9.188e-04 (using omega), max-res=3.132e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=9.188e-04 (all frequencies)
cgwh: max-diff=1.63e-03 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




OK: nf=1
cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

 ######## DONE KYRLOV ITERATIONS -- KSP residual=2.43e-11 (max-res=1.40e-10) (tol=1.00e-10) numIts=33 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.534, CR-perPeriod=0.855, Time to solve = 3.48e+00(s)
 max-residual=1.40e-10 (WaveHoltz its), numberOfIterations = 33 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=32, totalTimeStepsStaken=2240
 freq= 0, omega=   9.777, (adjusted=   8.437) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=1.327e-06 (using omega), max-res=3.251e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.327e-06 (all frequencies)
cgwh: max-diff=4.05e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...



Needs upwinding:
cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -y0=-.75 -omega=6.666 -amp=20 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

>>>>>>>>
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.55 -.55 .5 -y0=.5 .5 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.571, CR-perPeriod=0.869, Time to solve = 6.83e+00(s)
 max-residual=2.60e-10 (WaveHoltz its), numberOfIterations = 34 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=28, totalTimeStepsStaken=1008
 freq= 0, omega=   9.777, (adjusted=   7.985) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.216) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=1.221e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=3.154e-08.


**************************************************
**** Sun Jan 16, 2022

--- ANNULUS NOTE : Increase beta so SOURCE TERM IS ZERO AT BOUNDARY (Our current BC's do not support an f)

TWO FREQ IMPLICIT
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.55 -.55 .5 -y0=.5 .5 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.623, CR-perPeriod=0.888, Time to solve = 1.82e+01(s)
 max-residual=2.10e-10 (WaveHoltz its), numberOfIterations = 41 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=28, totalTimeStepsStaken=1204
 freq= 0, omega=   9.777, (adjusted=   7.985) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.216) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=2.327e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=4.727e-08.
CgWaveHoltz: max-res=4.727e-08 (all frequencies)
cgwh: max-diff=8.71e-10 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.48e-08 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.48e-08 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

... tighter tol: 
CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=1.623e-10.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=2.388e-10.
CgWaveHoltz: max-res=2.388e-10 (all frequencies)
cgwh: max-diff=8.48e-13 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.62e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.62e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>>>>>>>>>TEST more terms

Nf=5 - close frequencies
cgwh gaussian.cmd -g=square128.order4.ng3.hdf -nf=4 -freq=21 22 23 24 25 -x0=.4 .6 .3 .7 -y0=.4 .6 .7 .3 -amp=150 100 200 400 -beta=200 250 200 300 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=8 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.912, CR-perPeriod=0.989, Time to solve = 2.20e+01(s)
 numberOfIterations = 104 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=48, totalTimeStepsStaken=13440
 freq= 0, omega=  21.000, (adjusted=  15.550) T= 0.29920, Tbar= 2.39359, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  22.000, (adjusted=  15.946) T= 0.28560, Tbar= 2.28479, numPeriods=  8, Tbar(0)/T=  8.38
 freq= 2, omega=  23.000, (adjusted=  16.317) T= 0.27318, Tbar= 2.18546, numPeriods=  8, Tbar(0)/T=  8.76
 freq= 3, omega=  24.000, (adjusted=  16.665) T= 0.26180, Tbar= 2.09440, numPeriods=  8, Tbar(0)/T=  9.14

CgWaveHoltz::residual: freq= 0, omega=  21.000, max-res=6.958e-07.
CgWaveHoltz::residual: freq= 1, omega=  22.000, max-res=1.765e-06.
CgWaveHoltz::residual: freq= 2, omega=  23.000, max-res=1.860e-06.
CgWaveHoltz::residual: freq= 3, omega=  24.000, max-res=7.707e-07.
CgWaveHoltz: max-res=1.860e-06 (all frequencies)
cgwh: max-diff=1.29e-07 for freq0 =   2.1000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.11e-07 for freq1 =   2.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.08e-05 for freq2 =   2.3000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.53e-08 for freq3 =   2.4000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.08e-05 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



Nf=4 
cgwh gaussian.cmd -g=square128.order4.ng3.hdf -nf=4 -freq=9.777 12.34 18.9 21.4 -x0=.4 .6 .3 .7 -y0=.4 .6 .7 .3 -amp=150 100 200 400 -beta=200 250 200 300 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=40 -go=og
------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.687, CR-perPeriod=0.910, Time to solve = 1.44e+01(s)
 numberOfIterations = 56 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl= 40.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=3248
 freq= 0, omega=   9.777, (adjusted=   9.359) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=  11.530) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05
 freq= 2, omega=  18.900, (adjusted=  16.326) T= 0.33244, Tbar= 1.99466, numPeriods=  6, Tbar(0)/T=  7.73
 freq= 3, omega=  21.400, (adjusted=  17.861) T= 0.29361, Tbar= 2.05525, numPeriods=  7, Tbar(0)/T=  8.76

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=1.550e-07.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=3.779e-08.
CgWaveHoltz::residual: freq= 2, omega=  18.900, max-res=3.260e-07.
CgWaveHoltz::residual: freq= 3, omega=  21.400, max-res=2.528e-07.
CgWaveHoltz: max-res=3.260e-07 (all frequencies)
cgwh: max-diff=5.13e-08 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.14e-10 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.38e-06 for freq2 =   1.8900e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.03e-10 for freq3 =   2.1400e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.38e-06 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh gaussian.cmd -g=square64.order4.ng3.hdf -nf=4 -freq=9.777 12.34 17.7 21.4 -x0=.4 .6 .3 .7 -y0=.4 .6 .5 .3 -amp=50 100 200 400 -beta=200 250 200 300 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=20 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.767, CR-perPeriod=0.936, Time to solve = 4.86e+00(s)
 numberOfIterations = 96 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl= 20.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=5488
 freq= 0, omega=   9.777, (adjusted=   9.359) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=  11.530) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05
 freq= 2, omega=  17.700, (adjusted=  15.533) T= 0.35498, Tbar= 2.12989, numPeriods=  6, Tbar(0)/T=  7.24
 freq= 3, omega=  21.400, (adjusted=  17.861) T= 0.29361, Tbar= 2.05525, numPeriods=  7, Tbar(0)/T=  8.76

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=4.598e-10.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=8.631e-10.
CgWaveHoltz::residual: freq= 2, omega=  17.700, max-res=6.351e-09.
CgWaveHoltz::residual: freq= 3, omega=  21.400, max-res=6.627e-09.
CgWaveHoltz: max-res=6.627e-09 (all frequencies)
cgwh: max-diff=2.49e-11 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.25e-11 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.05e-06 for freq2 =   1.7700e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=7.50e-10 for freq3 =   2.1400e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.05e-06 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...



Nf=2
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.4 .6 .5 -y0=.4 .6 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og

**************************************************
**** Sat Jan 15, 2022

RUN FOR PLOTS:

G8 IMPLICIT THREE FREQ 
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=3 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=8 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.500, CR-perPeriod=0.917, Time to solve = 4.60e+01(s)
 numberOfIterations = 30 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=88, totalTimeStepsStaken=2816
 freq= 0, omega=   8.000, (adjusted=   7.438) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  13.700, (adjusted=  11.348) T= 0.45863, Tbar= 5.50352, numPeriods= 12, Tbar(0)/T= 13.70
 freq= 2, omega=  17.300, (adjusted=  13.162) T= 0.36319, Tbar= 5.08466, numPeriods= 14, Tbar(0)/T= 17.30

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=5.639e-09.
CgWaveHoltz::residual: freq= 1, omega=  13.700, max-res=1.579e-08.
CgWaveHoltz::residual: freq= 2, omega=  17.300, max-res=2.228e-08.
CgWaveHoltz: max-res=2.228e-08 (all frequencies)
cgwh: max-diff=3.60e-11 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.18e-09 for freq1 =   1.3700e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.93e-09 for freq2 =   1.7300e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.93e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



G4 IMPLICIT THREE FREQ 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=3 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=8 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.600, CR-perPeriod=0.938, Time to solve = 1.15e+01(s)
 numberOfIterations = 40 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=88, totalTimeStepsStaken=6424
 freq= 0, omega=   8.000, (adjusted=   7.438) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  13.700, (adjusted=  11.348) T= 0.45863, Tbar= 5.50352, numPeriods= 12, Tbar(0)/T= 13.70
 freq= 2, omega=  17.300, (adjusted=  13.162) T= 0.36319, Tbar= 5.08466, numPeriods= 14, Tbar(0)/T= 17.30

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.657e-07.
CgWaveHoltz::residual: freq= 1, omega=  13.700, max-res=5.753e-07.
CgWaveHoltz::residual: freq= 2, omega=  17.300, max-res=7.498e-07.
CgWaveHoltz: max-res=7.498e-07 (all frequencies)
cgwh: max-diff=1.38e-09 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.83e-07 for freq1 =   1.3700e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.16e-09 for freq2 =   1.7300e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.83e-07 (between WaveHoltz and Direct Helmholtz solution, all frequencies)






G4 IMPLICIT THREE FREQ 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=3 -freq=8.0 12.34 17 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=8 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.797, CR-perPeriod=0.972, Time to solve = 7.45e+00(s)
 numberOfIterations = 25 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=88, totalTimeStepsStaken=5544
 freq= 0, omega=   8.000, (adjusted=   7.438) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  12.340, (adjusted=  10.536) T= 0.50917, Tbar= 5.60089, numPeriods= 11, Tbar(0)/T= 12.34
 freq= 2, omega=  17.000, (adjusted=  13.028) T= 0.36960, Tbar= 5.17439, numPeriods= 14, Tbar(0)/T= 17.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=8.197e-11.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=2.406e-10.
CgWaveHoltz::residual: freq= 2, omega=  17.000, max-res=1.141e-10.
CgWaveHoltz: max-res=2.406e-10 (all frequencies)
cgwh: max-diff=8.20e-13 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.87e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.94e-10 for freq2 =   1.7000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.87e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



G8 IMPLICIT TWO FREQ
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=2 -freq=8.0 12.34 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.684, CR-perPeriod=0.909, Time to solve = 3.05e+01(s)
 numberOfIterations = 57 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=32, totalTimeStepsStaken=1888
 freq= 0, omega=   8.000, (adjusted=   6.903) T= 0.78540, Tbar= 3.14159, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.167) T= 0.50917, Tbar= 2.54586, numPeriods=  5, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=7.315e-09.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=2.422e-08.
CgWaveHoltz: max-res=2.422e-08 (all frequencies)
cgwh: max-diff=5.73e-10 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.93e-08 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.93e-08 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



IMPLICIT TWO FREQ
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=2 -freq=8.0 12.34 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 52 (maximumNumberOfIterations=100)
 numberOfFrequencies=2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.833, CR-perPeriod=0.955, Time to solve = 5.31e+00(s)
 freq= 0, omega=   8.000, (adjusted=   6.903) T= 0.78540, Tbar= 3.14159, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.167) T= 0.50917, Tbar= 2.54586, numPeriods=  5, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=5.318e-11.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=1.876e-10.
CgWaveHoltz: max-res=1.876e-10 (all frequencies)
cgwh: max-diff=4.25e-13 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.71e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.71e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



IMPLICIT TWO FREQ
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=2 -freq=8.0 12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=10 -go=og


CFL=100
------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 61 (maximumNumberOfIterations=100)
 numberOfFrequencies=2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.722, CR-perPeriod=0.922, Time to solve = 6.50e+00(s)
 freq= 0, omega=   8.000, (adjusted=   6.903) T= 0.78540, Tbar= 3.14159, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.167) T= 0.50917, Tbar= 2.54586, numPeriods=  5, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.869e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=9.103e-08.
CgWaveHoltz: max-res=9.103e-08 (all frequencies)
cgwh: max-diff=5.66e-10 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.29e-06 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.29e-06 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

... solve to higher tol: 
cgwh: max-diff=3.24e-13 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.18e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.18e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



CFL=10 AFTER FIX numPeriods
------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 33 (maximumNumberOfIterations=100)
 numberOfFrequencies=2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.545, CR-perPeriod=0.859, Time to solve = 9.57e+00(s)
 freq= 0, omega=   8.000, (adjusted=   7.863) T= 0.78540, Tbar= 3.14159, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=  11.855) T= 0.50917, Tbar= 3.05503, numPeriods=  6, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.438e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=1.794e-08.
CgWaveHoltz: max-res=1.794e-08 (all frequencies)
cgwh: max-diff=2.56e-10 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.25e-08 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.25e-08 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


BEFORE FIX NUMPERIODS
------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 53 (maximumNumberOfIterations=100)
 numberOfFrequencies=2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.680, CR-perPeriod=0.908, Time to solve = 1.44e+01(s)
 freq= 0, omega=   8.000, (adjusted=   7.863) T= 0.78540, Tbar= 3.14159, numPeriods=  4.00, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=  11.855) T= 0.50917, Tbar= 2.03669, numPeriods=  4.00, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.250e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=1.782e-08.
CgWaveHoltz: max-res=1.782e-08 (all frequencies)
cgwh: max-diff=2.65e-10 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.68e-07 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.68e-07 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




IMPLICIT **WORKS NOW*** -- using adjust. for upwinding 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=1 -freq=12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=10 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 49 (maximumNumberOfIterations=100)
 numberOfFrequencies=1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.668, CR-perPeriod=0.904, Time to solve = 8.78e+00(s)
 freq= 0, omega=  12.340, (adjusted=  11.881) T= 0.50917, Tbar= 2.03669, numPeriods=  4.00, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  12.340, max-res=9.465e-07 (using omega), max-res=2.170e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=9.465e-07 (all frequencies)
cgwh: max-diff=2.40e-05 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=1 -freq=12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=.9 -go=og


**************************************************
**** Fri Jan 14, 2022

START more examples for waho



cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=1 -freq=12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=.9 -go=og

EXPLICIT: FD24u 
cgwh: max-diff=5.42e-05 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

IMPLICIT 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=1 -freq=12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=10 -go=og

CFL=1 FD24u

FD24u *TROUBLE** with upwinding

cgwh: max-diff=6.65e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

FD24
cgwh: max-diff=1.50e-08 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


SIC -Np=4 (ok) trouble Np=2
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=10 -go=og


UPWIND: trouble
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=5.917e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12.34, max-res=5.910e-02 (using omega).
cgwh: max-diff=5.11e-02 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.28e+00 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.28e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


NO upwind
cgwh: max-diff=8.10e-12 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.55e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.55e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.4 .6 .5 -y0=.4 .6 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og


TWO FREQ IMPLICIT
  >> RESIDUAL IS VERY SMALL BUT DIFF IS LARGER??
  BETA=100 --> WORKS!!
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.5 .5 .5 -y0=.5 .5 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=100 100 100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og
cgwh: max-diff=4.45e-10 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.89e-10 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.89e-10 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


BTA=50 : 
 ######## DONE KYRLOV ITERATIONS -- KSP residual=7.34e-15 (max-res=1.07e-14) (tol=1.00e-14) numIts=10 #######
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.4520749e+00 (from symbol of D+D-), dt=9.180709e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=8.497e-11 (using omega).
CgWaveHoltz::residual: freq=1, omega=12.34, max-res=4.755e-11 (using omega).
CgWaveHoltz: omega=9.777e+00, max-res=8.497e-11, CR=0.456 CR-perPeriod=0.675, cpu= 3.56e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=7.54e-12 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.24e-04 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.24e-04 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




+++++++++++++++++++++++ ANNULUS:

***CHECK*** residual in freq2 -- works ok for trigHelmholtz 

FREQ=12.34 - OK 
cgwh gaussian.cmd -g=annulus4.order4.ng3.hdf -x0=.5 .5 .5 -y0=.5 .5 .5 -nf=1 -freq=12.34 -amp=50 50 50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og
cgwh: max-diff=1.03e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


TWO FREQ IMPLICIT
cgwh gaussian.cmd -g=annulus4.order4.ng3.hdf -x0=.5 .5 .5 -y0=.5 .5 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=100 100 100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og



OK -- one freq
cgwh gaussian.cmd -g=annulus8.order2.hdf -x0=.5 -y0=.5 -nf=1 -freq=12.34  -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=20 -go=og

cgwh: max-diff=1.07e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

THREE FREQ -- ***TROUBLE***
cgwh gaussian.cmd -g=annulus8.order2.hdf -x0=.5 -y0=.5 -nf=3 -freq=9.777 12.34 15 -beta=100 100 100 -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=20 -go=og


cgwh gaussian.cmd -g=annulus8.order2.hdf -x0=.5 -y0=.5 -nf=2 -freq=9.777 12.34 -beta=100 100 -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=20 -go=og


ORDER=2 : TWO FREQ IMPLICIT
cgwh gaussian.cmd -g=annulus8.order2.hdf -x0=.5 -y0=.5 -nf=2 -freq=9.777 12.34 -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=20 -go=og
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=5.154e-08 (using omega).
CgWaveHoltz::residual: freq=1, omega=12.34, max-res=6.031e-08 (using omega).
CgWaveHoltz: omega=9.777e+00, max-res=6.031e-08, CR=0.111 CR-perPeriod=0.334, cpu= 8.94e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=9.49e-11 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.12e-03 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=9.49e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


TWO FREQ IMPLICIT
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -nf=2 -freq=9.777 12.34 -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og

CFL=10: steps=51
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=2.170e-10 (using omega).
CgWaveHoltz::residual: freq=1, omega=12.34, max-res=2.300e-10 (using omega).
CgWaveHoltz: omega=9.777e+00, max-res=2.300e-10, CR=0.804 CR-perPeriod=0.897, cpu= 4.02e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=4.08e-12 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.99e-03 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.08e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




TWO FREQ EXPLICIT -- ***CHECK*** residual in freq2
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -nf=2 -freq=9.777 12.34 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -go=og

cgwh: max-diff=2.21e-11 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.99e-03 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.21e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -nf=1 -freq=9.777 -amp=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -go=og

######## DONE KYRLOV ITERATIONS -- KSP residual=4.99e-11 (max-res=1.90e-10) (tol=1.00e-10) numIts=15 #######
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.7761795e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=2.673e-09 (using omega), max-res=3.401e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.673e-09, CR=0.255 CR-perPeriod=0.505, cpu= 1.12e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=3.94e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



OLD:
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega9p777Krylov -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -show=annulusOmega9p777.show -go=og




**************************************************
**** Wed Jan 12, 2022

CHECK after changes to upwind coeff


G8 IMPLICIT 
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -ts=implicit -cfl=1000 -numPeriods=4 -go=og


CFL=1000 steps=20, kits=26
cgwh: max-diff=1.82e-05 (between WaveHoltz and Direct Helmholtz solution)

numPeriods=4:
CFL=100 steps=32 kits=16
cgwh: max-diff=6.60e-06 (between WaveHoltz and Direct Helmholtz solution)

G8 IMPLICIT
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -ts=implicit -cfl=10 -go=og



CFL=10 steps=11, kits=70
cgwh: max-diff=2.30e-05 (between WaveHoltz and Direct Helmholtz solution)

CFL=1 steps=104, kits=30
cgwh: max-diff=1.76e-05 (between WaveHoltz and Direct Helmholtz solution)



G8 IMPLICIT
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -ts=implicit -cfl=1 -go=og

CFL=20 steps=6 kits=190!!
cgwh: max-diff=2.64e-05 (between WaveHoltz and Direct Helmholtz solution)

CFL-10 steps=11 kits=70
cgwh: max-diff=2.30e-05 (between WaveHoltz and Direct Helmholtz solution)

CFL=1 steps=104m kits=30
cgwh: max-diff=1.76e-05 (between WaveHoltz and Direct Helmholtz solution)

IMPLICIT
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -ts=implicit -cfl=1 -go=og

CFL=10 steps=6
cgwh: max-diff=7.71e-04 (between WaveHoltz and Direct Helmholtz solution)

CFL=1
cgwh: max-diff=5.44e-04 (between WaveHoltz and Direct Helmholtz solution)

EXPLICIT: 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-9 -upwind=1 -imode=1 -maxIterations=100 -go=og


 ######## DONE KYRLOV ITERATIONS -- KSP residual=8.15e-10 (max-res=3.47e-09) (tol=1.00e-09) numIts=29 #######

CgWaveHoltz::residual: freq=0, omega=8.1, max-res=2.298e-06 (using omega), max-res=6.627e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=2.298e-06, CR=0.539 CR-perPeriod=0.539, cpu= 9.16e-01(s)
cgwh: max-diff=1.34e-06 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Fri Dec 31, 2021

Multi-freq results for proposal



**************************************************
**** Thurs Dec 30, 2021

generate plots for OverHoltz proposal


NON ZERO INITIAL CONDITION IS BROKEN (RANDOM)

>>> GMRES -- converges fast to a TOLERANCE = 1e-9 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-9 -ad4=1 -imode=1 -maxIterations=100 -go=og


>>> GMRES -- converges fast to a TOLERANCE = 1e-9 
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-9 -ad4=1 -imode=1 -maxIterations=100 -go=og

it=-3:  max(residual) = max(|v-vOld|)=5.51e-06, tol=1e-09

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.02e-10 (max-res=5.51e-06) (tol=1.00e-09) numberOfIterations=29 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=1.769e-02 (using omega), max-res=4.729e-08 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.769e-02, CR=0.531 CR-perPeriod=0.531, cpu= 2.35e+00(s)
CgWaveHoltz::Results saved to file junk.m
cgwh: max-diff=3.24e-03 (between WaveHoltz and Direct Helmholtz solution)




>>> GMRES -- BROKEN: slow to converge
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -show=junk.show -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=4.67e-10 (max-res=3.88e-02) (tol=1.00e-12) numberOfIterations=207 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=1.769e-02 (using omega), max-res=1.099e-08 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.769e-02, CR=0.914 CR-perPeriod=0.914, cpu= 1.52e+01(s)
CgWaveHoltz::Results saved to file jumk.m
cgwh: max-diff=3.24e-03 (between WaveHoltz and Direct Helmholtz solution)



>>> FP : may be OK
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=jumk -tol=1e-10 -ad4=1 -imode=1 -maxIterations=200 -go=og


CgWave::advance: c=1, numberOfFrequencies=1, omega=8.1, Tperiod=0.775702, numPeriods=1, tFinal=0.775702, plotOptions=0
cgWave:FD24 t=0.000e+00 (  0 steps) dt=6.687e-03 ||u||= 9.77e-01, cpu= 0.00e+00(s)
cgWave:FD24 t=7.757e-01 (116 steps) dt=6.687e-03 ||u||= 9.77e-01, cpu= 6.91e-02(s)
it=199:  l2Norm( v-vOld )=1.43e-11 (tol=1e-12)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 200 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =200 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=1.769e-02 (using omega), max-res=2.064e-08 (using omega from discrete symbol)

 >>>> cgwh: omega=8.100e+00, max-res=1.769e-02, CR=0.991 CR-perPeriod=0.991, cpu= 1.40e+01(s)
CgWaveHoltz::Results saved to file jumk.m
cgwh: max-diff=3.24e-03 (between WaveHoltz and Direct Helmholtz solution)

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=1.769e-02 (using omega), max-res=3.295e-08 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.769e-02, CR=0.949 CR-perPeriod=0.949, cpu= 1.52e+01(s)
CgWaveHoltz::Results saved to file jumk.m
cgwh: max-diff=1.04e-02 (between WaveHoltz and Direct Helmholtz solution)








>>> OLD: ++++++++++++++++ DISK 

SOMETHING WRONG WITH direct solve order=4 ??

>>>>>>>>>SIC ORDER=4
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHDiskO4Omega8p1Krylov -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -show=gaussianDiskOmega8p1.show -go=og

cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHDiskO4Omega8p1FPI -tol=1e-10 -ad4=1 -imode=1 -maxIterations=400 -go=og

it=399:  l2Norm( v-vOld )=6.26e-05 (tol=1e-10)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 400 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =400 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09901e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.054e-01 (using omega), max-res=8.808e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.054e-01, CR=0.983 CR-perPeriod=0.983, cpu= 4.00e+01(s)
CgWaveHoltz::Results saved to file gaussianWHDiskO4Omega8p1FPI.m



cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=none -matlab=test -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.41e-11 (tol=1.00e-10) numberOfIterations=26 #############
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09901e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.776e-02 (using omega), max-res=9.749e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.776e-02, CR=0.476 CR-perPeriod=0.476, cpu= 2.97e+00(s)
CgWaveHoltz::Results saved to file test.m
CgWaveHoltz: max-diff=3.25e-03 (between WaveHoltz and Direct Helmholtz solution)







**************************************************
**** Wed Dec 15, 2021

FIXED: solveHelmholtz : ignore bc<=0 



REVISIT GAUSSIAN SOURCE -- TRY fancier geometries

*trouble*
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -go=og


TEST SIS -- slow convergence  **CHECK ME --> BIG ERRORS  **SOMETHING IS WRONG ****
cgwh gaussian.cmd -g=sise4.order2.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-14 -upwind=1 -imode=1 -maxIterations=100 -go=og


RESIDUAL IS LARGE NEAR INTERP POINTS -- 
errors look OK
cgwh gaussian.cmd -g=sice4.order2.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-14 -upwind=1 -imode=1 -maxIterations=100 -go=og



 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.87e-15 (tol=1.00e-14) numberOfIterations=93 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0948783e+00 (from symbol of D+D-), dt=1.520984e-02, adjustOmega=1, upwind=1
 **** WARNING: upwinding is ON! Correcting omega for the discrete-time-symbol will not fully work to give a small residual ! *****
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.094878339772e+00
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.094878339772e+00
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=2.712e+00 (using omega), max-res=2.646e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=2.712e+00, CR=0.734 CR-perPeriod=0.734, cpu= 4.16e+00(s)
CgWaveHoltz::Results saved to file junk.m
cgwh: max-diff=6.60e-02 (between WaveHoltz and Direct Helmholtz solution)



OK
cgwh gaussian.cmd -g=square64.order2 -nf=2 -freq=5.1 12 -x0=.7 .3 -y0=.7 .3 -omega=5.1 -amp=100 100 -beta=100 100 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -ad4=0 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=7.64e-09 (tol=1.00e-08) numberOfIterations=14 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=8.421e-03 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.501e-01 (using omega).
CgWaveHoltz: omega=5.100e+00, max-res=1.501e-01, CR=0.411 CR-perPeriod=0.411, cpu= 5.83e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=1.13e-03 (between WaveHoltz and Direct Helmholtz solution)

**************************************************
**** Sun Oct 31, 2021

START ON multi-freq

TRY TWO FREQUENCIES: starts to work (use same frequencies as for boxHelmholtz)
cgwh gaussian.cmd -g=square64.order2 -nf=2 -freq=5.1 12 -x0=.7 .3 -y0=.7 .3 -omega=5.1 -amp=100 100 -beta=100 100 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -ad4=0 -imode=1 -go=halt


cgWave:FD22 t=1.232e+00 (124 steps) dt=9.935e-03 ||u||= 2.84e+00, cpu= 3.75e-02(s)
it=-3:  max(|v-vOld|)=7.36e-09, tol=1e-08

 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.24e-09 (tol=1.00e-08) numberOfIterations=16 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=2.594e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=2.145e-01 (using omega).
CgWaveHoltz: omega=5.100e+00, max-res=2.145e-01, CR=0.304 CR-perPeriod=0.304, cpu= 7.15e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=3.94e-03 (between WaveHoltz and Direct Helmholtz solution)




cgwh gaussian.cmd -g=square64.order2 -nf=1 -freq=17.17 -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=0 -imode=1 -go=halt


 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.31e-13 (tol=1.00e-12) numberOfIterations=30 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 1.7170000e+01, omegas= 1.7149377e+01 (from symbol of D+D-), dt=9.890263e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  1.714937666998e+01
CgWaveHoltz::residual: freq=0, omega=17.17, max-res=1.009e-08 (using omega), max-res=1.063e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=1.717e+01, max-res=1.009e-08, CR=0.870 CR-perPeriod=0.870, cpu= 3.45e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=9.84e-10 (between WaveHoltz and Direct Helmholtz solution)




cgwh gaussian.cmd -g=square32.order2  -nf=1 -freq=9.777 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=1 -solver=none -tol=1e-10 -ad4=1 -go=halt


 ################ DONE KYRLOV ITERATIONS -- KSP residual=5.50e-16 (tol=1.00e-10) numberOfIterations=2 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.7622385e+00 (from symbol of D+D-), dt=1.947423e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  9.762238536132e+00
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=6.441e-12 (using omega), max-res=7.193e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=6.441e-12, CR=0.000 CR-perPeriod=0.000, cpu= 2.85e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=6.66e-15 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Tues July 27, 2021

Save figure for doc's

cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega9p777Krylov -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -show=annulusOmega9p777.show -go=og


 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.27e-15 (tol=1.00e-14) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.7761795e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  9.776179483905e+00
CgWaveHoltz::residual: max-res=1.414e-11 (using omega), max-res=3.401e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=1.414e-11, CR=0.385 CR-perPeriod=0.385, cpu= 5.42e+00(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega9p777Krylov.m



**************************************************
**** Mon July 26, 2021


REVISIT DISK: --> RESIDUALS small with adjustOmega, DIRECT solve seems to work
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-14 -ad4=1 -imode=1 -maxIterations=400 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=8.41e-15 (tol=1.00e-10) numberOfIterations=1 #############
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.099009848595e+00
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.099009848595e+00
CgWaveHoltz::residual: max-res=3.521e-11 (using omega), max-res=1.773e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=3.521e-11, CR=1.000 CR-perPeriod=1.000, cpu= 2.44e-01(s)
CgWaveHoltz::Results saved to file junk.m
CgWaveHoltz: max-diff=3.53e-14 (between WaveHoltz and Direct Helmholtz solution)



 ################ DONE KYRLOV ITERATIONS -- KSP residual=4.56e-15 (tol=1.00e-14) numberOfIterations=24 #############
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.099009848595e+00
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.099009848595e+00
CgWaveHoltz::residual: max-res=3.007e-11 (using omega), max-res=1.773e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=3.007e-11, CR=0.710 CR-perPeriod=0.710, cpu= 1.79e+00(s)
CgWaveHoltz::Results saved to file junk.m



REVISIT ANNULUS  --> RESIDUALS small with adjustOmega : (NOTE TURN OFF UPWINDING) 

cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega9p777Krylov -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -go=og


 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.27e-15 (tol=1.00e-14) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.7761795e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  9.776179483905e+00
CgWaveHoltz::residual: max-res=1.414e-11 (using omega), max-res=3.401e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=1.414e-11, CR=0.385 CR-perPeriod=0.385, cpu= 5.42e+00(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega9p777Krylov.m





**************************************************
**** Fri July 23, 2021


++++ SPHERE : NEED TO FIX ORDER=4 grid : sphere.cmd
cgwh gaussian.cmd -g=spheree4.order2 -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=100 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHSphereO2Omega8p1Krylov -tol=1e-8 -ad4=1 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.14e-09 (tol=1.00e-08) numberOfIterations=64 #############
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09720e+00 (from symbol of D+D-), dt=1.124206e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=1.650e+00 (using omega), max-res=1.634e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.650e+00, CR=0.790 CR-perPeriod=0.790, cpu= 9.67e+01(s)
CgWaveHoltz::Results saved to file gaussianWHSphereO4Omega8p1Krylov.m





cgwh gaussian.cmd -g=spheree4.order2 -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=100 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHSphereO2Omega8p1FPI -tol=1e-8 -ad4=1 -imode=1 -maxIterations=100 -go=og

it=99:  l2Norm( v-vOld )=4.72e-04 (tol=1e-08)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 100 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =100 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09720e+00 (from symbol of D+D-), dt=1.124206e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.559e+00 (using omega), max-res=2.564e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=2.559e+00, CR=0.958 CR-perPeriod=0.958, cpu= 1.42e+02(s)
CgWaveHoltz::Results saved to file gaussianWHSphereO4Omega8p1Krylov.m


++++ BOX 
cgwh gaussian.cmd -g=box4.order4.ng3.hdf -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHBoxO4Omega8p1FPI -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

it=99:  l2Norm( v-vOld )=7.23e-04 (tol=1e-10)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 100 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =100 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09720e+00 (from symbol of D+D-), dt=1.124206e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=9.514e-01 (using omega), max-res=9.631e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=9.514e-01, CR=0.963 CR-perPeriod=0.963, cpu= 2.07e+01(s)
CgWaveHoltz::Results saved to file gaussianWHBoxO4Omega8p1FPI.m


cgwh gaussian.cmd -g=box4.order4.ng3.hdf -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHBoxO4Omega8p1Krylov -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.10e-11 (tol=1.00e-10) numberOfIterations=16 #############
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09720e+00 (from symbol of D+D-), dt=1.124206e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=4.019e-02 (using omega), max-res=7.963e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=4.019e-02, CR=0.270 CR-perPeriod=0.270, cpu= 3.91e+00(s)
CgWaveHoltz::Results saved to file gaussianWHBoxO4Omega8p1Krylov.m





++++++++++++++++ DISK 

SOMETHING WRONG WITH direct solve order=4 ??

>>>>>>>>>SIC ORDER=4
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHDiskO4Omega8p1Krylov -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -show=gaussianDiskOmega8p1.show -go=og

cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHDiskO4Omega8p1FPI -tol=1e-10 -ad4=1 -imode=1 -maxIterations=400 -go=og

it=399:  l2Norm( v-vOld )=6.26e-05 (tol=1e-10)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 400 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =400 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09901e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.054e-01 (using omega), max-res=8.808e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.054e-01, CR=0.983 CR-perPeriod=0.983, cpu= 4.00e+01(s)
CgWaveHoltz::Results saved to file gaussianWHDiskO4Omega8p1FPI.m



cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=none -matlab=test -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.41e-11 (tol=1.00e-10) numberOfIterations=26 #############
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09901e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.776e-02 (using omega), max-res=9.749e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.776e-02, CR=0.476 CR-perPeriod=0.476, cpu= 2.97e+00(s)
CgWaveHoltz::Results saved to file test.m
CgWaveHoltz: max-diff=3.25e-03 (between WaveHoltz and Direct Helmholtz solution)





SIC ORDER=2
cgwh gaussian.cmd -g=sice8.order2.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=none -matlab=test -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

it=99:  l2Norm( v-vOld )=3.88e-06 (tol=1e-10)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 100 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =100 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09867e+00 (from symbol of D+D-), dt=7.757019e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.158e-01 (using omega), max-res=9.883e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.158e-01, CR=0.990 CR-perPeriod=0.990, cpu= 6.54e+00(s)
CgWaveHoltz::Results saved to file test.m
CgWaveHoltz: max-diff=2.00e-02 (between WaveHoltz and Direct Helmholtz solution)



++++++++++ ANNULUS

>>> omeg=18.4
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=18.4 -amp=20 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega18p4Krylov -tol=1e-10 -ad4=0 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=8.03e-09 (tol=1.00e-10) numberOfIterations=104 #############
CgWaveHoltz::residual: c=1, omega= 1.84000e+01, omegas= 1.83946e+01 (from symbol of D+D-), dt=4.553033e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=2.082e-02 (using omega), max-res=1.824e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=1.840e+01, max-res=2.082e-02, CR=0.870 CR-perPeriod=0.870, cpu= 1.34e+01(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega18p4.m


cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=18.4 -amp=20 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHAnnulusO4Omega18p4FPI -tol=1e-10 -ad4=0 -imode=1 -maxIterations=400 -go=og





cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega9p777Krylov -tol=1e-10 -ad4=0 -imode=1 -maxIterations=100 -go=og


 ################ DONE KYRLOV ITERATIONS -- KSP residual=4.13e-11 (tol=1.00e-10) numberOfIterations=27 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77618e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=3.417e-03 (using omega), max-res=4.099e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=3.417e-03, CR=0.476 CR-perPeriod=0.476, cpu= 6.79e+00(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega9p777Krylov.m

cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHAnnulusO4Omega9p777FPI -tol=1e-10 -ad4=0 -imode=1 -maxIterations=300 -go=og

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =200 #########################
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77618e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.351e-01 (using omega), max-res=1.355e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=1.351e-01, CR=0.974 CR-perPeriod=0.974, cpu= 4.60e+01(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega9p777FPI.m





cgwh gaussian.cmd -g=annulus4.order2 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=0 -solver=none -tol=1e-10 -ad4=1 -go=halt


+++++++++++ SQUARE

cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWaveHoltzSquare64Order4Krylov -tol=1e-10 -ad4=0 -imode=1 -go=go

FP
cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWaveHoltzSquare64Order4FixedPoint -tol=1e-10 -ad4=0 -imode=1 -maxIterations=400 -go=go


cgwh gaussian.cmd -g=square128.order4.ng3.hdf -x0=.7 -y0=.7 -omega=15 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHSquare128O4Omega15FPI -tol=1e-10 -ad4=0 -imode=1 -maxIterations=500 -go=og

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =500 #########################
CgWaveHoltz::residual: c=1, omega= 1.50000e+01, omegas= 1.49974e+01 (from symbol of D+D-), dt=4.273544e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=2.374e-03 (using omega), max-res=4.870e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=1.500e+01, max-res=2.374e-03, CR=0.976 CR-perPeriod=0.976, cpu= 2.16e+01(s)
CgWaveHoltz::Results saved to file gaussianWHSquare128O4Omega15FPI.m



cgwh gaussian.cmd -g=square128.order4.ng3.hdf -x0=.7 -y0=.7 -omega=15 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHSquare128O4Omega15Krylov -tol=1e-10 -ad4=0 -imode=1 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.54e-11 (tol=1.00e-10) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 1.50000e+01, omegas= 1.49974e+01 (from symbol of D+D-), dt=4.273544e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=4.010e-04 (using omega), max-res=5.004e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=1.500e+01, max-res=4.010e-04, CR=0.492 CR-perPeriod=0.492, cpu= 1.58e+00(s)
CgWaveHoltz::Results saved to file gaussianWHSquare128O4Omega15Krylov.m





cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=15 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHSquare64O4Omega15Krylov -tol=1e-10 -ad4=0 -imode=1 -go=og


 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.52e-11 (tol=1.00e-10) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 1.50000e+01, omegas= 1.49897e+01 (from symbol of D+D-), dt=8.542696e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=1.195e-02 (using omega), max-res=1.977e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=1.500e+01, max-res=1.195e-02, CR=0.493 CR-perPeriod=0.493, cpu= 3.91e-01(s)
CgWaveHoltz::Results saved to file gaussianWHSquare64O4Omega15Krylov.m


**************************************************
**** Fri July 16, 2021


QUESTION -- why doesn't adjustOmega=1 work ??

cgwh gaussian.cmd -g=square32.order2 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=1 -solver=none -tol=1e-10 -ad4=1 -go=halt


REVISIT test annulus for Cassandra

cgwh gaussian.cmd -g=annulus4.order2 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=0 -solver=none -tol=1e-10 -ad4=1 -go=halt

--- random initial condition
 ################ DONE KYRLOV ITERATIONS -- KSP residual=5.16e-11 (tol=1.00e-10) numberOfIterations=48 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.446e-01 (using omega), max-res=2.520e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.446e-01, CR=0.618 CR-perPeriod=0.618, cpu= 1.28e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=2.43e-02 (between WaveHoltz and Direct Helmholtz solution)



--- zero initial condition
 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.92e-11 (tol=1.00e-10) numberOfIterations=47 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.446e-01 (using omega), max-res=2.520e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.446e-01, CR=0.668 CR-perPeriod=0.668, cpu= 1.15e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m



**************************************************
**** Fri June 11, 2021

Test annulus for Cassandra

cgwh gaussian.cmd -g=annulus4.order4.ng3 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=1 -go=halt


cgwh gaussian.cmd -g=annulus4.order4.ng3 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=0 -solver=none -tol=1e-10 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.83e-11 (tol=1.00e-10) numberOfIterations=37 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.795e-03 (using omega), max-res=1.822e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.795e-03, CR=0.561 CR-perPeriod=0.561, cpu= 2.04e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=9.09e-05 (between WaveHoltz and Direct Helmholtz solution)




cgwh gaussian.cmd -g=annulus4.order2 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=0 -solver=none -tol=1e-10 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.51e-11 (tol=1.00e-10) numberOfIterations=33 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.446e-01 (using omega), max-res=2.520e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.446e-01, CR=0.559 CR-perPeriod=0.559, cpu= 8.62e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=2.43e-02 (between WaveHoltz and Direct Helmholtz solution)
plot contours...




 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.62e-12 (tol=1.00e-11) numberOfIterations=52 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.446e-01 (using omega), max-res=2.520e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.446e-01, CR=0.664 CR-perPeriod=0.664, cpu= 1.31e+00(s)


cgwh gaussian.cmd -g=cice4.order4.ng3.hdf -x0=.9 -y0=.9 -omega=3.555 -amp=10 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

**************************************************
**** Mon May 24, 2021


TEST on more interesting grid

Make sharper peak
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -y0=-.75 -omega=9.777 -amp=20 -beta=100 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-8 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.71e-09 (tol=1.00e-08) numberOfIterations=93 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77691e+00 (from symbol of D+D-), dt=1.501518e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=3.500e-02 (using omega), max-res=3.382e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=3.500e-02, CR=0.872 CR-perPeriod=0.872, cpu= 9.54e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=1.16e-02 (between WaveHoltz and Direct Helmholtz solution)


cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -y0=-.75 -omega=6.666 -amp=20 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.35e-11 (tol=1.00e-10) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 6.66600e+00, omegas= 6.66589e+00 (from symbol of D+D-), dt=3.001822e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=5.318e-03 (using omega), max-res=4.653e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=6.666e+00, max-res=5.318e-03, CR=0.557 CR-perPeriod=0.557, cpu= 9.19e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=1.25e-03 (between WaveHoltz and Direct Helmholtz solution)


cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -y0=-.75 -omega=3.555 -amp=10 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

################ DONE KYRLOV ITERATIONS -- KSP residual=5.46e-11 (tol=1.00e-10) numberOfIterations=6 #############
CgWaveHoltz::residual: c=1, omega= 3.55500e+00, omegas= 3.55498e+00 (from symbol of D+D-), dt=3.000717e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=8.900e-05 (using omega), max-res=9.157e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=3.555e+00, max-res=8.900e-05, CR=0.061 CR-perPeriod=0.061, cpu= 4.14e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=2.49e-06 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Sun May 23, 2021


ADD OPTION TO PLOT MOVIE OF CGWAVE

Small omega: WH and H agree
cgwh gaussian.cmd -g=cice4.order4.ng3.hdf -x0=.9 -y0=.9 -omega=3.555 -amp=10 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.22e-11 (tol=1.00e-10) numberOfIterations=26 #############
CgWaveHoltz::residual: c=1, omega= 3.55500e+00, omegas= 3.55464e+00 (from symbol of D+D-), dt=1.380798e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=1.441e-03 (using omega), max-res=2.616e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.555e+00, max-res=1.441e-03, CR=0.482 CR-perPeriod=0.482, cpu= 3.86e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=4.56e-05 (between WaveHoltz and Direct Helmholtz solution)



cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=0 -go=halt


ADD SHOW FILE OPTION

plotStuff plotSolution.cmd -show=gaussianSquare.show -name=gaussianSquareOmega17p17 -solution=1

show file for doc's 
cgwh gaussian.cmd -g=square128.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=0 -show=gaussianSquare.show -go=halt


**************************************************
**** Sat May 22, 2021

Generate results for the documentation


FD24 + orderinTime=2 + adjustOmega + ad4=0 -- MATCHES
cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWaveHoltzSquare64Order4Krylov -tol=1e-10 -ad4=0 -imode=1 -go=go

FP
cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWaveHoltzSquare64Order4FixedPoint -tol=1e-10 -ad4=0 -imode=1 -go=go


cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=0 -imode=1 -go=halt





cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=0 -solver=none -tol=1e-8 -ad4=1 -imode=1 -go=halt


BUG FIXED -- userDefinedForcing: SET fLocal=0 

cgwh gaussian.cmd -g=square64.order2.hdf -x0=.7 -y0=.7 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-12 -tp=1 -ad4=0 -imode=1 -go=halt


cgwh gaussian.cmd -g=square64.order2.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=0 -solver=none -tol=1e-8 -ad4=1 -imode=1 -go=halt

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>> FLIPPED SIGN ON GAUSSIAN SOURCE so source term is a positive Gaussian by default for Helmholtz
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

BIGGER omega
FP has trouble converging
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -ad4=0 -imode=1 -go=halt


FD24 + orderinTime=2 + adjustOmega + ad4=0 -- MATCHES
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=3.333 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -ad4=0 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=8.93e-14 (tol=1.00e-12) numberOfIterations=2 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33289e+00 (from symbol of D+D-), dt=8.607669e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=4.900e-11 (using omega), max-res=1.705e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=4.900e-11, CR=0.000 CR-perPeriod=0.000, cpu= 1.27e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=6.76e-13 (between WaveHoltz and Direct Helmholtz solution)

FD24s
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.40e-13 (tol=1.00e-12) numberOfIterations=5 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33289e+00 (from symbol of D+D-), dt=8.607669e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=1.985e-06 (using omega), max-res=1.704e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=1.985e-06, CR=0.005 CR-perPeriod=0.005, cpu= 3.16e-01(s)



FD44 
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=3.333 -amp=100 -adjustOmega=0 -solver=none -tol=1e-12 -ad4=1 -imode=1 -go=halt
 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.56e-13 (tol=1.00e-12) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33285e+00 (from symbol of D+D-), dt=9.921811e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=2.525e-03 (using omega), max-res=2.393e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=2.525e-03, CR=0.028 CR-perPeriod=0.028, cpu= 3.73e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=2.27e-06 (between WaveHoltz and Direct Helmholtz solution)


>> ad4:
cgwh gaussian.cmd -g=square64.order2.hdf -x0=.7 -y0=.7 -omega=3.333 -amp=100 -adjustOmega=1 -solver=none -tol=1e-12 -ad4=1 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.26e-14 (tol=1.00e-12) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33295e+00 (from symbol of D+D-), dt=5.401486e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=5.467e-04 (using omega), max-res=1.717e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=5.467e-04, CR=0.017 CR-perPeriod=0.017, cpu= 4.69e-01(s)
CgWaveHoltz: max-diff=5.66e-05 (between WaveHoltz and Direct Helmholtz solution)


>>> NO AD4
cgwh gaussian.cmd -g=square64.order2.hdf -x0=.7 -y0=.7 -omega=3.333 -amp=100 -adjustOmega=1 -solver=none -tol=1e-12 -ad4=0 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=5.41e-13 (tol=1.00e-12) numberOfIterations=10 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33291e+00 (from symbol of D+D-), dt=7.725787e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=7.352e-11 (using omega), max-res=1.375e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=7.352e-11, CR=0.061 CR-perPeriod=0.061, cpu= 3.33e-01(s)

DIRECT SOLVER:
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33291e+00 (from symbol of D+D-), dt=7.733980e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=3.327e-11 (using omega).
CgWaveHoltz: omega=3.333e+00, max-res=3.327e-11, cpu= 2.19e-02 (Direct solution of Helmholtz).
