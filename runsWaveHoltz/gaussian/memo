
ADD THESE TO grids/Makefile: 
ogen -noplot multiKnivesGrid -prefix=sixteenKnivesGrid -nke=8 -xke=-.45 -0.35 -0.25 -0.15 0.15 0.25 0.35 .45 -nker=8 -xker=-0.4 -0.3 -0.2 -0.1 0.1 0.2 0.3 0.4 -interp=e -order=2 -factor=256
ogen -noplot multiKnivesGrid -prefix=sixteenKnivesGrid -nke=8 -xke=-.45 -0.35 -0.25 -0.15 0.15 0.25 0.35 .45 -nker=8 -xker=-0.4 -0.3 -0.2 -0.1 0.1 0.2 0.3 0.4 -interp=e -order=2 -factor=16
ogen -noplot multiKnivesGrid -prefix=sixteenKnivesGrid -nke=8 -xke=-.45 -0.35 -0.25 -0.15 0.15 0.25 0.35 .45 -nker=8 -xker=-0.4 -0.3 -0.2 -0.1 0.1 0.2 0.3 0.4 -interp=e -order=4 -factor=32

ogen -noplot multiKnivesGrid -prefix=fourteenKnivesGrid -nke=6 -xke=-0.35 -0.25 -0.15 0.15 0.25 0.35 -nker=8 -xker=-0.4 -0.3 -0.2 -0.1 0.1 0.2 0.3 0.4 -interp=e -order=2 -factor=16

set dwh = ~/Dropbox/DeflatedWaveHoltz
set ovp2 = ~/Dropbox/overHoltzPaper/part2


*******************************************
********* Tues May 20, 2025 

cp square128FD24TSINf3Np2*.m $mfwh/results/


cgwh -noplot gaussian.cmd -g=square64.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=3 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=15 15 15 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -matlab=square128 -go=dfk


*******************************************
********* Fri May 16, 2025 

+++++ ADD check for large forcing on the boundary ++++++

NF=7
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 .44 .53 .44 -y0=0.45 0.55 .5 .5 .54 .45 .47 -nf=7 -freq=15 21 26 32 41 49 58 -amp=400 400 400 400 400 400 400 -beta=18 19 20 21 22 23 24 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=6 -matlab=square128 -go=dfk

solveHelmholtz: max-res=5.643e-07 (all freq, gmres, numIts=159, ave-CR= 0.85 )
solveHelmholtz: rel-max-diff=6.51e-10 for freq0 =   1.5000e+01, |v|_max= 1.16e+00 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=2.89e-11 for freq1 =   2.1000e+01, |v|_max= 3.81e+00 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=1.64e-08 for freq2 =   2.6000e+01, |v|_max= 6.08e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=2.25e-09 for freq3 =   3.2000e+01, |v|_max= 5.61e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=7.51e-10 for freq4 =   4.1000e+01, |v|_max= 1.56e+00 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=5.76e-09 for freq5 =   4.9000e+01, |v|_max= 8.50e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=5.49e-10 for freq6 =   5.8000e+01, |v|_max= 4.85e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=1.64e-08, |v|_max= 3.81e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



NF=5 
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 .44 -y0=0.45 0.55 .5 .5 .54 -nf=5 -freq=15 21 26 32 41 -amp=400 400 400 400 400 -beta=18 19 20 21 22 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -matlab=square128 -go=dfk



--- RUNS FOR MFWH paper ---
NF=3 Np=2 EXP
cp square128FD24TSENf3Np2*.m $mfwh/results/
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=3 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=15 15 15 -adjustOmega=1 -ts=explicit -cfl=0.9 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -matlab=square128 -go=dfk

NF=3 Np=2 IMP 
cp square128FD24TSINf3Np2*.m $mfwh/results/
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=3 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=15 15 15 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -matlab=square128 -go=dfk

NF=3 Np=1 IMP 
cp square128FD24TSINf3Np1*.m $mfwh/results
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=3 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=15 15 15 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=1 -matlab=square128 -go=dfk
solveHelmholtz: rel-max-diff=5.30e-12 for freq0 =   5.1000e+00, |v|_max= 2.12e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=5.38e-12 for freq1 =   1.0100e+01, |v|_max= 2.20e+00 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=2.77e-12 for freq2 =   1.5100e+01, |v|_max= 7.16e-01 (between WaveHoltz and Direct Helmholtz solution)


cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=3 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=15 15 15 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-15 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=1 -matlab=square128 -go=dk

solveHelmholtz: rel-max-diff=7.24e-13 for freq0 =   5.1000e+00, |v|_max= 2.12e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=4.98e-12 for freq1 =   1.0100e+01, |v|_max= 2.20e+00 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=2.59e-13 for freq2 =   1.5100e+01, |v|_max= 7.16e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=4.98e-12, |v|_max= 2.20e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

-------


cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.6 0.4 .55 .5 .44 -y0=0.45 0.55 .5 .5 .54 -nf=2 -freq=15 21 26 32 41 -amp=200 200 400 400 400 -beta=15 19 20 21 22 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -matlab=square -go=dk

cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.6 0.4 .55 .5 .44 -y0=0.45 0.55 .5 .5 .54 -nf=2 -freq=15 21 26 32 41 -amp=400 400 400 400 400 -beta=8 10 20 21 22 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -matlab=square -go=dk

*******************************************
********* Thurs May 15, 2025 

MORE FREQ's for examples: 

PROBLEM FOUND -- BETA TOO SMALL


NF=3 Np=2 EXP
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=3 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=15 15 15 -adjustOmega=1 -ts=explicit -cfl=0.9 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -matlab=square128 -go=dfk

CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=3.888e-09.
CgWaveHoltz::residual: freq= 1, omega=  10.100, max-res=6.452e-09.
CgWaveHoltz::residual: freq= 2, omega=  15.100, max-res=8.764e-09.
solveHelmholtz: max-res=8.764e-09 (all freq, gmres, numIts=18, ave-CR= 0.28 )
solveHelmholtz: rel-max-diff=5.96e-12 for freq0 =   5.1000e+00, |v|_max= 2.12e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=8.20e-12 for freq1 =   1.0100e+01, |v|_max= 2.20e+00 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=3.31e-12 for freq2 =   1.5100e+01, |v|_max= 7.16e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=8.20e-12, |v|_max= 2.20e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



NF=2 EXPLICIT: freq=2 
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=2 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=15 15 15 -adjustOmega=1 -ts=explicit -cfl=0.9 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -matlab=square32 -go=dfk



NF=2 IMPLIICT BUT EXPLICIT: 
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=2 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=10 10 15 -adjustOmega=1 -ts=implicit -beta2=1 -cfl=0.9 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -matlab=square32 -go=dfk

NF=2 IMPLIICT 
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=2 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=15 15 15 -adjustOmega=1 -ts=implicit  -cfl=10000 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -matlab=square32 -go=dk



OK 
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.6 0.4 .55 .5 .44 -y0=0.45 0.55 .5 .5 .54 -nf=2 -freq=15 21 26 32 41 -amp=400 400 400 400 400 -beta=18 19 20 21 22 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -matlab=square -go=dk


OK 
cgwh -noplot gaussian.cmd -g=square64.order4 -x0=0.6 0.4 .55 .5 .44 -y0=0.45 0.55 .5 .5 .54 -nf=2 -freq=15 21 26 32 41 -amp=400 400 400 400 400 -beta=18 19 20 21 22 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -matlab=square -go=dk

OK 
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 .44 -y0=0.45 0.55 .5 .5 .54 -nf=2 -freq=15 21 26 32 41 -amp=400 400 400 400 400 -beta=18 19 20 21 22 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -matlab=square128 -go=dk


solveHelmholtz: rel-max-diff=5.21e-14 for freq0 =   5.1000e+00, |v|_max= 4.60e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=5.86e-06 for freq1 =   1.0100e+01, |v|_max= 4.30e+00 (between WaveHoltz and Direct Helmholtz solution)


NF=3 Np=2 IMP 
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=3 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=10 10 15 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -matlab=square128 -go=dfk

NF=3 Np=1 IMP 
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=3 -freq=5.1 10.1 15.1 -amp=25 100 225 -beta=10 10 15 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=1 -matlab=square128 -go=dfk





NF=4 NP=2
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=4 -freq=5 9 16 21 -amp=25 81 225 400 -beta=10 15 15 20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -matlab=square128 -go=dfk



NF=4 
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=4 -freq=5 9 16 21 -amp=25 81 225 400 -beta=10 15 15 20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=3 -matlab=square128 -go=dfk



NF=5 
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 .44 -y0=0.45 0.55 .5 .5 .54 -nf=5 -freq=15 21 26 32 41 -amp=400 400 400 400 400 -beta=18 19 20 21 22 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -matlab=square128 -go=dfk

CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=1.133e-08.
CgWaveHoltz::residual: freq= 1, omega=  21.000, max-res=7.858e-09.
CgWaveHoltz::residual: freq= 2, omega=  26.000, max-res=6.250e-09.
CgWaveHoltz::residual: freq= 3, omega=  32.000, max-res=7.127e-09.
CgWaveHoltz::residual: freq= 4, omega=  41.000, max-res=2.863e-09.
solveHelmholtz: max-res=1.133e-08 (all freq, gmres, numIts=76, ave-CR= 0.72 )
solveHelmholtz: rel-max-diff=1.71e-12 for freq0 =   1.5000e+01, |v|_max= 1.16e+00 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=3.54e-12 for freq1 =   2.1000e+01, |v|_max= 3.81e+00 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=5.27e-11 for freq2 =   2.6000e+01, |v|_max= 6.08e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=1.49e-11 for freq3 =   3.2000e+01, |v|_max= 5.61e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=9.76e-12 for freq4 =   4.1000e+01, |v|_max= 1.56e+00 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=5.27e-11, |v|_max= 3.81e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



NF=4 
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=4 -freq=5 9 16 21 -amp=25 81 225 400 -beta=10 15 15 20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=3 -matlab=square128 -go=dfk


cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -beta2=.5 -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=30 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=dk


*******************************************
********* Tues May 13, 2025 

RETURN TO MULTI-FREQUENCY WAVEHOLTZ FOR PAPER

CHECK ORDER=4 RESIDUALS
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -freq=3 5 -amp=9 25 -beta=10 20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=3 -matlab=square128 -go=og dfk


DHS: 
CgWaveHoltz::residual: grid=0 : maxRes= 1.08e-12
CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=7.655e-13.
CgWaveHoltz::residual: freq= 1, omega=   5.000, max-res=1.081e-12.

GMRES -- residual on first line isn is BAD for freq=1: 
CgWaveHoltz::residual: grid=0 : maxRes= 1.48e+00
CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=7.655e-13.
CgWaveHoltz::residual: freq= 1, omega=   5.000, max-res=1.485e+00.

FPI is OK:
CgWaveHoltz::residual: grid=0 : maxRes= 7.21e-12
CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=7.207e-12.
CgWaveHoltz::residual: freq= 1, omega=   5.000, max-res=6.378e-12.
solveHelmholtz: max-res=7.207e-12 (all freq, FP, numIts=26, ave-CR= 0.38 )
solveHelmholtz: rel-max-diff=4.91e-12 for freq0 =   3.0000e+00, |v|_max= 1.31e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=7.97e-12 for freq1 =   5.0000e+00, |v|_max= 1.41e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=7.97e-12, |v|_max= 1.41e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


NF=4 
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 .55 .5 -y0=0.45 0.55 .5 .5 -nf=4 -freq=5 9 16 21 -amp=25 81 225 400 -beta=10 15 15 20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=3 -matlab=square128 -go=dfk

*** CHECK RESIDUALS ****
CgWaveHoltz::residual: grid=0 : maxRes= 2.95e+03
CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=2.078e-08.
CgWaveHoltz::residual: freq= 1, omega=   9.000, max-res=5.214e+01.
CgWaveHoltz::residual: freq= 2, omega=  16.000, max-res=2.948e+03.
CgWaveHoltz::residual: freq= 3, omega=  21.000, max-res=6.845e+01.
solveHelmholtz: max-res=2.948e+03 (all freq, gmres, numIts=23, ave-CR= 0.34 )
solveHelmholtz: rel-max-diff=6.27e-12 for freq0 =   5.0000e+00, |v|_max= 5.39e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=7.90e-11 for freq1 =   9.0000e+00, |v|_max= 7.03e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=3.35e-11 for freq2 =   1.6000e+01, |v|_max= 2.63e+01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=5.79e-11 for freq3 =   2.1000e+01, |v|_max= 5.01e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=7.90e-11, |v|_max= 2.63e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh -noplot gaussian.cmd -g=square128.order4 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -freq=5 9 -amp=25 81 -beta=10 20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=3 -matlab=square128 -go=dfk

solveHelmholtz: max-res=3.050e+01 (all freq)
solveHelmholtz: rel-max-diff=1.49e-12 for freq0 =   5.0000e+00, |v|_max= 5.39e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=7.62e-12 for freq1 =   9.0000e+00, |v|_max= 4.11e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=7.62e-12, |v|_max= 5.39e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


IMP NF=2 (TURN OFF UPWIND)
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -freq=5 9 -amp=25 81 -beta=10 20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=3 -matlab=square128O2 -go=dfk


square128O2Nf2gmres

cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -freq=5 9 -amp=25 81 -beta=10 20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=3 -matlab=square128O2Nf2 -go=og dfk


CgWaveHoltz::residual: grid=0 : maxRes= 1.21e-09
CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=9.640e-10.
CgWaveHoltz::residual: freq= 1, omega=   9.000, max-res=1.213e-09.
solveHelmholtz: max-res=1.213e-09 (all freq)
solveHelmholtz: rel-max-diff=2.80e-12 for freq0 =   5.0000e+00, |v|_max= 5.39e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=7.52e-12 for freq1 =   9.0000e+00, |v|_max= 4.10e-01 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=7.52e-12, |v|_max= 5.39e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*******************************************
********* Tues May 13, 2025 

RETURN TO MULTI-FREQUENCY WAVEHOLTZ FOR PAPER

IMP NF=2 (TURN OFF UPWIND)
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -amp=50 50 -beta=150 150 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=3 -freq=5 9 -go=og dfk

Convergence rate CR=0.151, CR-perPeriod=0.532, Time to solve = 1.10e+00(s) : CgWave= 1.09e+00(s) 98.83%, advance= 1.08e+00(s) 98.27%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 10 (gmres) (maximumNumberOfIterations=100)
 omega=  5.00e+00, k=  5.00e+00, lambda=  1.26e+00, dx=  7.81e-03, domainSize=  1.00e+00, NLambda=0.795775, ppw=lambda/dx=160.8, ppw(rule-of-thumb)= 28.7 (epsr=0.01)<<<

 
CgWaveHoltz::residual: grid=0 : maxRes= 2.91e-08
CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=1.730e-08.
CgWaveHoltz::residual: freq= 1, omega=   9.000, max-res=2.906e-08.
solveHelmholtz: max-res=2.906e-08 (all freq)
solveHelmholtz: rel-max-diff=2.66e-10 for freq0 =   5.0000e+00, |v|_max= 5.09e-03 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=4.64e-10 for freq1 =   9.0000e+00, |v|_max= 4.73e-03 (between WaveHoltz and Direct Helmholtz solution)
solveHelmholtz: rel-max-diff=4.64e-10, |v|_max= 5.09e-03 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

*******************************************
********* Mon May 5, 2025 

scale RBC CBC residual

cgwh -noplot gaussian.cmd -g=square256.order4 -ts=implicit -beta2=.5 -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=30 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=dk

BEFORE:

Square256
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 1.26e-10, 2.10e-10], max|forcing(ghost)|= 9.38e-10
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 2: max-res=[ 4.03e-05, 4.98e-05]
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 1.79e-10, 4.30e-10], max|forcing(ghost)|= 9.38e-10
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 2: max-res=[ 1.90e-05, 2.13e-05]
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 1.61e-10, 1.51e-10], max|forcing(ghost)|= 9.38e-10
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 2: max-res=[ 3.07e-05, 4.59e-05]
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 1.53e-10, 2.74e-10], max|forcing(ghost)|= 9.38e-10
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 2: max-res=[ 2.06e-05, 2.65e-05]

Square 128:
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 1.63e-11, 3.33e-11], max|forcing(ghost)|= 6.32e-10
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 2: max-res=[ 6.70e-07, 1.44e-06]
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 3.42e-11, 3.81e-11], max|forcing(ghost)|= 6.32e-10
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 2: max-res=[ 5.54e-07, 9.84e-07]
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 1.67e-11, 3.20e-11], max|forcing(ghost)|= 6.32e-10
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 2: max-res=[ 7.62e-07, 8.67e-07]
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 1.85e-11, 3.63e-11], max|forcing(ghost)|= 6.32e-10
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 2: max-res=[ 6.62e-07, 6.72e-07]

*******************************************
********* Fri May 2, 2025 

START ON SPLIT RING RESONATOR

cgwh -noplot gaussian.cmd -g=/home/henshw/runs/cgwave/grids/splitRingGride4.order2.hdf -ts=implicit -cfl=1000 -nf=1 -x0=-0.75 -y0=0 -freq=20 -amp=-400 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -superGridWidth=0.15 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -debug=0 -takeImplicitFirstStep=1 -filterD0t=1 -go=og



>>> SUPERGRID CHECK IS BROKEN (AGAIN)
>>>>>USE PERIODIC FIRST STEP FOR NOW WITH SUPERGRID <<<<<<


TURN OFF IMPLICIT FIRST STEP: ***WORKS***
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -takeImplicitFirstStep=0  -go=dk

SUPERGRID FAILS WITH IMPLICIT FIRST STEP: 
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -takeImplicitFirstStep=1 -filterD0t=1 -go=dk

SUPERGRID -- broken ***AGAIN** 
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=dk


WORKING VERSION: 
------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Complex Solution 

 grid=/home/henshw/grids/square64.order2.hdf
 Convergence rate CR=0.373, CR-perPeriod=0.611, Time to solve = 5.40e-01(s) : CgWave= 5.28e-01(s) 97.75%, advance= 5.20e-01(s) 96.27%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 26 (gmres) (maximumNumberOfIterations=1000)
 omega=  2.00e+01, k=  2.00e+01, lambda=  3.14e-01, dx=  1.56e-02, domainSize=  1.00e+00, NLambda=3.1831, ppw=lambda/dx= 20.1, ppw(rule-of-thumb)= 57.4 (epsr=0.01)<<<



Check residual in absorbing BC: omega=  2.000000e+01, c=  1.000000e+00
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 3.73e-11, 7.59e-10], max|forcing(ghost)|= 6.51e-44
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 3.74e-11, 7.59e-10], max|forcing(ghost)|= 6.51e-44
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 3.74e-11, 7.59e-10], max|forcing(ghost)|= 6.51e-44
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 3.73e-11, 7.59e-10], max|forcing(ghost)|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 3.70e-02
CgWaveHoltz::residual: INFO: Set residuals to zero in the SuperGrid layers
solveHelmholtz: max-residual [Re,Im]=[1.48e-03,2.05e-03] (gmres, numIts=26, ave-CR= 0.37 )
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.78e-03,1.93e-03],  norm [Re,Im]=[8.06e-01,1.55e+00] (between WaveHoltz and Direct Helmholtz)




*******************************************
********* Wed April 30, 2025 

FIX advance.bC --> compute adjusted omega for general alpha

TEST FULL WEIGHTING IMP TIME-STEPPING

cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -beta2=.5 -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=30 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=dk


Full weighting *matches now*
solveHelmholtz: max-residual [Re,Im]=[2.68e-12,2.75e-12] (gmres, numIts=15, ave-CR= 0.19 )
solveHelmholtz: rel-max-diff [Re,Im]=[4.79e-13,9.71e-13],  norm [Re,Im]=[3.19e-01,6.11e-01] (between WaveHoltz and Direct Helmholtz)


*******************************************
********* Tues April 29, 2025 

+++++++++++++ADD IMPLICIT FIRST STEP TO COMPLEX +++++++++


TEST ORDER=4
cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=30 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=dk

CgWaveHoltz::residual: grid=0 : maxRes= 1.17e-09
solveHelmholtz: max-residual [Re,Im]=[5.09e-12,2.89e-12] (gmres, numIts=20, ave-CR= 0.29 )
solveHelmholtz: rel-max-diff [Re,Im]=[1.28e-12,1.48e-12],  norm [Re,Im]=[3.19e-01,6.11e-01] (between WaveHoltz and Direct Helmholtz)

+++++++++++++ ODRER=2 

Test runs for the paper to check theory IMP FIRST STEP + FILTER D0t


cgwh -noplot gaussian.cmd -g=square128.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=60 -amp=3600 -beta=60 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -filterD0t=1 -matlab=square128O2BrrrrFreq60 -go=dfk

cgwh -noplot gaussian.cmd -g=square128.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=30 -amp=900 -beta=30 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -filterD0t=1 -matlab=square128O2BrrrrFreq30 -go=dfk


cgwh -noplot gaussian.cmd -g=square128.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=15 -amp=225 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -filterD0t=1 -matlab=square128O2BrrrrFreq15 -go=dfk




cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=30 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=dk

TAKEIMPLIICT FIRST STEP:
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 1.44e-10, 2.20e-10], max|forcing(ghost)|= 5.53e-11
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 1.44e-10, 2.20e-10], max|forcing(ghost)|= 5.53e-11
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 1.44e-10, 2.20e-10], max|forcing(ghost)|= 5.53e-11
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 1.44e-10, 2.20e-10], max|forcing(ghost)|= 5.53e-11
CgWaveHoltz::residual: grid=0 : maxRes= 1.43e-11
solveHelmholtz: max-residual [Re,Im]=[1.43e-11,7.46e-12] (gmres, numIts=20, ave-CR= 0.30 )
solveHelmholtz: rel-max-diff [Re,Im]=[3.41e-12,4.89e-12],  norm [Re,Im]=[3.23e-01,6.21e-01] (between WaveHoltz and Direct Helmholtz)

USE PERIODIC FIRST STEP
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 5.38e-10, 1.23e-09], max|forcing(ghost)|= 5.53e-11
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 5.38e-10, 1.23e-09], max|forcing(ghost)|= 5.53e-11
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 5.38e-10, 1.23e-09], max|forcing(ghost)|= 5.53e-11
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 5.38e-10, 1.23e-09], max|forcing(ghost)|= 5.53e-11
CgWaveHoltz::residual: grid=0 : maxRes= 1.57e-11
solveHelmholtz: max-residual [Re,Im]=[8.57e-12,1.57e-11] (gmres, numIts=24, ave-CR= 0.36 )
solveHelmholtz: rel-max-diff [Re,Im]=[2.46e-12,3.24e-12],  norm [Re,Im]=[3.23e-01,6.21e-01] (between WaveHoltz and Direct Helmholtz)


cgwh -noplot gaussian.cmd -g=square8.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -matlab=junk -filterD0t=1 -takeImplicitFirstStep=1 -go=og


cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=30 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=dk

cgwh -noplot gaussian.cmd -g=square8.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=og



*******************************************
********* Mon April 28, 2025 

START TEST FILTER D0t

BUGS FIXED *** NOTE : CgWaveHoltz currenty iterates on vk(:,0) =ur and vk(:,1) = ui **NOT** ON vDot !!!  (due to the viFactor) 


cgwh -noplot gaussian.cmd -g=square8.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=og


cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=5 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=og


cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=30 -numPeriods=1 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=junk -filterD0t=1 -go=dk

**** Form filter weights for D0t W...

+++++++++++++ takeFirstStepHelmholtz: DO USE periodic first step since there is a complex solution ++++++++++++


residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 1.74e-10, 6.21e-10], max|forcing(ghost)|= 5.53e-11
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 1.74e-10, 6.21e-10], max|forcing(ghost)|= 5.53e-11
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 1.74e-10, 6.21e-10], max|forcing(ghost)|= 5.53e-11
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 1.74e-10, 6.21e-10], max|forcing(ghost)|= 5.53e-11
CgWaveHoltz::residual: grid=0 : maxRes= 9.63e-12
solveHelmholtz: max-residual [Re,Im]=[9.63e-12,6.39e-12] (gmres, numIts=16, ave-CR= 0.22 )
solveHelmholtz: rel-max-diff [Re,Im]=[2.46e-12,2.13e-12],  norm [Re,Im]=[3.23e-01,6.21e-01] (between WaveHoltz and Direct Helmholtz)

*******************************************
********* Sun April 27, 2025 

Test runs for the paper to check theory

cgwh -noplot gaussian.cmd -g=square128.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=30 -amp=900 -beta=30 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=square128O2BrrrrFreq30 -go=dfk



cgwh -noplot gaussian.cmd -g=square128.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=15 -amp=225 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -matlab=square128O2BrrrrFreq15 -go=dfk


*******************************************
********* Fri April 25, 2025 

***BUGS FIXED In solveHelmholtzDirect

**BUG FIXED** IMPLICIT MATRIX INCLUDED 4TH ORDER CORRECTIONS

EXPLICIT ORDER=4: **MATCHES DHS***
   EXPLIICT EM CURRENTLY USES EXTRAPOLATION
cgwh -noplot gaussian.cmd -g=square32.order4 -ts=explicit -cfl=.5 -x0=0.5 -y0=0.5 -nf=1 -freq=10  -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -go=dk

Check residual in absorbing BC: omega=  1.000000e+01, c=  1.000000e+00
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 2.40e-12, 4.58e-10], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 5.18e-15, 3.06e-15] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 2.40e-12, 4.58e-10], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 5.18e-15, 3.06e-15] (extrapolation)
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 2.07e-12, 4.59e-10], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 5.26e-15, 2.30e-15] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 2.07e-12, 4.59e-10], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 5.26e-15, 2.30e-15] (extrapolation)
CgWaveHoltz::residual: grid=0 : maxRes= 5.68e-11
solveHelmholtz: max-residual [Re,Im]=[4.07e-12,5.68e-11] (gmres, numIts=12, ave-CR= 0.15 )
solveHelmholtz: rel-max-diff [Re,Im]=[1.09e-11,1.41e-11],  norm [Re,Im]=[1.63e-01,3.12e-01] (between WaveHoltz and Direct Helmholtz)



++++++++ FD24I EXACT MATCH TO DHS
cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10  -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -go=dk
Check residual in absorbing BC: omega=  1.000000e+01, c=  1.000000e+00
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 5.13e-11, 5.56e-11], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 2: max-res=[ 8.10e-09, 1.95e-08]
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 5.13e-11, 5.53e-11], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 2: max-res=[ 8.00e-09, 1.90e-08]
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 5.13e-11, 5.52e-11], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 2: max-res=[ 8.05e-09, 1.91e-08]
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 5.13e-11, 5.54e-11], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 2: max-res=[ 8.08e-09, 1.90e-08]
CgWaveHoltz::residual: grid=0 : maxRes= 1.95e-10
solveHelmholtz: max-residual [Re,Im]=[2.63e-12,3.17e-12] (gmres, numIts=16, ave-CR= 0.21 )
solveHelmholtz: rel-max-diff [Re,Im]=[1.04e-12,1.09e-12],  norm [Re,Im]=[1.63e-01,3.12e-01] (between WaveHoltz and Direct Helmholtz)



+++++ FIX CHECKS:

RESTORED FILES: WORKS
  OK with new implicit.bC, bcOptWave.bf90, takeFirstStep.bC, solveHelmholtz.bC
  trouble: applyBoundaryConditions.bC and/or advance.bC

SUPERGRID -- broken, then fixed
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=dk

------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Complex Solution 

 grid=/home/henshw/grids/square64.order2.hdf
 Convergence rate CR=0.373, CR-perPeriod=0.611, Time to solve = 5.40e-01(s) : CgWave= 5.28e-01(s) 97.75%, advance= 5.20e-01(s) 96.27%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 26 (gmres) (maximumNumberOfIterations=1000)
 omega=  2.00e+01, k=  2.00e+01, lambda=  3.14e-01, dx=  1.56e-02, domainSize=  1.00e+00, NLambda=3.1831, ppw=lambda/dx= 20.1, ppw(rule-of-thumb)= 57.4 (epsr=0.01)<<<



Check residual in absorbing BC: omega=  2.000000e+01, c=  1.000000e+00
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 3.73e-11, 7.59e-10], max|forcing(ghost)|= 6.51e-44
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 3.74e-11, 7.59e-10], max|forcing(ghost)|= 6.51e-44
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 3.74e-11, 7.59e-10], max|forcing(ghost)|= 6.51e-44
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 3.73e-11, 7.59e-10], max|forcing(ghost)|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 3.70e-02
CgWaveHoltz::residual: INFO: Set residuals to zero in the SuperGrid layers
solveHelmholtz: max-residual [Re,Im]=[1.48e-03,2.05e-03] (gmres, numIts=26, ave-CR= 0.37 )
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.78e-03,1.93e-03],  norm [Re,Im]=[8.06e-01,1.55e+00] (between WaveHoltz and Direct Helmholtz)


checkWaveHoltz.p -solver=cgwh square64ImpSuperGridKrylov

cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -takeImplicitFirstStep=1 -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=dk 

    0: square     0    0      8 : superGrid+EM2 (width=0.20)
    0: square     1    0      8 : superGrid+EM2 (width=0.20)
    0: square     0    1      8 : superGrid+EM2 (width=0.20)
    0: square     1    1      8 : superGrid+EM2 (width=0.20)

residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 2.17e+00, 2.84e+00], max|forcing(ghost)|= 6.51e-44
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 2.17e+00, 2.84e+00], max|forcing(ghost)|= 6.51e-44
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 2.17e+00, 2.84e+00], max|forcing(ghost)|= 6.51e-44
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 2.17e+00, 2.84e+00], max|forcing(ghost)|= 6.51e-44


TOLERANCE TOO TIGHT ???
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=dk >! results/square64ImpSuperGridKrylov.out
COMPARE files: " cgWaveHoltz.check results/square64ImpSuperGridKrylov.check -tol=1e-05 "

Header new:[# Check file for cgWaveHoltz, grid=square64, Fri Apr 25 15:28:55 2025]
Header old:[# Check file for cgWaveHoltz, grid=square64, Mon Dec 23 10:18:38 2024]
** DIFFERENCE FOUND at line 77 :
lineNew=[convergenceRate=0.954;]
lineOld=[convergenceRate=0.373;]
** DIFFERENCE FOUND at line 78 :
lineNew=[numberOfIterations=549;]
lineOld=[numberOfIterations=26;]
** DIFFERENCE FOUND at line 83 :
lineNew=[errorBetweenWaveHoltzAndHelmholtz=3.718e-03;]
lineOld=[errorBetweenWaveHoltzAndHelmholtz=2.780e-03;]


++++++
  BROKEN:  ... fixed
cgwh -noplot ../scattering/scat.cmd -g=cice2.order2 -ts=implicit -cfl=1000 -nf=1 -amp=1 -kx=1 -ky=0 -kz=0 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -superGridWidth=0.15 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -implicitUpwind=0 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -debug=0 -takeImplicitFirstStep=0 -go=dk

=== Direct Helmholtz Solver (Complex) :
 yale, solver=[direct sparse solver, no pivoting + ]
 =====
Oges::allocateWorkSpace: numberOfNonzeros=74110 fillinRatio=2.000000e+01
allocateWorkSpace: numberOfEquations=16364, nsp = 1482200, fillinRatio= 20, numberOfNonzeros = 74110
 EM RBC: (side,axis,grid)={0,0,0) res: bc1[Re,Im]=[ 9.99e+01, 8.03e+01], max|rhs|= 0.00e+00
 EM RBC: (side,axis,grid)={1,0,0) res: bc1[Re,Im]=[ 9.95e+01, 8.02e+01], max|rhs|= 0.00e+00
 EM RBC: (side,axis,grid)={0,1,0) res: bc1[Re,Im]=[ 8.68e+01, 4.82e+01], max|rhs|= 0.00e+00
 EM RBC: (side,axis,grid)={1,1,0) res: bc1[Re,Im]=[ 8.67e+01, 4.82e+01], max|rhs|= 0.00e+00
grid=0 : maxRes= 9.99e+01
 Scattering Dirichlet BC: (side,axis,grid)={0,1,1) max-res=[ 0.00e+00, 0.00e+00]
grid=1 : maxRes= 2.38e-11


EXPLICIT ORDER=4: **MATCHES DHS***
   EXPLIICT EM CURRENTLY USES EXTRAPOLATION
cgwh -noplot gaussian.cmd -g=square32.order4 -ts=explicit -cfl=.5 -x0=0.5 -y0=0.5 -nf=1 -freq=10  -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -go=dk

residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 2.40e-12, 4.58e-10], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 5.18e-15, 3.06e-15] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 2.40e-12, 4.58e-10], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 5.18e-15, 3.06e-15] (extrapolation)
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 2.07e-12, 4.59e-10], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 5.26e-15, 2.30e-15] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 2.07e-12, 4.59e-10], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 5.26e-15, 2.30e-15] (extrapolation)
CgWaveHoltz::residual: grid=0 : maxRes= 5.68e-11
solveHelmholtz: max-residual [Re,Im]=[4.07e-12,5.68e-11] (gmres, numIts=12, ave-CR= 0.15 )
solveHelmholtz: rel-max-diff [Re,Im]=[1.09e-11,1.41e-11],  norm [Re,Im]=[1.63e-01,3.12e-01] (between WaveHoltz and Direct Helmholtz)



IMPLICIT: 

cgwh -noplot gaussian.cmd -g=square8.order4 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10  -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -go=og



++++++++ FD24I 
   --> better match to DHS
cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10  -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -go=dk

residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 5.14e-11, 5.55e-11], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 2: max-res=[ 7.98e-09, 1.90e-08]
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 5.13e-11, 5.56e-11], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 2: max-res=[ 7.98e-09, 1.90e-08]
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 5.13e-11, 5.54e-11], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 2: max-res=[ 8.01e-09, 1.90e-08]
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 5.14e-11, 5.55e-11], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 2: max-res=[ 7.99e-09, 1.91e-08]
CgWaveHoltz::residual: grid=0 : maxRes= 1.91e-10
solveHelmholtz: max-residual [Re,Im]=[2.62e-12,3.18e-12] (gmres, numIts=16, ave-CR= 0.21 )
solveHelmholtz: rel-max-diff [Re,Im]=[1.04e-12,1.09e-12],  norm [Re,Im]=[1.63e-01,3.12e-01] (between WaveHoltz and Direct Helmholtz)



cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10  -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -go=dk

*******************************************
********* Tues April 22, 2025 

RETURN TO RBC -- match to Matlab code

++++++++ FD24I 
cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10  -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -go=dk

 ^^^^^^ solveHelmholtzDirect: max-rel-res [re,Im]=[2.62e-13,2.50e-13] ^^^^^^^^

Check residual in absorbing BC: omega=  1.000000e+01, c=  1.000000e+00
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 8.15e-13, 1.03e-11], max|forcing(ghost)|= 5.03e-16
                                                 ghost line 2: max-res=[ 4.16e-17, 6.94e-17] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 7.18e-12, 4.20e-12], max|forcing(ghost)|= 5.03e-16
                                                 ghost line 2: max-res=[ 6.94e-17, 4.16e-17] (extrapolation)
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 5.24e-12, 6.60e-12], max|forcing(ghost)|= 5.03e-16
                                                 ghost line 2: max-res=[ 6.94e-17, 6.94e-17] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 1.85e-11, 2.03e-12], max|forcing(ghost)|= 5.03e-16
                                                 ghost line 2: max-res=[ 6.94e-17, 6.94e-17] (extrapolation)


residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 4.67e-02, 6.87e-01], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 3.47e-17, 6.94e-17] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 4.58e-02, 6.88e-01], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 2.78e-17, 6.94e-17] (extrapolation)
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 4.94e-02, 3.03e-01], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 6.94e-17, 6.94e-17] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 2.63e-02, 5.52e-01], max|forcing(ghost)|= 2.64e-26
                                                 ghost line 2: max-res=[ 6.94e-17, 6.94e-17] (extrapolation)
CgWaveHoltz::residual: grid=0 : maxRes= 4.21e-01
solveHelmholtz: max-residual [Re,Im]=[4.21e-01,2.02e-01] (gmres, numIts=100, ave-CR= 0.91 )
solveHelmholtz: rel-max-diff [Re,Im]=[5.54e-01,3.01e-01],  norm [Re,Im]=[1.96e-01,2.85e-01] (between WaveHoltz and Direct Helmholtz)




++++++++ FD22I **matches DHS**
cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -freq=10  -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -takeImplicitFirstStep=1 -go=dk

Check residual in absorbing BC: omega=  1.000000e+01, c=  1.000000e+00
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 8.99e-11, 4.22e-10], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 8.99e-11, 4.22e-10], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 8.99e-11, 4.22e-10], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 9.00e-11, 4.22e-10], max|forcing(ghost)|= 2.64e-26
CgWaveHoltz::residual: grid=0 : maxRes= 8.11e-12
solveHelmholtz: max-residual [Re,Im]=[8.11e-12,4.47e-12] (gmres, numIts=16, ave-CR= 0.22 )
solveHelmholtz: rel-max-diff [Re,Im]=[3.09e-12,3.67e-12],  norm [Re,Im]=[1.65e-01,3.18e-01] (between WaveHoltz and Direct Helmholtz)






++++++++ FD22E **matches DHS**
cgwh -noplot gaussian.cmd -g=square32.order2 -ts=explicit -cfl=0.9 -x0=0.5 -y0=0.5 -nf=1 -freq=10 -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=dk

Check residual in absorbing BC: omega=  1.000000e+01, c=  1.000000e+00
residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 1.65e-12, 1.08e-10], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 1.66e-12, 1.08e-10], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 1.63e-12, 1.08e-10], max|forcing(ghost)|= 2.64e-26
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 1.64e-12, 1.08e-10], max|forcing(ghost)|= 2.64e-26
CgWaveHoltz::residual: grid=0 : maxRes= 1.20e-11
solveHelmholtz: max-residual [Re,Im]=[6.87e-12,1.20e-11] (gmres, numIts=13, ave-CR= 0.15 )
solveHelmholtz: rel-max-diff [Re,Im]=[4.39e-12,3.85e-12],  norm [Re,Im]=[1.65e-01,3.18e-01] (between WaveHoltz and Direct Helmholtz)






FROM checks: 
cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=dk 

Abort (core dumped)




*******************************************
********* Tues Feb 10, 2025 

MATCH MATLAB TO CGWAVE

cgwh -noplot gaussian.cmd -g=square32.order2 -ts=explicit -cfl=0.9 -x0=0.5 -y0=0.5 -nf=1 -freq=5.5 -amp=64 -beta=8 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=d -implicitUpwind=0 -takeImplicitFirstStep=0 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -go=og

CgWaveHoltz::residual: grid=0 : maxRes= 9.34e-12
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=9.340e-12.
solveHelmholtz: max-res=9.340e-12 (FP, numIts=22, ave-CR= 0.29 , ACR=-1.00)
solveHelmholtz: rel-max-diff=6.00e-13, |v|_max= 8.77e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


************************************
****** Fri Jan 31, 2025

++++++++ IMPLICIT
cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og



cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

++++++++++ IMPLICIT
cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -cfl=0.1 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

CFL=0.1: SMALLER RESIDS
CgWaveHoltz::residual: grid=0 : maxRes= 7.39e-04
solveHelmholtz: max-residual [Re,Im]=[7.39e-04,9.72e-05] (FP, numIts=35, ave-CR= 0.47 )
solveHelmholtz: rel-max-diff [Re,Im]=[1.29e-04,1.16e-04],  norm [Re,Im]=[7.99e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)



cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 1.06e-11, 1.36e-10], max|forcing(ghost)|= 9.38e-47
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 1.05e-11, 1.36e-10], max|forcing(ghost)|= 9.38e-47
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 1.07e-11, 1.36e-10], max|forcing(ghost)|= 9.38e-47
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 1.05e-11, 1.36e-10], max|forcing(ghost)|= 9.38e-47
CgWaveHoltz::residual: grid=0 : maxRes= 7.60e-01
solveHelmholtz: max-residual [Re,Im]=[7.60e-01,1.86e-01] (FP, numIts=36, ave-CR= 0.48 )
solveHelmholtz: rel-max-diff [Re,Im]=[1.65e-01,1.34e-01],  norm [Re,Im]=[6.66e-01,1.36e+00] (between WaveHoltz and Direct Helmholtz)


++++++++ EXPLICIT -- MATCHES DHS
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=exmplicit -cfl=0.95 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

residual: Radiation BC: (side,axis,grid)={0,0,0) ghost line 1: max-res=[ 3.50e-12, 5.66e-12], max|forcing(ghost)|= 6.51e-44
                                                 ghost line 2: max-res=[ 1.67e-16, 2.78e-16] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,0,0) ghost line 1: max-res=[ 3.50e-12, 5.66e-12], max|forcing(ghost)|= 6.51e-44
                                                 ghost line 2: max-res=[ 1.67e-16, 2.78e-16] (extrapolation)
residual: Radiation BC: (side,axis,grid)={0,1,0) ghost line 1: max-res=[ 3.62e-12, 4.97e-12], max|forcing(ghost)|= 6.51e-44
                                                 ghost line 2: max-res=[ 2.78e-16, 2.78e-16] (extrapolation)
residual: Radiation BC: (side,axis,grid)={1,1,0) ghost line 1: max-res=[ 3.62e-12, 4.97e-12], max|forcing(ghost)|= 6.51e-44
                                                 ghost line 2: max-res=[ 2.78e-16, 2.78e-16] (extrapolation)
CgWaveHoltz::residual: grid=0 : maxRes= 1.12e-13
solveHelmholtz: max-residual [Re,Im]=[1.12e-13,7.05e-14] (FP, numIts=35, ave-CR= 0.47 )
solveHelmholtz: rel-max-diff [Re,Im]=[2.58e-12,1.75e-12],  norm [Re,Im]=[7.97e-01,1.53e+00] (between WaveHoltz and Direct Helmholtz)

cgwh -noplot gaussian.cmd -g=square32.order4 -ts=exmplicit -cfl=0.95 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 5.12e-13, 8.24e-13], max|forcing(ghost)|= 9.38e-47
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 5.12e-13, 8.24e-13], max|forcing(ghost)|= 9.38e-47
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 6.82e-13, 9.09e-13], max|forcing(ghost)|= 9.38e-47
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 6.82e-13, 9.09e-13], max|forcing(ghost)|= 9.38e-47
CgWaveHoltz::residual: grid=0 : maxRes= 4.51e-13
solveHelmholtz: max-residual [Re,Im]=[4.51e-13,7.69e-14] (FP, numIts=34, ave-CR= 0.45 )
solveHelmholtz: rel-max-diff [Re,Im]=[5.18e-13,7.33e-13],  norm [Re,Im]=[7.99e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)


ORDER=2 IMP 
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og
cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og


************************************
****** Thurs Jan 30, 2025

START 3D: FIRST ORDER 2 -- TROUBLE DIRECT HELMHOLTZ SOLVE
cgwh -noplot gaussian.cmd -g=box4.order2 -ts=explicit -cfl=0.9 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

TO DO: IMPLICIT

cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

ORDER=4
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og


START:
Check residual in absorbing BC: omega=  2.000000e+01, c=  1.000000e+00
residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 3.47e-10, 9.67e-10], max|forcing(ghost)|= 9.38e-47
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 3.47e-10, 9.67e-10], max|forcing(ghost)|= 9.38e-47
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 3.47e-10, 9.67e-10], max|forcing(ghost)|= 9.38e-47
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 3.47e-10, 9.67e-10], max|forcing(ghost)|= 9.38e-47
CgWaveHoltz::residual: grid=0 : maxRes= 9.33e-12
solveHelmholtz: max-residual [Re,Im]=[4.54e-12,9.33e-12] (gmres, numIts=26, ave-CR= 0.39 )
solveHelmholtz: rel-max-diff [Re,Im]=[2.56e-12,2.74e-12],  norm [Re,Im]=[8.37e-01,1.58e+00] (between WaveHoltz and Direct Helmholtz)


++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++=


EXPLICIT -- ORDER=4 EM RBC's --> **WORKS**
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=explicit -cfl=0.9 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og


Check residual in absorbing BC: omega=  2.000000e+01, c=  1.000000e+00
residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 4.79e-11, 3.02e-09], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 4.79e-11, 3.02e-09], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 4.79e-11, 3.00e-09], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 4.79e-11, 3.00e-09], max|forcing(ghost)|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 2.77e-11
solveHelmholtz: max-residual [Re,Im]=[3.67e-12,2.77e-11] (gmres, numIts=18, ave-CR= 0.26 )
solveHelmholtz: rel-max-diff [Re,Im]=[2.73e-12,2.81e-12],  norm [Re,Im]=[7.97e-01,1.53e+00] (between WaveHoltz and Direct Helmholtz)



************************************
****** Mon/Tues Jan 27/28, 2025

>>>>>>> FOR TESTING: Use 2nd-order EM2 in solveHelmholtzDirect to match cgWave:

IMP
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

EXPLICIT --  pretty close match, corners are done differently
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=explicit -cfl=0.9 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 1.39e+00, 2.45e+00], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 1.39e+00, 2.45e+00], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 1.39e+00, 2.45e+00], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 1.39e+00, 2.45e+00], max|forcing(ghost)|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 6.12e-03
solveHelmholtz: max-residual [Re,Im]=[2.16e-12,5.01e-13] (FP, numIts=31, ave-CR= 0.43 )
solveHelmholtz: rel-max-diff [Re,Im]=[2.05e-03,2.86e-03],  norm [Re,Im]=[7.98e-01,1.52e+00] (between WaveHoltz and Direct Helmholtz)

<<<<<<<<<<



START EM2 ORDER=4
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

IMP + RBC=EM2 
cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=dk

************************************
****** Sun Jan 26, 2025

RETURN TO COMPLEX PROBLEMS:

COMPARE TO MATLAB - WAVEHOLTZ

**BUG FIXED** INCLUDE GHOST ON RBC sides for getActivePointIndex

ORDER=4 ? NOT IMPLEMENTED YET
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og



>>>>>>>>>>
IMP + RBC=EM2 
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -takeImplicitFirstStep=0 -go=og

GMRES : matches
Check residual in absorbing BC: omega=  2.000000e+01, c=  1.000000e+00
residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 1.76e-10, 1.61e-09], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 1.77e-10, 1.61e-09], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 1.77e-10, 1.60e-09], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 1.76e-10, 1.61e-09], max|forcing(ghost)|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 4.70e-12
solveHelmholtz: max-residual [Re,Im]=[3.18e-12,4.70e-12] (gmres, numIts=25, ave-CR= 0.37 )
solveHelmholtz: rel-max-diff [Re,Im]=[2.69e-12,2.19e-12],  norm [Re,Im]=[8.08e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)

++++++ FPI matches
residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 9.01e-12, 1.72e-10], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 8.58e-12, 1.71e-10], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 9.35e-12, 1.72e-10], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 8.94e-12, 1.71e-10], max|forcing(ghost)|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 8.29e-13
solveHelmholtz: max-residual [Re,Im]=[8.29e-13,6.37e-13] (FP, numIts=45, ave-CR= 0.56 )
solveHelmholtz: rel-max-diff [Re,Im]=[2.82e-12,3.44e-12],  norm [Re,Im]=[8.08e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)


>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
EXPLICIT EM2 -- MATCHES
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -go=og

Check residual in absorbing BC: omega=  2.000000e+01, c=  1.000000e+00
residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 2.50e-12, 3.13e-12], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 3.17e-12, 2.96e-12], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 3.58e-12, 3.07e-12], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 2.93e-12, 3.58e-12], max|forcing(ghost)|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 2.46e-13
solveHelmholtz: max-residual [Re,Im]=[2.46e-13,1.66e-13] (FP, numIts=33, ave-CR= 0.46 )
solveHelmholtz: rel-max-diff [Re,Im]=[2.07e-12,2.37e-12],  norm [Re,Im]=[8.08e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)

Wrote results to the check file [cgWaveHoltz.check]
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]


***************************************************
****** Wed  Jan 8, 2025

PLOTS FOR PART2

+++ ORDER=4
plotStuff plotSolution.cmd -show=diskG8O4Freq60 -solution=1 
plotStuff plotSolution.cmd -show=diskG16O4Freq60 -solution=1 
plotStuff plotSolution.cmd -show=diskG32O4Freq60 -solution=1 
plotStuff plotSolution.cmd -show=diskG48O4Freq60 -solution=1 
plotStuff plotSolution.cmd -show=diskG64O4Freq60 -solution=1 


DISK G180: TOO BIG
cgwh -noplot gaussian.cmd -g=sicFixede180.order2  -ts=implicit -cfl=10000 -x0=-0.55 -y0=-0.5 -nf=1 -freq=30 -amp=160 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=diskG180O2Freq30  -show=diskG180O2Freq30.show  -krylovType=gmres -go=ds 

GMRES NO GOOD!!
cgwh -noplot gaussian.cmd -g=sicFixede200.order2  -ts=implicit -cfl=10000 -x0=-0.55 -y0=-0.5 -nf=1 -freq=30 -amp=160 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -solverh=best -iluh=100 -rtolh=1e-10 -atolh=1e-10 -matlab=diskG200O2Freq30  -show=diskG200O2Freq30.show  -krylovType=gmres -go=ds > diskG200O2Freq30.out

TEST gmres for direct solver
iluh=100 : syas it converges in one iteration byt large residuals ???
cgwh -noplot gaussian.cmd -g=sicFixede64.order2  -ts=implicit -cfl=10000 -x0=-0.55 -y0=-0.5 -nf=1 -freq=30 -amp=160 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -solverh=gmres -iluh=300 -rtolh=1e-10 -atolh=1e-10  -krylovType=gmres -go=d


gaussian2:
plotStuff plotSolution.cmd -show=diskG16O2Freq30 -solution=1 
plotStuff plotSolution.cmd -show=diskG32O2Freq30 -solution=1 
plotStuff plotSolution.cmd -show=diskG64O2Freq30 -solution=1 
plotStuff plotSolution.cmd -show=diskG96O2Freq30 -solution=1 
plotStuff plotSolution.cmd -show=diskG128O2Freq30 -solution=1 


FIX PPW CALCULATION:
cgwh -noplot gaussian.cmd -g=sicFixede16.order2 -ts=implicit -cfl=10000 -x0=-0.55 -y0=-0.5 -nf=1 -freq=30 -amp=160 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -rtoli=1e-10 -atoli=1e-10 -matlab=diskG16O2Freq30 -show=diskG16O2Freq30.show -krylovType=gmres -go=da

 >>>omega=  3.00e+01, k=  3.00e+01, lambda=  2.09e-01, dx=  6.25e-03, domainSize=  2.00e+00, NLambda=9.5493, ppw=lambda/dx= 33.5, ppw(rule-of-thumb)= 99.3 (old= 97.1) (epsr=0.01)<<<


***************************************************
****** Tues  Jan 7, 2025

START easier

DISK:

plotStuff plotSolution.cmd -show=diskG64O4Freq60 -solution=1 
plotStuff plotSolution.cmd -show=diskG48O4Freq60 -solution=1 
plotStuff plotSolution.cmd -show=diskG32O4Freq60 -solution=1 
plotStuff plotSolution.cmd -show=diskG16O4Freq60 -solution=1 


comp compRates  

% -------------- max norm results -------------
\begin{table}[hbt]\tableFont % you should set \tableFont to \footnotesize or other size
% \newcommand{\num}[2]{#1e{#2}} % use this command to set the format of numbers in the table.
% \newcommand{\errFormat}[1]{#1}} % use this command to set the format of the error label.
\begin{center}
\begin{tabular}{|l|c|c|c|c|} \hline 
   show file         & \errFormat{uDHS0} &  r   & \errFormat{f0} &  r  \\ \hline
 diskG16O4Freq60.show & \num{3.1}{-2} &      & \num{-inf}{-2147483648} &      \\ \hline
 diskG32O4Freq60.show & \num{2.0}{-3} & 15.7 & \num{-inf}{-2147483648} &  0.5 \\ \hline
 diskG64O4Freq60.show & \num{1.3}{-4} & 15.7 & \num{-inf}{-2147483648} &  0.5 \\ \hline
                      &     3.97      &      &    -1.00      &     \\ \hline
\end{tabular}
\caption{comp. Max-norm self convergence results, t=0.000000e+00, Tue Jan  7 12:43:33 2025. }
\end{center}
\end{table}



$cgwh -noplot gaussian.cmd -g=sicFixede16.order4  -ts=implicit -cfl=10000 -x0=-0.55 -y0=-0.5 -nf=1 -freq=60 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -rtoli=1e-10 -atoli=1e-10 -matlab=diskG16O4Freq60  -show=diskG16O4Freq60.show  -krylovType=gmres -go=og

ORDER=2

$cgwh -noplot gaussian.cmd -g=sicFixede16.order2  -ts=implicit -cfl=10000 -x0=-0.65 -y0=-0.6 -nf=1 -freq=30 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -rtoli=1e-10 -atoli=1e-10 -matlab=diskG16O2Freq30  -show=diskG16O2Freq30.show  -krylovType=gmres -go=ds

$cgwh -noplot gaussian.cmd -g=sicFixede16.order2  -ts=implicit -cfl=10000 -x0=.25 -y0=0.35 -nf=1 -freq=30 -amp=1600 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -rtoli=1e-10 -atoli=1e-10 -matlab=diskG16O2Freq40  -show=diskG16O2Freq40.show  -krylovType=gmres -go=ds > diskG16O2Freq40.out

 omega=  3.00e+01, k=  3.00e+01, lambda=  2.09e-01, dx=  6.25e-03, domainSize=  2.00e+00, NLambda=9.5493, ppw=lambda/dx=  34, ppw(rule-of-thumb)=  97 (epsr=0.01)<<<


$cgwh -noplot gaussian.cmd -g=sicFixede16.order4  -ts=implicit -cfl=10000 -x0=.25 -y0=0.35 -nf=1 -freq=60 -amp=1600 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -rtoli=1e-10 -atoli=1e-10 -matlab=diskG16O4Freq60  -show=diskG16O4Freq60.show  -krylovType=gmres -go=ds > diskG16O4Freq60.out

omega=  6.00e+01, k=  6.00e+01, lambda=  1.05e-01, dx=  6.25e-03, domainSize=  2.00e+00, NLambda=19.0986, ppw=lambda/dx=  17, ppw(rule-of-thumb)=  21 (epsr=0.01)<<<

$cgwh -noplot gaussian.cmd -g=sicFixede32.order4  -ts=implicit -cfl=10000 -x0=.25 -y0=0.35 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -rtoli=1e-10 -atoli=1e-10 -matlab=diskG32O4Freq40  -show=diskG32O4Freq40.show  -krylovType=gmres -go=ds > diskG32O4Freq40.out

$cgwh -noplot gaussian.cmd -g=sicFixede16.order4  -ts=implicit -cfl=10000 -x0=.25 -y0=0.35 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -rtoli=1e-10 -atoli=1e-10 -matlab=diskG16O4Freq40  -show=diskG16O4Freq40.show  -krylovType=gmres -go=ds > diskG16O4Freq40.out

$cgwh -noplot gaussian.cmd -g=sicFixede8.order4  -ts=implicit -cfl=10000 -x0=.25 -y0=0.35 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -rtoli=1e-10 -atoli=1e-10 -matlab=diskG8O4Freq40  -show=diskG8O4Freq40.show  -krylovType=gmres -go=ds > diskG8O4Freq40.out

omega=  4.00e+01, k=  4.00e+01, lambda=  1.57e-01, dx=  1.25e-02, domainSize=  2.00e+00, NLambda=12.7324, ppw=lambda/dx=  13, ppw(rule-of-thumb)=  19 (epsr=0.01)<<<




$cgwh -noplot gaussian.cmd -g=sixteenKnivesGride32.order2.hdf -ts=implicit -cfl=10000 -x0=0 -y0=0.1 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride32O2Freq40 -show=sixteenKnivesGrid32O2Freq40.show -krylovType=gmres -go=ds > sixteenKnivesGrid32O2Freq40.out



***************************************************
****** Mon Jan 6, 2025


G128

NO DEFLATE FOR NOW: running...
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride128.order4.hdf -ts=implicit -cfl=10000  -x0=0.0 -y0=0.3 -nf=1 -freq=175 -amp=30625 -beta=175 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=5000 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/sixteenKnivesGridG128O4Freq300Ev1024o.show -deflateWaveHoltz=0 -numToDeflate=600 -rtoli=1e-10 -atoli=1e-10  -matlab=sixteenKnivesGride128O4Freq175 -show=sixteenKnivesGride128O4Freq175.show -go=das > sixteenKnivesGride128O4Freq175.out

omega=  1.75e+02, k=  1.75e+02, lambda=  3.59e-02, dx=  7.81e-04, domainSize=  1.00e+00, NLambda=27.8521, ppw=lambda/dx=  46, ppw(rule-of-thumb)=  23 (epsr=0.01)<<<
solveHelmholtz: max-res=1.931e-07 (agmres, numIts=629, ave-CR= 0.96 , ACR=-1.00)
solveHelmholtz: rel-max-diff=4.65e-08, |v|_max= 6.77e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


plotStuff plotSolution.cmd -show=sixteenKnivesGride128O4Freq175 -solution=1 

***************************************************
****** Mon Jan 6, 2025

16 knives for pollution errors and PPW

set ovp2 = ~/Dropbox/overHoltzPaper/part2


++++ ODRER=2 16 knives

>>> freq=80
plotStuff plotSolution.cmd -show=sixteenKnivesGrid400O2Freq80 -solution=1 
plotStuff plotSolution.cmd -show=sixteenKnivesGrid256O2Freq80 -solution=1 
plotStuff plotSolution.cmd -show=sixteenKnivesGrid128O2Freq80 -solution=1 
plotStuff plotSolution.cmd -show=sixteenKnivesGrid64O2Freq80 -solution=1 

*** G512: TOO BIG: 
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride512.order2.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1 -freq=80 -amp=6400 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride128O2EV512.show -deflateWaveHoltz=0 -numToDeflate=16 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride512O2Freq80 -show=sixteenKnivesGrid512O2Freq80.show -krylovType=gmres -go=das > sixteenKnivesGrid512O2Freq80.out

G400: 
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride400.order2.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1 -freq=80 -amp=6400 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride128O2EV512.show -deflateWaveHoltz=0 -numToDeflate=16 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride400O2Freq80 -show=sixteenKnivesGrid400O2Freq80.show -krylovType=gmres -go=das > sixteenKnivesGrid400O2Freq80.out

omega=  8.00e+01, k=  8.00e+01, lambda=  7.85e-02, dx=  2.50e-04, domainSize=  1.00e+00, NLambda=12.7324, ppw=lambda/dx= 314, ppw(rule-of-thumb)= 112 (epsr=0.01)<<<
solveHelmholtz: max-res=4.748e-06 (agmres, numIts=55, ave-CR= 0.63 , ACR=-1.00)
solveHelmholtz: rel-max-diff=3.32e-10, |v|_max= 7.08e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

G256
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride256.order2.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1 -freq=80 -amp=6400 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride128O2EV512.show -deflateWaveHoltz=0 -numToDeflate=16 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride256O2Freq80 -show=sixteenKnivesGrid256O2Freq80.show -krylovType=gmres -go=das > sixteenKnivesGrid256O2Freq80.out

omega=  8.00e+01, k=  8.00e+01, lambda=  7.85e-02, dx=  3.91e-04, domainSize=  1.00e+00, NLambda=12.7324, ppw=lambda/dx= 201, ppw(rule-of-thumb)= 112 (epsr=0.01)<<<
solveHelmholtz: max-res=1.369e-06 (agmres, numIts=78, ave-CR= 0.71 , ACR=-1.00)
solveHelmholtz: rel-max-diff=8.57e-09, |v|_max= 7.03e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

G128
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride128.order2.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1 -freq=80 -amp=6400 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride128O2EV512.show -deflateWaveHoltz=0 -numToDeflate=16 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride128O2Freq80 -show=sixteenKnivesGrid128O2Freq80.show -krylovType=gmres -go=das > sixteenKnivesGrid128O2Freq80.out

omega=  8.00e+01, k=  8.00e+01, lambda=  7.85e-02, dx=  7.81e-04, domainSize=  1.00e+00, NLambda=12.7324, ppw=lambda/dx= 101, ppw(rule-of-thumb)= 112 (epsr=0.01)<<<
solveHelmholtz: max-res=1.441e-07 (agmres, numIts=55, ave-CR= 0.62 , ACR=-1.00)
solveHelmholtz: rel-max-diff=2.96e-11, |v|_max= 7.03e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

No deflate for now
$cgwh -noplot gaussian.cmd -g=sixteenKnivesGride64.order2.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1 -freq=80 -amp=6400 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride32O2EV512.show -deflateWaveHoltz=0 -numToDeflate=16 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride64O2Freq80 -show=sixteenKnivesGrid64O2Freq80.show -krylovType=gmres -go=das > sixteenKnivesGrid64O2Freq80.out

omega=  8.00e+01, k=  8.00e+01, lambda=  7.85e-02, dx=  1.56e-03, domainSize=  1.00e+00, NLambda=12.7324, ppw=lambda/dx=  50, ppw(rule-of-thumb)= 112 (epsr=0.01)<<<
solveHelmholtz: max-res=1.130e-08 (agmres, numIts=93, ave-CR= 0.76 , ACR=-1.00)
solveHelmholtz: rel-max-diff=2.15e-11, |v|_max= 7.22e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>> freq=45
plotStuff plotSolution.cmd -show=sixteenKnivesGrid128O2Freq45 -solution=1 
plotStuff plotSolution.cmd -show=sixteenKnivesGrid64O2Freq45 -solution=1 
plotStuff plotSolution.cmd -show=sixteenKnivesGrid32O2Freq45 -solution=1 


No deflate for now
$cgwh -noplot gaussian.cmd -g=sixteenKnivesGride128.order2.hdf -ts=implicit -cfl=10000 -x0=0.1 -y0=0.05 -nf=1 -freq=45 -amp=2025 -beta=45 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride128O2EV512.show -deflateWaveHoltz=0 -numToDeflate=16 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride128O2Freq45 -show=sixteenKnivesGrid128O2Freq45.show -krylovType=gmres -go=das > sixteenKnivesGrid128O2Freq45.out


No deflate for now
$cgwh -noplot gaussian.cmd -g=sixteenKnivesGride64.order2.hdf -ts=implicit -cfl=10000 -x0=0.1 -y0=0.05 -nf=1 -freq=45 -amp=2025 -beta=45 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride32O2EV512.show -deflateWaveHoltz=0 -numToDeflate=16 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride64O2Freq45 -show=sixteenKnivesGrid64O2Freq45.show -krylovType=gmres -go=das > sixteenKnivesGrid64O2Freq45.out

omega=  4.50e+01, k=  4.50e+01, lambda=  1.40e-01, dx=  1.56e-03, domainSize=  1.00e+00, NLambda=7.16197, ppw=lambda/dx=  89, ppw(rule-of-thumb)=  84 (epsr=0.01)<<<


solveHelmholtz: max-res=1.604e-06 (gmres, numIts=33, ave-CR= 0.57 , ACR=-1.00)
solveHelmholtz: rel-max-diff=1.95e-10, |v|_max= 1.46e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


$cgwh -noplot gaussian.cmd -g=sixteenKnivesGride32.order2.hdf -ts=implicit -cfl=10000 -x0=0.1 -y0=0.05 -nf=1 -freq=45 -amp=2025 -beta=45 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride32O2EV512.show -deflateWaveHoltz=0 -numToDeflate=16 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride32O2Freq45 -show=sixteenKnivesGrid32O2Freq45.show -krylovType=gmres -go=das > sixteenKnivesGrid32O2Freq45.out

omega=  4.50e+01, k=  4.50e+01, lambda=  1.40e-01, dx=  3.13e-03, domainSize=  1.00e+00, NLambda=7.16197, ppw=lambda/dx=  45, ppw(rule-of-thumb)=  84 (epsr=0.01)<<<


omega=  5.00e+01, k=  5.00e+01, lambda=  1.26e-01, dx=  3.13e-03, domainSize=  1.00e+00, NLambda=7.95775, ppw=lambda/dx=  40, ppw(rule-of-thumb)=  89 (epsr=0.01)<<<


+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++ ORDER=4 16 knives 

plotStuff plotSolution.cmd -show=sixteenKnivesGride128O4Freq175 -solution=1 
plotStuff plotSolution.cmd -show=sixteenKnivesGrid64O4Freq175 -solution=1 
plotStuff plotSolution.cmd -show=sixteenKnivesGrid32O4Freq175 -solution=1 

G128

NO DEFLATE FOR NOW: running...
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride128.order4.hdf -ts=implicit -cfl=10000  -x0=0.0 -y0=0.3 -nf=1 -freq=175 -amp=30625 -beta=175 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=5000 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/sixteenKnivesGridG128O4Freq300Ev1024o.show -deflateWaveHoltz=0 -numToDeflate=600 -rtoli=1e-10 -atoli=1e-10  -matlab=sixteenKnivesGride128O4Freq175 -show=sixteenKnivesGride128O4Freq175.show -go=das > sixteenKnivesGride128O4Freq175.out


G64: 
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride64.order4.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1  -freq=175 -amp=30625 -beta=175 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride64EV1024.show -deflateWaveHoltz=1 -numToDeflate=200 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride64O4Freq175 -show=sixteenKnivesGrid64O4Freq175.show -krylovType=gmres -go=das


 Convergence rate CR=0.580, CR-perPeriod=0.762, Time to solve = 6.43e+01(s) : CgWave= 6.34e+01(s) 98.61%, advance= 6.10e+01(s) 94.79%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 34 (gmres) (maximumNumberOfIterations=100)
 omega=  1.75e+02, k=  1.75e+02, lambda=  3.59e-02, dx=  1.56e-03, domainSize=  1.00e+00, NLambda=27.8521, ppw=lambda/dx=  23, ppw(rule-of-thumb)=  23 (epsr=0.01)<<<

solveHelmholtz: max-res=1.037e-07 (agmres, numIts=44, ave-CR= 0.58 deflate=216, ACR= 0.91)
solveHelmholtz: rel-max-diff=4.49e-09, |v|_max= 6.68e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

G32:
$cgwh -noplot gaussian.cmd -g=sixteenKnivesGride32.order4.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1 -freq=175 -amp=30625 -beta=175 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride32EV1024.show -deflateWaveHoltz=1 -numToDeflate=200 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride32O4Freq175 -show=sixteenKnivesGrid32O4Freq175.show -krylovType=gmres -go=das > sixteenKnivesGrid32O4Freq175.out

 omega=  1.75e+02, k=  1.75e+02, lambda=  3.59e-02, dx=  3.13e-03, domainSize=  1.00e+00, NLambda=27.8521, ppw=lambda/dx=  11, ppw(rule-of-thumb)=  23 (epsr=0.01)<<<
solveHelmholtz: max-res=3.549e-03 (agmres, numIts=42, ave-CR= 0.57 deflate=219, ACR= 0.91)
solveHelmholtz: rel-max-diff=1.76e-06, |v|_max= 6.93e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



***************************************************
****** Wed Jan 1, 2025

BICGSTAB:
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -freq=14.064 -amp=197.8 -beta=14.064 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1600.show -deflateWaveHoltz=1 -numToDeflate=350 -matlab=darkCornerRoomG8O4Freq14 -show=darkCornerRoomG8O4Freq14.show -krylovType=bicgstab -go=ka

DOUBLE ELLIPSE -- freq=14 (edge mode)
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -freq=14.064 -amp=197.8 -beta=14.064 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1600.show -deflateWaveHoltz=1 -numToDeflate=350 -matlab=darkCornerRoomG8O4Freq14 -show=darkCornerRoomG8O4Freq14.show -krylovType=gmres -go=dfkas > darkCornerRoomG8O4Freq14.out


omega=  1.41e+01, k=  1.41e+01, lambda=  4.47e-01, dx=  1.25e-02, domainSize=  1.20e+01, NLambda=26.8526, ppw=lambda/dx=  36, ppw(rule-of-thumb)=  23 (epsr=0.01)<<<




plotStuff plotSolution.cmd -show=darkCornerRoomG8O4Freq14 -solution=1 -comp=absv

***************************************************
****** Tues Dec 31, 2024

DISK COMPARE ERRORS

LOWER FREQ: 
$cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=5 -amp=25 -beta=5 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=junk -krylovType=gmres -go=da

CgWaveHoltz::residual: grid=0 : maxRes= 1.72e-08
CgWaveHoltz::residual: grid=1 : maxRes= 9.15e-11
CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=1.723e-08.
CgWaveHoltz: omega=5.000e+00, max-res=1.723e-08 (direct Helmholtz solution)


deflate=0
solveHelmholtz: max-res=1.723e-08 (gmres, numIts=0, ave-CR= 1.00 , ACR=-1.00)
solveHelmholtz: rel-max-diff=8.42e-16, |v|_max= 1.50e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

deflate 125:
CgWaveHoltz::residual: grid=0 : maxRes= 8.58e-09
CgWaveHoltz::residual: grid=1 : maxRes= 1.67e-10
CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=8.584e-09.
solveHelmholtz: max-res=8.584e-09 (agmres, numIts=8, ave-CR= 0.03 deflate=125, ACR= 0.06)
solveHelmholtz: rel-max-diff=2.02e-11, |v|_max= 1.50e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





ABICGSTAB: small tol:
$cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64 -show=diskG16O4Freq50Deflate64.show -krylovType=bicgstab -go=da

CgWaveHoltz::residual: grid=0 : maxRes= 1.81e-07
CgWaveHoltz::residual: grid=1 : maxRes= 9.00e-08
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=1.814e-07.
solveHelmholtz: max-res=1.814e-07 (abicgstab, numIts=81, ave-CR= 0.75 deflate=125, ACR= 0.95)
solveHelmholtz: rel-max-diff=2.38e-08, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

ABICGSTAB: small tol:
$cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64 -show=diskG16O4Freq50Deflate64.show -krylovType=bicgstab -go=dk


AGMRES:
deflate fewer
cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=4 -matlab=junk  -krylovType=gmres -go=da

***CHECK ME: WHY IS RESIDUAL SO BIG FOR DIRECT SOLVE ???
*** freq=0: omega=50, max residual=0.00e+00, time for direct Helmholtz solve = 3.18e+00 (s) (iterations=0) ***
CgWaveHoltz::residual: grid=0 : maxRes= 2.46e-06
CgWaveHoltz::residual: grid=1 : maxRes= 4.46e-07
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=2.461e-06.
CgWaveHoltz: omega=5.000e+01, max-res=2.461e-06 (direct Helmholtz solution)

CgWaveHoltz::residual: grid=0 : maxRes= 1.72e-07
CgWaveHoltz::residual: grid=1 : maxRes= 7.82e-08
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=1.716e-07.
solveHelmholtz: max-res=1.716e-07 (agmres, numIts=431, ave-CR= 0.94 deflate=8, ACR= 1.00)
solveHelmholtz: rel-max-diff=2.37e-08, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


AGMRES: change freq a bit:
$cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50.5 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=junk -krylovType=gmres -go=da

freq 50.5
AUG-GMRES: Compute A*W(:,0) ASSUMING augmented vectors are eigenvectors, eig= 1.000e+00, lam=1-eig= 3.195e-05
AUG-GMRES: Compute A*W(:,1) ASSUMING augmented vectors are eigenvectors, eig= 1.000e+00, lam=1-eig= 3.195e-05


CgWaveHoltz::residual: freq= 0, omega=  50.500, max-res=5.935e-08.
solveHelmholtz: max-res=5.935e-08 (agmres, numIts=72, ave-CR= 0.67 deflate=122, ACR= 0.95)
solveHelmholtz: rel-max-diff=1.95e-09, |v|_max= 1.46e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

freq=50.1
CgWaveHoltz::residual: grid=0 : maxRes= 1.34e-07
CgWaveHoltz::residual: grid=1 : maxRes= 7.48e-08
CgWaveHoltz::residual: freq= 0, omega=  50.100, max-res=1.336e-07.
solveHelmholtz: max-res=1.336e-07 (agmres, numIts=73, ave-CR= 0.68 deflate=123, ACR= 0.96)
solveHelmholtz: rel-max-diff=1.46e-08, |v|_max= 1.57e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


AGMRES: small tol:
$cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64 -show=diskG16O4Freq50Deflate64.show -krylovType=gmres -go=da

AUG-GMRES: Compute A*W(:,0) ASSUMING augmented vectors are eigenvectors, eig= 1.000e+00, lam=1-eig= 1.305e-05
AUG-GMRES: Compute A*W(:,1) ASSUMING augmented vectors are eigenvectors, eig= 1.000e+00, lam=1-eig= 1.305e-05
AUG-GMRES: Compute A*W(:,2) ASSUMING augmented vectors are eigenvectors, eig= 1.000e+00, lam=1-eig= 1.366e-05
AUG-GMRES: Compute A*W(:,3) ASSUMING augmented vectors are eigenvectors, eig= 1.000e+00, lam=1-eig= 1.366e-05
AUG-GMRES: Compute A*W(:,4) ASSUMING augmented vectors are eigenvectors, eig= 9.999e-01, lam=1-eig= 1.215e-04


CgWaveHoltz::residual: grid=0 : maxRes= 1.75e-07
CgWaveHoltz::residual: grid=1 : maxRes= 8.92e-08
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=1.754e-07.
solveHelmholtz: max-res=1.754e-07 (agmres, numIts=71, ave-CR= 0.67 deflate=125, ACR= 0.95)
solveHelmholtz: rel-max-diff=2.38e-08, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


tol=1e-14
CgWaveHoltz::residual: grid=0 : maxRes= 1.75e-07
CgWaveHoltz::residual: grid=1 : maxRes= 8.92e-08
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=1.753e-07.
solveHelmholtz: max-res=1.753e-07 (agmres, numIts=100, ave-CR= 0.73 deflate=125, ACR= 0.95)
solveHelmholtz: rel-max-diff=2.38e-08, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES
$cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=150 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64 -show=diskG16O4Freq50Deflate64.show -krylovType=gmres -go=dk

CgWaveHoltz::residual: grid=0 : maxRes= 1.06e-02
CgWaveHoltz::residual: grid=1 : maxRes= 3.80e-03
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=1.062e-02.
solveHelmholtz: max-res=1.062e-02 (gmres, numIts=46, ave-CR= 0.66 deflate=125, ACR= 0.95)
solveHelmholtz: rel-max-diff=1.30e-04, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


***************************************************
****** Sun Dec 29, 2024

>>>>>>>  RETURN TO SIXTEEEN KNIVES 

from /home/henshw/runs/overHoltz/eig
$genEigs -noplot /home/henshw/runs/eig/eigs.cmd -problem=laplace -eigCase=none -discreteEigenvalues=1 -g=sixteenKnivesGride128.order4.hdf -numEigenValues=1024 -tol=1.0e-14 -bc1=d -evFile=sixteenKnivesGridG128O4Freq300Ev1024.show -show=sixteenKnivesGridG128O4Freq300Ev1024o.show -orthogonalize=1 -matlab=0 -go=read

16 knives: SOURCE UPPER LEFT CORNER

setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride128.order4.hdf -ts=implicit -cfl=10000 -x0=-.47 -y0=.52 -nf=1 -freq=326.2 -amp=106410 -beta=326.2 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/sixteenKnivesGridG128O4Freq300Ev1024o.show -deflateWaveHoltz=1 -numToDeflate=600 -rtoli=1e-10 -atoli=1e-10  -matlab=sixteenKnivesGride128O4Freq326p2 -show=sixteenKnivesGride128O4Freq326p2.show -go=dks > sixteenKnivesGride128O4Freq326p2.out

Convergence rate CR=0.671, CR-perPeriod=0.819, Time to solve = 4.54e+02(s) : CgWave= 4.47e+02(s) 98.48%, advance= 4.28e+02(s) 94.41%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 45 (gmres) (maximumNumberOfIterations=500)
 omega=  3.26e+02, k=  3.26e+02, lambda=  1.93e-02, dx=  7.81e-04, domainSize=  1.00e+00, NLambda=51.9163, ppw=lambda/dx=  25, ppw(rule-of-thumb)=  27 (epsr=0.01)<<<

plotStuff plotSolution.cmd -show=sixteenKnivesGride128O4Freq326p2.show -solution=1 -comp=absv



setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride128.order4.hdf -ts=implicit -cfl=10000 -x0=-.47 -y0=.52 -nf=1 -freq=325 -amp=90000 -beta=300 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/sixteenKnivesGridG128O4Freq300Ev1024o.show -deflateWaveHoltz=1 -numToDeflate=600 -rtoli=1e-10 -atoli=1e-10  -matlab=sixteenKnivesGride128O4Freq300 -show=sixteenKnivesGride128O4Freq325.show -go=das > sixteenKnivesGride128O4Freq325.out


***************************************************
****** Sun Dec 29, 2024

>>>>>>>  RETURN TO SIXTEEEN KNIVES 

PLOT GRD:

plotStuff plotTipGrid.cmd -grid=/home/henshw/grids/sixteenKnivesGride16.order2.hdf -name=sixteenKnivesGride16



FREQ=175
BICGSTAB
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride64.order4.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1  -freq=175 -amp=30625 -beta=175 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride64EV1024.show -deflateWaveHoltz=1 -numToDeflate=200 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride64O4Freq175 -show=sixteenKnivesGrid64O4Freq175.show -krylovType=bicgstab -go=ka

GMRES:
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride64.order4.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1  -freq=175 -amp=30625 -beta=175 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride64EV1024.show -deflateWaveHoltz=1 -numToDeflate=200 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride64O4Freq175 -show=sixteenKnivesGrid64O4Freq175.show -go=dfka

omega=  1.75e+02, k=  1.75e+02, lambda=  3.59e-02, dx=  1.56e-03, domainSize=  1.00e+00, NLambda=27.8521, ppw=lambda/dx=  23, ppw(rule-of-thumb)=  23 (epsr=0.01)<<<


plotStuff plotSolution.cmd -show=sixteenKnivesGride64O4Freq175.show -solution=1 -comp=absv



Solution very local to middle
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride64.order4.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1  -freq=180 -amp=32400 -beta=180 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride64EV1024.show -deflateWaveHoltz=1 -numToDeflate=200 -rtoli=1e-10 -atoli=1e-10 -matlab=sixteenKnivesGride64O4Freq180 -show=sixteenKnivesGride64O4Freq180.show -go=ks

-go=dfkas > sixteenKnivesGride64O4Freq193.out

plotStuff plotSolution.cmd -show=sixteenKnivesGride64O4Freq180.show -solution=1 -comp=absv


OMEGA=180: PPW=22 ROT=23
omega=  1.80e+02, k=  1.80e+02, lambda=  3.49e-02, dx=  1.56e-03, domainSize=  1.00e+00, NLambda=28.6479, ppw=lambda/dx=  22, ppw(rule-of-thumb)=  23 (epsr=0.01)<<<


OMEGA=193: PPW=21 ROT=23
omega=  1.93e+02, k=  1.93e+02, lambda=  3.26e-02, dx=  1.56e-03, domainSize=  1.00e+00, NLambda=30.7169, ppw=lambda/dx=  21, ppw(rule-of-thumb)=  23 (epsr=0.01)<<<


+++++++++++++



DOUBLE ELLIPSE -- need more eigs 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -freq=16.4 -amp=268.96 -beta=16.4 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=256 -matlab=darkCornerRoomG8O4Freq20 -show=darkCornerRoomG8O4Freq20.show -go=k



DISK HIGH FREQ - plot for paper
cgwh -noplot gaussian.cmd -g=sice32.order4.ng3 -x0=-0.65 -y0=-0.6 -nf=1 -freq=90 -amp=8100 -beta=90 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG32O4Ev2048.show -deflateWaveHoltz=1 -numToDeflate=128 -matlab=diskG32O4Freq90Deflate128  -krylovType=gmres -show=diskG32O4Freq90Deflate128.show -go=as


plotStuff plotSolution.cmd -show=diskG32O4Freq90Deflate128.show -solution=1 -comp=absv

DISK REDO FEWER FPI ITERATIONS:
$cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=150 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64 -show=diskG16O4Freq50Deflate64.show -krylovType=gmres -go=df

***************************************************
****** Sat Dec 28, 2024


++++++++++++++ RETURN TO DOUBLE ELLIPSE for DWH paper


G8 : need EV's orthogomalized
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -freq=16.4 -amp=268.96 -beta=16.4 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=256 -matlab=darkCornerRoomG8O4Freq20 -show=darkCornerRoomG8O4Freq20.show -go=k


CHECK PPW: 
freq=16.4 : PPW=15 PPW-ROT=24 
Np=6 --> Np=2
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -freq=16.4 -amp=268.96 -beta=16.4 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=6 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=256 -matlab=darkCornerRoomG4O4Freq16p4 -show=darkCornerRoomG4O4Freq16p4.show -go=das > darkCornerRoomG4O4Freq16p4.out

plotStuff plotSolution.cmd -show=darkCornerRoomG4O4Freq16p4.show -solution=1 -comp=absv

Convergence rate CR=0.467, CR-perPeriod=0.881, Time to solve = 1.79e+02(s) : CgWave= 1.51e+02(s) 83.93%, advance= 1.50e+02(s) 83.37%
 max-residual=0.00e+00 (WaveHoltz its), numberOfIterations = 32 (Augmented-GMRES) (maximumNumberOfIterations=50)
 omega=  1.64e+01, k=  1.64e+01, lambda=  3.83e-01, dx=  2.50e-02, domainSize=  1.20e+01, NLambda=31.3217, ppw=lambda/dx=  15, ppw(rule-of-thumb)=  24 (epsr=0.01)<<<

++++++++++++++++++++++++++ DISK ++++++++++++++++++++++++++++++

DISK G32 freq=90:
OK 
cgwh -noplot gaussian.cmd -g=sice32.order4.ng3 -x0=-0.5 -y0=-0.65 -nf=1 -freq=90 -amp=8100 -beta=90 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG32O4Ev2048.show -deflateWaveHoltz=1 -numToDeflate=128 -matlab=diskG32O4Freq90Deflate128  -krylovType=gmres -show=diskG32O4Freq90Deflate128.show -go=as

OK: 
cgwh -noplot gaussian.cmd -g=sice32.order4.ng3 -x0=-0.65 -y0=-0.6 -nf=1 -freq=90 -amp=8100 -beta=90 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG32O4Ev2048.show -deflateWaveHoltz=1 -numToDeflate=128 -matlab=diskG32O4Freq90Deflate128  -krylovType=gmres -show=diskG32O4Freq90Deflate128.show -go=as

freq=90
 omega=  9.00e+01, k=  9.00e+01, lambda=  6.98e-02, dx=  3.13e-03, domainSize=  2.00e+00, NLambda=28.6479, ppw=lambda/dx=  22, ppw(rule-of-thumb)=  23 (epsr=0.01)<<<

plotStuff plotSolution.cmd -show=diskG32O4Freq90Deflate128.show -solution=1 -comp=absv

freq=80
max-residual=0.00e+00 (WaveHoltz its), numberOfIterations = 77 (Augmented-GMRES) (maximumNumberOfIterations=200)
 omega=  8.00e+01, k=  8.00e+01, lambda=  7.85e-02, dx=  3.13e-03, domainSize=  2.00e+00, NLambda=25.4648, ppw=lambda/dx=  25, ppw(rule-of-thumb)=  22 (epsr=0.01)<<<


plotStuff plotSolution.cmd -show=diskG32O4Freq80Deflate1280.show -solution=1 -comp=absv


omega=75:
 Convergence rate CR=0.700, CR-perPeriod=0.837, Time to solve = 2.86e+02(s) : CgWave= 2.24e+02(s) 78.15%, advance= 2.22e+02(s) 77.64%
 max-residual=0.00e+00 (WaveHoltz its), numberOfIterations = 69 (Augmented-GMRES) (maximumNumberOfIterations=200)
 omega=  7.50e+01, k=  7.50e+01, lambda=  8.38e-02, dx=  3.13e-03, domainSize=  2.00e+00, NLambda=23.8732, ppw=lambda/dx=  27, ppw(rule-of-thumb)=  22 (epsr=0.01)<<<


+++ G32 freq=60 : 
cgwh -noplot gaussian.cmd -g=sice32.order4.ng3 -x0=-0.65 -y0=-0.6 -nf=1 -freq=60 -amp=360 -beta=60 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG32O4Ev1024.show -deflateWaveHoltz=1 -numToDeflate=100 -matlab=diskG32O4Freq60Deflate100  -krylovType=gmres -show=diskG32O4Freq60Deflate100.show -go=as

plotStuff plotSolution.cmd -show=diskG32O4Freq60Deflate100 -solution=1 -comp=absv

>>>omega=  6.00e+01, k=  6.00e+01, lambda=  1.05e-01, dx=  3.13e-03, domainSize=  2.00e+00, NLambda=19.0986, ppw=lambda/dx=  34, ppw(rule-of-thumb)=  21 (epsr=0.01)<<<

CgWaveHoltz::residual: grid=0 : maxRes= 1.03e-07
CgWaveHoltz::residual: grid=1 : maxRes= 7.01e-08
CgWaveHoltz::residual: freq= 0, omega=  60.000, max-res=1.030e-07.
solveHelmholtz: max-res=1.030e-07 (agmres, numIts=53, ave-CR= 0.65 deflate=198, ACR= 0.94)

CgWaveHoltz::residual: grid=0 : maxRes= 5.43e-02
CgWaveHoltz::residual: grid=1 : maxRes= 1.66e-01
CgWaveHoltz::residual: freq= 0, omega=  60.000, max-res=1.660e-01.
solveHelmholtz: max-res=1.660e-01 (gmres, numIts=38, ave-CR= 0.65 deflate=198, ACR= 0.94)


COARSE GRID EIGENVECTORS

+++++ TEST LOWER FREQ: OMEGA=25 --> better


BICGSTAB-C2
cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=25 -amp=625 -beta=25 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG8O4Ev1024.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG16O4Freq25Deflate32C2  -krylovType=bicgstab -go=da


BICGSTAB
cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=25 -amp=625 -beta=25 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG16O4Freq25Deflate32  -krylovType=bicgstab -go=ka

AGMRES-C2
cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=25 -amp=625 -beta=25 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG8O4Ev1024.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG16O4Freq25Deflate32C2  -krylovType=gmres -go=da


GMRES
cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=25 -amp=625 -beta=25 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG16O4Freq25Deflate32  -krylovType=gmres -go=dfka


 >>>omega=  2.50e+01, k=  2.50e+01, lambda=  2.51e-01, dx=  6.25e-03, domainSize=  2.00e+00, NLambda=7.95775, ppw=lambda/dx=  40, ppw(rule-of-thumb)=  17 (epsr=0.01)<<<

+++++++++++++++++++++++++++++++++++++


AGMRES-O2 -- SLOW
cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/diskG16O2Ev1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64O2  -krylovType=gmres -go=da
CgWaveHoltz::residual: grid=0 : maxRes= 3.77e-08
CgWaveHoltz::residual: grid=1 : maxRes= 2.92e-07
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=2.917e-07.
solveHelmholtz: max-res=2.917e-07 (agmres, numIts=345, ave-CR= 0.93 deflate=120, ACR= 0.96)
solveHelmholtz: rel-max-diff=7.37e-10, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



BICGSTAB-C2
cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG8O4Ev1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64C2  -krylovType=bicgstab -go=da

CgWaveHoltz::residual: grid=0 : maxRes= 5.03e-05
CgWaveHoltz::residual: grid=1 : maxRes= 4.02e-05
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=5.032e-05.
solveHelmholtz: max-res=5.032e-05 (abicgstab, numIts=875, ave-CR= 0.98 deflate=121, ACR= 0.96)
solveHelmholtz: rel-max-diff=7.07e-06, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

AGMRES-C2
cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG8O4Ev1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64C2  -krylovType=gmres -go=da

CgWaveHoltz::residual: grid=0 : maxRes= 3.06e-08
CgWaveHoltz::residual: grid=1 : maxRes= 1.58e-08
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=3.058e-08.
solveHelmholtz: max-res=3.058e-08 (agmres, numIts=292, ave-CR= 0.92 deflate=121, ACR= 0.96)
solveHelmholtz: rel-max-diff=4.80e-10, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

***************************************************
****** Fri Dec 27, 2024

START CASES FOR DEFLATED WAVEHOLTZ PAPER


@@@@@@@@@ DISK 
   - excite surface mode ?? 


DISK G16: Interesting mode: PPW OK 

setsid runCases.p disk16

bicgstab
$cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64 -show=diskG16O4Freq50Deflate64.show -krylovType=bicgstab -go=ka

AGMRES
$cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64 -show=diskG16O4Freq50Deflate64.show -krylovType=gmres -go=a


setsid $cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq50Deflate64 -show=diskG16O4Freq50Deflate64.show -krylovType=gmres -go=dfks > diskG16O4Freq50Deflate64.out

>>>omega=  5.00e+01, k=  5.00e+01, lambda=  1.26e-01, dx=  6.25e-03, domainSize=  2.00e+00, NLambda=15.9155, ppw=lambda/dx=  20, ppw(rule-of-thumb)=  20 (epsr=0.01)<<<

solveHelmholtz: max-res=1.062e-02 (gmres, numIts=46, ave-CR= 0.66 deflate=125, ACR= 0.95)
solveHelmholtz: rel-max-diff=1.30e-04, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


plotStuff plotSolution.cmd -show=diskG16O4Freq50Deflate64 -solution=1 -comp=absv




@@@@@@@  DOUBLE ELLIPSE @@@@@@@@@@@@@@@@@
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=2 -nf=1 -freq=10.44 -amp=-108.9936 -beta=10.44 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10p44Np1G4O4X3Y2Deflate256 -show=darkCornerRoomFreq10p44Np1G4O4X3Y2Deflate256.show -go=dfks > darkCornerRoomFreq10p44Np1G4O4X3Y2Deflate100.out



setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -freq=10.44 -amp=-108.9936 -beta=10.44 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10p44Np1G4Order4Deflate64 -show=darkCornerRoomFreq10p44Np1G4Order4Deflate64.show -go=dfks > darkCornerRoomFreq10p44Np1G4Order4Deflate64.out



setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -freq=10.44 -amp=-108.9936 -beta=10.44 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10p44Np1G4Order4Deflate64 -show=darkCornerRoomFreq10p44Np1G4Order4Deflate64.show -go=dfks > darkCornerRoomFreq10p44Np1G4Order4Deflate64.out

plotStuff plotSolution.cmd -show=darkCornerRoomFreq10p44Np1G4Order4Deflate64.show -name=darkCornerRoomFreq10p44Np1G4Order4Deflate64 -solution=1


solveHelmholtz: max-res=9.200e-02 (gmres, numIts=50, ave-CR= 0.87 deflate=66, ACR= 1.00)
solveHelmholtz: rel-max-diff=1.05e-02, |v|_max= 1.30e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


***************************************************
****** Wed Dec 25, 2024

TEST NEW COARSE-TO-FINE genEigs 


AGMRES: O4 COARSE
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=.35 -y0=.45 -nf=1 -freq=10 -amp=-100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=da

CgWaveHoltz::residual: grid=0 : maxRes= 1.87e-10
CgWaveHoltz::residual: grid=1 : maxRes= 1.39e-10
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=1.873e-10.
solveHelmholtz: max-res=1.873e-10 (agmres, numIts=54, ave-CR= 0.58 deflate=14, ACR= 0.89)
solveHelmholtz: rel-max-diff=3.32e-11, |v|_max= 2.18e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

AGMRES: O2 COARSE
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=.35 -y0=.45 -nf=1 -freq=10 -amp=-100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG4O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=da

solveHelmholtz: max-res=1.290e-10 (agmres, numIts=55, ave-CR= 0.59 deflate=14, ACR= 0.90)
solveHelmholtz: rel-max-diff=2.52e-11, |v|_max= 2.18e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

++++++ DISK ORDER=4

>>> coarse-to-fine eigenvectors:
cgwh -noplot gaussian.cmd -g=sice8.order4 -x0=.35 -y0=.45 -nf=1 -freq=10 -amp=-100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG8O4Ev64cf.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=dk

CgWaveHoltz::residual: grid=0 : maxRes= 3.64e-01
CgWaveHoltz::residual: grid=1 : maxRes= 8.01e-01
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=8.014e-01.
solveHelmholtz: max-res=8.014e-01 (gmres, numIts=30, ave-CR= 0.45 deflate=14, ACR= 0.89)
solveHelmholtz: rel-max-diff=3.58e-04, |v|_max= 2.27e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>> use standard eigenvectors: 
cgwh -noplot gaussian.cmd -g=sice8.order4 -x0=.35 -y0=.45 -nf=1 -freq=10 -amp=-100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG8O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=dk

CgWaveHoltz::residual: grid=0 : maxRes= 6.14e-04
CgWaveHoltz::residual: grid=1 : maxRes= 1.93e-04
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=6.138e-04.
solveHelmholtz: max-res=6.138e-04 (gmres, numIts=28, ave-CR= 0.42 deflate=15, ACR= 0.88)
solveHelmholtz: rel-max-diff=4.00e-05, |v|_max= 2.27e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


***************************************************
****** Wed Dec 25, 2024

TEST NEW COARSE-TO-FINE genEigs 

++++++ DISK

>>> coarse-to-fine eigenvectors:
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=.35 -y0=.45 -nf=1 -freq=10 -amp=-100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG8O2Ev64cf.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=dk

AGMRES: -- pretending EV's are exact:
CgWaveHoltz::residual: grid=0 : maxRes= 1.00e+01
CgWaveHoltz::residual: grid=1 : maxRes= 1.65e+00
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=1.004e+01.
solveHelmholtz: max-res=1.004e+01 (agmres, numIts=36, ave-CR= 0.45 deflate=14, ACR= 0.89)
solveHelmholtz: rel-max-diff=8.62e-03, |v|_max= 2.17e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES
CgWaveHoltz::residual: grid=0 : maxRes= 1.01e+01
CgWaveHoltz::residual: grid=1 : maxRes= 9.45e-01
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=1.012e+01.
solveHelmholtz: max-res=1.012e+01 (gmres, numIts=33, ave-CR= 0.48 deflate=14, ACR= 0.89)
solveHelmholtz: rel-max-diff=6.11e-03, |v|_max= 2.19e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

>>>>> use standard eigenvectors: 
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=.35 -y0=.45 -nf=1 -freq=10 -amp=-100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG8O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=dk

CgWaveHoltz::residual: grid=0 : maxRes= 3.07e-03
CgWaveHoltz::residual: grid=1 : maxRes= 1.52e-03
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=3.071e-03.
solveHelmholtz: max-res=3.071e-03 (gmres, numIts=33, ave-CR= 0.48 deflate=14, ACR= 0.89)
solveHelmholtz: rel-max-diff=2.48e-04, |v|_max= 2.18e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


++++++++++ SQUARE

>>> coarse-to-fine eigenvectors:
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=.65 -y0=.6 -nf=1 -freq=25 -amp=-625 -beta=25 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square128O2Ev64cf.show -deflateWaveHoltz=1 -numToDeflate=20 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=dk

>>> interpWidth=5
CgWaveHoltz::residual: grid=0 : maxRes= 4.74e+00
CgWaveHoltz::residual: freq= 0, omega=  25.000, max-res=4.736e+00.
solveHelmholtz: max-res=4.736e+00 (gmres, numIts=29, ave-CR= 0.44 deflate=38, ACR= 0.80)
solveHelmholtz: rel-max-diff=9.74e-05, |v|_max= 1.49e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

>>> interpWidth=4
CgWaveHoltz::residual: grid=0 : maxRes= 1.79e+01
CgWaveHoltz::residual: freq= 0, omega=  25.000, max-res=1.793e+01.
solveHelmholtz: max-res=1.793e+01 (gmres, numIts=29, ave-CR= 0.44 deflate=38, ACR= 0.80)
solveHelmholtz: rel-max-diff=7.41e-04, |v|_max= 1.49e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>> use standard eigenvectors: 
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=.65 -y0=.6 -nf=1 -freq=25 -amp=-625 -beta=25 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square128O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=20 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=dk


CgWaveHoltz::residual: grid=0 : maxRes= 1.91e-09
CgWaveHoltz::residual: freq= 0, omega=  25.000, max-res=1.915e-09.
solveHelmholtz: max-res=1.915e-09 (gmres, numIts=29, ave-CR= 0.44 deflate=38, ACR= 0.80)
solveHelmholtz: rel-max-diff=3.60e-12, |v|_max= 1.49e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



***************************************************
****** Tues Dec 24, 2024

DIRECT COARSE-GRID EIGENVECTOR DEFLATION -- COMPARE TO MATLAB

SOMETHING IS WRONG: 
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=.65 -y0=.6 -nf=1 -freq=25 -amp=-625 -beta=25 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev512.show -deflateWaveHoltz=1 -numToDeflate=20 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=dk

--quadratic interpolation: 
solveHelmholtz: max-res=2.049e+02 (gmres, numIts=29, ave-CR= 0.44 deflate=38, ACR= 0.80)
solveHelmholtz: rel-max-diff=3.29e-01, |v|_max= 2.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

@@@@@@@@@@@@@@@@@@ MATLAB @@@@@@@@@@@@@@@@@@@@@@@@
waveHoltz -nd=2 -ms=gaussian -implicit=1 -cfl=1000 -N0=128 -useFixPoint=0 -useGMRES=1 -kx1=1 -adjustOmega=1 -upwind=0 -tol=1e-12 -numFPI=50 -numPer=1 -numFreq=1 -omega1=25 -amp1=625 -beta1=25 -bc=dddd -x0=0.65 -y0=0.6 -krylovType=gmres -maxit=200 -deflate=1 -numToDeflate=20 -agmres=0 -abicgstab=0 -acg=0 -useApproxEigs=1

>>>>>>>>>>>> USE COARSE GRID EIGENVALUES:

linear interp:
 freq=1: max || H v -f ||/omega^2  = 1.38e+00 (residual in WaveHoltz solution v)
  freq=1: max || v - Helmholtz ||   = 1.11e-01 (error in WaveHoltz - Helmholtz)

Cubic interp ()
  freq=1: max || H v -f ||/omega^2  = 1.47e-01 (residual in WaveHoltz solution v)
  freq=1: max || v - Helmholtz ||   = 1.03e-01 (error in WaveHoltz - Helmholtz)

>>>>>>>>>>> USE FINE GRID EIGENVALUES: 
----CUBIC INTERP
  deflateWaveHoltz=1, numToDeflate=38, deflateForcing=0, deflateToRate=-1
  GMRES: average-CR=0.4462, FPI-ACR=0.8072, its=23, ||res||_h= 3.77e-08 [wave-solves=23]
==============================================================================
  freq=1: max || H v -f ||/omega^2  = 1.56e-01 (residual in WaveHoltz solution v)
  freq=1: max || v - Helmholtz ||   = 3.06e-03 (error in WaveHoltz - Helmholtz)

----LINEAR INTERP:
 GMRES: average-CR=0.4462, FPI-ACR=0.8072, its=23, ||res||_h= 3.77e-08 [wave-solves=23]
==============================================================================
  freq=1: max || H v -f ||/omega^2  = 1.46e+00 (residual in WaveHoltz solution v)
  freq=1: max || v - Helmholtz ||   = 1.41e-02 (error in WaveHoltz - Helmholtz)

***************************************************
****** Monday Dec 23, 2024

FIX direct deflation to also project the forcing

WHAT IS THE ACCURACY WITH Direct Eigenvector Deflation and USING COARSE GRID EVs ???

cgwh -noplot gaussian.cmd -g=square128.order2 -x0=.65 -y0=.7 -nf=1 -freq=20 -amp=400 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev512.show -deflateWaveHoltz=1 -numToDeflate=16 -matlab=square128O2freq20Deflate16  -krylovType=gmres -gmresRestartLength=200 -go=dk


ORDER=2: COARSE GRID EVs: WHY ARE ERRORS SO BIG ???
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=.65 -y0=.7 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev512.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=dk

INTERP-WIDTH=5: residual is less
solveHelmholtz: max-res=2.941e-01 (gmres, numIts=9, ave-CR= 0.13 deflate=3, ACR= 0.73)
solveHelmholtz: rel-max-diff=8.02e-02, |v|_max= 2.58e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

INTERP-WIDTH=4 : max-res is a lot less!!
CgWaveHoltz::residual: grid=0 : maxRes= 1.11e+00
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=1.110e+00.
solveHelmholtz: max-res=1.110e+00 (gmres, numIts=9, ave-CR= 0.13 deflate=3, ACR= 0.73)
solveHelmholtz: rel-max-diff=8.02e-02, |v|_max= 2.58e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


INTERP-WIDTH=3
CgWaveHoltz::residual: grid=0 : maxRes= 1.57e+01
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=1.575e+01.
solveHelmholtz: max-res=1.575e+01 (gmres, numIts=9, ave-CR= 0.13 deflate=3, ACR= 0.73)
solveHelmholtz: rel-max-diff=8.01e-02, |v|_max= 2.58e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


ORDER=2: FINE GRID EV's: 
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=.65 -y0=.7 -nf=1 -freq=10 -amp=100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square128O2Ev512.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -go=dk

solveHelmholtz: max-res=1.340e-07 (gmres, numIts=9, ave-CR= 0.13 deflate=3, ACR= 0.72)
solveHelmholtz: rel-max-diff=1.15e-10, |v|_max= 2.78e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



ORDER 4 -- TROUBLE ?? 
cgwh -noplot gaussian.cmd -g=square128.order4 -x0=.65 -y0=.7 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O4Ev512.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=square128O4freq40Deflate32  -krylovType=gmres -gmresRestartLength=200 -go=dk

cgwh -noplot gaussian.cmd -g=square128.order4 -x0=.65 -y0=.7 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O4Ev512.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=square128O4freq40Deflate32  -krylovType=gmres -gmresRestartLength=200 -go=dk

**TROUBLE: 
solvePETSc: RHS is b: l2-norm(b)=      inf, L2h-norm(b)=      inf





cgwh -noplot gaussian.cmd -g=square128.order4 -x0=.65 -y0=.7 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square128O4Ev512 -deflateWaveHoltz=1 -numToDeflate=32 -matlab=square128O4freq40Deflate32  -krylovType=gmres -gmresRestartLength=200 -go=dk



AFTER:
CgWaveHoltz::residual: grid=0 : maxRes= 4.25e-02
CgWaveHoltz::residual: freq= 0, omega=  40.000, max-res=4.254e-02.
solveHelmholtz: max-res=4.254e-02 (gmres, numIts=24, ave-CR= 0.37 deflate=61, ACR= 0.74)
solveHelmholtz: rel-max-diff=2.99e-04, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


START:



CgWaveHoltz::residual: grid=0 : maxRes= 4.29e-02
CgWaveHoltz::residual: freq= 0, omega=  40.000, max-res=4.290e-02.
solveHelmholtz: max-res=4.290e-02 (gmres, numIts=24, ave-CR= 0.37 deflate=61, ACR= 0.74)
solveHelmholtz: rel-max-diff=3.00e-04, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

Wrote results to the check file [cgWaveHoltz.check]
CgWaveHoltz::saved results in matlab file=[square128O4freq40Deflate32gmres.m]


***************************************************
****** Sat Dec 21, 2024

CHECK YALE VERUS PETSC LU : -- Yale is faster

tcm3 tipGridSmalle32.order4.ng3.hdf -order=4 -dirichlet -tol=1e-10 -solver=petsc -pc_type lu

PETSC: LU: 
*** max residual=1.48e-24, time for 1st solve of the Dirichlet problem = 3.03e+00 (iterations=1) ***
*** max residual=1.48e-24, time for 2nd solve of the Dirichlet problem = 7.69e-02 (iterations=1) ***


YALE:
*** max residual=0.00e+00, time for 1st solve of the Dirichlet problem = 1.36e+00 (iterations=0) ***
*** max residual=0.00e+00, time for 2nd solve of the Dirichlet problem = 1.52e-02 (iterations=0) ***



tcm3 square512.order4 -dirichlet -tol=1e-10 -solver=petsc -pc_type lu

PETSC : LU 
*** max residual=4.72e-23, time for 1st solve of the Dirichlet problem = 1.95e+00 (iterations=1) ***
*** max residual=4.72e-23, time for 2nd solve of the Dirichlet problem = 1.01e-01 (iterations=1) ***


=== Solver:
 yale, solver=[direct sparse solver, no pivoting + ]
 =====
*** max residual=0.00e+00, time for 1st solve of the Dirichlet problem = 1.75e+00 (iterations=0) ***

*** max residual=0.00e+00, time for 2nd solve of the Dirichlet problem = 2.26e-02 (iterations=0) ***

=== Solver:
 PETSc, solver=[bi-conjugate gradient stabilized + ILU(1) + reverse Cuthill-McKee ordering]
=====
*** max residual=2.04e-08, time for 1st solve of the Dirichlet problem = 2.55e+00 (iterations=184) ***
*** max residual=2.04e-08, time for 2nd solve of the Dirichlet problem = 2.37e+00 (iterations=184) ***



MORE OPTIMIZATIONS:

optimize updateTimeIntegral


cgwh -noplot gaussian.cmd -g=square128.order4 -x0=.65 -y0=.7 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square128O4Ev512 -deflateWaveHoltz=1 -numToDeflate=32 -matlab=square128O4freq40  -krylovType=gmres -gmresRestartLength=200 -go=dk

CgWaveHoltz::residual: grid=0 : maxRes= 4.29e-02
CgWaveHoltz::residual: freq= 0, omega=  40.000, max-res=4.290e-02.
solveHelmholtz: max-res=4.290e-02 (gmres, numIts=24, ave-CR= 0.37 deflate=61, ACR= 0.74)
solveHelmholtz: rel-max-diff=3.00e-04, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

  time integral.....................  1.20e-01    2.31e-04    1.39e-08     6.079   1.201e-01   1.201e-01
  deflation.........................  1.37e-01    2.64e-04    1.58e-08     6.937   1.371e-01   1.371e-01

***************************************************
****** Fri Dec 20, 2024

CHECK TIMINGS: EXPLICIT VS IMPLICIT

>>>>>>>>>>> IMPLICIT:

cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -freq=80 -amp=6400 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG32Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=128 -rtoli=1e-10 -atoli=1e-10 -matlab=knifeEdgeG32O4Freq80Np1Deflate128 -krylovType=gmres -go=k 

cgWave:FD24 t=0.000e+00 ( 0 steps) dt=8.589e-03 ||u||= 2.19e-02, cpu= 1.00e-06(s)
cgWave:FD24 t=7.730e-02 ( 9 steps) dt=8.589e-03 ||u||= 4.18e-01, cpu= 1.45e-01(s)
cgWave:FD24 t=8.589e-02 (10 steps) dt=8.589e-03 ||u||= 3.50e-01, cpu= 1.96e-01(s)

Convergence rate CR=0.639, CR-perPeriod=0.639, Time to solve = 1.02e+01(s) : CgWave= 1.00e+01(s) 98.24%, advance= 9.84e+00(s) 96.41%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 41 (gmres) (maximumNumberOfIterations=10000) 


CgWave:printStatistics: timeForOgesSolve= 7.80e+00(s), per-step= 1.81e-02(s) (for implicit solve factor)

              -------------------CgWave Summary----------------- 
                       Fri Dec 20 17:38:44 2024
               Grid:   /home/henshw/grids/tipGridSmalle32.order4.ng3.hdf 
  ==== final time= 7.85e-02, numberOfStepsTaken =      430, grids=4, gridpts =59740, interp pts=1476, processors=1, clock=2.99 GHz ==== 
  ==== memory per-proc: [min=281.527,ave=281.527,max=281.527](Mb), max-recorded=0 (Mb), total=281.527 (Mb)
 applyBoundaryConditions called 947 times
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  1.00e+01    2.33e-02    3.90e-07   100.000   1.001e+01   1.001e+01
setup and initialize................  4.38e-02    1.02e-04    1.71e-09     0.438   4.380e-02   4.380e-02
initialize BCs......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
initial conditions..................  2.55e-03    5.93e-06    9.93e-11     0.026   2.552e-03   2.552e-03
advance.............................  9.82e+00    2.28e-02    3.82e-07    98.171   9.823e+00   9.823e+00
  advance rectangular grids.........  2.71e-01    6.30e-04    1.05e-08     2.707   2.708e-01   2.708e-01
  advance curvilinear grids.........  3.38e-02    7.86e-05    1.32e-09     0.338   3.381e-02   3.381e-02
    implicit solve..................  7.88e+00    1.83e-02    3.07e-07    78.759   7.881e+00   7.881e+00
  add dissipation...................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  boundary conditions...............  5.00e-02    1.16e-04    1.95e-09     0.500   5.004e-02   5.004e-02
  interpolation.....................  2.27e-02    5.29e-05    8.85e-10     0.227   2.273e-02   2.273e-02
  update ghost (parallel)...........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add forcing.......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
    user known solution.............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  time integral.....................  1.56e+00    3.63e-03    6.07e-08    15.581   1.559e+00   1.559e+00
  deflation.........................  1.69e+00    3.92e-03    6.56e-08    16.842   1.685e+00   1.685e+00
  get errors........................  5.23e-04    1.22e-06    2.04e-11     0.005   5.230e-04   5.230e-04
  plotting..........................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
output results......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
waiting (not counted)...............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
--------------------------------------------------------------------------------------------------------




>>>>>>>>>>>>>>EXPLICIT:

cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=explicit -cfl=.95 -x0=-0.2 -y0=0.2 -nf=1 -freq=80 -amp=6400 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG32Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=128 -rtoli=1e-10 -atoli=1e-10 -matlab=knifeEdgeG32O4Freq80ExplicitNp1Deflate128 -krylovType=gmres -go=k   

cgWave:FD24 t=0.000e+00 (  0 steps) dt=9.532e-05 ||u||= 1.71e-02, cpu= 0.00e+00(s)
cgWave:FD24 t=7.854e-02 (824 steps) dt=9.532e-05 ||u||= 3.40e-01, cpu= 6.73e-01(s)


------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Real Solution 

 grid=/home/henshw/grids/tipGridSmalle32.order4.ng3.hdf
 Convergence rate CR=0.676, CR-perPeriod=0.676, Time to solve = 3.52e+01(s) : CgWave= 3.50e+01(s) 99.38%, advance= 3.48e+01(s) 98.76%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 48 (gmres) (maximumNumberOfIterations=10000)

 CgWaveHoltz::residual: grid=0 : maxRes= 3.29e-01
CgWaveHoltz::residual: grid=1 : maxRes= 1.53e-01
CgWaveHoltz::residual: grid=2 : maxRes= 1.12e-01
CgWaveHoltz::residual: grid=3 : maxRes= 8.71e-02
CgWaveHoltz::residual: freq= 0, omega=  80.000, max-res=3.286e-01.
solveHelmholtz: max-res=3.286e-01 (gmres, numIts=48, ave-CR= 0.68 deflate=130, ACR= 0.90)
solveHelmholtz: rel-max-diff=1.98e-04, |v|_max= 5.18e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

              -------------------CgWave Summary----------------- 
                       Fri Dec 20 16:14:57 2024
               Grid:   /home/henshw/grids/tipGridSmalle32.order4.ng3.hdf 
  ==== final time= 7.85e-02, numberOfStepsTaken =    41200, grids=4, gridpts =59740, interp pts=1476, processors=1, clock=2.99 GHz ==== 
  ==== memory per-proc: [min=133.887,ave=133.887,max=133.887](Mb), max-recorded=0 (Mb), total=133.887 (Mb)
 applyBoundaryConditions called 41301 times
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  3.50e+01    8.50e-04    1.42e-08   100.000   3.503e+01   3.503e+01
setup and initialize................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
initialize BCs......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
initial conditions..................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
advance.............................  3.48e+01    8.45e-04    1.41e-08    99.368   3.481e+01   3.481e+01
  advance rectangular grids.........  2.00e+01    4.86e-04    8.14e-09    57.217   2.004e+01   2.004e+01
  advance curvilinear grids.........  2.68e+00    6.50e-05    1.09e-09     7.645   2.678e+00   2.678e+00
    implicit solve..................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add dissipation...................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  boundary conditions...............  2.48e+00    6.01e-05    1.01e-09     7.073   2.478e+00   2.478e+00
  interpolation.....................  1.61e+00    3.91e-05    6.55e-10     4.604   1.613e+00   1.613e+00
  update ghost (parallel)...........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add forcing.......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
    user known solution.............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  time integral.....................  6.70e+00    1.63e-04    2.72e-09    19.117   6.697e+00   6.697e+00
  deflation.........................  1.90e+00    4.62e-05    7.73e-10     5.428   1.901e+00   1.901e+00
  get errors........................  1.63e-04    3.96e-09    6.62e-14     0.000   1.630e-04   1.630e-04
  plotting..........................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
output results......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
waiting (not counted)...............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
--------------------------------------------------------------------------------------------------------



setsid runCases.p knifeEdgeG32ExplicitNp1

setsid runCases.p knifeEdgeG32Np32




***************************************************
****** Thurs Dec 19, 2024

ADD function to compute grid coordinate bounds to GridStatistics
ADD RULE OF THUMB ESTIMATE


>>>>>>>>>>>>> RETURN TO THE KNIFE EDGE

setsid runCases.p knifeEdgeG32

1 slit : G32:
cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG32Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG32O4Freq80 -krylovType=gmres -go=dfka  > tipGridSmallG32O4Freq80.out

 >>>omega=  8.00e+01, k=  8.00e+01, lambda=  7.85e-02, dx=  3.13e-03, domainSize=  1.00e+00, NLambda=12.7324, ppw=lambda/dx=  25, ppw(rule-of-thumb)=  19 (epsr=0.01)<<<

agmres:
CgWaveHoltz::residual: grid=0 : maxRes= 8.16e-08
CgWaveHoltz::residual: grid=1 : maxRes= 9.33e-08
CgWaveHoltz::residual: grid=2 : maxRes= 2.25e-08
CgWaveHoltz::residual: grid=3 : maxRes= 3.23e-01
CgWaveHoltz::residual: freq= 0, omega=  80.000, max-res=3.234e-01.
solveHelmholtz: max-res=3.234e-01 (agmres, numIts=10, ave-CR= 0.08 deflate=64, ACR= 0.12)
solveHelmholtz: rel-max-diff=1.68e-09, |v|_max= 7.65e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


gmres:
CgWaveHoltz::residual: grid=0 : maxRes= 2.45e-01
CgWaveHoltz::residual: grid=1 : maxRes= 1.63e-01
CgWaveHoltz::residual: grid=2 : maxRes= 1.59e-01
CgWaveHoltz::residual: grid=3 : maxRes= 8.67e-02
CgWaveHoltz::residual: freq= 0, omega=  80.000, max-res=2.454e-01.
solveHelmholtz: max-res=2.454e-01 (gmres, numIts=8, ave-CR= 0.09 deflate=64, ACR= 0.12)
solveHelmholtz: rel-max-diff=1.69e-04, |v|_max= 7.65e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


DISK G16:
cgwh -noplot gaussian.cmd -g=sice16.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=50 -amp=2500 -beta=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=diskG16O4Freq30 -krylovType=gmres -go=dk

>>>omega=  5.00e+01, k=  5.00e+01, lambda=  1.26e-01, dx=  6.25e-03, domainSize=  2.00e+00, NLambda=15.9155, ppw=lambda/dx=  20, ppw(rule-of-thumb)=  20 (epsr=0.01)<<<


AGMRES:
Convergence rate CR=0.675, CR-perPeriod=0.821, Time to solve = 4.12e+01(s) : CgWave= 3.65e+01(s) 88.45%, advance= 3.62e+01(s) 87.83%
total time..........................  3.65e+01    2.94e-02    2.84e-07   100.000   3.648e+01   3.648e+01
CgWaveHoltz::residual: freq= 0, omega=  50.000, max-res=1.749e-07.
solveHelmholtz: max-res=1.749e-07 (agmres, numIts=60, ave-CR= 0.67 deflate=125, ACR= 0.95)
solveHelmholtz: rel-max-diff=2.37e-08, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


GMRES: 
>>>omega=  5.00e+01, k=  5.00e+01, lambda=  1.26e-01, dx=  6.25e-03, domainSize=  2.00e+00, NLambda=15.9155, ppw=lambda/dx=  20, ppw(rule-of-thumb)=  20 (epsr=0.01)<<<
Convergence rate CR=0.664, CR-perPeriod=0.815, Time to solve = 3.29e+01(s) : CgWave= 3.25e+01(s) 98.94%, advance= 3.23e+01(s) 98.24%
total time..........................  3.25e+01    3.39e-02    3.27e-07   100.000   3.251e+01   3.251e+01
solveHelmholtz: max-res=1.067e-02 (gmres, numIts=46, ave-CR= 0.66 deflate=125, ACR= 0.95)
solveHelmholtz: rel-max-diff=1.30e-04, |v|_max= 1.67e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh -noplot gaussian.cmd -g=square256.order4 -x0=.62 -y0=.73 -nf=1 -freq=60 -amp=3600 -beta=60 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square256O4Ev512 -deflateWaveHoltz=1 -numToDeflate=64 -matlab=square256O4freq40  -krylovType=bicgstab -gmresRestartLength=200 -go=a

>>>omega=  6.00e+01, k=  6.00e+01, lambda=  1.05e-01, dx=  3.91e-03, domainSize=  1.00e+00, NLambda=9.5493, ppw=lambda/dx=  27, ppw(rule-of-thumb)=  17 (epsr=0.01)<<<

cgwh -noplot gaussian.cmd -g=square128.order4 -x0=.65 -y0=.7 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square128O4Ev512 -deflateWaveHoltz=1 -numToDeflate=32 -matlab=square128O4freq40Deflate32  -krylovType=gmres -gmresRestartLength=200 -go=dk

 >>>omega=  4.00e+01, k=  4.00e+01, lambda=  1.57e-01, dx=  7.81e-03, domainSize=  1.00e+00, NLambda=6.3662, ppw=lambda/dx=  20, ppw(rule-of-thumb)=  16 (epsr=0.01)<<<


cgwh -noplot gaussian.cmd -g=sice8.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=30 -amp=900 -beta=30 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG8O4Freq30 -krylovType=gmres -go=dk

 >>>omega=  3.00e+01, k=  3.00e+01, lambda=  2.09e-01, dx=  1.25e-02, domainSize=  2.00e+00, NLambda=9.5493, ppw=lambda/dx=   17, ppw(rule-of-thumb)=   17 (epsr=0.01)<<<


cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=400 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4OGenEigsEV -krylovType=gmres -go=dk

 >>>omega=  2.00e+01, k=  2.00e+01, lambda=  3.14e-01, dx=  2.50e-02, domainSize=  2.00e+00, NLambda=6.3662, ppw=lambda/dx=   13, ppw(rule-of-thumb)=   79 (epsr=0.01)<<<



***************************************************
****** Tues Dec 17, 2024

set dwh = ~/Dropbox/DeflatedWaveHoltz

COARSE GRID EV's

runCases.p disk8c

runCases.p square256c

runCases.p square128c

gaussian2
setsid /home/henshw/Dropbox/research/cgwave/runsWaveHoltz/gaussian/runCases.p square256

***************************************************
****** Mon Dec 16, 2024

add timings for deflation

set dwh = ~/Dropbox/DeflatedWaveHoltz

runCases.p square64

DISK8 PPW=17
cgwh -noplot gaussian.cmd -g=sice8.order4 -x0=-0.25 -y0=-0.2 -nf=1 -freq=30 -amp=900 -beta=30 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG8O4Freq30 -krylovType=gmres -go=dk

DISK4
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=400 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4OGenEigsEV -krylovType=gmres -go=dk


cgwh -noplot gaussian.cmd -g=square128.order4 -x0=.65 -y0=.7 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square128O4Ev512 -deflateWaveHoltz=1 -numToDeflate=32 -matlab=square128O4freq40Deflate32  -krylovType=gmres -gmresRestartLength=200 -go=dk

cgwh -noplot gaussian.cmd -g=square64.order2 -x0=.55 -y0=.6 -nf=1 -freq=5.5 -amp=25 -beta=5.5 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk -krylovType=bicgstab -gmresRestartLength=200 -deflateForcing=0 -go=dk

NP=2: 
   time integral 13%    -- OPTIMIZE THIS 
   deflation takes 15% 

cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=256 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -deflateForcing=0 -go=dk 


total time..........................  1.09e+02    2.72e-01    1.03e-06   100.000   1.087e+02   1.087e+02
setup and initialize................  1.01e-01    2.52e-04    9.57e-10     0.093   1.008e-01   1.008e-01
initialize BCs......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
initial conditions..................  4.24e-03    1.06e-05    4.03e-11     0.004   4.243e-03   4.243e-03
advance.............................  1.07e+02    2.68e-01    1.02e-06    98.794   1.074e+02   1.074e+02
  advance rectangular grids.........  1.02e+00    2.54e-03    9.65e-09     0.935   1.016e+00   1.016e+00
  advance curvilinear grids.........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
    implicit solve..................  9.18e+01    2.30e-01    8.72e-07    84.495   9.183e+01   9.183e+01
  add dissipation...................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  boundary conditions...............  4.46e-02    1.12e-04    4.24e-10     0.041   4.462e-02   4.462e-02
  interpolation.....................  3.00e-03    7.50e-06    2.85e-11     0.003   3.001e-03   3.001e-03
  update ghost (parallel)...........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add forcing.......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
    user known solution.............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  time integral.....................  1.44e+01    3.61e-02    1.37e-07    13.294   1.445e+01   1.445e+01
  deflation.........................  1.63e+01    4.08e-02    1.55e-07    15.010   1.631e+01   1.631e+01
  get errors........................  6.94e-04    1.74e-06    6.59e-12     0.001   6.940e-04   6.940e-04
  plotting..........................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
output results......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
waiting (not counted)...............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
--------------------------------------------------------------------------------------------------------


***************************************************
****** Sun Dec 15, 2024


RETURN TO square512 and then square1024

>>> BASELINE: no deflate
cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=0 -numToDeflate=256 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -deflateForcing=0 -go=dk 


++++++++++++++++++++ DEFLATE 8 --> 22
>>> COMPARE KRYLOV

cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=8 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -deflateForcing=0 -go=dk 

Convergence rate CR=0.942, CR-perPeriod=0.971, Time to solve = 9.77e+02(s) : CgWave= 9.57e+02(s) 97.94%, advance= 9.56e+02(s) 97.87%
solveHelmholtz: max-res=1.518e-03 (gmres, numIts=391, ave-CR= 0.94 deflate=22, ACR= 1.00)
solveHelmholtz: rel-max-diff=2.80e-05, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

--------------------------

GMRES Np=4: deflate=293
 Convergence rate CR=0.109, CR-perPeriod=0.574, Time to solve = 1.08e+02(s) : CgWave= 1.07e+02(s) 99.18%, advance= 1.06e+02(s) 98.08%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 10 (gmres) (maximumNumberOfIterations=10000)


GMRES Np=2
Convergence rate CR=0.292, CR-perPeriod=0.541, Time to solve = 1.09e+02(s) : CgWave= 1.07e+02(s) 98.27%, advance= 1.05e+02(s) 97.15%

GMRES Np=1:
Convergence rate CR=0.570, CR-perPeriod=0.570, Time to solve = 1.30e+02(s) : CgWave= 1.28e+02(s) 98.91%, advance= 1.27e+02(s) 97.93%

+++ DEFLATE MORE Np=1
cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=4 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=256 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -deflateForcing=0 -go=dk 


++++ DEFLATE MORE:
cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=256 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -deflateForcing=0 -go=dk 

AGMRES:
 AugmentedKrylov:gmres: matVect= 5.47e+01(s) QR= 2.17e+02 innerProducts= 4.08e+00 localMatVects= 1.00e-02 cpuExtra= 5.05e+00 sum= 2.81e+02 total cpu =  2.86e+02(s)
 Convergence rate CR=0.294, CR-perPeriod=0.542, Time to solve = 3.39e+02(s) : CgWave= 1.06e+02(s) 31.17%, advance= 1.04e+02(s) 30.81%
 solveHelmholtz: max-res=6.302e-08 (agmres, numIts=23, ave-CR= 0.29 deflate=632, ACR= 0.22)
 solveHelmholtz: rel-max-diff=1.18e-09, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES
opt deflateSolution:
 Convergence rate CR=0.292, CR-perPeriod=0.541, Time to solve = 1.09e+02(s) : CgWave= 1.07e+02(s) 98.27%, advance= 1.05e+02(s) 97.15%
 solveHelmholtz: max-res=3.470e-02 (gmres, numIts=18, ave-CR= 0.29 deflate=632, ACR= 0.22)
solveHelmholtz: rel-max-diff=2.84e-05, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

before opt: 
Convergence rate CR=0.292, CR-perPeriod=0.541, Time to solve = 1.26e+02(s) : CgWave= 1.24e+02(s) 98.52%, advance= 1.23e+02(s) 97.55%
solveHelmholtz: max-res=3.470e-02 (gmres, numIts=18, ave-CR= 0.29 deflate=632, ACR= 0.22)
solveHelmholtz: rel-max-diff=2.84e-05, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

Fixed-Point:
Convergence rate CR=0.567, CR-perPeriod=0.753, Time to solve = 2.08e+02(s) : CgWave= 2.06e+02(s) 99.13%, advance= 2.05e+02(s) 98.53%
solveHelmholtz: max-res=3.470e-02 (FP, numIts=41, ave-CR= 0.57 deflate=632, ACR= 0.22)
solveHelmholtz: rel-max-diff=2.84e-05, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

++++++++++++++++++++ DEFLATE 128 --> 324 
>>> COMPARE KRYLOV
cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=bicgstab -gmresRestartLength=200 -deflateForcing=0 -go=dk 

cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -deflateForcing=0 -go=dk 

ABICGSTAB 
>>>> Augmented BiCGStab: cpu: QR= 5.79e+01, innerProducts= 4.02e-02, matVects=9.794e+01, sum= 1.56e+02, total= 1.64e+02
Convergence rate CR=0.578, CR-perPeriod=0.760, Time to solve = 2.16e+02(s) : CgWave= 1.48e+02(s) 68.74%, advance= 1.48e+02(s) 68.40%
solveHelmholtz: max-res=6.971e-08 (abicgstab, numIts=43, ave-CR= 0.58 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=1.18e-09, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

BICGSTAB
after opt deflateSolution
Convergence rate CR=0.590, CR-perPeriod=0.768, Time to solve = 1.70e+02(s) : CgWave= 1.70e+02(s) 99.63%, advance= 1.69e+02(s) 99.23%

before opt deflation solution:
Convergence rate CR=0.590, CR-perPeriod=0.768, Time to solve = 1.95e+02(s) : CgWave= 1.94e+02(s) 99.29%, advance= 1.93e+02(s) 98.91%
solveHelmholtz: max-res=1.831e-02 (bicgstab, numIts=44, ave-CR= 0.59 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=2.83e-05, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

AGMRES
AugmentedKrylov:gmres: matVect= 8.26e+01(s) QR= 5.57e+01 innerProducts= 3.46e+00 localMatVects= 6.04e-03 cpuExtra= 3.61e+00 sum= 1.45e+02 total cpu =  1.50e+02(s)
Convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 1.91e+02(s) : CgWave= 1.23e+02(s) 64.48%, advance= 1.23e+02(s) 64.11%
solveHelmholtz: max-res=7.062e-08 (agmres, numIts=30, ave-CR= 0.47 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=1.20e-09, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES
Convergence rate CR=0.466, CR-perPeriod=0.682, Time to solve = 1.48e+02(s) : CgWave= 1.47e+02(s) 99.02%, advance= 1.46e+02(s) 98.56%
solveHelmholtz: max-res=1.831e-02 (gmres, numIts=30, ave-CR= 0.47 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=2.83e-05, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



+++ CHECK Augmented BICGSTAB

>>> bigger test: 
cgwh -noplot gaussian.cmd -g=square256.order4 -x0=.62 -y0=.73 -nf=1 -freq=60 -amp=3600 -beta=60 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square256O4Ev512 -deflateWaveHoltz=1 -numToDeflate=64 -matlab=square256O4freq40  -krylovType=bicgstab -gmresRestartLength=200 -go=da

FIXED resid test:
>>>> Augmented BiCGStab: cpu: QR= 2.13e+00, innerProducts= 7.79e-03, matVects=1.436e+01, sum= 1.65e+01, total= 1.72e+01

solveHelmholtz: max-res=9.975e-09 (abicgstab, numIts=36, ave-CR= 0.50 deflate=134, ACR= 0.77)
solveHelmholtz: rel-max-diff=6.01e-11, |v|_max= 6.79e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

OLD:
>>>> Augmented BiCGStab: cpu: QR= 2.19e+00, innerProducts= 9.52e-03, matVects=1.782e+01, sum= 2.00e+01, total= 2.09e+01
solveHelmholtz: max-res=9.077e-09 (abicgstab, numIts=42, ave-CR= 0.51 deflate=134, ACR= 0.77)
solveHelmholtz: rel-max-diff=5.93e-11, |v|_max= 6.79e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

>>> smaller test:
cgwh -noplot gaussian.cmd -g=square64.order2 -x0=.55 -y0=.6 -nf=1 -freq=5.5 -amp=25 -beta=5.5 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk -krylovType=bicgstab -gmresRestartLength=200 -deflateForcing=1  -go=dk

solveHelmholtz: max-res=3.658e-11 (bicgstab, numIts=10, ave-CR= 0.13 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.99e-13, |v|_max= 8.74e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


***************************************************
****** Sat/Sun Dec 14/15, 2024

FIX AugmentedKrylov.bC to only store columns of V

>>> bigger test: 
cgwh -noplot gaussian.cmd -g=square256.order4 -x0=.62 -y0=.73 -nf=1 -freq=60 -amp=3600 -beta=60 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square256O4Ev512 -deflateWaveHoltz=1 -numToDeflate=64 -matlab=square256O4freq40  -krylovType=gmres -gmresRestartLength=200 -go=da

 AugmentedKrylov:gmres: matVect= 1.15e+01(s) QR= 2.09e+00 innerProducts= 2.64e-01 localMatVects= 6.75e-04 cpuExtra= 2.71e-01 sum= 1.42e+01 total cpu =  1.45e+01(s)
 cpuInit=2.663e+00, cpuIt=1.177e+01

..old: 
 AugmentedKrylov:gmres: matVect= 1.12e+01(s) QR= 2.06e+00 innerProducts= 2.63e-01 localMatVects= 1.78e-02 cpuExtra= 2.67e-01 sum= 1.38e+01 total cpu =  1.40e+01(s)
 cpuInit=2.620e+00, cpuIt=1.137e+01

>>> smaller test :
cgwh -noplot gaussian.cmd -g=square64.order2 -x0=.55 -y0=.6 -nf=1 -freq=5.5 -amp=25 -beta=5.5 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1  -go=da


START: 
 AugmentedKrylov:gmres: matVect= 1.30e-01(s) QR= 1.12e-04 innerProducts= 3.72e-04 localMatVects= 2.70e-05 cpuExtra= 1.70e-04 sum= 1.31e-01 total cpu =  1.52e-01(s)
 cpuInit=3.458e-02, cpuIt=1.174e-01

CgWaveHoltz::residual: grid=0 : maxRes= 3.52e-11
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=3.518e-11.
solveHelmholtz: max-res=3.518e-11 (agmres, numIts=9, ave-CR= 0.06 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.01e-13, |v|_max= 8.74e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



***************************************************
****** Fri Dec 13, 2024


RETURN TO AugmentedGmres CPU TIMES --- WHY DON'T TIMES ADD UP ?? --> BUG FOUND declaring V with guess for n too large!!



cgwh -noplot gaussian.cmd -g=square256.order4 -x0=.62 -y0=.73 -nf=1 -freq=60 -amp=3600 -beta=60 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square256O4Ev512 -deflateWaveHoltz=1 -numToDeflate=64 -matlab=square256O4freq40  -krylovType=gmres -gmresRestartLength=200 -go=da

SET maxit=50 from 10000 !!!!
 AugmentedKrylov:gmres: matVect= 1.12e+01(s) QR= 2.06e+00 innerProducts= 2.63e-01 localMatVects= 1.78e-02 cpuExtra= 2.67e-01 sum= 1.38e+01 total cpu =  1.40e+01(s)
 cpuInit=2.620e+00, cpuIt=1.137e+01

 AugmentedKrylov:gmres: matVect= 1.16e+01(s) QR= 2.11e+00 innerProducts= 2.64e-01 localMatVects= 1.88e-02 cpuExtra= 2.70e-01 sum= 1.43e+01 total cpu =  1.74e+01(s)
 cpuInit=5.548e+00, cpuIt=1.184e+01

AugmentedKrylov:gmres: matVect= 1.15e+01(s) QR= 2.07e+00 innerProducts= 2.64e-01 localMatVects= 1.87e-02 cpuExtra= 2.67e-01 sum= 1.41e+01 total cpu =  1.72e+01(s)

AugmentedKrylov:gmres: matVect= 1.14e+01(s) QR= 2.08e+00, innerProducts= 2.64e-01, localMatVects= 1.87e-02, cpuExtra= 2.39e-01, total cpu =  1.72e+01(s)

AugmentedKrylov:gmres: matVect= 1.08e+01(s) innerProducts= 2.63e-01, localMatVects= 1.71e-02, cpuExtra= 1.64e-01, total cpu =  1.65e+01(s)

AugmentedKrylov:gmres: matVect= 1.14e+01(s) innerProducts= 2.64e-01, localMatVects= 1.82e-02, total cpu =  1.71e+01(s)
AugmentedKrylov:gmres: matVect= 1.14e+01(s) innerProducts and norms= 2.64e-01, total cpu =  1.71e+01(s)
AugmentedKrylov:gmres: matVect= 1.14e+01(s) innerProducts and norms= 2.63e-01, total cpu =  1.72e+01(s)
AugmentedKrylov:gmres: matVect= 1.15e+01(s) innerProducts and norms= 2.63e-01, total cpu =  1.73e+01(s)

START: 
AugmentedKrylov:gmres: matVect= 1.16e+01(s) innerProducts and norms= 2.70e-01, total cpu =  1.76e+01(s)
Convergence rate CR=0.406, CR-perPeriod=0.637, Time to solve = 2.25e+01(s) : CgWave= 1.62e+01(s) 72.06%, advance= 1.61e+01(s) 71.44%

CgWaveHoltz::residual: freq= 0, omega=  60.000, max-res=1.122e-08.
solveHelmholtz: max-res=1.122e-08 (agmres, numIts=26, ave-CR= 0.41 deflate=134, ACR= 0.77)
solveHelmholtz: rel-max-diff=5.96e-11, |v|_max= 6.79e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


OLD: 
agmres + deflate:
@@@@@@@@@@@  DEFLATION SETUP: cpu =  1.18e-01(s) @@@@@@@@@@@@@

More opts:
AugmentedKrylov:gmres: matVect= 1.13e+01(s) innerProducts and norms= 2.63e-01, total cpu =  1.71e+01(s)



***************************************************
****** Mon Dec 2, 2024


RETURN TO square512 and then square1024

>>> gmres deflate forcing ORDER 2
cgwh -noplot gaussian.cmd -g=square512.order2 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O2Ev1024 -deflateWaveHoltz=1 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -go=dk 


>>> gmres deflateForcing **trouble**
cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -go=dk 

SLOWED DOWN 
##### SAVE KRYLOV RESIDUAL: iteration=30: L2h-residual= 3.82e-09

>>>> gmres deflate
cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -go=dk 

Convergence rate CR=0.466, CR-perPeriod=0.682, Time to solve = 1.49e+02(s) : CgWave= 1.47e+02(s) 99.02%, advance= 1.47e+02(s) 98.56%

CgWaveHoltz::residual: freq= 0, omega= 100.000, max-res=1.831e-02.
solveHelmholtz: max-res=1.831e-02 (gmres, numIts=30, ave-CR= 0.47 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=2.83e-05, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>> agmres: 
cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -go=da 

now: 
AugmentedKrylov:gmres: matVect= 7.02e+01(s) innerProducts and norms= 2.78e+00, total cpu =  1.39e+02(s)
solveAugmentedKrylov: cpuTotal= 1.90e+02(s)
Convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 1.90e+02(s) : CgWave= 1.20e+02(s) 63.34%, advance= 1.19e+02(s) 62.98%

CgWaveHoltz::residual: grid=0 : maxRes= 7.06e-08
CgWaveHoltz::residual: freq= 0, omega= 100.000, max-res=7.062e-08.
solveHelmholtz: max-res=7.062e-08 (agmres, numIts=30, ave-CR= 0.47 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=1.20e-09, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

--- before: 

*** Nov 28 : more optimizations:
AugmentedKrylov:gmres: matVect= 6.50e+01(s) total cpu =  1.28e+02(s)
solveAugmentedKrylov: cpuTotal= 1.78e+02(s)

convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 1.78e+02(s) : CgWave= 1.14e+02(s) 64.02%, advance= 1.14e+02(s) 63.64%
solveHelmholtz: max-res=7.062e-08 (agmres, numIts=30, ave-CR= 0.47 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=1.20e-09, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



***************************************************
****** Sat Nov 30, 2024

>>>>>>>>>> DISK:
sice4O4EigsEv256.show
cgwh -noplot gaussian.cmd -g=sice4.order4 -x0=.3 -y0=.35 -nf=1 -freq=17 -amp=40 -beta=17 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/sice4O4EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=0 -go=dk


DEFLATE FORCING ** TROUBLE ***
solveHelmholtz: max-res=2.965e-03 (gmres, numIts=364, ave-CR= 0.94 deflate=58, ACR= 0.71)
solveHelmholtz: rel-max-diff=7.51e-05, |v|_max= 7.81e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

cgwh -noplot gaussian.cmd -g=sice4.order4 -x0=.3 -y0=.35 -nf=1 -freq=17 -amp=40 -beta=17 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/sice4O4EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=0 -go=dk

gmres NEW WAY (BUG FIXED -- APPLY BCS)
CgWaveHoltz::residual: grid=0 : maxRes= 5.82e-03
CgWaveHoltz::residual: grid=1 : maxRes= 1.76e-03
CgWaveHoltz::residual: freq= 0, omega=  17.000, max-res=5.822e-03.
solveHelmholtz: max-res=5.822e-03 (gmres, numIts=28, ave-CR= 0.47 deflate=58, ACR= 0.71)
solveHelmholtz: rel-max-diff=1.10e-03, |v|_max= 7.80e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

gmres : OLD FINAL SOLVE 
CgWaveHoltz::residual: grid=0 : maxRes= 5.82e-03
CgWaveHoltz::residual: grid=1 : maxRes= 1.76e-03
CgWaveHoltz::residual: freq= 0, omega=  17.000, max-res=5.822e-03.
solveHelmholtz: max-res=5.822e-03 (gmres, numIts=29, ave-CR= 0.46 deflate=58, ACR= 0.71)
solveHelmholtz: rel-max-diff=1.10e-03, |v|_max= 7.80e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

CgWaveHoltz::residual: grid=0 : maxRes= 1.76e-04
CgWaveHoltz::residual: grid=1 : maxRes= 1.03e-05
CgWaveHoltz::residual: freq= 0, omega=  17.000, max-res=1.763e-04.
solveHelmholtz: max-res=1.763e-04 (agmres, numIts=22, ave-CR= 0.38 deflate=58, ACR= 0.71)
solveHelmholtz: rel-max-diff=7.93e-06, |v|_max= 7.81e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



START TEST USING COARSE GRID INITIAL GUESS: SOMETHING FUNNY WHEN SOLVING MULTIPLE TIMES WITH DEFLATE FORCING

FINER
square64O2EigsEv64.show
cgwh -noplot gaussian.cmd -g=square64.order2 -x0=.55 -y0=.6 -nf=1 -freq=5.5 -amp=25 -beta=5.5 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -icShow=square32O2Freq5p5.show -go=dk

FPI + coarse grid IC
CgWaveHoltz::residual: grid=0 : maxRes= 1.73e-11
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=1.733e-11.
solveHelmholtz: max-res=1.733e-11 (FP, numIts=14, ave-CR= 0.13 deflate=3, ACR= 0.20)


FPI
solveHelmholtz: max-res=1.743e-11 (FP, numIts=17, ave-CR= 0.22 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=7.99e-14, |v|_max= 8.74e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


bicgstab:
solveHelmholtz: max-res=3.658e-11 (bicgstab, numIts=10, ave-CR= 0.13 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.99e-13, |v|_max= 8.74e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

>>> NO DEFLATE FORCING FIRST
cgwh -noplot gaussian.cmd -g=square64.order2 -x0=.55 -y0=.6 -nf=1 -freq=5.5 -amp=25 -beta=5.5 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=0 -icShow=square32O2Freq5p5.show -go=dk

gmres + CIC  7 iterations
CgWaveHoltz::residual: grid=0 : maxRes= 7.36e-09
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=7.359e-09.
solveHelmholtz: max-res=7.359e-09 (gmres, numIts=7, ave-CR= 0.03 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.82e-12, |v|_max= 8.74e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

gmres + CIC 9 iterations
CgWaveHoltz::residual: grid=0 : maxRes= 3.93e-11
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=3.929e-11.
solveHelmholtz: max-res=3.929e-11 (gmres, numIts=9, ave-CR= 0.07 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.05e-13, |v|_max= 8.74e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


COARSE:
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=.55 -y0=.6 -nf=1 -freq=5.5 -amp=25 -beta=5.5 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -show=square32O2Freq5p5.show -go=dks

solveHelmholtz: max-res=2.748e-11 (gmres, numIts=9, ave-CR= 0.07 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.47e-13, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



CONTINUE TEST DEFLATE FORCING

DEFLATE INITIAL CONDITION TOO



cgwh -noplot gaussian.cmd -g=square32.order2 -x0=.55 -y0=.6 -nf=1 -freq=5.5 -amp=25 -beta=5.5 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk  -krylovType=bicgstab -gmresRestartLength=200 -deflateForcing=1 -go=dk

cg 
CgWaveHoltz::residual: grid=0 : maxRes= 2.42e-08
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=2.418e-08.
solveHelmholtz: max-res=2.418e-08 (cg, numIts=7, ave-CR= 0.08 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.05e-10, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

abicgstab -- agmres: more its but more accurate
CgWaveHoltz::residual: grid=0 : maxRes= 5.99e-10
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=5.989e-10.
solveHelmholtz: max-res=5.989e-10 (abicgstab, numIts=10, ave-CR= 0.08 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=3.07e-12, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



bicgstab
CgWaveHoltz::residual: grid=0 : maxRes= 3.08e-08
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=3.077e-08.
solveHelmholtz: max-res=3.077e-08 (bicgstab, numIts=8, ave-CR= 0.16 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=2.66e-10, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh -noplot gaussian.cmd -g=square32.order2 -x0=.55 -y0=.6 -nf=1 -freq=5.5 -amp=25 -beta=5.5 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -go=da

agmres: 
CgWaveHoltz::residual: grid=0 : maxRes= 2.41e-08
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=2.408e-08.
solveHelmholtz: max-res=2.408e-08 (agmres, numIts=7, ave-CR= 0.07 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.06e-10, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



gmres: skip extra step: 
CgWaveHoltz::residual: grid=0 : maxRes= 2.41e-08
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=2.408e-08.
solveHelmholtz: max-res=2.408e-08 (gmres, numIts=7, ave-CR= 0.08 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.06e-10, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


gmres
CgWaveHoltz::residual: grid=0 : maxRes= 1.77e-09
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=1.771e-09.
solveHelmholtz: max-res=1.771e-09 (gmres, numIts=8, ave-CR= 0.07 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=8.03e-12, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


CgWaveHoltz::residual: grid=0 : maxRes= 2.41e-08
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=2.408e-08.
solveHelmholtz: max-res=2.408e-08 (agmres, numIts=7, ave-CR= 0.08 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=6.72e+00, |v|_max= 1.34e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

***************************************************
****** Fri Nov 29, 2024

START TEST DEFLATE FORCING

**BUGS FIXED** 

COMPARE TO waveHoltz.m 

cgwh -noplot gaussian.cmd -g=square32.order2 -x0=.55 -y0=.6 -nf=1 -freq=5.5 -amp=25 -beta=5.5 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=2 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -go=og

DEFLATE INITIAL CONDITION TOO


--- DEFLATE FORCING: works with zero initial conditions

GMRES
CgWaveHoltz::residual: grid=0 : maxRes= 1.77e-09
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=1.771e-09.
solveHelmholtz: max-res=1.771e-09 (gmres, numIts=8, ave-CR= 0.07 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=8.03e-12, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

FPI
CgWaveHoltz::residual: grid=0 : maxRes= 1.03e-09
CgWaveHoltz::residual: freq= 0, omega=   5.500, max-res=1.034e-09.
solveHelmholtz: max-res=1.034e-09 (FP, numIts=14, ave-CR= 0.22 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.75e-11, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


---- DEFLATE:
-C++ : norms may differ but CR is about right
solveHelmholtz: max-res=1.033e-09 (FP, numIts=14, ave-CR= 0.22 deflate=3, ACR= 0.20)
solveHelmholtz: rel-max-diff=1.75e-11, |v|_max= 8.72e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

res=[ ...
 4.4491393731e-02  8.4112996351e-03  1.6544114062e-03  3.2771129976e-04  6.5059811764e-05  1.2930817583e-05  2.5719458139e-06  5.1184272998e-07  1.0190536225e-07  2.0295728251e-08 ...
 4.0432392037e-09  8.0565249022e-10  1.6056124171e-10  3.2003189563e-11 ];

---- MATLAB: 
** deflateSolution: DEFLATE FORCING ***
 fix-point it=  1, freq=1: || vkp1 - vk ||_2h = 4.16e-02 (Nx=32)
 fix-point it=  2, freq=1: || vkp1 - vk ||_2h = 4.65e-03 (Nx=32) rate=0.1119
 fix-point it=  3, freq=1: || vkp1 - vk ||_2h = 7.57e-04 (Nx=32) rate=0.1629
 fix-point it=  4, freq=1: || vkp1 - vk ||_2h = 1.44e-04 (Nx=32) rate=0.1906
 fix-point it=  5, freq=1: || vkp1 - vk ||_2h = 2.86e-05 (Nx=32) rate=0.1977
 fix-point it=  6, freq=1: || vkp1 - vk ||_2h = 5.70e-06 (Nx=32) rate=0.1996
 fix-point it=  7, freq=1: || vkp1 - vk ||_2h = 1.14e-06 (Nx=32) rate=0.2004
 fix-point it=  8, freq=1: || vkp1 - vk ||_2h = 2.29e-07 (Nx=32) rate=0.2008
 fix-point it=  9, freq=1: || vkp1 - vk ||_2h = 4.61e-08 (Nx=32) rate=0.2011
 fix-point it= 10, freq=1: || vkp1 - vk ||_2h = 9.29e-09 (Nx=32) rate=0.2013



EASIER CASE:

cgwh -noplot gaussian.cmd -g=square32.order2 -x0=.65 -y0=.7 -nf=1 -freq=20 -amp=50 -beta=20 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=12 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -go=dk

deflate forcing
solveHelmholtz: max-res=5.473e+00 (gmres, numIts=32, ave-CR= 0.54 deflate=22, ACR= 0.23)
solveHelmholtz: rel-max-diff=1.14e+01, |v|_max= 6.67e-02 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

no-deflate-forcing
solveHelmholtz: max-res=2.256e-09 (gmres, numIts=10, ave-CR= 0.13 deflate=22, ACR= 0.23)
solveHelmholtz: rel-max-diff=7.02e-12, |v|_max= 7.06e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh -noplot gaussian.cmd -g=square32.order2 -x0=.65 -y0=.7 -nf=1 -freq=7 -amp=2 -beta=7 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=20 -numPeriods=2 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -go=dk

deflateForcing : explicit
solveHelmholtz: max-res=6.533e-04 (gmres, numIts=10, ave-CR= 0.20 deflate=13, ACR= 0.05)
solveHelmholtz: rel-max-diff=1.27e-03, |v|_max= 2.17e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh -noplot gaussian.cmd -g=square32.order2 -x0=.65 -y0=.7 -nf=1 -freq=7 -amp=2 -beta=7 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=20 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=junk  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -go=dk

deflate forcing 
solveHelmholtz: max-res=1.531e-03 (gmres, numIts=12, ave-CR= 0.24 deflate=13, ACR= 0.09)
solveHelmholtz: rel-max-diff=3.12e-03, |v|_max= 2.18e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


solveHelmholtz: max-res=5.821e-10 (gmres, numIts=9, ave-CR= 0.06 deflate=13, ACR= 0.09)
solveHelmholtz: rel-max-diff=1.24e-12, |v|_max= 6.82e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh -noplot gaussian.cmd -g=square128.order4 -x0=.65 -y0=.7 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=20 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square128O4Ev512 -deflateWaveHoltz=1 -numToDeflate=32 -matlab=square128O4freq40  -krylovType=gmres -gmresRestartLength=200 -deflateForcing=1 -go=dk


cgwh -noplot gaussian.cmd -g=square128.order4 -x0=.65 -y0=.7 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square128O4Ev512 -deflateWaveHoltz=1 -numToDeflate=32 -matlab=square128O4freq40  -krylovType=gmres -gmresRestartLength=200 -go=da


---- DEFLATE SOLUTION

ABICGSTAB: 
CgWaveHoltz::residual: grid=0 : maxRes= 1.27e-09
CgWaveHoltz::residual: freq= 0, omega=  40.000, max-res=1.266e-09.
solveHelmholtz: max-res=1.266e-09 (abicgstab, numIts=35, ave-CR= 0.45 deflate=61, ACR= 0.74)
solveHelmholtz: rel-max-diff=6.16e-12, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

agmres
solveHelmholtz: max-res=2.455e-09 (agmres, numIts=24, ave-CR= 0.37 deflate=61, ACR= 0.74)
solveHelmholtz: rel-max-diff=3.24e-11, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

gmres
solveHelmholtz: max-res=4.290e-02 (gmres, numIts=25, ave-CR= 0.37 deflate=61, ACR= 0.74)
solveHelmholtz: rel-max-diff=3.00e-04, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

***************************************************
****** Thurs Nov 28, 2024


CHECK TIME FOR SETUP DEFLATION WITH AUGMENTED ROUTINES 

>>>> COMPARE AGMRES TO GMRES - no deflation : aboyt the same time
cgwh -noplot gaussian.cmd -g=square256.order4 -x0=.62 -y0=.73 -nf=1 -freq=60 -amp=3600 -beta=60 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square256O4Ev512 -deflateWaveHoltz=0 -numToDeflate=64 -matlab=square256O4freq40  -krylovType=gmres -gmresRestartLength=200 -go=dk


Convergence rate CR=0.697, CR-perPeriod=0.835, Time to solve = 8.99e+00(s) : CgWave= 8.95e+00(s) 99.65%, advance= 8.95e+00(s) 99.57%
 max-residual=0.00e+00 (WaveHoltz its), numberOfIterations = 10 (Augmented-GMRES) (maximumNumberOfIterations=10)

Convergence rate CR=0.708, CR-perPeriod=0.842, Time to solve = 9.11e+00(s) : CgWave= 9.07e+00(s) 99.52%, advance= 9.06e+00(s) 99.43%
 max-residual=2.05e-03 (WaveHoltz its), numberOfIterations = 11 (gmres) (maximumNumberOfIterations=10)
\<<<<<


cgwh -noplot gaussian.cmd -g=square256.order4 -x0=.62 -y0=.73 -nf=1 -freq=60 -amp=3600 -beta=60 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square256O4Ev512 -deflateWaveHoltz=1 -numToDeflate=64 -matlab=square256O4freq40  -krylovType=gmres -gmresRestartLength=200 -go=da

agmres + deflate:
@@@@@@@@@@@  DEFLATION SETUP: cpu =  1.18e-01(s) @@@@@@@@@@@@@

More opts:
AugmentedKrylov:gmres: matVect= 1.13e+01(s) innerProducts and norms= 2.63e-01, total cpu =  1.71e+01(s)

AugmentedKrylov:gmres: matVect= 1.08e+01(s) total cpu =  1.63e+01(s)   use LAPACK ddot 
AugmentedKrylov:gmres: matVect= 1.13e+01(s) total cpu =  1.70e+01(s)    use LAPACK ddot 

AugmentedKrylov:gmres: matVect= 1.15e+01(s) total cpu =  1.72e+01(s)
AugmentedKrylov:gmres: matVect= 1.08e+01(s) total cpu =  1.64e+01(s)
AugmentedKrylov:gmres: matVect= 1.13e+01(s) total cpu =  1.71e+01(s)
solveAugmentedKrylov: cpuTotal= 2.18e+01(s)
solveHelmholtz: max-res=1.122e-08 (agmres, numIts=26, ave-CR= 0.41 deflate=134, ACR= 0.77)
solveHelmholtz: rel-max-diff=5.96e-11, |v|_max= 6.79e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



++ NOTE: 
AugmentedKrylov:gmres: matVect= 1.14e+01(s) total cpu =  1.79e+01(s) with one opt
AugmentedKrylov:gmres: matVect= 1.16e+01(s) total cpu =  1.96e+01(s) 





solveAugmentedKrylov: cpuTotal= 2.44e+01(s)
Convergence rate CR=0.406, CR-perPeriod=0.637, Time to solve = 2.26e+01(s) : CgWave= 1.58e+01(s) 69.96%, advance= 1.57e+01(s) 69.35%
Convergence rate CR=0.406, CR-perPeriod=0.637, Time to solve = 2.44e+01(s) : CgWave= 1.60e+01(s) 65.64%, advance= 1.59e+01(s) 65.06%
Convergence rate CR=0.406, CR-perPeriod=0.637, Time to solve = 2.36e+01(s) : CgWave= 1.54e+01(s) 65.23%, advance= 1.53e+01(s) 64.65%
 max-residual=0.00e+00 (WaveHoltz its), numberOfIterations = 26 (Augmented-GMRES) (maximumNumberOfIterations=10000)


solveHelmholtz: max-res=1.057e-08 (agmres, numIts=26, ave-CR= 0.41 deflate=134, ACR= 0.77)
solveHelmholtz: rel-max-diff=6.06e-11, |v|_max= 6.79e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

gmres + deflate
Convergence rate CR=0.404, CR-perPeriod=0.636, Time to solve = 1.82e+01(s) : CgWave= 1.80e+01(s) 98.81%, advance= 1.80e+01(s) 98.69%
 max-residual=2.08e-12 (WaveHoltz its), numberOfIterations = 27 (gmres) (maximumNumberOfIterations=10000)
solveHelmholtz: max-res=2.310e-02 (gmres, numIts=27, ave-CR= 0.40 deflate=134, ACR= 0.77)
solveHelmholtz: rel-max-diff=8.48e-05, |v|_max= 6.79e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


***************************************************
****** Mon Nov 25, 2024

++++ square512: TEST CG no deflation
setsid $cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=0 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=cg -gmresRestartLength=200 -go=dk > square512O4freq100CG.out


++++ square512: TEST BICGSTAB no deflation
setsid $cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=0 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=bicgstab -gmresRestartLength=200 -go=dk > square512O4freq100BICGSTAB.out

cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -go=da 

*** Nov 28 : more optimizations:
AugmentedKrylov:gmres: matVect= 6.50e+01(s) total cpu =  1.28e+02(s)
solveAugmentedKrylov: cpuTotal= 1.78e+02(s)
convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 1.78e+02(s) : CgWave= 1.14e+02(s) 64.02%, advance= 1.14e+02(s) 63.64%
solveHelmholtz: max-res=7.062e-08 (agmres, numIts=30, ave-CR= 0.47 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=1.20e-09, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


useOpt=1: compile solveAugmentedKrylov.C optimized

AugmentedKrylov:gmres: total cpu =  1.60e+02(s)
solveAugmentedKrylov: cpuTotal= 2.12e+02(s)
Convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 2.12e+02(s) : CgWave= 1.21e+02(s) 57.17%, advance= 1.21e+02(s) 56.84%

useOpt=1: more opts:
AugmentedKrylov:gmres: total cpu =  1.61e+02(s)
Convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 2.15e+02(s) : CgWave= 1.20e+02(s) 55.85%, advance= 1.19e+02(s) 55.54%

useOpt=1: 
 Convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 2.07e+02(s) : CgWave= 1.15e+02(s) 55.54%, advance= 1.15e+02(s) 55.23%
useOpt=0: 
 Convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 2.44e+02(s) : CgWave= 1.21e+02(s) 49.36%, advance= 1.20e+02(s) 49.07%
start:
Convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 2.60e+02(s) : CgWave= 1.22e+02(s) 46.74%, advance= 1.21e+02(s) 46.47%

CgWaveHoltz::residual: freq= 0, omega= 100.000, max-res=7.152e-08.
solveHelmholtz: max-res=7.152e-08 (agmres, numIts=30, ave-CR= 0.47 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=1.20e-09, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


***************************************************
****** Sat/Sun Nov 23/24, 2024

START TEST AUGMENTED BICGSTAB:


>>>>>>>> SQUARE - higher freq

++++++++++++ square256

***CHECK TIMINGS: ARE augmented routines slow ?? ***

++++ square512:
setsid $cgwh -noplot gaussian.cmd -g=square512.order4 -x0=.62 -y0=.73 -nf=1 -freq=100 -amp=10000 -beta=100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square512O4Ev1024 -deflateWaveHoltz=1 -numToDeflate=128 -matlab=square512O4freq100 -krylovType=gmres -gmresRestartLength=200 -go=da > square512O4freq100.out

agmres
Convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 2.60e+02(s) : CgWave= 1.22e+02(s) 46.74%, advance= 1.21e+02(s) 46.47%

solveHelmholtz: max-res=7.152e-08 (agmres, numIts=30, ave-CR= 0.47 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=1.20e-09, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


gmres deflate
Convergence rate CR=0.465, CR-perPeriod=0.682, Time to solve = 1.47e+02(s) : CgWave= 1.45e+02(s) 99.01%, advance= 1.45e+02(s) 98.97%
solveHelmholtz: max-res=1.831e-02 (gmres, numIts=31, ave-CR= 0.46 deflate=324, ACR= 0.81)
solveHelmholtz: rel-max-diff=2.83e-05, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

gmres no-deflate 
 Convergence rate CR=0.965, CR-perPeriod=0.982, Time to solve = 3.12e+03(s) : CgWave= 1.65e+03(s) 52.81%, advance= 1.65e+03(s) 52.78%

solveHelmholtz: max-res=6.427e-07 (agmres, numIts=661, ave-CR= 0.97 , ACR=-1.00)
solveHelmholtz: rel-max-diff=8.01e-08, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




cgwh -noplot gaussian.cmd -g=square256.order4 -x0=.62 -y0=.73 -nf=1 -freq=60 -amp=3600 -beta=60 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square256O4Ev512 -deflateWaveHoltz=0 -numToDeflate=64 -matlab=square256O4freq40  -krylovType=bicgstab -gmresRestartLength=200 -go=dk

ABICGS
Convergence rate CR=0.514, CR-perPeriod=0.717, Time to solve = 3.83e+01(s) : CgWave= 2.12e+01(s) 55.52%, advance= 2.11e+01(s) 55.11%
solveHelmholtz: max-res=9.077e-09 (abicgstab, numIts=42, ave-CR= 0.51 deflate=134, ACR= 0.77)
solveHelmholtz: rel-max-diff=5.93e-11, |v|_max= 6.79e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


AGMRES:
Convergence rate CR=0.406, CR-perPeriod=0.637, Time to solve = 2.82e+01(s) : CgWave= 1.52e+01(s) 54.09%, advance= 1.51e+01(s) 53.59%

solveHelmholtz: max-res=1.057e-08 (agmres, numIts=26, ave-CR= 0.41 deflate=134, ACR= 0.77)
solveHelmholtz: rel-max-diff=6.06e-11, |v|_max= 6.79e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


GMRES: restart=200
 Convergence rate CR=0.984, CR-perPeriod=0.992, Time to solve = 6.11e+02(s) : CgWave= 6.07e+02(s) 99.30%, advance= 6.06e+02(s) 99.14%
solveHelmholtz: max-res=2.347e-06 (bicgstab, numIts=1519, ave-CR= 0.98 , ACR=-1.00)
solveHelmholtz: rel-max-diff=1.48e-07, |v|_max= 6.79e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


CG:
solveHelmholtz: max-res=8.827e-07 (cg, numIts=1198, ave-CR= 0.98 , ACR=-1.00)
solveHelmholtz: rel-max-diff=8.10e-08, |v|_max= 3.48e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



++++++++++++ square128

omega=40: PPW=20

cgwh -noplot gaussian.cmd -g=square128.order4 -x0=.65 -y0=.7 -nf=1 -freq=40 -amp=1600 -beta=40 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig2/square128O4Ev512 -deflateWaveHoltz=1 -numToDeflate=32 -matlab=square128O4freq40  -krylovType=bicgstab -gmresRestartLength=200 -go=da


---- DEFLATE

solveHelmholtz: max-res=1.266e-09 (abicgstab, numIts=35, ave-CR= 0.45 deflate=61, ACR= 0.74)
solveHelmholtz: rel-max-diff=6.16e-12, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


solveHelmholtz: max-res=2.456e-09 (agmres, numIts=24, ave-CR= 0.37 deflate=61, ACR= 0.74)
solveHelmholtz: rel-max-diff=3.39e-11, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

------ NO DEFLATE: 
bicgstab
solveHelmholtz: max-res=3.631e-07 (bicgstab, numIts=289, ave-CR= 0.92 , ACR=-1.00)
solveHelmholtz: rel-max-diff=7.81e-08, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

cg:
solveHelmholtz: max-res=7.492e-08 (cg, numIts=300, ave-CR= 0.92 , ACR=-1.00)
solveHelmholtz: rel-max-diff=1.53e-08, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

gmres:
solveHelmholtz: max-res=1.749e-08 (gmres, numIts=117, ave-CR= 0.81 , ACR=-1.00)
solveHelmholtz: rel-max-diff=3.68e-09, |v|_max= 4.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>> DISK NO DEFLATE:

diskG4OFreq20gmres.m

cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG4O2Ev128.show -deflateWaveHoltz=0 -numToDeflate=32 -matlab=diskG4OFreq20 -krylovType=gmres -gmresRestartLength=60 -go=dk

bicgstab:
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=7.367e-09.
solveHelmholtz: max-res=7.367e-09 (bicgstab, numIts=303, ave-CR= 0.92 , ACR=-1.00)
solveHelmholtz: rel-max-diff=1.97e-09, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

gmres: 
solveHelmholtz: max-res=1.656e-09 (gmres, numIts=121, ave-CR= 0.82 , ACR=-1.00)
solveHelmholtz: rel-max-diff=1.13e-10, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

gmres restart=60
solveHelmholtz: max-res=1.470e-08 (gmres, numIts=171, ave-CR= 0.87 , ACR=-1.00)
solveHelmholtz: rel-max-diff=3.75e-09, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


gmres: restart=20
solveHelmholtz: max-res=1.331e-08 (gmres, numIts=344, ave-CR= 0.93 , ACR=-1.00)
solveHelmholtz: rel-max-diff=3.18e-09, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>>>> DISK DEFLATE:

cp diskG4OGenEigsEV{FP,gmres,agmres,bicgstab,abicgstab}.m $overHoltz/codes

cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4OGenEigsEV -krylovType=bicgstab -go=da

ABCGS:
solveHelmholtz: max-res=1.945e-03 (abicgstab, numIts=27, ave-CR= 0.35 deflate=62, ACR= 0.59)
solveHelmholtz: rel-max-diff=4.88e-05, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

BICGSTAB: diskG4OGenEigsEVbicgstab.m
solveHelmholtz: max-res=6.630e-02 (bicgstab, numIts=25, ave-CR= 0.35 deflate=62, ACR= 0.59)
solveHelmholtz: rel-max-diff=4.73e-03, |v|_max= 6.34e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4OGenEigsEV -krylovType=gmres -go=da

AGMRES: why no exact match?
solveHelmholtz: max-res=1.945e-03 (agmres, numIts=18, ave-CR= 0.27 deflate=62, ACR= 0.59)
solveHelmholtz: rel-max-diff=4.88e-05, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


GMRES: diskG4OGenEigsEVgmres.m
solveHelmholtz: max-res=6.630e-02 (gmres, numIts=19, ave-CR= 0.27 deflate=62, ACR= 0.59)
solveHelmholtz: rel-max-diff=4.73e-03, |v|_max= 6.34e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



ORDER=4: WORKS!
cgwh -noplot gaussian.cmd -g=square32.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=20 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -krylovType=bicgstab -go=da

ABICGSTAB:
CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=2.898e-12.
solveHelmholtz: max-res=2.898e-12 (abicgstab, numIts=11, ave-CR= 0.05 deflate=14, ACR= 0.13)
solveHelmholtz: rel-max-diff=1.56e-13, |v|_max= 4.15e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

AGMRES
solveHelmholtz: max-res=9.397e-12 (Agmres, numIts=8, ave-CR= 0.04 deflate=14, ACR= 0.13)
solveHelmholtz: rel-max-diff=1.42e-13, |v|_max= 4.15e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>>>>>>>>>.
ORDER2: WORKS!
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=20 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -krylovType=bicgstab -go=da

ABICGSTAB:
solveHelmholtz: max-res=1.862e-12 (Abicgstab, numIts=14, ave-CR= 0.10 deflate=3, ACR= 0.21)
solveHelmholtz: rel-max-diff=3.48e-14, |v|_max= 4.14e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

AGMRES
solveHelmholtz: max-res=6.427e-12 (Augmented-GMRES, numIts=10, ave-CR= 0.07 deflate=3, ACR= 0.21)
solveHelmholtz: rel-max-diff=5.41e-14, |v|_max= 4.14e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
<<<<<<<<<<<<<


ORDER=4: RETURN HERE 
cgwh -noplot gaussian.cmd -g=square32.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -krylovType=bicgstab -go=da



BICGSTAB
cgwh -noplot gaussian.cmd -g=square32.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -krylovType=bicgstab -go=dk

CgWaveHoltz::residual: grid=0 : maxRes= 4.63e-03
CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=4.632e-03.
solveHelmholtz: max-res=4.632e-03 (bicgstab, numIts=11, ave-CR= 0.06 deflate=14, ACR= 0.13)
solveHelmholtz: rel-max-diff=2.64e-04, |v|_max= 4.15e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


***************************************************
****** Wed Nov 20, 2024

RETURN TO AGMRES ---> START WORK ON AUGMENTED BI-CG-STAB --> first rename AugmentedGmres class to AugmentedKrylov

BICGSTAB
cgwh -noplot gaussian.cmd -g=square32.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -krylovType=bicgstab -go=dk

solveHelmholtz: max-res=4.632e-03 (bicgstab, numIts=11, ave-CR= 0.06 deflate=14, ACR= 0.13)
solveHelmholtz: rel-max-diff=2.64e-04, |v|_max= 4.15e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


AGMRES
cgwh -noplot gaussian.cmd -g=square32.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -go=da

solveHelmholtz: max-res=9.397e-12 (Augmented-GMRES, numIts=8, ave-CR= 0.04 deflate=14, ACR= 0.13)
solveHelmholtz: rel-max-diff=1.42e-13, |v|_max= 4.15e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


***************************************************
****** Sun Nov 17, 2024

CLEAN UP MATLAB CODE WaveHoltz and compare to cgWave

cgwh -noplot gaussian.cmd -g=square64.order2 -x0=.55 -y0=.6 -nf=1 -freq=7.7 -amp=-100 -beta=7.7 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=4 -minStepsPerPeriod=10 -cfl=10000 -solveri=yale -krylovType=gmres -go=df

solveHelmholtz: max-res=1.676e-09 (FP, numIts=33, CR= 0.51 )


***************************************************
****** Fri Nov 15, 2024



>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
TEST -- USE ACTIVE POINTS IN solvePETSc

CAN WE PRECONDITION FGMRES WITH CG ??? 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000  -matlab=diskG4NO -go=dk -krylovType=fgmres -pc_type ksp -ksp_ksp_type cg -ksp_rtol 1e-5


SIX-TEEN KNIVES : BCGS works almost as well as GMRES
cgwh -noplot gaussian.cmd -g=sixteenKnivesGride32.order4 -ts=implicit -cfl=10000 -x0=0.125 -y0=0.3 -nf=1 -amp=-2000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=20 -matlab=junk -show=junk -go=dk  -krylovType=bicgstab

solveHelmholtz: max-res=3.555e-08 (bicgstab, numIts=19, CR= 0.31 )
solveHelmholtz: rel-max-diff=2.20e-08, |v|_max= 1.80e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
advance.............................  8.79e+00    2.09e-02    1.99e-07    99.103   8.793e+00   8.793e+00


solveHelmholtz: max-res=2.542e-07 (gmres, numIts=13, CR= 0.23 )
solveHelmholtz: rel-max-diff=2.52e-09, |v|_max= 1.80e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
advance.............................  6.60e+00    2.20e-02    2.10e-07    99.118   6.600e+00   6.600e+00



TWELVE KNIVES : BCGS WORKS almost as well as GMRES !!
cgwh -noplot gaussian.cmd -g=twelveKnivesGride16.order2 -ts=implicit -cfl=10000 -x0=0.125 -y0=0.3 -nf=1 -amp=-2000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=20 -matlab=junk -show=junk -go=dk  -krylovType=bicgstab


solveHelmholtz: max-res=1.599e-08 (bicgstab, numIts=19, CR= 0.30 )


solveHelmholtz: max-res=1.101e-07 (gmres, numIts=13, CR= 0.22 )
solveHelmholtz: rel-max-diff=3.67e-09, |v|_max= 1.77e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





DISK NO DEFLATE: BICGS works 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000  -matlab=diskG4NO -go=dk -krylovType=bcgs


CgWaveHoltz::residual: grid=0 : maxRes= 1.62e-09
CgWaveHoltz::residual: grid=1 : maxRes= 1.66e-09
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=1.656e-09.

solveHelmholtz: max-res=7.367e-09 (bcgs, numIts=303, CR= 0.92 )
solveHelmholtz: max-res=1.656e-09 (gmres, numIts=121, CR= 0.82 )
solveHelmholtz: max-res=4.221e-09 (cg, numIts=330, CR= 0.93 )

solveHelmholtz: rel-max-diff=1.13e-10, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



DISK + DEFLATION : CG WORKS OK!!!
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4NO -go=dk -krylovType=cg

-- FLEXIBLE GMRES
-krylovType=fgmres 
solveHelmholtz: max-res=5.950e-02 (fgmres, numIts=19, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=2.43e-03, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

-krylovType=cg
CgWaveHoltz::residual: grid=0 : maxRes= 5.95e-02
CgWaveHoltz::residual: grid=1 : maxRes= 3.78e-02
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=5.950e-02.
solveHelmholtz: max-res=5.950e-02 (cg, numIts=19, CR= 0.28 deflate=62)
solveHelmholtz: rel-max-diff=2.43e-03, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


-krylovType=bicgstab
CgWaveHoltz::residual: grid=0 : maxRes= 5.95e-02
CgWaveHoltz::residual: grid=1 : maxRes= 3.78e-02
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=5.950e-02.
solveHelmholtz: max-res=5.950e-02 (bicgstab, numIts=25, CR= 0.35 deflate=62)
solveHelmholtz: rel-max-diff=2.43e-03, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES
CgWaveHoltz::residual: grid=0 : maxRes= 5.95e-02
CgWaveHoltz::residual: grid=1 : maxRes= 3.78e-02
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=5.950e-02.
solveHelmholtz: max-res=5.950e-02 (gmres, numIts=19, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=2.43e-03, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




DISK
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.55 -y0=.6 -nf=1 -freq=10 -amp=-200 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=yale -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -krylovType=gmres -go=og

-krylovType=cg 
CgWaveHoltz::residual: grid=0 : maxRes= 6.51e-08
CgWaveHoltz::residual: grid=1 : maxRes= 6.09e-08
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=6.511e-08.
solveHelmholtz: max-res=6.511e-08 (cg, numIts=241, CR= 0.92 )
solveHelmholtz: rel-max-diff=3.41e-09, |v|_max= 5.66e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


-BI-CG-STAB: 
-krylovType=bicgstab
CgWaveHoltz::residual: grid=0 : maxRes= 1.38e-07
CgWaveHoltz::residual: grid=1 : maxRes= 1.15e-07
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=1.384e-07.
solveHelmholtz: max-res=1.384e-07 (bicgstab, numIts=133, CR= 0.85 )
solveHelmholtz: rel-max-diff=1.48e-08, |v|_max= 5.66e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

-GMRES
CgWaveHoltz::residual: grid=0 : maxRes= 7.19e-09
CgWaveHoltz::residual: grid=1 : maxRes= 5.40e-09
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=7.194e-09.
solveHelmholtz: max-res=7.194e-09 (gmres, numIts=39, CR= 0.57 )
solveHelmholtz: rel-max-diff=3.61e-10, |v|_max= 5.66e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

>>>> SQUARE 
CG NOW WORKS !!

cgwh -noplot gaussian.cmd -g=square128.order2 -x0=.55 -y0=.6 -nf=1 -freq=10 -amp=-200 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=yale -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -krylovType=cg -go=og

-krylovType=cg 
CgWaveHoltz::residual: grid=0 : maxRes= 4.13e-09
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=4.132e-09.
solveHelmholtz: max-res=4.132e-09 (cg, numIts=16, CR= 0.22 )
solveHelmholtz: rel-max-diff=1.12e-10, |v|_max= 2.10e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


-krylovType=gmres
CgWaveHoltz::residual: grid=0 : maxRes= 4.55e-09
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=4.554e-09.
solveHelmholtz: max-res=4.554e-09 (gmres, numIts=16, CR= 0.22 )
solveHelmholtz: rel-max-diff=1.22e-10, |v|_max= 2.10e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


REVISIT biCG-Stab -- why doesn't it work better

cgwh -noplot gaussian.cmd -g=square128.order2 -x0=.55 -y0=.6 -nf=1 -freq=10 -amp=-200 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=yale -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -krylovType=bicgstab -go=og

-krylovType=cg
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=1.339e-08.
solveHelmholtz: max-res=1.339e-08 (cg, numIts=30, CR= 0.47 )
solveHelmholtz: rel-max-diff=3.98e-10, |v|_max= 2.10e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


-krylovType=bicgstab
CgWaveHoltz::residual: grid=0 : maxRes= 3.06e-07
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=3.065e-07.
solveHelmholtz: max-res=3.065e-07 (bicgstab, numIts=21, CR= 0.35 )
solveHelmholtz: rel-max-diff=1.09e-08, |v|_max= 2.10e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies) 

GMRES
CgWaveHoltz::residual: grid=0 : maxRes= 4.48e-09
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=4.482e-09.
solveHelmholtz: max-res=4.482e-09 (gmres, numIts=16, CR= 0.22 )
solveHelmholtz: rel-max-diff=1.11e-10, |v|_max= 2.10e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


************************************
****** Thurs/Fri Oct 17/18, 2024


>>>>> DOUBLE ELLIPSOID
DEFLATE G2: 

plotStuff plotSolution3d.cmd -show=darkCornerRoom3dG2Freq3p89.show -name=darkCornerRoom3dG2Freq3p89 -solution=1 -comp=absv -cf=4 -res=2048


RERUN WITH FPI TOO 
OK: RERUN WITH smaller tolerences
freq=3.89 -->  side mode
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoom3dGride2.order2.hdf -x0=3 -y0=4.3 -z0=0 -nf=1 -freq=3.89 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/darkCornerRoom3dG2O2Freq3p5Ev128o.show -deflateWaveHoltz=1 -numToDeflate=30  -solveri=bcgs -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=darkCornerRoom3dG2Freq3p89 -show=darkCornerRoom3dG2Freq3p89.show -go=fks > darkCornerRoom3dG2Freq3p89.out

plotStuff plotSolution3d.cmd -show=darkCornerRoom3dG2Freq3p89.show -name=darkCornerRoom3dG2Freq3p89 -solution=1 -comp=absv -res=2048 -emin=0 -emax=.49

CgWaveHoltz::residual: grid=0 : maxRes= 3.38e-02
CgWaveHoltz::residual: grid=1 : maxRes= 2.39e-02
CgWaveHoltz::residual: grid=2 : maxRes= 6.36e-03
CgWaveHoltz::residual: grid=3 : maxRes= 2.31e-02
CgWaveHoltz::residual: grid=4 : maxRes= 1.55e-02
CgWaveHoltz::residual: freq= 0, omega=   3.890, max-res=3.376e-02.
solveHelmholtz: max-res=3.376e-02 (GMRES, numIts=57, CR= 0.77 deflate=115)


=== START PIPE MULTIGRID

>>>>>>> PIPE ORDER 4
ogen -noplot pipe -order=4 -interp=e -axial=z -sa=0 -sb=1 -radius=0.5 -ml=1 -factor=2
ogen -noplot pipe -order=4 -interp=e -axial=z -sa=0 -sb=1 -radius=0.5 -ml=2 -factor=4
ogen -noplot pipe -order=4 -interp=e -axial=z -sa=0 -sb=1 -radius=0.5 -ml=3 -factor=8
ogen -noplot pipe -order=4 -interp=e -axial=z -sa=0 -sb=1 -radius=0.5 -ml=4 -factor=16


cgwh -noplot gaussian.cmd -g=pipeze8.order4.ml3.hdf -x0=0.4 -y0=0.4 -z0=.4 -nf=1 -freq=7 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -solverh=gmres -rtolh=1.0e-9 -atolh=1.0e-9 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k 

cgwh -noplot gaussian.cmd -g=pipeze4.order4.ml2.hdf -x0=0.4 -y0=0.4 -z0=.4 -nf=1 -freq=7 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -solverh=gmres -rtolh=1.0e-9 -atolh=1.0e-9 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k 

cgwh -noplot gaussian.cmd -g=pipeze2.order4.ml1.hdf -x0=0.4 -y0=0.4 -z0=.4 -nf=1 -freq=7 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -solverh=gmres -rtolh=1.0e-9 -atolh=1.0e-9 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k 

G8:


G4: but timing is 20x slower than G2 ?? >> **could be coarse grid factor***
grid=/home/henshw/grids/pipeze4.order4.ml2.hdf
 Convergence rate CR=0.294, CR-perPeriod=0.542, Time to solve = 3.06e+02(s) : CgWave= 3.06e+02(s) 99.97%, advance= 3.06e+02(s) 99.96%
 max-residual=5.53e-08 (WaveHoltz its), numberOfIterations = 8 (GMRES) (maximumNumberOfIterations=100)


G2:
grid=/home/henshw/grids/pipeze2.order4.ml1.hdf
 Convergence rate CR=0.270, CR-perPeriod=0.519, Time to solve = 1.56e+01(s) : CgWave= 1.56e+01(s) 99.86%, advance= 1.56e+01(s) 99.78%
 max-residual=3.63e-08 (WaveHoltz its), numberOfIterations = 8 (GMRES) (maximumNumberOfIterations=100)

>>>>>>> PIPE ORDER 2
ogen -noplot pipe -order=2 -interp=e -axial=z -sa=0 -sb=1 -radius=0.5 -ml=1 -factor=2
ogen -noplot pipe -order=2 -interp=e -axial=z -sa=0 -sb=1 -radius=0.5 -ml=2 -factor=4
ogen -noplot pipe -order=2 -interp=e -axial=z -sa=0 -sb=1 -radius=0.5 -ml=3 -factor=8
ogen -noplot pipe -order=2 -interp=e -axial=z -sa=0 -sb=1 -radius=0.5 -ml=4 -factor=16


cgwh -noplot gaussian.cmd -g=pipeze8.order2.ml3.hdf -x0=0.4 -y0=0.4 -z0=.4 -nf=1 -freq=7 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -solverh=gmres -rtolh=1.0e-9 -atolh=1.0e-9 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k 

cgwh -noplot gaussian.cmd -g=pipeze4.order2.ml2.hdf -x0=0.4 -y0=0.4 -z0=.4 -nf=1 -freq=7 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -solverh=gmres -rtolh=1.0e-9 -atolh=1.0e-9 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k 

cgwh -noplot gaussian.cmd -g=pipeze2.order2.ml1.hdf -x0=0.4 -y0=0.4 -z0=.4 -nf=1 -freq=7 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -solverh=gmres -rtolh=1.0e-9 -atolh=1.0e-9 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k 

G8:
 grid=/home/henshw/grids/pipeze8.order2.ml3.hdf
 Convergence rate CR=0.314, CR-perPeriod=0.560, Time to solve = 1.26e+02(s) : CgWave= 1.26e+02(s) 99.64%, advance= 1.26e+02(s) 99.58%
 max-residual=4.23e-08 (WaveHoltz its), numberOfIterations = 8 (GMRES) (maximumNumberOfIterations=100)


G4:
 Convergence rate CR=0.316, CR-perPeriod=0.562, Time to solve = 1.77e+01(s) : CgWave= 1.76e+01(s) 99.52%, advance= 1.76e+01(s) 99.42%
 max-residual=4.52e-08 (WaveHoltz its), numberOfIterations = 8 (GMRES) (maximumNumberOfIterations=100)

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=9.464e-06.
solveHelmholtz: max-res=9.464e-06 (GMRES, numIts=8, CR= 0.32 )

G2:
Convergence rate CR=0.327, CR-perPeriod=0.572, Time to solve = 3.49e+00(s) : CgWave= 3.47e+00(s) 99.48%, advance= 3.46e+00(s) 99.28%
 max-residual=4.55e-08 (WaveHoltz its), numberOfIterations = 8 (GMRES) (maximumNumberOfIterations=100)

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=4.420e-06.
solveHelmholtz: max-res=4.420e-06 (GMRES, numIts=8, CR= 0.33 )


=== START BOX WITH MULTIGRID

>>>> BOX ORDER 4
overHoltz/gaussian2
cgwh -noplot gaussian.cmd -g=box8.order4 -x0=0.4 -y0=0.4 -z0=.4 -nf=1 -freq=7 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -solverh=gmres -rtolh=1.0e-9 -atolh=1.0e-9 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k 

G8 
Convergence rate CR=0.188, CR-perPeriod=0.434, Time to solve = 5.70e+01(s) : CgWave= 5.66e+01(s) 99.39%, advance= 5.66e+01(s) 99.27%
 max-residual=1.67e-08 (WaveHoltz its), numberOfIterations = 9 (GMRES) (maximumNumberOfIterations=100)


G4
grid=/home/henshw/grids/box4.order4.hdf
 Convergence rate CR=0.188, CR-perPeriod=0.434, Time to solve = 8.26e+00(s) : CgWave= 8.21e+00(s) 99.31%, advance= 8.19e+00(s) 99.15%
 max-residual=1.36e-08 (WaveHoltz its), numberOfIterations = 9 (GMRES) (maximumNumberOfIterations=100)

G2
grid=/home/henshw/grids/box2.order4.hdf
 Convergence rate CR=0.199, CR-perPeriod=0.446, Time to solve = 1.60e+00(s) : CgWave= 1.58e+00(s) 99.14%, advance= 1.58e+00(s) 98.80%
 max-residual=1.41e-08 (WaveHoltz its), numberOfIterations = 9 (GMRES) (maximumNumberOfIterations=100)


>>>> BOX ORDER 2 
overHoltz/gaussian2
cgwh -noplot gaussian.cmd -g=box4.order2 -x0=0.4 -y0=0.4 -z0=.4 -nf=1 -freq=7 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -solverh=gmres -rtolh=1.0e-9 -atolh=1.0e-9 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k 


box1:
CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=5.243e-07.
solveHelmholtz: max-res=5.243e-07 (GMRES, numIts=9, CR= 0.19 )

box2
CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=4.687e-07.
solveHelmholtz: max-res=4.687e-07 (GMRES, numIts=9, CR= 0.19 )

box4:
CgWaveHoltz::residual: grid=0 : maxRes= 5.63e-07
CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=5.628e-07.
solveHelmholtz: max-res=5.628e-07 (GMRES, numIts=9, CR= 0.19 )

box8:
CgWaveHoltz::residual: grid=0 : maxRes= 7.97e-07
CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=7.970e-07.
solveHelmholtz: max-res=7.970e-07 (GMRES, numIts=9, CR= 0.19 )




DEFLATE G2: 

freq=3.95 -> 3.61 (middle mode)
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoom3dGride2.order2.hdf -x0=0.5 -y0=3 -z0=0 -nf=1 -freq=3.95 -amp=150 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/darkCornerRoom3dG2O2Freq3p5Ev128o.show -deflateWaveHoltz=1 -numToDeflate=20  -solveri=bcgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=darkCornerRoom3dG2Freq3p95 -show=darkCornerRoom3dG2Freq3p495.show -go=ks > darkCornerRoom3dG2Freq3p95.out

grid=/home/henshw/grids/darkCornerRoom3dGride2.order2.hdf
 Convergence rate CR=0.861, CR-perPeriod=0.928, Time to solve = 1.37e+04(s) : CgWave= 1.36e+04(s) 99.35%, advance= 1.36e+04(s) 99.31%
 max-residual=5.71e-08 (WaveHoltz its), numberOfIterations = 92 (GMRES) (maximumNumberOfIterations=500)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1

--> probably not so well resolved >? CHECK PPW 
CgWaveHoltz::residual: grid=0 : maxRes= 1.99e-01
CgWaveHoltz::residual: grid=1 : maxRes= 2.89e-02
CgWaveHoltz::residual: grid=2 : maxRes= 6.23e-02
CgWaveHoltz::residual: grid=3 : maxRes= 4.43e-02
CgWaveHoltz::residual: grid=4 : maxRes= 9.92e-03
CgWaveHoltz::residual: freq= 0, omega=   3.950, max-res=1.992e-01.
solveHelmholtz: max-res=1.992e-01 (GMRES, numIts=92, CR= 0.86 deflate=79)



 plotStuff plotSolution.cmd -show=darkCornerRoom3dG2Freq3p495.show -name=darkCornerRoom3dG2Freq3p495 -solution=1 -comp=absv -res=2048 -emin=0 -emax=.49


freq=3.47 --> 3.17 too small
freq=4.06 --> 3.7  too big 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoom3dGride2.order2.hdf -x0=3 -y0=3.5 -z0=0 -nf=1 -freq=4.06 -amp=150 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/darkCornerRoom3dG2O2Freq3p5Ev128o.show -deflateWaveHoltz=1 -numToDeflate=20  -solveri=bcgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=darkCornerRoom3dG2Freq3p47 -show=darkCornerRoom3dG2Freq3p47.show -go=ks

**ADJUSTED OMEGA OUTSIDE RANGE
CgWave::initializeDeflation:: Eigenvalues from showfile: lambdaMin= 3.54e+00, lambdaAve= 3.85e+00, lambdaMax= 4.15e+00, omega= 3.17e+00
CgWave::initializeDeflation::ERROR omega=  3.17e+00 is outside the range of eigenvalues [ 3.54e+00, 4.15e+00].

************************************
****** Tues Oct 15, 2024

BUG FOUND --> Need to resize eigeNumbersToDeflate

SEG FAULT HERE: ... FIXED

Deflate: NOTE HIGH MULTIPLICITIES FOUND !!
valgrind $cgwh -noplot gaussian.cmd -g=darkCornerRoom3dGride1.order2.hdf -x0=3 -y0=3.5 -z0=0 -nf=1 -freq=3.47 -amp=150 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG1O2Ev256.show -deflateWaveHoltz=1 -numToDeflate=20  -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=darkCornerRoom3dG1Freq3p47 -show=darkCornerRoom3dG1Freq3p47.show -go=ks

CgWaveHoltz::residual: grid=0 : maxRes= 4.08e-03
CgWaveHoltz::residual: grid=1 : maxRes= 2.49e-03
CgWaveHoltz::residual: grid=2 : maxRes= 7.91e-04
CgWaveHoltz::residual: grid=3 : maxRes= 3.70e-03
CgWaveHoltz::residual: grid=4 : maxRes= 6.48e-04
CgWaveHoltz::residual: freq= 0, omega=   3.470, max-res=4.085e-03.
solveHelmholtz: max-res=4.085e-03 (GMRES, numIts=14, CR= 0.38 deflate=159)


************************************
****** Mon Oct 14, 2024

START ON DOUBLE ELLIPSOID for PAPER PART2
darkCornerRoom3dGride1.order2.hdf

SLEPSc :
  darkCornerRoom3dG1O2EigsEv512.show 
  darkCornerRoom3dG2O2EigsEv64.show 

Deflate: NOTE HIGH MULTIPLICITIES FOUND !!
>> NOTE USE bcgs NOT cgs

setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoom3dGride1.order2.hdf -x0=3 -y0=3.5 -z0=0 -nf=1 -freq=3.47 -amp=150 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG1O2Ev256.show -deflateWaveHoltz=1 -numToDeflate=20  -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=darkCornerRoom3dG1Freq3p47 -show=darkCornerRoom3dG1Freq3p47.show -go=ks > darkCornerRoom3dG1Freq3p47.out


AGMRES works too

GMRES: 
CgWaveHoltz::residual: grid=0 : maxRes= 4.08e-03
CgWaveHoltz::residual: grid=1 : maxRes= 2.49e-03
CgWaveHoltz::residual: grid=2 : maxRes= 7.91e-04
CgWaveHoltz::residual: grid=3 : maxRes= 3.70e-03
CgWaveHoltz::residual: grid=4 : maxRes= 6.48e-04
CgWaveHoltz::residual: freq= 0, omega=   3.470, max-res=4.085e-03.
solveHelmholtz: max-res=4.085e-03 (GMRES, numIts=14, CR= 0.38 deflate=159)


setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoom3dGride1.order2.hdf -x0=0.5 -y0=2.0 -z0=0 -nf=1 -freq=3 -amp=150 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=darkCornerRoom3dG1Freq3 -show=darkCornerRoom3dG1Freq3.show -go=ks > darkCornerRoom3dG1Freq3.out

plotStuff plotSolution3d.cmd -show=darkCornerRoom3dG1Freq3.show -name=darkCornerRoom3dG1Freq5 -solution=1

after 10 its
CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=4.149e-03.
solveHelmholtz: max-res=4.149e-03 (GMRES, numIts=11, CR= 0.55 )


************************************
****** Tues Oct 2, 2024

COMPLEX SOLUTIONS

**FIXED RESIDUALS in implicit.bC -- use adjusted c


>>>>>>>>>>  EXPLICIT, BC+EM2 : NO-UPWIND : MATCHES EXACTLY <<<<<<<<<<<<<<<<<<
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -go=og

residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 2.67e-12, 6.18e-11], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 2.81e-12, 6.19e-11], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 3.06e-12, 6.24e-11], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 4.05e-12, 6.25e-11], max|forcing(ghost)|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 3.20e-13
solveHelmholtz: max-residual [Re,Im]=[1.78e-13,3.20e-13]
solveHelmholtz: rel-max-diff [Re,Im]=[2.26e-12,2.45e-12],  norm [Re,Im]=[8.08e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)



>>> IMP  -- check EM2 residuals: 
cgwh gaussian.cmd -g=square5.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=1 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -go=halt 

DO NOT APPLY-BC AFTER implicit-solve: 
residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 8.95e-06, 1.36e-03], max|forcing(ghost)|= 1.38e-84
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 8.95e-06, 1.36e-03], max|forcing(ghost)|= 1.38e-84
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 8.95e-06, 1.36e-03], max|forcing(ghost)|= 1.38e-84
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 8.95e-06, 1.36e-03], max|forcing(ghost)|= 1.38e-84
CgWaveHoltz::residual: grid=0 : maxRes= 2.72e-05
solveHelmholtz: max-residual [Re,Im]=[2.72e-05,3.55e-06]

cgwh gaussian.cmd -g=square16.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -debug=3 -go=halt 


IMP -- 
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -takeImplicitFirstStep=1 -minStepsPerPeriod=10 -go=halt


residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 2.19e-01, 1.05e+01], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 2.19e-01, 1.05e+01], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 2.19e-01, 1.05e+01], max|forcing(ghost)|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 2.19e-01, 1.05e+01], max|forcing(ghost)|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 2.28e-01
solveHelmholtz: max-residual [Re,Im]=[2.28e-01,2.11e-02]




IMP  -- now runs but not correct
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=abcEM2 -implicitUpwind=0 -go=halt

solveHelmholtz: max-residual [Re,Im]=[2.30e-01,2.40e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[4.50e-01,1.52e+00],  norm [Re,Im]=[6.46e-01,5.60e-01] (between WaveHoltz and Direct Helmholtz)


EXP -- not exact 
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -go=halt

solveHelmholtz: max-residual [Re,Im]=[7.25e-03,1.58e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[8.42e-03,1.95e-03],  norm [Re,Im]=[8.05e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)


************************************
****** Sat Sept 28, 2024

>>>>>>> COMPLEX : BUG FIXED : takeFirstStep was no longer correct ... FIXED : use Periodic first step


cgwh -noplot gaussian.cmd -g=square32.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -go=og


IMP -- NANS
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -go=halt



NOT EXACT 
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -go=halt

solveHelmholtz: max-residual [Re,Im]=[7.25e-03,1.58e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[8.42e-03,1.95e-03],  norm [Re,Im]=[8.05e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)



COMPLEX solution -- starts to look OK 

cgwh gaussian.cmd -g=square128.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -omega=20 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=halt

##### SAVE KRYLOV RESIDUAL: iteration=17: L2h-residual= 1.41e-12
Convergence rate CR=0.242, CR-perPeriod=0.492, Time to solve = 1.80e+00(s) : CgWave= 1.75e+00(s) 97.10%, advance= 1.74e+00(s) 96.44%
 max-residual=1.53e-02 (WaveHoltz its), numberOfIterations = 19 (GMRES) (maximumNumberOfIterations=1000)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=0


CgWaveHoltz::residual: grid=0 : maxRes= 7.54e-03
solveHelmholtz: max-residual [Re,Im]=[4.81e-03,7.33e-03]
solveHelmholtz: rel-max-diff [Re,Im]=[1.08e-02,3.42e-03],  norm [Re,Im]=[7.94e-01,1.53e+00] (between WaveHoltz and Direct Helmholtz)



EXP  EM2:  BETTER : 
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -omega=20 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=halt

residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 5.02e-04, 5.54e+00], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 5.02e-04, 5.54e+00], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 5.02e-04, 5.54e+00], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 5.02e-04, 5.54e+00], max|rhs|= 6.51e-44
CgWaveHoltz::residual: grid=0 : maxRes= 1.53e-02
solveHelmholtz: max-residual [Re,Im]=[9.34e-03,1.53e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[2.84e-02,8.20e-03],  norm [Re,Im]=[7.94e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)



>>>>>>>>>>> DAMPING <<<<<<<<<<

ADJUST BETA to SQUARE ROOT 144 --> 12



EXPLICIT:
cgwh -noplot gaussian.cmd -g=square64.order2 -x0=0.5 -y0=0.5 -nf=1 -amp=50 -beta=12 -adjustOmega=1 -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=6 -filterTimeDerivative=1 -damp=1 -go=og


CgWaveHoltz::residual: grid=0 : maxRes= 5.15e-12
solveHelmholtz: max-residual [Re,Im]=[5.95e-13,5.15e-12]
solveHelmholtz: rel-max-diff [Re,Im]=[2.64e-13,1.59e-12],  norm [Re,Im]=[1.91e-01,9.77e-02] (between WaveHoltz and Direct Helmholtz)






OLD RESULT: 

cgwh -noplot gaussian.cmd -g=square64.order2 -x0=0.5 -y0=0.5 -nf=1 -amp=50 -beta=144 -adjustOmega=1 -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=6 -filterTimeDerivative=1 -damp=1 -go=og

>>> LATEST: fixed omega used in forming complex solution 
CgWaveHoltz::residual (complex): omega=   6.000000000, max-res=[Re,Im]=[9.632e-05,1.131e-03].
CgWaveHoltz: max-res=1.131e-03 (all frequencies)

Direct solve Helmholtz: cpu= 6.43e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.047e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]
cgwh: rel-max-diff [Re,Im]=[4.46e-08,1.29e-07],  norm [Re,Im]=[1.91e-01,9.77e-02] (between WaveHoltz and Direct Helmholtz)


>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> double ellipse <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


G8 higher freq: 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=2.0 -y0=1.0 -nf=1 -amp=-100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=8 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/overHoltz/eig3/darkCornerRoomG8O4Freq25Ev512.show -deflateWaveHoltz=1 -numToDeflate=500 -matlab=darkCornerRoomG8O4Freq27p3 -show=darkCornerRoomG8O4Freq27p3.show -freq=27.3 -go=das > darkCornerRoomG8O4Freq27p3.out


plotStuff plotSolution.cmd -show=darkCornerRoomG8O4Freq27p3.show -name=darkCornerRoomG8O4Freq27p3 -solution=1 -comp=absv -res=2048 -emin=0 -emax=.49

CgWaveHoltz::residual: freq= 0, omega=  27.300, max-res=1.683e-09.
solveHelmholtz: max-res=1.683e-09 (Augmented-GMRES, numIts=32, CR= 0.52 deflate=500)
solveHelmholtz: rel-max-diff=4.29e-09, |v|_max= 2.57e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




*************************************
****** Fri Sept 27, 2024

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
RETURN TO OPEN PROBLEMS: COMPLEX SOLUTIONS

CHECK : **** INITIAL CONDITIONS****

EXP  EM2:  **BROKEN***
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -omega=20 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=halt

residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 7.28e-03, 1.06e+01], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 7.28e-03, 1.06e+01], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 7.28e-03, 1.06e+01], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 7.28e-03, 1.06e+01], max|rhs|= 6.51e-44

EXP *** BROKEN ***
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -omega=20 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=halt



cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000
-numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

IMP -- *BROKEN*
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=halt


&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&


DOUBLE ELLIPSE : EIGENWAVE + OVERHOLTZ

ISSUE: EIGENWAVE TARGET IS omega=15 ... BUT WE need OVERHOTZ ADJUSTED omega near 15 !! to omega approx 16.4 

G8 O4 -- use coarse grid EVs
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=6 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/overHoltz/eig3/darkCornerRoomG4O4Freq15EV256.show -deflateWaveHoltz=1 -numToDeflate=256 -matlab=darkCornerRoomG8O4Freq16p4 -show=darkCornerRoomG8O4Freq16p4.show -freq=16.4 -go=das > darkCornerRoomG8O4Freq16p4.out

plotStuff plotSolution.cmd -show=darkCornerRoomG8O4Freq16p4.show -name=darkCornerRoomG8O4Freq16p4 -solution=1 -comp=absv -emin=0 -emax=3.5

AUG-GMRES: it= 75, || r ||_2h = 1.97e-10, ratio=4.79e-01, (matrixIsAFunction=1)


solveHelmholtz: max-res=1.029e-05 (Augmented-GMRES, numIts=332, CR= 0.95 deflate=256)
solveHelmholtz: rel-max-diff=1.71e-06, |v|_max= 3.55e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


G4 O4 .. OK 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=6 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/overHoltz/eig3/darkCornerRoomG4O4Freq15EV256.show -deflateWaveHoltz=1 -numToDeflate=256 -matlab=darkCornerRoomG4O4Freq16p4 -show=darkCornerRoomG4O4Freq16p4.show -freq=16.4 -go=das > darkCornerRoomG4O4Freq16p4.out

plotStuff plotSolution.cmd -show=darkCornerRoomG4O2Freq16.show -name=darkCornerRoomG4O2Freq16 -solution=1 -comp=absv -emin=0 -emax=84

CgWaveHoltz::residual: freq= 0, omega=  16.400, max-res=1.093e-06.
solveHelmholtz: max-res=1.093e-06 (Augmented-GMRES, numIts=24, CR= 0.48 deflate=256)
solveHelmholtz: rel-max-diff=6.45e-06, |v|_max= 1.09e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



G4 O2 -- match periods with EigenWave? 
freq=15 too SMALL
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=6 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/overHoltz/eig2/darkCornerRoomG4O2Freq15EV256.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5 -matlab=darkCornerRoomG4O2Freq16p4 -show=darkCornerRoomG4O2Freq16.show -freq=16.4 -go=das > darkCornerRoomG4O2Freq16p4.out

plotStuff plotSolution.cmd -show=darkCornerRoomG4O2Freq16.show -name=darkCornerRoomG4O2Freq16 -solution=1 -comp=absv -emin=0 -emax=84

AGMRES: 
CgWaveHoltz::residual: freq= 0, omega=  16.400, max-res=1.978e-07.
solveHelmholtz: max-res=1.978e-07 (Augmented-GMRES, numIts=28, CR= 0.49 deflate=256)
solveHelmholtz: rel-max-diff=1.88e-07, |v|_max= 8.47e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


FIX ME: 

 ###### CgWave::initDeflation: reading Integrate object from the show file with precomputed integration weights...
DataBaseBuffer::getFromBuffer:ERROR magic number does not match, this is fatal 

*************************************
****** Thurs Sept 26, 2024

ONLY READ IN EIGENVECTORS NEEDED FOR DEFLATION

TEST CASE: 

FPI: 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4NO -go=df

NEW FAILS !! .. FIXED -- inflateSolution had wrong lambda

OLD: 
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=5.950e-02.
solveHelmholtz: max-res=5.950e-02 (FP, numIts=44, CR= 0.58 deflate=62)
solveHelmholtz: rel-max-diff=2.43e-03, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4NO -go=dk
GMRES
solveHelmholtz: max-res=5.950e-02 (GMRES, numIts=19, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=2.43e-03, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4NO -go=da

AGMRES
solveHelmholtz: max-res=2.012e-03 (Augmented-GMRES, numIts=18, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=5.08e-05, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

AGMRES -- NOT ORTHO: 
solveHelmholtz: max-res=1.238e-09 (Augmented-GMRES, numIts=32, CR= 0.49 deflate=32)
solveHelmholtz: rel-max-diff=2.19e-11, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************
****** Tues Sept 24, 2024

Use EigenWave results 

G128: 
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride128.order4.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1 -amp=-80000 -beta=120 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=4 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/sixteenKnivesGridG128O4Freq300Ev1024.show -deflateWaveHoltz=1 -numToDeflate=400 -rtoli=1e-10 -atoli=1e-10 -freq=328.49 -matlab=sixteenKnivesGride128O4Freq328p49 -show=sixteenKnivesGride128O4Freq328p49.show -go=das > sixteenKnivesGride128O4Freq328p49.out


plotStuff plotSolution.cmd -show=sixteenKnivesGride128O4Freq328p49.show -name=sixteenKnivesGride128O4Freq328p49 -solution=1 -comp=absv -emin=0 -emax=2

solveHelmholtz: max-res=7.635e-05 (Augmented-GMRES, numIts=40, CR= 0.65 deflate=400)
solveHelmholtz: rel-max-diff=9.91e-07, |v|_max= 2.15e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************
****** Tues Sept 24, 2024

DISK - ORDER=8
cgwh -noplot gaussian.cmd -g=sice2.order8.ng5 -x0=0.25 -y0=0.25 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2  -minStepsPerPeriod=10 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=diskG2O8Freq8p1Np1Nits10Exp -freq=8.1 -go=fk > diskG2O8Freq8p1Np1Nits10Exp.out

DISK - ORDER=6
cgwh -noplot gaussian.cmd -g=sice2.order6.ng4 -x0=0.25 -y0=0.25 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2  -minStepsPerPeriod=10 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=diskG2O6Freq8p1Np1Nits10Exp -freq=8.1 -go=fk > diskG2O6Freq8p1Np1Nits10Exp.out


ORDER 4
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=explicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95  -matlab=diskG2O4Freq8p1Np1Nits10Exp -go=fk > diskG2O4Freq8p1Np1Nits10Exp.out 



ORDER=2
cgwh -noplot gaussian.cmd -g=sice2.order2 -x0=0.25 -y0=0.25 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2  -minStepsPerPeriod=10 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=diskG2O2Freq8p1Np1Nits10ExpA -freq=8.1 -go=fk > diskG2O8Freq8p1Np1Nits10ExpA.out


*************************************
****** Tues Sept 24, 2024

START HIGHER ORDER

IS plotConvergence broken ??

DISK - ORDER=6
cgwh -noplot gaussian.cmd -g=sice2.order6.ng4 -x0=0.25 -y0=0.25 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2  -minStepsPerPeriod=10 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=diskG4O6Freq8p1Np1Nits10Exp -freq=8.1 -go=fk > diskG4O6Freq8p1Np1Nits10Exp.out


EXP G4 O4 
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=explicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95  -matlab=diskG4O4Freq8p1Np1Nits10ExpA -go=dfks > diskG4O4Freq8p1Np1Nits10ExpA.out 


IMP G4 O4 
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=implicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000  -matlab=diskG4O4Freq8p1Np1Nits10ImpA -go=dfks > diskG4O4Freq8p1Np1Nits10ImpA.out 

cp diskG4O4Freq8p1Np1Nits10Imp*.m $overHoltz/codes


getIntegrationWeights:ERROR: orderOfAccuracy=6 is not supported ... FIXED .. USE TRAP 

>>>>>>>>>>>>> CIC <<<<<<<<<<<<<<<

DISK - ORDER=8 .. RUNS !
cgwh -noplot gaussian.cmd -g=sice2.order8.ng5 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-13 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=diskG2O8FreqFreq14 -freq=14.8 -go=fk > diskG2O8FreqFreq14.out


CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=1.397e-11.
solveHelmholtz: max-res=1.397e-11 (GMRES, numIts=23, CR= 0.32 )


DISK - ORDER=6
cgwh -noplot gaussian.cmd -g=sice2.order6.ng4 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=diskG2O6FreqFreq14 -freq=14.8 -go=fk > diskG2O6FreqFreq14.out

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=2.500e-12.
solveHelmholtz: max-res=2.500e-12 (GMRES, numIts=25, CR= 0.32 )


DISK - ORDER=4
cgwh -noplot gaussian.cmd -g=sice2.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=diskG2O4FreqFreq14 -freq=14.8 -go=fk > diskG2O4FreqFreq14.out


cgwh -noplot gaussian.cmd -g=sice2.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=diskG2O4FreqFreq14 -freq=14.8 -go=fk > diskG2O4FreqFreq14.out


OLD WAY -- NO LCBC
cgwh -noplot gaussian.cmd -g=sice2.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=diskG2O4FreqFreq14 -freq=5 -go=fk 

OLD WAY -- SOMETHING IS BROKEN -- does not match theory
cgwh -noplot gaussian.cmd -g=sice2.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=diskG2O4FreqFreq14 -freq=5 -go=fk 

SHOULD MATCH PAPER:
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=diskG2O4FreqFreq14 -freq=8.1 -go=fk 

>>>>>>>>>>>>> SQUARE <<<<<<<<<<,
SQUARE ORDER=8 WAVEHOLTZ ... RUNS!!
cgwh -noplot gaussian.cmd -g=square32.order8.ng5 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95  -freq=14 -go=og

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=2.792e-12.
solveHelmholtz: max-res=2.792e-12 (GMRES, numIts=13, CR= 0.09 )


SQUARE ORDER=6 WAVEHOLTZ ... RUNS!!
cgwh -noplot gaussian.cmd -g=square32.order6.ng4 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=junk -freq=5 -go=og

CgWaveHoltz::residual: grid=0 : maxRes= 2.11e-12
CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=2.107e-12.
solveHelmholtz: max-res=2.107e-12 (GMRES, numIts=13, CR= 0.09 )


SQUARE ORDER=4 
cgwh -noplot gaussian.cmd -g=square32.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -meApproach=ha -bcApproach=lcbc -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.95 -matlab=junk -freq=5 -go=og


CgWaveHoltz::residual: grid=0 : maxRes= 1.48e-12
CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=1.476e-12.
solveHelmholtz: max-res=1.476e-12 (GMRES, numIts=13, CR= 0.09 )




NEED TO CHECK QUADRATURE RULE AT ORDER=4 -- should just use TRAP for 1 frequency periodic.


cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.45 -y0=0.5 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -freq=12 -matlab=square32O4Freq12 -go=og

QUADRATURE ORDER=2 : **looks the same**
CgWaveHoltz::residual: freq= 0, omega=  12.000, max-res=2.004e-12.
solveHelmholtz: max-res=2.004e-12 (GMRES, numIts=19, CR= 0.19 )
solveHelmholtz: rel-max-diff=9.50e-14, |v|_max= 5.33e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

QUADARTURE ORDER=4 
solveHelmholtz: max-res=2.004e-12 (GMRES, numIts=19, CR= 0.19 )
solveHelmholtz: rel-max-diff=9.50e-14, |v|_max= 5.33e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>> SIXTEEEN KNIVES <<<<<<<<<<<,

EIGENWAVE: 
sixteenKnivesGridG64O4Freq150Ev512.show

freq=186.43
gaussian2: run again ...
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride64.order4.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1 -amp=-1000 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/sixteenKnivesGridG64O4Freq150Ev512.show -deflateWaveHoltz=1 -numToDeflate=250 -rtoli=1e-10 -atoli=1e-10 -freq=186.43 -matlab=sixteenKnivesGride64O4Freq186 -show=sixteenKnivesGride64O4Freq186.show -go=das > sixteenKnivesGride64O4Freq186.out

plotStuff plotSolution.cmd -show=sixteenKnivesGride64O4Freq186.show -name=sixteenKnivesGride64O4Freq186 -solution=1 -comp=absv -emin=0 -emax=0.5

>>> Knife edge freq=333
Running... increase beta ...
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle128.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.15 -y0=0.2 -nf=1 -amp=-80000 -beta=120 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=16 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG128O4Freq300Ev500.show -deflateWaveHoltz=1 -numToDeflate=250 -rtoli=1e-10 -atoli=1e-10 -freq=333 -matlab=tipGridSmallG128O4Freq333 -show=tipGridSmallG128O4Freq333.show -go=as > tipGridSmallG128O4Freq333.out

CgWaveHoltz::residual: freq= 0, omega= 333.000, max-res=6.965e-06.
solveHelmholtz: max-res=6.965e-06 (Augmented-GMRES, numIts=23, CR= 0.45 deflate=250)


plotStuff plotSolution.cmd -show=tipGridSmallG128O4Freq333.show -name=tipGridSmallG128O4Freq333 -solution=1 -comp=absv -emin=0 -emax=1.4

*************************************
****** Mon Sept 23, 2024

>>> ADD option to plot filter after deflated eigs have been found <<<<




START MORE KNIFE EDGES ...

>>>>>>> SIXTEEEN


freq=193 : 
setsid $cgwh -noplot gaussian.cmd -g=sixteenKnivesGride64.order4.hdf -ts=implicit -cfl=10000 -x0=0.0 -y0=0.3 -nf=1 -amp=-2000 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/sixteenKnivesGride64EV1024.show -deflateWaveHoltz=1 -numToDeflate=200 -rtoli=1e-10 -atoli=1e-10 -freq=193 -matlab=sixteenKnivesGride64O4Freq193 -show=sixteenKnivesGride64O4Freq193.show -go=dfkas > sixteenKnivesGride64O4Freq193.out

plotStuff plotSolution.cmd -show=sixteenKnivesGride64O4Freq193.show -name=sixteenKnivesGride64O4Freq193 -solution=1 -comp=absv -emin=0 -emax=0.22

CgWaveHoltz::residual: freq= 0, omega= 193.000, max-res=8.571e-05.
solveHelmholtz: max-res=8.571e-05 (Augmented-GMRES, numIts=35, CR= 0.65 deflate=211)
solveHelmholtz: rel-max-diff=2.19e-05, |v|_max= 2.30e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>>>>> TWELVE

freq=120
setsid $cgwh -noplot gaussian.cmd -g=twelveKnivesGride64.order4.hdf -ts=implicit -cfl=10000 -x0=0. -y0=0.3 -nf=1 -amp=-2000 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/twelveKnivesGride64EV512.show -deflateWaveHoltz=1 -numToDeflate=200 -rtoli=1e-10 -atoli=1e-10 -freq=120 -matlab=twelveKnivesGride64O4Freq120 -show=twelveKnivesGride64O4Freq120.show -go=dfkas > twelveKnivesGride64O4Freq120.out


plotStuff plotSolution.cmd -show=twelveKnivesGride64O4Freq120 -name=twelveKnivesGride64O4Freq120 -solution=1 -comp=absv -emin=0 -emax=3.75

CgWaveHoltz::residual: freq= 0, omega= 120.000, max-res=2.266e-04.
solveHelmholtz: max-res=2.266e-04 (Augmented-GMRES, numIts=20, CR= 0.44 deflate=213)
solveHelmholtz: rel-max-diff=6.97e-08, |v|_max= 3.76e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


freq=100 : OK 
cgwh -noplot gaussian.cmd -g=twelveKnivesGride64.order4.hdf -ts=implicit -cfl=10000 -x0=0. -y0=0.3 -nf=1 -amp=-2000 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/twelveKnivesGride64EV512.show -deflateWaveHoltz=1 -numToDeflate=64 -rtoli=1e-10 -atoli=1e-10 -freq=100 -matlab=twelveKnivesGride64O4Freq100 -show=twelveKnivesGride64O4Freq100.show -go=og

CgWaveHoltz::residual: freq= 0, omega= 100.000, max-res=9.687e-06.
solveHelmholtz: max-res=9.687e-06 (Augmented-GMRES, numIts=30, CR= 0.57 deflate=92)
solveHelmholtz: rel-max-diff=2.59e-07, |v|_max= 2.23e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>> TWELVE
cgwh -noplot gaussian.cmd -g=twelveKnivesGride64.order4.hdf -ts=implicit -cfl=10000 -x0=0. -y0=0.3 -nf=1 -amp=-2000 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=160 -matlab=junk -show=junk -go=og


cgwh -noplot gaussian.cmd -g=twelveKnivesGride32.order2.hdf -ts=implicit -cfl=10000 -x0=0. -y0=0.3 -nf=1 -amp=-2000 -beta=60 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=40 -matlab=junk -show=junk -go=og

CgWaveHoltz::residual: freq= 0, omega=  40.000, max-res=1.831e-07.
solveHelmholtz: max-res=1.831e-07 (GMRES, numIts=17, CR= 0.30 )
solveHelmholtz: rel-max-diff=9.48e-11, |v|_max= 4.80e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>.eight knives
cgwh -noplot gaussian.cmd -g=eightKnivesGride32.order2.hdf -ts=implicit -cfl=10000 -x0=0. -y0=0.3 -nf=1 -amp=-2000 -beta=60 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=40 -matlab=junk -show=junk -go=og

CgWaveHoltz::residual: freq= 0, omega=  40.000, max-res=1.831e-07.
solveHelmholtz: max-res=1.831e-07 (GMRES, numIts=17, CR= 0.30 )
solveHelmholtz: rel-max-diff=9.47e-11, |v|_max= 4.80e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh -noplot gaussian.cmd -g=eightKnivesGride16.order2.hdf -ts=implicit -cfl=10000 -x0=0. -y0=0.3 -nf=1 -amp=-2000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=20 -matlab=junk -show=junk -go=og

CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=2.734e-08.
solveHelmholtz: max-res=2.734e-08 (GMRES, numIts=14, CR= 0.19 )
solveHelmholtz: rel-max-diff=1.21e-10, |v|_max= 8.98e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


Three KNIVES -- mode between knives
cgwh -noplot gaussian.cmd -g=threeKnivesGride32.order2.hdf -ts=implicit -cfl=10000 -x0=0.125 -y0=0.3 -nf=1 -amp=-2000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=20 -matlab=junk -show=junk -go=og

CgWaveHoltz::residual: grid=0 : maxRes= 1.05e-08
CgWaveHoltz::residual: grid=1 : maxRes= 1.57e-09
CgWaveHoltz::residual: grid=2 : maxRes= 3.78e-09
CgWaveHoltz::residual: grid=3 : maxRes= 1.98e-09
CgWaveHoltz::residual: grid=4 : maxRes= 6.48e-09
CgWaveHoltz::residual: grid=5 : maxRes= 3.14e-09
CgWaveHoltz::residual: grid=6 : maxRes= 3.96e-09
CgWaveHoltz::residual: grid=7 : maxRes= 4.02e-10
CgWaveHoltz::residual: grid=8 : maxRes= 1.61e-09
CgWaveHoltz::residual: grid=9 : maxRes= 9.53e-10
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=1.049e-08.
solveHelmholtz: max-res=1.049e-08 (GMRES, numIts=23, CR= 0.38 )
solveHelmholtz: rel-max-diff=5.52e-12, |v|_max= 2.35e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


TWO KNIVES -- mode between knives
cgwh -noplot gaussian.cmd -g=twoKnivesGride32.order2.hdf -ts=implicit -cfl=10000 -x0=0.125 -y0=0.3 -nf=1 -amp=-2000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=20 -matlab=junk -show=junk -go=og

CgWaveHoltz::residual: grid=0 : maxRes= 4.99e-08
CgWaveHoltz::residual: grid=1 : maxRes= 3.69e-09
CgWaveHoltz::residual: grid=2 : maxRes= 1.54e-08
CgWaveHoltz::residual: grid=3 : maxRes= 2.32e-08
CgWaveHoltz::residual: grid=4 : maxRes= 3.74e-08
CgWaveHoltz::residual: grid=5 : maxRes= 1.33e-08
CgWaveHoltz::residual: grid=6 : maxRes= 1.64e-08
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=4.993e-08.
solveHelmholtz: max-res=4.993e-08 (GMRES, numIts=28, CR= 0.46 )
solveHelmholtz: rel-max-diff=4.86e-10, |v|_max= 2.35e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4OEV -go=og




G128 grid: SHIFT SLIGHLY BIGGER beta
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle128.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.15 -y0=0.2 -nf=1 -amp=-20000 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=16 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG128O4Freq200Ev256.show -deflateWaveHoltz=1 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=222.86 -matlab=tipGridSmallG128O4Freq222 -show=tipGridSmallG128O4Freq222.show -go=as > tipGridSmallG128O4Freq222.out

plotStuff plotSolution.cmd -show=tipGridSmallG128O4Freq222 -name=tipGridSmallG128O4Freq222 -solution=1 -comp=absv -res=2048 -emin=0 -emax=12

CgWaveHoltz::residual: grid=0 : maxRes= 2.28e-06
CgWaveHoltz::residual: grid=1 : maxRes= 6.59e-07
CgWaveHoltz::residual: grid=2 : maxRes= 4.81e-07
CgWaveHoltz::residual: grid=3 : maxRes= 6.71e-07
CgWaveHoltz::residual: freq= 0, omega= 222.860, max-res=2.275e-06.
solveHelmholtz: max-res=2.275e-06 (Augmented-GMRES, numIts=19, CR= 0.43 deflate=100)




*************************************
****** Sun Sept 22, 2024


>>>>>>>>>>>>>>> MORE KNIFE EDGE <<<<<<<<<<<<<<<<<<<

freq=229.5 
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-40000 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG64O4Freq200Ev500.show -deflateWaveHoltz=1 -numToDeflate=150 -rtoli=1e-10 -atoli=1e-10 -freq=229.5 -matlab=tipGridSmallG64O4Freq229 -show=tipGridSmallG64O4Freq229.show -go=as > tipGridSmallG64O4Freq229.out


plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq229.show -name=tipGridSmallG64O4Freq229 -solution=1 -comp=absv -emin=0 -emax=2.5


SHIFT SOURCE .. no .. -- sharper source : beta=80 OK
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-40000 -beta=80 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG64O4Freq200Ev256.show -deflateWaveHoltz=1 -numToDeflate=150 -rtoli=1e-10 -atoli=1e-10 -freq=220 -matlab=tipGridSmallG64O4Freq220a -show=tipGridSmallG64O4Freq220a.show -go=as > tipGridSmallG64O4Freq220a.out

plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq220a.show -name=tipGridSmallG64O4Freq220 -solution=1 -comp=absv -emin=0 -emax=1


Use coarse grid EVS -- also looks like the forcing 
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle128.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-20000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=16 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG64O4Freq200Ev256.show -deflateWaveHoltz=1 -numToDeflate=150 -rtoli=1e-10 -atoli=1e-10 -freq=220 -matlab=tipGridSmallG128O4Freq220 -show=tipGridSmallG128O4Freq220.show -go=as > tipGridSmallG128O4Freq220.out

### CgWave:adjust omega and dt for Helmholtz: dtAdjusted=  3.1232795429e-03 (dt=  4.5695893143e-02) omegaAdjusted=  2.011727e+02 (omega=  2.200000e+02)##
freq=0: numPeriodsArray=16, periodArraySave=  4.5696e-01, ... corrected for numPeriods   4.5696e-01
cgWave:FD24 t=0.000e+00 (  0 steps) dt=3.123e-03 ||u||= 9.72e-03, cpu= 0.00e+00(s)
cgWave:FD24 t=4.560e-01 (146 steps) dt=3.123e-03 ||u||= 4.03e-01, cpu= 6.00e+01(s)
cgWave:FD24 t=4.997e-01 (160 steps) dt=3.123e-03 ||u||= 4.88e-01, cpu= 6.58e+01(s)
AUG-GMRES: it= 13, || r ||_2h = 2.38e-08, ratio=6.63e-01, (matrixIsAFunction=1)
 **************** MatVec for WaveHoltz (Augmented GMRES) iteration=164 *************

### CgWave:adjust omega and dt for Helmholtz: dtAdjusted=  3.1232795429e-03 (dt=  4.5695893143e-02) omegaAdjusted=  2.011727e+02 (omega=  2.200000e+02)##
cg66:~/runs/waveHoltz/gaussian> tail -100 tipGridSmallG128O4Freq220.out
cgWave:FD24 t=0.000e+00 (  0 steps) dt=3.123e-03 ||u||= 7.75e-03, cpu= 0.00e+00(s)
cgWave:FD24 t=4.560e-01 (146 steps) dt=3.123e-03 ||u||= 4.07e-01, cpu= 6.01e+01(s)
cgWave:FD24 t=4.997e-01 (160 steps) dt=3.123e-03 ||u||= 4.90e-01, cpu= 6.59e+01(s)
AUG-GMRES: it= 19, || r ||_2h = 2.97e-10, ratio=2.98e-01, (matrixIsAFunction=1)
 **************** MatVec for WaveHoltz (Augmented GMRES) iteration=170 *************


CgWaveHoltz::residual: grid=0 : maxRes= 1.33e-04
CgWaveHoltz::residual: grid=1 : maxRes= 1.03e-04
CgWaveHoltz::residual: grid=2 : maxRes= 1.03e-04
CgWaveHoltz::residual: grid=3 : maxRes= 2.94e-03
CgWaveHoltz::residual: freq= 0, omega= 220.000, max-res=2.943e-03.
solveHelmholtz: max-res=2.943e-03 (Augmented-GMRES, numIts=170, CR= 0.91 deflate=150)



TROUBLE: solution and DHS solution looks mainly like the forcing !! May be under-resolved 
freq=220 : amp=bigger
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-20000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG64O4Freq200Ev256.show -deflateWaveHoltz=1 -numToDeflate=150 -rtoli=1e-10 -atoli=1e-10 -freq=220 -matlab=tipGridSmallG64O4Freq220 -show=tipGridSmallG64O4Freq220.show -go=as > tipGridSmallG64O4Freq220.out


G64 freq=210 --> not centered use 215 **BUT tol may be too big if solution is too small**
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG64O4Freq200Ev256.show -deflateWaveHoltz=1 -numToDeflate=100 -rtoli=1e-10 -atoli=1e-10 -freq=215 -matlab=tipGridSmallG64O4Freq215 -show=tipGridSmallG64O4Freq215.show -go=as > tipGridSmallG64O4Freq215.out


CgWaveHoltz::residual: grid=0 : maxRes= 2.65e-06
CgWaveHoltz::residual: grid=1 : maxRes= 8.88e-07
CgWaveHoltz::residual: grid=2 : maxRes= 4.29e-07
CgWaveHoltz::residual: grid=3 : maxRes= 5.05e-07
CgWaveHoltz::residual: freq= 0, omega= 215.000, max-res=2.654e-06.
solveHelmholtz: max-res=2.654e-06 (Augmented-GMRES, numIts=17, CR= 0.42 deflate=100)


*************************************
****** Sat Sept 21, 2024


>>>>>>>>>>>>>>> BACK TO KNIFE EDGE <<<<<<<<<<<<<<<<<<<

NOTE increase omega=110 since adjusted value is smaller
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=110 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG64O4Freq100Ev256.show -deflateWaveHoltz=1 -numToDeflate=64 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG64O4Freq110 -show=tipGridSmallG64O4Freq110.show -go=as > tipGridSmallG64O4Freq110.out

CgWaveHoltz::residual: grid=0 : maxRes= 2.18e-07
CgWaveHoltz::residual: grid=1 : maxRes= 8.13e-08
CgWaveHoltz::residual: grid=2 : maxRes= 2.43e-08
CgWaveHoltz::residual: grid=3 : maxRes= 3.95e-08
CgWaveHoltz::residual: freq= 0, omega= 110.000, max-res=2.178e-07.
solveHelmholtz: max-res=2.178e-07 (Augmented-GMRES, numIts=9, CR= 0.12 deflate=64)


USE EV's from EIGENWAVE: **  WORKS ****
  (not orthogonalized)
cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG32O4Freq80Ev256.show -deflateWaveHoltz=1 -numToDeflate=64 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG32O4Freq80 -show=tipGridSmallG32O4Freq80.show -go=og 

AUG-GMRES: Compute A*W(:,0) ASSUMING augmented vectors are eigenvectors, eig= 9.998e-01, lam=1-eig= 1.522e-04
AUG-GMRES: Compute A*W(:,1) ASSUMING augmented vectors are eigenvectors, eig= 9.922e-01, lam=1-eig= 7.826e-03
AUG-GMRES: Compute A*W(:,2) ASSUMING augmented vectors are eigenvectors, eig= 9.910e-01, lam=1-eig= 9.013e-03
AUG-GMRES: Compute A*W(:,3) ASSUMING augmented vectors are eigenvectors, eig= 9.891e-01, lam=1-eig= 1.094e-02
AUG-GMRES: Compute A*W(:,4) ASSUMING augmented vectors are eigenvectors, eig= 9.112e-01, lam=1-eig= 8.876e-02
AUG-GMRES: Compute A*W(:,5) ASSUMING augmented vectors are eigenvectors, eig= 9.014e-01, lam=1-eig= 9.865e-02
AUG-GMRES: Compute A*W(:,6) ASSUMING augmented vectors are eigenvectors, eig= 8.755e-01, lam=1-eig= 1.245e-01
AUG-GMRES: Compute A*W(:,7) ASSUMING augmented vectors are eigenvectors, eig= 8.659e-01, lam=1-eig= 1.341e-01
AUG-GMRES: Compute A*W(:,8) ASSUMING augmented vectors are eigenvectors, eig= 8.337e-01, lam=1-eig= 1.663e-01


CgWaveHoltz::residual: grid=0 : maxRes= 1.87e-07
CgWaveHoltz::residual: grid=1 : maxRes= 7.04e-08
CgWaveHoltz::residual: grid=2 : maxRes= 4.42e-08
CgWaveHoltz::residual: grid=3 : maxRes= 1.11e-07
CgWaveHoltz::residual: freq= 0, omega=  80.000, max-res=1.875e-07.
solveHelmholtz: max-res=1.875e-07 (Augmented-GMRES, numIts=8, CR= 0.09 deflate=64)
solveHelmholtz: rel-max-diff=1.75e-10, |v|_max= 7.65e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



USE EV FROM genEigs: 
cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG32Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG32O4Freq80 -show=tipGridSmallG32O4Freq80.show -go=og 

AUG-GMRES: Compute A*W(:,0) ASSUMING augmented vectors are eigenvectors, eig= 9.998e-01, lam=1-eig= 1.522e-04
AUG-GMRES: Compute A*W(:,1) ASSUMING augmented vectors are eigenvectors, eig= 9.922e-01, lam=1-eig= 7.826e-03
AUG-GMRES: Compute A*W(:,2) ASSUMING augmented vectors are eigenvectors, eig= 9.910e-01, lam=1-eig= 9.013e-03
AUG-GMRES: Compute A*W(:,3) ASSUMING augmented vectors are eigenvectors, eig= 9.891e-01, lam=1-eig= 1.094e-02
AUG-GMRES: Compute A*W(:,4) ASSUMING augmented vectors are eigenvectors, eig= 9.112e-01, lam=1-eig= 8.876e-02
AUG-GMRES: Compute A*W(:,5) ASSUMING augmented vectors are eigenvectors, eig= 9.014e-01, lam=1-eig= 9.865e-02
AUG-GMRES: Compute A*W(:,6) ASSUMING augmented vectors are eigenvectors, eig= 8.755e-01, lam=1-eig= 1.245e-01
AUG-GMRES: Compute A*W(:,7) ASSUMING augmented vectors are eigenvectors, eig= 8.659e-01, lam=1-eig= 1.341e-01
AUG-GMRES: Compute A*W(:,8) ASSUMING augmented vectors are eigenvectors, eig= 8.337e-01, lam=1-eig= 1.663e-01
AUG-GMRES: Compute A*W(:,9) ASSUMING augmented vectors are eigenvectors, eig= 8.324e-01, lam=1-eig= 1.676e-01

CgWaveHoltz::residual: grid=0 : maxRes= 1.78e-07
CgWaveHoltz::residual: grid=1 : maxRes= 1.04e-07
CgWaveHoltz::residual: grid=2 : maxRes= 4.81e-08
CgWaveHoltz::residual: grid=3 : maxRes= 3.23e-01
CgWaveHoltz::residual: freq= 0, omega=  80.000, max-res=3.234e-01.
solveHelmholtz: max-res=3.234e-01 (Augmented-GMRES, numIts=8, CR= 0.09 deflate=64)
solveHelmholtz: rel-max-diff=1.68e-09, |v|_max= 7.65e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




REVERT to repo version of updateTimeIntegral.C 

EIGENWAVE -- for eigenvalues
WAVEHOLTZ -- to solve Helmholtz

plotFilter is broken for waveHoltz

NP=1 ? 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4OEV -go=og

USE ORTHOGONALIZED: --> **NOTE** acutally deflated 62 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4OEV -go=og

AGMRES OLD VERSION: 
solveHelmholtz: max-res=2.012e-03 (Augmented-GMRES, numIts=18, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=5.08e-05, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES:
solveHelmholtz: max-res=5.950e-02 (GMRES, numIts=19, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=2.43e-03, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


EV's from genEigs: **BROKEN** --> trouble in new updateTimeIntegral : getWaveHoltzIterationEigenvalue --> revert to old verions : OK 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4OGenEigsEV -go=og


OLD VERSION: (plotFilter is wrong )
solveHelmholtz: max-res=6.630e-02 (GMRES, numIts=19, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=4.73e-03, |v|_max= 6.34e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************
****** Fri Sept 20, 2024

>>>>>>>>>>>>>>> KNIFE EDGE <<<<<<<<<<<<<<<<<<<


EIGENWAVE -- for eigenvalues
WAVEHOLTZ -- to solve Helmholtz



>>>>>>>>>>>>>> KNIFE EDGE

G32: OLD CASE
cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG32Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG32O4Freq80 -show=tipGridSmallG32O4Freq80.show -go=og -go=dfka  > tipGridSmallG32O4Freq80.out

PlotFilter is **WRONG****

These look OK: 
AUG-GMRES: Compute A*W(:,0) ASSUMING augmented vectors are eigenvectors, eig= 9.998e-01, lam=1-eig= 1.522e-04
AUG-GMRES: Compute A*W(:,1) ASSUMING augmented vectors are eigenvectors, eig= 9.922e-01, lam=1-eig= 7.826e-03
AUG-GMRES: Compute A*W(:,2) ASSUMING augmented vectors are eigenvectors, eig= 9.910e-01, lam=1-eig= 9.013e-03
AUG-GMRES: Compute A*W(:,3) ASSUMING augmented vectors are eigenvectors, eig= 9.891e-01, lam=1-eig= 1.094e-02
AUG-GMRES: Compute A*W(:,4) ASSUMING augmented vectors are eigenvectors, eig= 9.112e-01, lam=1-eig= 8.876e-02
AUG-GMRES: Compute A*W(:,5) ASSUMING augmented vectors are eigenvectors, eig= 9.014e-01, lam=1-eig= 9.865e-02
AUG-GMRES: Compute A*W(:,6) ASSUMING augmented vectors are eigenvectors, eig= 8.755e-01, lam=1-eig= 1.245e-01
AUG-GMRES: Compute A*W(:,7) ASSUMING augmented vectors are eigenvectors, eig= 8.659e-01, lam=1-eig= 1.341e-01
AUG-GMRES: Compute A*W(:,8) ASSUMING augmented vectors are eigenvectors, eig= 8.337e-01, lam=1-eig= 1.663e-01
AUG-GMRES: Compute A*W(:,9) ASSUMING augmented vectors are eigenvectors, eig= 8.324e-01, lam=1-eig= 1.676e-01

AUG-GMRES: it=  2, || r ||_2h = 3.46e-04, ratio=7.04e-02, (matrixIsAFunction=1)





FREQ=120: NP=16 - ORTHOGONALIZED **CHECK ME**
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=120 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG64O4Freq120Ev128o.show -deflateWaveHoltz=1 -numToDeflate=80 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG32O4Freq120 -show=tipGridSmallG64O4Freq120o.show -go=da  > tipGridSmallG64O4Freq120o.out

**THESE ARE WRONG*******
AUG-GMRES: Compute A*W(:,51) ASSUMING augmented vectors are eigenvectors, eig=-1.009e-01, lam=1-eig= 1.101e+00
AUG-GMRES: Compute A*W(:,52) ASSUMING augmented vectors are eigenvectors, eig=-9.962e-02, lam=1-eig= 1.100e+00
AUG-GMRES: Compute A*W(:,53) ASSUMING augmented vectors are eigenvectors, eig= 9.826e-02, lam=1-eig= 9.017e-01
AUG-GMRES: Compute A*W(:,54) ASSUMING augmented vectors are eigenvectors, eig=-9.547e-02, lam=1-eig= 1.095e+00
AUG-GMRES: Compute A*W(:,55) ASSUMING augmented vectors are eigenvectors, eig= 9.440e-02, lam=1-eig= 9.056e-01
AUG-GMRES: Compute A*W(:,56) ASSUMING augmented vectors are eigenvectors, eig= 9.363e-02, lam=1-eig= 9.064e-01




FREQ=120: NOT_ORTHOGONALIZED
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=120 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/overHoltz/eig/tipGridG64O4Freq120Ev128.show -deflateWaveHoltz=1 -numToDeflate=80 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG32O4Freq120 -show=tipGridSmallG64O4Freq120.show -go=da  > tipGridSmallG64O4Freq120.out

### CgWave:adjust omega and dt for Helmholtz: dtAdjusted=  5.7260124954e-03 (dt=  8.3775804096e-02) omegaAdjusted=  1.097306e+02 (omega=  1.200000e+02)##
freq=0: numPeriodsArray=16, periodArraySave=  8.3776e-01, ... corrected for numPeriods   8.3776e-01
cgWave:FD24 t=0.000e+00 (  0 steps) dt=5.726e-03 ||u||= 8.88e-03, cpu= 0.00e+00(s)
cgWave:FD24 t=8.360e-01 (146 steps) dt=5.726e-03 ||u||= 3.32e-01, cpu= 1.17e+01(s)
cgWave:FD24 t=9.162e-01 (160 steps) dt=5.726e-03 ||u||= 4.37e-01, cpu= 1.28e+01(s)
AUG-GMRES: it= 49, || r ||_2h = 3.58e-05, ratio=9.16e-01, (matrixIsAFunction=1)
 **************** MatVec for WaveHoltz (Augmented GMRES) iteration=50 *************

### CgWave:adjust omega and dt for Helmholtz: dtAdjusted=  5.7260124954e-03 (dt=  8.3775804096e-02) omegaAdjusted=  1.097306e+02 (omega=  1.200000e+02)##
freq=0: numPeriodsArray=16, periodArraySave=  8.3776e-01, ... corrected for numPeriods   8.3776e-01
cgWave:FD24 t=0.000e+00 (  0 steps) dt=5.726e-03 ||u||= 8.12e-03, cpu= 0.00e+00(s)
cgWave:FD24 t=8.360e-01 (146 steps) dt=5.726e-03 ||u||= 3.33e-01, cpu= 1.17e+01(s)
cgWave:FD24 t=9.162e-01 (160 steps) dt=5.726e-03 ||u||= 4.37e-01, cpu= 1.28e+01(s)
AUG-GMRES: it= 50, || r ||_2h = 3.34e-05, ratio=9.32e-01, (matrixIsAFunction=1)




cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG32Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG32O4Freq80 -show=tipGridSmallG32O4Freq80.show -go=dfka  > tipGridSmallG32O4Freq80.out




>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

TEST DEFLATION USING NON_ORTHO EIGENWAVE RESULTS ... WORKS!

NOT ORTHOGONALIZED: -- deflate 62  .. now its=18 !!
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=62 -matlab=diskG4NO -go=da

solveHelmholtz: max-res=6.464e-10 (Augmented-GMRES, numIts=18, CR= 0.27 deflate=62)



NOT ORTHO EVS
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4NO -go=da

AGMRES : its=32
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=1.238e-09.
solveHelmholtz: max-res=1.238e-09 (Augmented-GMRES, numIts=32, CR= 0.49 deflate=32)
solveHelmholtz: rel-max-diff=2.19e-11, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


USE ORTHOGONALIZED: --> **NOTE** acutally deflated 62 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskG4O -go=da

AGMRES: its=18 
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=2.012e-03.
solveHelmholtz: max-res=2.012e-03 (Augmented-GMRES, numIts=18, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=5.08e-05, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


NO DEFLATE: 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=0 -numToDeflate=32 -matlab=junk -go=da

solveHelmholtz: max-res=6.069e-10 (Augmented-GMRES, numIts=120, CR= 0.82 )
solveHelmholtz: rel-max-diff=2.37e-11, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>>>>>>>>>>>>>>>>>.>>>>>>>>>>

--- FIX plotFilter to match matlab code ---

Now just a small difference --> CgWave uses betaDiscreteWaveHoltz <----

FIXED : added betaDiscreteWaveHoltz to MATLAB code in overHoltzPaper/matlab/getMultiFrequencyConvergenceRate.m


cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=diskTest -go=og

ie=  0 eig=  1.9854e+01 beta=  9.9976e-01 omega=  1.8288e+01
ie=  1 eig=  1.9854e+01 beta=  9.9976e-01 omega=  1.8288e+01
ie=  2 eig=  2.0153e+01 beta=  9.9974e-01 omega=  1.8288e+01
ie=  3 eig=  2.0153e+01 beta=  9.9974e-01 omega=  1.8288e+01
ie=  4 eig=  1.9480e+01 beta=  9.9692e-01 omega=  1.8288e+01
ie=  5 eig=  1.9480e+01 beta=  9.9692e-01 omega=  1.8288e+01
ie=  6 eig=  1.9463e+01 beta=  9.9671e-01 omega=  1.8288e+01
ie=  7 eig=  1.9463e+01 beta=  9.9671e-01 omega=  1.8288e+01
ie=  8 eig=  1.9411e+01 beta=  9.9605e-01 omega=  1.8288e+01
ie=  9 eig=  1.9411e+01 beta=  9.9605e-01 omega=  1.8288e+01
ie= 10 eig=  2.0629e+01 beta=  9.9561e-01 omega=  1.8288e+01
ie= 11 eig=  2.0629e+01 beta=  9.9561e-01 omega=  1.8288e+01
ie= 12 eig=  2.0636e+01 beta=  9.9552e-01 omega=  1.8288e+01
ie= 13 eig=  2.0636e+01 beta=  9.9552e-01 omega=  1.8288e+01
ie= 14 eig=  2.0640e+01 beta=  9.9546e-01 omega=  1.8288e+01
ie= 15 eig=  2.0644e+01 beta=  9.9540e-01 omega=  1.8288e+01
ie= 16 eig=  1.9258e+01 beta=  9.9371e-01 omega=  1.8288e+01
ie= 17 eig=  1.9258e+01 beta=  9.9371e-01 omega=  1.8288e+01
ie= 18 eig=  2.0899e+01 beta=  9.9111e-01 omega=  1.8288e+01

>>> MATLAB: from plotConvergence:
Deflate eigenvalue  37, lam=  1.9854e+01, adjusted=  1.8176e+01, beta=  9.9976e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  36, lam=  1.9854e+01, adjusted=  1.8176e+01, beta=  9.9976e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  38, lam=  2.0153e+01, adjusted=  1.8406e+01, beta=  9.9974e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  39, lam=  2.0153e+01, adjusted=  1.8406e+01, beta=  9.9974e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  35, lam=  1.9480e+01, adjusted=  1.7888e+01, beta=  9.9692e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  34, lam=  1.9480e+01, adjusted=  1.7888e+01, beta=  9.9692e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  33, lam=  1.9463e+01, adjusted=  1.7875e+01, beta=  9.9671e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  32, lam=  1.9463e+01, adjusted=  1.7875e+01, beta=  9.9671e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  31, lam=  1.9411e+01, adjusted=  1.7835e+01, beta=  9.9605e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  30, lam=  1.9411e+01, adjusted=  1.7835e+01, beta=  9.9605e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  40, lam=  2.0629e+01, adjusted=  1.8766e+01, beta=  9.9561e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  41, lam=  2.0629e+01, adjusted=  1.8766e+01, beta=  9.9561e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  42, lam=  2.0636e+01, adjusted=  1.8771e+01, beta=  9.9552e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  43, lam=  2.0636e+01, adjusted=  1.8771e+01, beta=  9.9552e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  44, lam=  2.0640e+01, adjusted=  1.8774e+01, beta=  9.9546e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  45, lam=  2.0644e+01, adjusted=  1.8777e+01, beta=  9.9540e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  29, lam=  1.9258e+01, adjusted=  1.7716e+01, beta=  9.9371e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  28, lam=  1.9258e+01, adjusted=  1.7716e+01, beta=  9.9371e-01 omega=  1.8288e+01, dt=  3.4356e-02
Deflate eigenvalue  46, lam=  2.0899e+01, adjusted=  1.8968e+01, beta=  9.9111e-01 omega=  1.8288e+01, dt=  3.4356e-02




**************************************
****** Thurs Sept 19, 2024

ADD PLOT FILTER: 

cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=diskTest -go=og


TEST DEFALATION USING EIGENWAVE RESULTS ... WORKS!

NOT ORTHOGONALIZED: -- not supported yet
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=junk -go=og

initDeflation: Eigenvectors in the show file have NOT been orthogonalized : this must be an old file. Regenerate with genEigs and orthogonalize to avoid doing this here.

 ###### CgWave::initDeflation: reading Integrate object from the show file with precomputed integration weights...
FindDir:ERROR: unable to find directory integrate



USE ORTHOGONALIZED: 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 -y0=-0.2 -nf=1 -freq=20 -amp=150 -beta=15 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/overHoltz/eig/diskG4O2Ev128o.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=junk -go=og

AGMRES
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=2.012e-03.
solveHelmholtz: max-res=2.012e-03 (Augmented-GMRES, numIts=18, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=5.08e-05, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


GMRES: 
solveHelmholtz: max-res=5.950e-02 (GMRES, numIts=19, CR= 0.27 deflate=62)
solveHelmholtz: rel-max-diff=2.43e-03, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


GMRES -- NO DEFLATE
solveHelmholtz: max-res=1.545e-09 (GMRES, numIts=121, CR= 0.81 )
solveHelmholtz: rel-max-diff=3.40e-10, |v|_max= 6.35e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

***************************************************
****** Wed Sept 11, 2024

ADD CHECK FOR AGMRES
cgwh -noplot gaussian.cmd -g=square32.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -go=da

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=9.397e-12.
solveHelmholtz: max-res=9.397e-12 (Augmented-GMRES, numIts=8, CR= 0.04 deflate=14)
solveHelmholtz: rel-max-diff=1.42e-13, |v|_max= 4.15e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -go=da



***************************************************
****** Wed Sept 11, 2024

CHANGED AugementedGmres -- don't count iterations if we don't used a mat-vect

KNIFE EDGE -- OK

COARSE GRID EVS
cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG16Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG32O4Freq80C2 -show=tipGridSmallG32O4Freq80.show -go=da 

CgWaveHoltz::residual: grid=0 : maxRes= 8.58e-05
CgWaveHoltz::residual: grid=1 : maxRes= 2.48e-06
CgWaveHoltz::residual: grid=2 : maxRes= 1.04e-06
CgWaveHoltz::residual: grid=3 : maxRes= 6.21e-05
CgWaveHoltz::residual: freq= 0, omega=  80.000, max-res=8.580e-05.
solveHelmholtz: max-res=8.580e-05 (Augmented-GMRES, numIts=89, CR= 0.82 deflate=78)
solveHelmholtz: rel-max-diff=7.01e-10, |v|_max= 7.65e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


plotStuff plotSolution.cmd -show=tipGridSmallG32O4Freq80.show -name=tipGridSmallG32O4Freq80 -solution=1 -comp=absv -emin=0 -emax=0.3

cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG32Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -rtoli=1e-10 -atoli=1e-10 -matlab=tipGridSmallG32O4Freq80 -show=tipGridSmallG32O4Freq80.show -go=dfka  > tipGridSmallG32O4Freq80.out

AGMRES ** CHECK RESIDUAL --> bad on one grid near interpolation and boundary but solution matches DHS  GHOST POINTS??
CgWaveHoltz::residual: grid=0 : maxRes= 1.78e-07
CgWaveHoltz::residual: grid=1 : maxRes= 1.04e-07
CgWaveHoltz::residual: grid=2 : maxRes= 4.81e-08
CgWaveHoltz::residual: grid=3 : maxRes= 3.23e-01
CgWaveHoltz::residual: freq= 0, omega=  80.000, max-res=3.234e-01.
solveHelmholtz: max-res=3.234e-01 (Augmented-GMRES, numIts=8, CR= 0.09 deflate=64)
solveHelmholtz: rel-max-diff=1.68e-09, |v|_max= 7.65e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES
CgWaveHoltz::residual: grid=0 : maxRes= 2.45e-01
CgWaveHoltz::residual: grid=1 : maxRes= 1.63e-01
CgWaveHoltz::residual: grid=2 : maxRes= 1.59e-01
CgWaveHoltz::residual: grid=3 : maxRes= 8.67e-02
CgWaveHoltz::residual: freq= 0, omega=  80.000, max-res=2.454e-01.
solveHelmholtz: max-res=2.454e-01 (GMRES, numIts=9, CR= 0.08 deflate=64)
solveHelmholtz: rel-max-diff=1.69e-04, |v|_max= 7.65e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG32Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -rtoli=1e-10 -atoli=1e-10  -show=tipGridSmallG32O4Freq40.show -go=og dfks

AGMRES:
solveHelmholtz: max-res=4.530e-01 (Augmented-GMRES, numIts=6, CR= 0.03 deflate=64)
solveHelmholtz: rel-max-diff=1.09e-09, |v|_max= 1.65e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES
solveHelmholtz: max-res=7.016e-02 (GMRES, numIts=7, CR= 0.03 deflate=64)
solveHelmholtz: rel-max-diff=3.72e-05, |v|_max= 1.65e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -go=da

number of AugmentedGmres iterations=13
resVector
    (      0) (      1) (      2) (      3) (      4) (      5) (      6) (      7) (      8) (      9) (     10) (     11) (     12) 
(0)  1.02e-03  1.02e-03  1.02e-03  1.02e-03  8.04e-05  7.31e-06  5.31e-07  4.94e-08  2.42e-09  1.62e-10  7.05e-12  2.30e-13  5.49e-15 


number of AugmentedGmres iterations=10
resVector
    (      0) (      1) (      2) (      3) (      4) (      5) (      6) (      7) (      8) (      9) 
(0)  1.02e-03  8.04e-05  7.31e-06  5.31e-07  4.94e-08  2.42e-09  1.62e-10  7.05e-12  2.30e-13  5.49e-15 


***************************************************
****** Tues Sept 10, 2024

**BUG FIXED***  FIRST STEP FOR EXPLICIT SHOULD USE Dot U = 0 


****NOTE**** AGMRES NOT EXACT FOR DISK SINCE ORTHOGONAL EVECTORS ONLY HAVE A RESIDUAL OF 1e-7 ******

TRY OTHER CASES...

DISK EXP 
cgwh -noplot gaussian.cmd -g=sice2.order2 -x0=0.2 -y0=0.1 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=explicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.9 -eigenVectorFile=/home/henshw/runs/eig/sice2O2EigsEv64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -go=da


AGMRES -- OLD WAY -- not exact, WHY???
solveHelmholtz: max-res=5.421e-06 (Augmented-GMRES, numIts=10, CR= 0.07 deflate=14)
solveHelmholtz: rel-max-diff=5.38e-07, |v|_max= 6.85e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


NO DEFLATION: 
solveHelmholtz: max-res=1.736e-12 (Augmented-GMRES, numIts=26, CR= 0.30 )
solveHelmholtz: rel-max-diff=4.93e-14, |v|_max= 6.85e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


DISK IMP:
cgwh -noplot gaussian.cmd -g=sice2.order2 -x0=0.2 -y0=0.1 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=explicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=.9 -eigenVectorFile=/home/henshw/runs/eig/sice2O2EigsEv64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -go=da

solveHelmholtz: max-res=5.421e-06 (Augmented-GMRES, numIts=10, CR= 0.07 deflate=14)
solveHelmholtz: rel-max-diff=5.38e-07, |v|_max= 6.85e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


DISK IMP 
cgwh -noplot gaussian.cmd -g=sice2.order2 -x0=0.2 -y0=0.1 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice2O2EigsEv16.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -go=da

AGMRES
solveHelmholtz: max-res=6.150e-06 (Augmented-GMRES, numIts=12, CR= 0.10 deflate=14)
solveHelmholtz: rel-max-diff=5.73e-07, |v|_max= 6.85e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES: 
solveHelmholtz: max-res=8.609e-03 (GMRES, numIts=13, CR= 0.10 deflate=14)
solveHelmholtz: rel-max-diff=1.73e-03, |v|_max= 6.84e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


IMP: 
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -go=da

solveHelmholtz: max-res=6.427e-12 (Augmented-GMRES, numIts=10, CR= 0.07 deflate=3)
solveHelmholtz: rel-max-diff=5.41e-14, |v|_max= 4.14e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  FIXING BUGS <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<,

EXP ORDER=4 --> WORKS!
cgwh -noplot gaussian.cmd -g=square32.order4.ng3 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -go=da 

++AUG-GMRES: j=0: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  1.26e-14
++AUG-GMRES: j=0: eig= 9.23595e-01, lam=1-eig= 7.64052e-02, lamEst= 7.64052e-02 or  7.64052e-02, residEst=[7.92e-15,1.58e-14]


++AUG-GMRES: j=1: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  9.67e-15
++AUG-GMRES: j=1: eig= 2.25171e-01, lam=1-eig= 7.74829e-01, lamEst= 7.74300e-01 or  7.74829e-01, residEst=[5.29e-04,6.24e-15]

++AUG-GMRES: j=2: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  1.28e-14
++AUG-GMRES: j=2: eig= 2.25171e-01, lam=1-eig= 7.74829e-01, lamEst= 7.76027e-01 or  7.74829e-01, residEst=[1.20e-03,4.68e-15]

solveHelmholtz: max-res=1.915e-10 (Augmented-GMRES, numIts=8, CR= 0.06 deflate=3)
solveHelmholtz: rel-max-diff=1.16e-12, |v|_max= 4.15e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


EXP ORDER2: 
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -go=da > junk.out

++AUG-GMRES: j=0: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  1.90e-15
++AUG-GMRES: j=0: eig= 9.23087e-01, lam=1-eig= 7.69127e-02, lamEst= 7.69127e-02 or  7.69127e-02, residEst=[2.83e-15,4.90e-15]

++AUG-GMRES: j=1: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  5.10e-15
++AUG-GMRES: j=1: eig= 2.29876e-01, lam=1-eig= 7.70124e-01, lamEst= 7.70024e-01 or  7.70124e-01, residEst=[1.00e-04,1.33e-15]

solveHelmholtz: max-res=2.434e-10 (Augmented-GMRES, numIts=8, CR= 0.06 deflate=3)
solveHelmholtz: rel-max-diff=1.49e-12, |v|_max= 4.14e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.09 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -go=da

CFL=.09 
++AUG-GMRES: j=0: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  3.96e-04
++AUG-GMRES: j=0: eig= 9.23220e-01, lam=1-eig= 7.67798e-02, lamEst= 7.63842e-02 or  7.63842e-02, residEst=[6.43e-15,5.75e-15]



EXP: -- beta value is wrong for explicit
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -go=da > junk.out

SHOULD BE eig = 0.927037 intsead of off by .004 
    1-7.29630e-02 = 0.927037

getWaveHoltzIterationEigenvalue: EXPLICIT time-stepping dt=1.962706973097e-02
betaDiscreteWaveHoltz : lambda=4.44250607e+00 omega=5.00200854e+00 dt=1.96270697e-02 alphad=4.98793276e-01
getWaveHoltzIterationEigenvalue: ilam=  0 omega= 5.0020085e+00, 2*pi/T= 5.0020085e+00 lambda= 4.4410989e+00 lam(adjusted)= 4.4425061e+00 mu= 9.2308729e-01 betac= 9.2311682e-01 (dt= 1.96271e-02)

++AUG-GMRES: j=0: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  3.95e-03
++AUG-GMRES: j=0: eig= 9.23087e-01, lam=1-eig= 7.69127e-02, lamEst= 7.29630e-02 or  7.29630e-02, residEst=[2.44e-15,4.87e-15]

****************************************************
****** Sun/Mon Sept 8/9, 2024

>>>>>>>>>> CHECK SAVING INTEGRATE CLASS TO SHOW FILE

>>>>>> BUG FIXED for AUG-GMRES and exact eigenvectors : added betaDiscreteWaveHoltz

EXP: -- beta value is wrong for explicit
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=explicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.9 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -go=da


getWaveHoltzIterationEigenvalue: ilam=  0 omega= 5.0020085e+00, 2*pi/T= 5.0020085e+00 lambda= 4.4410989e+00 lam(adjusted)= 4.4425061e+00 mu= 9.231e-01 betac= 9.231e-01 (dt= 1.96271e-02)
getWaveHoltzIterationEigenvalue: ilam=  1 omega= 5.0020085e+00, 2*pi/T= 5.0020085e+00 lambda= 7.0152281e+00 lam(adjusted)= 7.0207814e+00 mu= 2.299e-01 betac= 2.300e-01 (dt= 1.96271e-02)
getWaveHoltzIterationEigenvalue: ilam=  2 omega= 5.0020085e+00, 2*pi/T= 5.0020085e+00 lambda= 7.0152281e+00 lam(adjusted)= 7.0207814e+00 mu= 2.299e-01 betac= 2.300e-01 (dt= 1.96271e-02)

getWaveHoltzIterationEigenvalue: ilam=  0 omega= 5.00201e+00, lambda= 4.441e+00 lam(adjusted)= 4.443e+00 mu= 9.231e-01 betac= 9.231e-01 (dt= 1.96271e-02)
getWaveHoltzIterationEigenvalue: ilam=  1 omega= 5.00201e+00, lambda= 7.015e+00 lam(adjusted)= 7.021e+00 mu= 2.299e-01 betac= 2.300e-01 (dt= 1.96271e-02)
getWaveHoltzIterationEigenvalue: ilam=  2 omega= 5.00201e+00, lambda= 7.015e+00 lam(adjusted)= 7.021e+00 mu= 2.299e-01 betac= 2.300e-01 (dt= 1.96271e-02)


getWaveHoltzIterationEigenvalue: ilam=  0 omega= 5.00201e+00, lambda= 4.441e+00 lam(adjusted)= 4.443e+00 mu= 9.231e-01 (dt= 1.96271e-02)
getWaveHoltzIterationEigenvalue: ilam=  1 omega= 5.00201e+00, lambda= 7.015e+00 lam(adjusted)= 7.021e+00 mu= 2.299e-01 (dt= 1.96271e-02)
getWaveHoltzIterationEigenvalue: ilam=  2 omega= 5.00201e+00, lambda= 7.015e+00 lam(adjusted)= 7.021e+00 mu= 2.299e-01 (dt= 1.96271e-02)

SHOULD BE eig = 0.927037 off by .004 

++AUG-GMRES: j=0: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  3.95e-03
++AUG-GMRES: j=0: eig= 9.23087e-01, lam=1-eig= 7.69127e-02, lamEst= 7.29630e-02 or  7.29630e-02, residEst=[2.44e-15,4.87e-15]

++AUG-GMRES: j=1: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  2.50e-02
++AUG-GMRES: j=1: eig= 2.29876e-01, lam=1-eig= 7.70124e-01, lamEst= 7.45089e-01 or  7.45148e-01, residEst=[5.89e-05,1.33e-15]

++AUG-GMRES: j=2: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  2.50e-02
++AUG-GMRES: j=2: eig= 2.29876e-01, lam=1-eig= 7.70124e-01, lamEst= 7.45838e-01 or  7.45148e-01, residEst=[6.91e-04,2.66e-15]


--- OLDER

EXP time-stepping DOES NOT MATCH: 
++AUG-GMRES: j=0: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  5.41e-02
++AUG-GMRES: j=0: eig= 9.231e-01, lam=1-eig= 7.691e-02, lamEst= 7.296e-02 or  7.296e-02, residEst=3.35e-14

++AUG-GMRES: j=1: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  3.35e-02
++AUG-GMRES: j=1: eig= 2.299e-01, lam=1-eig= 7.701e-01, lamEst= 7.451e-01 or  7.451e-01, residEst=7.90e-05


EXP smaller dt:
++AUG-GMRES: j=0: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  4.44e-04
++AUG-GMRES: j=0: eig= 9.232e-01, lam=1-eig= 7.678e-02, lamEst= 7.634e-02 or  7.634e-02, residEst=3.18e-15


IMP: 
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.5 -y0=0.45 -nf=1 -amp=20 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 -go=da

getWaveHoltzIterationEigenvalue: ilam=  0 omega= 4.57211e+00, lambda= 4.441e+00 lam(adjusted)= 4.133e+00 mu= 9.419e-01 (dt= 1.37424e-01)
getWaveHoltzIterationEigenvalue: ilam=  1 omega= 4.57211e+00, lambda= 7.015e+00 lam(adjusted)= 5.962e+00 mu= 4.971e-01 (dt= 1.37424e-01)
getWaveHoltzIterationEigenvalue: ilam=  2 omega= 4.57211e+00, lambda= 7.015e+00 lam(adjusted)= 5.962e+00 mu= 4.971e-01 (dt= 1.37424e-01)
AGMRES

++++ IMP TS : ANSWERS AGREE:  *but why is residEst off ?

++AUG-GMRES: j=0: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  2.82e-15
++AUG-GMRES: j=0: eig= 9.41934e-01, lam=1-eig= 5.80656e-02, lamEst= 5.80656e-02 or  5.80656e-02, residEst=[2.70e-15,3.84e-15]


++AUG-GMRES: j=1: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  2.55e-15
++AUG-GMRES: j=1: eig= 4.97074e-01, lam=1-eig= 5.02926e-01, lamEst= 5.03072e-01 or  5.02926e-01, residEst=[1.45e-04,1.94e-15]

++AUG-GMRES: j=2: max | (1-eig(j))*W(:,j) - A*W(:,j) |/|w_j|_inf =  3.77e-15
++AUG-GMRES: j=2: eig= 4.97074e-01, lam=1-eig= 5.02926e-01, lamEst= 5.04929e-01 or  5.02926e-01, residEst=[2.00e-03,3.33e-15]




GMRES
 Convergence rate CR=0.088, CR-perPeriod=0.088, Time to solve = 7.31e-02(s) : CgWave= 6.72e-02(s) 91.88%, advance= 6.38e-02(s) 87.25%
 max-residual=1.79e-11 (WaveHoltz its), numberOfIterations = 9 (GMRES) (maximumNumberOfIterations=100)



sice2O2EigsEv16.show 

cgwh -noplot gaussian.cmd -g=sice2.order2 -x0=0.2 -y0=0.45 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice2O2EigsEv16.show -matlab=disk8O4Freq5Np2Deflate8 -deflateWaveHoltz=1 -numToDeflate=8 -freq=5 -go=dfka


 ###### CgWave::initDeflation: reading Integrate object from the show file with precomputed integration weights...
initializeDeflation: computed volume of the domain =  3.14e+00



****************************************************
****** Thurs Sept 5, 2024


START TEST -- genEigs can now orthogonalize the eigenvectors


NEW WAY: .. fix multiple eigs .. *fixed*
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.45 -y0=0.5 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=.95 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64orthog.show -matlab=square64O4Freq15Deflate8 -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=da

AUGMENTED GMRES: 
CgWaveHoltz::residual: grid=0 : maxRes= 2.59e-10
CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=2.589e-10.
solveHelmholtz: max-res=2.589e-10 (Augmented-GMRES, numIts=10, CR= 0.09 deflate=14)
solveHelmholtz: rel-max-diff=1.16e-12, |v|_max= 4.88e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES: 
CgWaveHoltz::residual: grid=0 : maxRes= 7.90e-02
CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=7.905e-02.
solveHelmholtz: max-res=7.905e-02 (GMRES, numIts=11, CR= 0.09 deflate=14)
solveHelmholtz: rel-max-diff=3.22e-03, |v|_max= 4.87e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


OLD WAY: 
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.45 -y0=0.5 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=.95 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=square64O4Freq15Deflate8 -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=da

AUGMENTED:

==== INITIALIZE DEFLATION : compute integration weights...
Oges::allocateWorkSpace: numberOfNonzeros=10969 fillinRatio=3.600000e+01
allocateWorkSpace: numberOfEquations=1369, nsp = 394884, fillinRatio= 36, numberOfNonzeros = 10969
initializeDeflation: computed volume of the domain =  1.00e+00

 ---- CHOOSE EIGENVALUES TO DEFLATE: (freq(0)=  1.5011e+01) 
 >>> Multiple eigenvalue found: i=13, eig= 1.57079e+01, eigMultiplicity(i)=2 will orthogonalize eigenvectors...
 Inner product: (u14,u13) = 5.191e-03
Eigenvector 14 is now orthonormal to eigenvector 13.
 >>> Multiple eigenvalue found: i=12, eig= 1.40495e+01, eigMultiplicity(i)=2 will orthogonalize eigenvectors...
 Inner product: (u11,u12) = -1.062e-03
Eigenvector 11 is now orthonormal to eigenvector 12.
 >>> Multiple eigenvalue found: i=15, eig= 1.60182e+01, eigMultiplicity(i)=2 will orthogonalize eigenvectors...
 Inner product: (u16,u15) = 7.434e-04


CgWaveHoltz::residual: grid=0 : maxRes= 2.59e-10
CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=2.587e-10.
solveHelmholtz: max-res=2.587e-10 (Augmented-GMRES, numIts=10, CR= 0.09 deflate=14)
solveHelmholtz: rel-max-diff=1.16e-12, |v|_max= 4.88e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


GMRES
CgWaveHoltz::residual: grid=0 : maxRes= 7.90e-02
CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=7.905e-02.
solveHelmholtz: max-res=7.905e-02 (GMRES, numIts=11, CR= 0.09 deflate=14)
solveHelmholtz: rel-max-diff=3.22e-03, |v|_max= 4.87e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

****************************************************
****** Sat/Sun Aug 31/Sept 1, 2024

AUGMENTED GMRES with Approximate eigenvectors 

plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G4Order4X1Y1AGmresC2.show -name=darkCornerRoomFreq10Np8G4Order4X1Y1AGmresC2 -comp=absv -emin=0 -emax=1

GMRES NO Deflation, restart=50 **FIX ERROR BELOW***
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=1.0 -y0=1.0 -nf=1 -amp=-50 -beta=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10000 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -gmresRestartLength=50 -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G4Order4X1Y1GmresNoDeflate -show=darkCornerRoomFreq10Np8G4Order4X1Y1GmresNoDeflate.show -go=ks > darkCornerRoomFreq10p8G4O4X1Y1GmresNoDeflate.out


++++++++ WaveHoltz Matrix vector multiply routine: waveHoltzMatrixVectorMultiply called iteration=1010 (-2=rhs, -3=check residual)
 **************** MatVec for PETSc iteration=1010 (-2=rhs, -3=residual) *************


### CgWave:adjust omega and dt for Helmholtz: dtAdjusted=  6.8712149945e-02 (dt=  5.0265482457e-01) omegaAdjusted=  9.144213e+00 (omega=  1.000000e+01)##
freq=0: numPeriodsArray=8, periodArraySave=  5.0265e+00, ... corrected for numPeriods   5.0265e+00
cgWave:FD24 t=0.000e+00 ( 0 steps) dt=6.871e-02 ||u||= 1.08e-02, cpu= 0.00e+00(s)
cgWave:FD24 t=5.016e+00 (73 steps) dt=6.871e-02 ||u||= 4.89e-01, cpu= 4.79e+00(s)
cgWave:FD24 t=5.497e+00 (80 steps) dt=6.871e-02 ||u||= 7.43e-01, cpu= 5.25e+00(s)
solvePETSC: ERROR: INVALID iteration=1010. resVector.getLength(0)=1010
Error occured in file src/solvePETSc.C, function waveHoltzMatrixVectorMultiply, line 452.




AGMRES NO DEFLATION
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=1.0 -y0=1.0 -nf=1 -amp=-50 -beta=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=none -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G4Order4X1Y1NoDeflate -show=darkCornerRoomFreq10Np8G4Order4X1Y1NoDeflate.show -go=as > darkCornerRoomFreq10p8G4O4X1Y1NoDeflate.out



G4 O4 --- AUGMENTED GMRES COARSE GRID EV's  CR=.67 45 its -- not bad
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=1.0 -y0=1.0 -nf=1 -amp=-50 -beta=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG2O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G4Order4X1Y1AGmresC2 -show=darkCornerRoomFreq10Np8G4Order4X1Y1AGmresC2.show -go=as > darkCornerRoomFreq10p8G4O4X1Y1AGmresC2.out

CgWaveHoltz::residual: grid=0 : maxRes= 5.82e-07
CgWaveHoltz::residual: grid=1 : maxRes= 1.20e-08
CgWaveHoltz::residual: grid=2 : maxRes= 8.62e-09
CgWaveHoltz::residual: grid=3 : maxRes= 9.08e-09
CgWaveHoltz::residual: grid=4 : maxRes= 8.47e-09
CgWaveHoltz::residual: grid=5 : maxRes= 2.21e-07
CgWaveHoltz::residual: grid=6 : maxRes= 9.61e-08
CgWaveHoltz::residual: grid=7 : maxRes= 2.29e-07
CgWaveHoltz::residual: grid=8 : maxRes= 8.63e-08
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=5.820e-07.
solveHelmholtz: max-res=5.820e-07 (Augmented-GMRES, numIts=45, CR= 0.67 deflate=65)

solveHelmholtz: max-res=5.820e-07 (Augmented-GMRES, numIts=45, CR= 0.67 deflate=65)


G4 O4 --- AUGMENTED GMRES seems to work CR=.5, 27 its  (after 64 mat-vects )
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=1.0 -y0=1.0 -nf=1 -amp=-50 -beta=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G4Order4X1Y1AGmres -show=darkCornerRoomFreq10Np8G4Order4X1Y1AGmres.show -go=ks > darkCornerRoomFreq10p8G4O4X1Y1AGmres.out

CgWaveHoltz::residual: grid=0 : maxRes= 6.41e-09
CgWaveHoltz::residual: grid=1 : maxRes= 1.56e-09
CgWaveHoltz::residual: grid=2 : maxRes= 1.89e-09
CgWaveHoltz::residual: grid=3 : maxRes= 1.58e-09
CgWaveHoltz::residual: grid=4 : maxRes= 9.74e-10
CgWaveHoltz::residual: grid=5 : maxRes= 5.40e-09
CgWaveHoltz::residual: grid=6 : maxRes= 3.75e-09
CgWaveHoltz::residual: grid=7 : maxRes= 2.74e-09
CgWaveHoltz::residual: grid=8 : maxRes= 4.70e-09
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=6.406e-09.
solveHelmholtz: max-res=6.406e-09 (Augmented-GMRES, numIts=27, CR= 0.51 deflate=64)


G2 O4 max=1.106
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride2.order4.hdf -ts=implicit -cfl=1000 -x0=1.0 -y0=1.0 -nf=1 -amp=-50 -beta=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG2O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G2Order4X1Y1 -show=darkCornerRoomFreq10Np8G2Order4X1Y1.show -go=dfks > darkCornerRoomFreq10Np8G2O4X1Y1.out



--------- DISK G8 ORDER=4  -----

Lower order EV
cgwh -noplot gaussian.cmd -g=sice8.order4 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O2EigsEv64.show -matlab=disk8O4Freq15Np2Deflate8O2 -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=da > disk8O4Freq15Np2Deflate8O2.out



Coarse grid EV
cgwh -noplot gaussian.cmd -g=sice8.order4 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice4O4EigsEv256.show -matlab=disk8O4Freq15Np2Deflate8C2 -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=da > disk8O4Freq15Np2Deflate8C2.out

cgwh -noplot gaussian.cmd -g=sice8.order4 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O4EigsEv64.show -matlab=disk8O4Freq15Np2Deflate8 -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=dfka > disk8O4Freq15Np2Deflate8.out


--------- DISK G8 ORDER=2  -----

Coarse grid EV
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice4O2EigsEv64.show -matlab=disk8O2Freq15Np2Deflate8C2 -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=da

disk8O2Freq15Np2Deflate8C2AGmres.m


First run regular case ... BUT AGMRES IS OFF FROM RUNNING ALONE ??? ... FIXED : USE ZERO INITIAL CONDITION

cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O2EigsEv64.show -matlab=disk8O2Freq15Np2Deflate8 -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=dfka > disk8O2Freq15Np2Deflate8.out


disk8O2Freq15Np2Deflate8AGmres.m
disk8O2Freq15Np2Deflate8Krylov.m
disk8O2Freq15Np2Deflate8FP.m

RUN AGMRES: 
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O2EigsEv64.show -matlab=disk8O2Freq15Np2Deflate8Imp -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=da


****************************************************
****** Fri Aug 30, 2024

AUGMENTED GMRES -- can we use approximate eigenvectors ??

++++++++++++++++++ DISK 

DISK G8 ORDER=2 -- G2 EV's : NOT as good -- may not be resolved
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice2O2EigsEv64.show -matlab=disk8O2Freq15Np2Deflate8Imp -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=da

CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=1.555e-07.
solveHelmholtz: max-res=1.555e-07 (Augmented-GMRES, numIts=63, CR= 0.72 deflate=11)
solveHelmholtz: rel-max-diff=9.52e-10, |v|_max= 7.51e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


DISK G8 ORDER=2 -- G4 EV's  : GOOD 
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice4O2EigsEv64.show -matlab=disk8O2Freq15Np2Deflate8Imp -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=da

CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=1.173e-07.
solveHelmholtz: max-res=1.173e-07 (Augmented-GMRES, numIts=35, CR= 0.56 deflate=13)
solveHelmholtz: rel-max-diff=9.50e-10, |v|_max= 7.51e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


DISK G8 ORDER=2 
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O2EigsEv64.show -matlab=disk8O2Freq15Np2Deflate8Imp -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=da


CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=9.763e-09.
solveHelmholtz: max-res=9.763e-09 (Augmented-GMRES, numIts=31, CR= 0.52 deflate=13)
solveHelmholtz: rel-max-diff=3.43e-10, |v|_max= 7.51e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



+++++++++++++++   SIMPLE EXAMPLE: square

USE COARSE GRID EV-- about the same 
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.45 -y0=0.5 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=.95 -eigenVectorFile=/home/henshw/runs/eig/square16O4Ev64.show -matlab=square64O4Freq15Deflate8 -deflateWaveHoltz=1 -numToDeflate=2 -freq=15 -go=og

solveHelmholtz: max-res=1.283e-08 (Augmented-GMRES, numIts=15, CR= 0.24 deflate=4)
solveHelmholtz: rel-max-diff=7.07e-11, |v|_max= 4.88e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

USE FINE GRID EV 
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.45 -y0=0.5 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=.95 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=square64O4Freq15Deflate8 -deflateWaveHoltz=1 -numToDeflate=2 -freq=15 -go=og

CgWaveHoltz::residual: grid=0 : maxRes= 3.50e-08
CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=3.495e-08.
solveHelmholtz: max-res=3.495e-08 (Augmented-GMRES, numIts=14, CR= 0.23 deflate=4)
solveHelmholtz: rel-max-diff=1.50e-10, |v|_max= 4.88e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



DISK G8 ORDER=2 
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O2EigsEv64.show -matlab=disk8O2Freq15Np2Deflate8Imp -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=dfka

****************************************************
****** Fri Aug 23, 2024

FIX problem with AGMRES ?? 
**BUG FIXED *** call initializeDefaltion in advance.bC for AGMRES




Order4: DISK
cgwh -noplot gaussian.cmd -g=sice8.order4 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O4EigsEv64.show -matlab=disk8O4Freq15Np2Deflate8Imp -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=dfka > disk8O4Freq15Np2Deflate8Imp.out

Order2: DISK -- trouble here .. **FIXED**
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=10 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-11 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O2EigsEv64.show -matlab=disk8O2Freq15Np2Deflate8Imp -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=dfka > disk8O2Freq15Np2Deflate8Imp.out

NOW
solveHelmholtz: max-res=6.653e-08 (Augmented-GMRES, numIts=27, CR= 0.51 deflate=13)
solveHelmholtz: rel-max-diff=1.65e-09, |v|_max= 7.51e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


AGMRES (no FPI)

---- SORTED by beta: freq(0)=  1.5000e+01
 i=  77: lambda=  1.8403e+01, |beta|=  6.2627e-01
 i=  76: lambda=  1.8403e+01, |beta|=  6.2624e-01



solveHelmholtz: max-res=1.106e-07 (Augmented-GMRES, numIts=78, CR= 0.79)

AGRMES (after FPI)

 ---- SORTED by beta: freq(0)=  1.3716e+01
 i=  50: lambda=  1.4914e+01, |beta|=  9.9940e-01
 i=  48: lambda=  1.4805e+01, |beta|=  9.9691e-01
 i=  49: lambda=  1.4805e+01, |beta|=  9.9691e-01
 i=  47: lambda=  1.4782e+01, |beta|=  9.9614e-01


solveHelmholtz: max-res=6.653e-08 (Augmented-GMRES, numIts=27, CR= 0.51 deflate=13)



ORDER=4 -- seems ok
cgwh -noplot gaussian.cmd -g=square32.order4 -x0=0.45 -y0=0.5 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=.95 -eigenVectorFile=/home/henshw/runs/eig/square32O4Ev64.show -matlab=square64O4Freq15Deflate8 -deflateWaveHoltz=1 -numToDeflate=2 -freq=15 -go=og

Convergence rate CR=0.227, CR-perPeriod=0.476, Time to solve = 2.75e-01(s) : CgWave= 2.67e-01(s) 96.87%, advance= 2.61e-01(s) 94.72%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 14 (Augmented-GMRES) (maximumNumberOfIterations=100)
solveHelmholtz: max-res=3.495e-08 (all frequencies)
solveHelmholtz: rel-max-diff=1.50e-10, |v|_max= 4.88e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


THIS SEEMS OK: 
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.45 -y0=0.5 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=.95 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=square64O2Freq15Deflate8 -deflateWaveHoltz=1 -numToDeflate=2 -freq=15 -go=og

AGMRES
Convergence rate CR=0.197, CR-perPeriod=0.444, Time to solve = 2.18e-01(s) : CgWave= 2.10e-01(s) 96.28%, advance= 2.05e-01(s) 93.73%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 13 (Augmented-GMRES) (maximumNumberOfIterations=100)
solveHelmholtz: max-res=1.242e-08 (all frequencies)
solveHelmholtz: rel-max-diff=8.67e-11, |v|_max= 5.39e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


****************************************************
****** Thurs Aug 22, 2024


plots for doc

cgwh -noplot gaussian.cmd -g=square64.order4 -x0=0.6 -y0=0.45 -nf=1 -amp=50 -beta=20 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O4Ev64.show -matlab=square64O4Freq15Deflate8 -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=dfka > square64O4Freq15Deflate8.out


cgwh -noplot gaussian.cmd -g=square64.order4 -x0=0.6 -y0=0.45 -nf=1 -amp=50 -beta=20 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O4Ev64.show -matlab=square64O4Freq15Deflate8 -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=og


COMPARE TO MATLAB 
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.45 -y0=0.5 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=.95 -eigenVectorFile=/home/henshw/runs/eig/square32O2Ev64.show -matlab=square64O4Freq15Deflate8 -deflateWaveHoltz=1 -numToDeflate=2 -freq=15 -go=og


AUG-GMRES: Compute A*W(:,0) (Augmented vectors)

AUG-GMRES: Compute A*W(:,1) (Augmented vectors)
AUG-GMRES: Compute A*W(:,2) (Augmented vectors)
AUG-GMRES: Compute A*W(:,3) (Augmented vectors)
 **************** MatVec for WaveHoltz (Augmented GMRES) iteration=4 (-2=RHS)*************
#### CgWave::advance: freq=0 omega=  1.500000e+01 omegaAdjusted=  1.501543e+01

### CgWave:adjust omega and dt for Helmholtz: dtAdjusted=  1.0461212764e-02 (dt=  2.0943951024e-02) omegaAdjusted=  1.501543e+01 (omega=  1.500000e+01)##
freq=0: numPeriodsArray=2, periodArraySave=  8.3776e-01, ... corrected for numPeriods   8.3776e-01
cgWave:FD22 t=0.000e+00 ( 0 steps) dt=1.046e-02 ||u||= 2.82e+00, cpu= 0.00e+00(s)
cgWave:FD22 t=8.369e-01 (80 steps) dt=1.046e-02 ||u||= 2.28e+00, cpu= 9.83e-03(s)
 **************** MatVec for WaveHoltz (Augmented GMRES) iteration=5 (-2=RHS)*************
#### CgWave::advance: freq=0 omega=  1.500000e+01 omegaAdjusted=  1.501543e+01

### CgWave:adjust omega and dt for Helmholtz: dtAdjusted=  1.0461212764e-02 (dt=  2.0943951024e-02) omegaAdjusted=  1.501543e+01 (omega=  1.500000e+01)##
freq=0: numPeriodsArray=2, periodArraySave=  8.3776e-01, ... corrected for numPeriods   8.3776e-01
cgWave:FD22 t=0.000e+00 ( 0 steps) dt=1.046e-02 ||u||= 8.00e-02, cpu= 0.00e+00(s)
cgWave:FD22 t=8.369e-01 (80 steps) dt=1.046e-02 ||u||= 3.09e-01, cpu= 9.79e-03(s)
 **************** MatVec for WaveHoltz (Augmented GMRES) iteration=6 (-2=RHS)*************
#### CgWave::advance: freq=0 omega=  1.500000e+01 omegaAdjusted=  1.501543e+01

### CgWave:adjust omega and dt for Helmholtz: dtAdjusted=  1.0461212764e-02 (dt=  2.0943951024e-02) omegaAdjusted=  1.501543e+01 (omega=  1.500000e+01)##
freq=0: numPeriodsArray=2, periodArraySave=  8.3776e-01, ... corrected for numPeriods   8.3776e-01
cgWave:FD22 t=0.000e+00 ( 0 steps) dt=1.046e-02 ||u||= 9.88e-02, cpu= 0.00e+00(s)
cgWave:FD22 t=8.369e-01 (80 steps) dt=1.046e-02 ||u||= 3.33e-01, cpu= 9.99e-03(s)
AUG-GMRES: n=  2, || r_n ||/|| b || = 1.22e-01, ratio=4.48e-01 (matrixIsAFunction=1)
AUG-GMRES: n=  3, || r_n ||/|| b || = 3.04e-02, ratio=2.48e-01 (matrixIsAFunction=1)
AUG-GMRES: n=  4, || r_n ||/|| b || = 1.24e-02, ratio=4.08e-01 (matrixIsAFunction=1)


--- MATLAB
gmresFunction called numMatVect=  1, omega=  1.5062e+01 cpuAdvance=  0.00e+00...
gmresFunction called numMatVect=  2, omega=  1.5062e+01 cpuAdvance=  3.00e-02...
gmresFunction called numMatVect=  3, omega=  1.5062e+01 cpuAdvance=  6.00e-02...
gmresFunction called numMatVect=  4, omega=  1.5062e+01 cpuAdvance=  9.00e-02...
gmresFunction called numMatVect=  5, omega=  1.5062e+01 cpuAdvance=  1.10e-01...
gmresFunction called numMatVect=  6, omega=  1.5062e+01 cpuAdvance=  1.50e-01...
gmresFunction called numMatVect=  7, omega=  1.5062e+01 cpuAdvance=  1.70e-01...
AUG-GMRES: n=  2, || r_n ||/|| b || = 1.22e-01, ratio=4.41e-01 (matrixIsAFunction=1)
gmresFunction called numMatVect=  8, omega=  1.5062e+01 cpuAdvance=  2.00e-01...
AUG-GMRES: n=  3, || r_n ||/|| b || = 3.33e-02, ratio=2.73e-01 (matrixIsAFunction=1)
gmresFunction called numMatVect=  9, omega=  1.5062e+01 cpuAdvance=  2.40e-01...
AUG-GMRES: n=  4, || r_n ||/|| b || = 1.27e-02, ratio=3.81e-01 (matrixIsAFunction=1)
gmresFunction called numMatVect= 10, omega=  1.5062e+01 cpuAdvance=  2.70e-01...
AUG-GMRES: n=  5, || r_n ||/|| b || = 2.66e-03, ratio=2.09e-01 (matrixIsAFunction=1)
gmresFunction called numMatVect= 11, omega=  1.5062e+01 cpuAdvance=  3.20e-01...
AUG-GMRES: n=  6, || r_n ||/|| b || = 4.40e-04, ratio=1.66e-01 (matrixIsAFunction=1)
gmresFunction called numMatVect= 12, omega=  1.5062e+01 cpuAdvance=  3.50e-01...


****************************************************
****** Wed/Tues Aug 20/21, 2024

START TEST WAVEHOLTZ + AUGMENTED GMRES

ORDER=2 FIX STARTUP BUG ... FIXED ...




=========== ORDER 4 ===========

DEFLATE ORDER 4 -- FREQ=15 
cgwh gaussian.cmd -g=square64.order4 -x0=0.6 -y0=0.45 -nf=1 -amp=50 -beta=20 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O4Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=8 -freq=15 -go=halt


AGMRES
Convergence rate CR=0.110, CR-perPeriod=0.332, Time to solve = 4.17e-01(s) : CgWave= 3.79e-01(s) 90.84%, advance= 3.70e-01(s) 88.75%
 max-residual=2.45e-10 (WaveHoltz its), numberOfIterations = 10 (Augmented-GMRES) (maximumNumberOfIterations=100)
 
CgWaveHoltz::residual: grid=0 : maxRes= 1.12e-09
CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=1.118e-09.
solveHelmholtz: max-res=1.118e-09 (all frequencies)
solveHelmholtz: rel-max-diff=1.16e-11, |v|_max= 1.22e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


GMRES
Convergence rate CR=0.122, CR-perPeriod=0.349, Time to solve = 3.08e-01(s) : CgWave= 2.99e-01(s) 97.02%, advance= 2.95e-01(s) 95.60%
 max-residual=2.45e-10 (WaveHoltz its), numberOfIterations = 9 (GMRES) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 

CgWaveHoltz::residual: grid=0 : maxRes= 1.70e-03
CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=1.703e-03.
solveHelmholtz: max-res=1.703e-03 (all frequencies)
solveHelmholtz: rel-max-diff=3.44e-04, |v|_max= 1.22e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)






DEFLATE ORDER 4
cgwh gaussian.cmd -g=square64.order4 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=20 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O4Ev64.show -matlab=junk -deflateWaveHoltz=1 -numToDeflate=2 -freq=9 -go=halt

AGMRES
Convergence rate CR=0.115, CR-perPeriod=0.339, Time to solve = 2.45e-01(s) : CgWave= 2.26e-01(s) 92.16%, advance= 2.21e-01(s) 89.91%
 max-residual=1.11e-10 (WaveHoltz its), numberOfIterations = 10 (Augmented-GMRES) (maximumNumberOfIterations=100)
solveHelmholtz: max-res=4.107e-09 (all frequencies)
solveHelmholtz: rel-max-diff=2.81e-11, |v|_max= 2.54e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


GMRES
Convergence rate CR=0.131, CR-perPeriod=0.361, Time to solve = 3.22e-01(s) : CgWave= 3.12e-01(s) 97.10%, advance= 3.08e-01(s) 95.62%
 max-residual=1.11e-10 (WaveHoltz its), numberOfIterations = 10 (GMRES) (maximumNumberOfIterations=100)

solveHelmholtz: max-res=2.974e-04 (all frequencies)
solveHelmholtz: rel-max-diff=9.07e-05, |v|_max= 2.54e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



NO DEFLATE ORDER 4
cgwh gaussian.cmd -g=square64.order4 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=20 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev64.show -matlab=junk -deflateWaveHoltz=0 -numToDeflate=2 -freq=9 -go=halt

==AGMRES: OK 
solveHelmholtz: max-res=7.763e-10 (all frequencies)
solveHelmholtz: rel-max-diff=1.27e-11, |v|_max= 2.54e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


solveHelmholtz: max-res=7.173e+00 (all frequencies)
solveHelmholtz: rel-max-diff=1.27e-11, |v|_max= 2.54e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

====GMRES
solveHelmholtz: max-res=6.928e-10 (all frequencies)
solveHelmholtz: rel-max-diff=3.10e-11, |v|_max= 2.54e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

=========== ORDER 2 ===========
cgwh gaussian.cmd -g=sice8.order2 -x0=0.2 0.2 -y0=0.45 0.55 -nf=1 -amp=50 -beta=20 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/sice8O2EigsEv64.show -matlab=square128O2Freq9Np2Deflate2Imp -deflateWaveHoltz=1 -numToDeflate=4 -freq=9 -go=halt


AGMRES:
grid=/home/henshw/grids/sice8.order2.hdf
 Convergence rate CR=0.277, CR-perPeriod=0.526, Time to solve = 1.28e+00(s) : CgWave= 1.03e+00(s) 80.14%, advance= 1.01e+00(s) 79.01%
 max-residual=8.25e-13 (WaveHoltz its), numberOfIterations = 21 (Augmented-GMRES) (maximumNumberOfIterations=100)
CgWaveHoltz::residual: grid=0 : maxRes= 5.74e-12
CgWaveHoltz::residual: grid=1 : maxRes= 1.86e-12 
solveHelmholtz: max-res=5.741e-12 (all frequencies)
solveHelmholtz: rel-max-diff=6.48e-13, |v|_max= 1.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


GMRES
Convergence rate CR=0.277, CR-perPeriod=0.526, Time to solve = 7.99e-01(s) : CgWave= 7.52e-01(s) 94.13%, advance= 7.41e-01(s) 92.72%
 max-residual=8.25e-13 (WaveHoltz its), numberOfIterations = 19 (GMRES) (maximumNumberOfIterations=100)

CgWaveHoltz::residual: grid=0 : maxRes= 1.19e-04
CgWaveHoltz::residual: grid=1 : maxRes= 6.18e-05
CgWaveHoltz::residual: freq= 0, omega=   9.000, max-res=1.191e-04.
solveHelmholtz: max-res=1.191e-04 (all frequencies)
solveHelmholtz: rel-max-diff=1.39e-04, |v|_max= 1.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


DEFLATE ORDER 2
cgwh gaussian.cmd -g=square64.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=20 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev64.show -matlab=square128O2Freq9Np2Deflate2Imp -deflateWaveHoltz=1 -numToDeflate=2 -freq=9 -go=halt

AGMRES
Convergence rate CR=0.104, CR-perPeriod=0.322, Time to solve = 1.66e-01(s) : CgWave= 1.43e-01(s) 86.10%, advance= 1.37e-01(s) 82.37%
 max-residual=5.45e-13 (WaveHoltz its), numberOfIterations = 12 (Augmented-GMRES) (maximumNumberOfIterations=100)
solveHelmholtz: max-res=1.173e-11 (all frequencies)
solveHelmholtz: rel-max-diff=4.62e-12, |v|_max= 2.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

Convergence rate CR=0.126, CR-perPeriod=0.355, Time to solve = 1.39e-01(s) : CgWave= 1.21e-01(s) 87.26%, advance= 1.16e-01(s) 83.50%
 max-residual=1.62e-08 (WaveHoltz its), numberOfIterations = 9 (Augmented-GMRES) (maximumNumberOfIterations=100)
solveHelmholtz: max-res=5.875e-08 (all frequencies)
solveHelmholtz: rel-max-diff=4.50e-10, |v|_max= 2.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



GMRES
Convergence rate CR=0.115, CR-perPeriod=0.339, Time to solve = 1.86e-01(s) : CgWave= 1.76e-01(s) 94.39%, advance= 1.70e-01(s) 91.58%
 max-residual=5.45e-13 (WaveHoltz its), numberOfIterations = 12 (GMRES) (maximumNumberOfIterations=100)
solveHelmholtz: max-res=1.277e-11 (all frequencies)
solveHelmholtz: rel-max-diff=5.05e-13, |v|_max= 2.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

Convergence rate CR=0.145, CR-perPeriod=0.380, Time to solve = 9.92e-02(s) : CgWave= 9.26e-02(s) 93.31%, advance= 8.85e-02(s) 89.18%
 max-residual=1.62e-08 (WaveHoltz its), numberOfIterations = 8 (GMRES) (maximumNumberOfIterations=100)
solveHelmholtz: max-res=4.737e-07 (all frequencies)
solveHelmholtz: rel-max-diff=9.50e-09, |v|_max= 2.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



NO DEFLATE ORDER 2
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=20 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=/home/henshw/runs/eig/square64O2Ev64.show -matlab=square128O2Freq9Np2Deflate2Imp -deflateWaveHoltz=0 -numToDeflate=2 -freq=9 -go=halt

solveHelmholtz: max-res=7.672e-07 (all frequencies)
solveHelmholtz: rel-max-diff=2.60e-09, |v|_max= 2.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=10000 -x0=0.65 -y0=0.45 -nf=1 -amp=-10 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -go=halt


solveHelmholtz: max-res=1.314e-09 (all frequencies)
solveHelmholtz: rel-max-diff=6.05e-11, |v|_max= 1.09e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


**** AUG-GMRES seems to work (no deflation)

cgwh gaussian.cmd -g=square16.order2 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=-10 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -go=halt


CgWaveHoltz::residual: grid=0 : maxRes= 5.66e-10
CgWaveHoltz::residual: freq= 0, omega=   2.000, max-res=5.664e-10.
solveHelmholtz: max-res=5.664e-10 (all frequencies)
solveHelmholtz: rel-max-diff=3.64e-12, |v|_max= 3.14e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=200 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG64Order4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=128 -eigTol=1.0e-5 -rtoli=1e-10 -atoli=1e-10 -go=dfks

****************************************************
****** Fri Aug 9, 2024

DONE SAT AUG 17



plotStuff plotSolution.cmd -show=darkCornerRoomFreq40G16O4X3Y3c -solution=1 -comp=absv -res=2048 -emin=0 -emax=0.9

----- FINAL RUN ----
G16 O4 omega=40 NP=64 gaussian2/
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=2000 -numPeriods=64 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G16O4X3Y3c -show=darkCornerRoomFreq40G16O4X3Y3c.show -solveri=best -restart=200 -rtoli=1e-10 -atoli=1e-10  -go=ks > darkCornerRoomFreq40G16O4X3Y3c.out

##### SAVE KRYLOV RESIDUAL: iteration=89: L2h-residual= 9.10e-06
##### SAVE KRYLOV RESIDUAL: iteration=120: L2h-residual= 4.52e-06
##### SAVE KRYLOV RESIDUAL: iteration=154: L2h-residual= 2.95e-06 
##### SAVE KRYLOV RESIDUAL: iteration=246: L2h-residual= 4.50e-07
##### SAVE KRYLOV RESIDUAL: iteration=268: L2h-residual= 2.65e-07 
##### SAVE KRYLOV RESIDUAL: iteration=303: L2h-residual= 8.13e-08
##### SAVE KRYLOV RESIDUAL: iteration=324: L2h-residual= 4.43e-08 
##### SAVE KRYLOV RESIDUAL: iteration=364: L2h-residual= 1.26e-08
##### SAVE KRYLOV RESIDUAL: iteration=416: L2h-residual= 8.99e-10 
##### SAVE KRYLOV RESIDUAL: iteration=472: L2h-residual= 2.25e-10
##### SAVE KRYLOV RESIDUAL: iteration=582: L2h-residual= 1.02e-10 

****************************************************
****** Thus Aug 8, 2024

gaussian4 run done:


##### SAVE KRYLOV RESIDUAL: iteration=1000: L2h-residual= 5.90e-08 
######## DONE KYRLOV ITERATIONS -- KSP residual=5.85e-08 (max-res=3.34e-07) (tol=1.00e-10) numIts=1002 #######


plotStuff plotSolution.cmd -show=darkCornerRoomFreq40G16O4X3Y3 -solution=1 -comp=absv -res=2048 -emin=0 -emax=0.8

****************************************************
****** Wed Aug 7, 2024

----- FINAL RUN ----
G16 O4 omega=40 NP=64 gaussian2/
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=2000 -numPeriods=64 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G16O4X3Y3c -show=darkCornerRoomFreq40G16O4X3Y3c.show -solveri=best -restart=200 -rtoli=1e-10 -atoli=1e-10  -go=ks > darkCornerRoomFreq40G16O4X3Y3c.out

##### SAVE KRYLOV RESIDUAL: iteration=89: L2h-residual= 9.10e-06
##### SAVE KRYLOV RESIDUAL: iteration=120: L2h-residual= 4.52e-06

****************************************************
****** Mon/Tues Aug 5/6, 2024





RUNS FOR RICHARDSON 

plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G2Order2Deflate64 -name=darkCornerRoomFreq10Np8G2Order2Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G4Order2Deflate64 -name=darkCornerRoomFreq10Np8G4Order2Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G8Order2Deflate64 -name=darkCornerRoomFreq10Np8G8Order2Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G2Order4Deflate64 -name=darkCornerRoomFreq10Np8G2Order4Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G4Order4Deflate64 -name=darkCornerRoomFreq10Np8G4Order4Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G8Order4Deflate64 -name=darkCornerRoomFreq10Np8G8Order4Deflate64 -solution=1

>>>>>>>>>>>
comp compDoubleEllipse
% -------------- max norm results -------------
\begin{table}[hbt]\tableFont % you should set \tableFont to \footnotesize or other size
% \newcommand{\num}[2]{#1e{#2}} % use this command to set the format of numbers in the table.
% \newcommand{\errFormat}[1]{#1}} % use this command to set the format of the error label.
\begin{center}
\begin{tabular}{|l|c|c|c|c|c|c|c|c|} \hline 
   show file         & \errFormat{v0} &  r   & \errFormat{uDHS0} &  r   & \errFormat{err0} &  r   & \errFormat{f0} &  r  \\ \hline
 darkCornerRoomFreq10Np8G2Order4Deflate64.show & \num{2.4}{-1} &      & \num{2.3}{-1} &      & \num{2.4}{-2} &      & \num{1.9}{-1} &      \\ \hline
 darkCornerRoomFreq10Np8G4Order4Deflate64.show & \num{9.0}{-3} & 27.2 & \num{8.6}{-3} & 27.0 & \num{2.7}{-3} &  8.8 & \num{1.6}{-2} & 12.4 \\ \hline
 darkCornerRoomFreq10Np8G8Order4Deflate64.show & \num{3.3}{-4} & 27.2 & \num{3.2}{-4} & 27.0 & \num{3.1}{-4} &  8.8 & \num{1.2}{-3} & 12.4 \\ \hline
                      &     4.76      &      &     4.75      &      &     3.14      &      &     3.63      &     \\ \hline
\end{tabular}
\caption{comp. Max-norm self convergence results, t=0.000000e+00, Tue Aug  6 07:06:53 2024. }
\end{center}
\end{table}



plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G8Order4X1Y1 -solution=1 -comp=absv  -emin=0 -emax=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G4Order4X1Y1 -solution=1 -comp=absv  -emin=0 -emax=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G2Order4X1Y1 -solution=1 -comp=absv  -emin=0 -emax=1


>>>>>>>>>>>
comp compDoubleEllipse

% -------------- l1 norm results -------------
\begin{table}[hbt]\tableFont % you should set \tableFont to \footnotesize or other size
% \newcommand{\num}[2]{#1e{#2}} % use this command to set the format of numbers in the table.
% \newcommand{\errFormat}[1]{#1}} % use this command to set the format of the error label.
\begin{center}
\begin{tabular}{|l|c|c|c|c|c|c|c|c|} \hline 
   show file         & \errFormat{v0} &  r   & \errFormat{uDHS0} &  r   & \errFormat{err0} &  r   & \errFormat{f0} &  r  \\ \hline
 darkCornerRoomFreq10Np8G2Order4X1Y1.show & \num{3.6}{-1} &      & \num{3.6}{-1} &      & \num{2.2}{-4} &      & \num{-inf}{-2147483648} &      \\ \hline
 darkCornerRoomFreq10Np8G4Order4X1Y1.show & \num{2.7}{-3} & 133.2 & \num{2.7}{-3} & 133.5 & \num{6.1}{-5} &  3.7 & \num{-inf}{-2147483648} &  0.5 \\ \hline
 darkCornerRoomFreq10Np8G8Order4X1Y1.show & \num{2.0}{-5} & 133.2 & \num{2.0}{-5} & 133.5 & \num{1.6}{-5} &  3.7 & \num{-inf}{-2147483648} &  0.5 \\ \hline
                      &     7.06      &      &     7.06      &      &     1.88      &      &    -1.00      &     \\ \hline
\end{tabular}
\caption{comp. L1-norm self convergence results, t=0.000000e+00, Tue Aug  6 05:33:13 2024. }
\end{center}
\end{table}


>>>>>>>>>>>>>>>>  RE-DO
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG16O2EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G16Order2Deflate64 -show=darkCornerRoomFreq10Np8G16Order2Deflate64.show -go=dfks > darkCornerRoomFreq10Np8G16Order2Deflate64.out

getTimeStep: grid=0: gridSize=  4.42e-03, gridCFL*dt=c*dt/gridSize=  2.26e+02
getTimeStep: grid=1: gridSize=  4.41e-03, gridCFL*dt=c*dt/gridSize=  2.27e+02
getTimeStep: grid=2: gridSize=  4.41e-03, gridCFL*dt=c*dt/gridSize=  2.27e+02
getTimeStep: grid=3: gridSize=  4.41e-03, gridCFL*dt=c*dt/gridSize=  2.27e+02
getTimeStep: grid=4: gridSize=  4.41e-03, gridCFL*dt=c*dt/gridSize=  2.27e+02
getTimeStep: grid=5: gridSize=  3.36e-03, gridCFL*dt=c*dt/gridSize=  2.97e+02
getTimeStep: grid=6: gridSize=  3.56e-03, gridCFL*dt=c*dt/gridSize=  2.81e+02
getTimeStep: grid=7: gridSize=  3.36e-03, gridCFL*dt=c*dt/gridSize=  2.97e+02
getTimeStep: grid=8: gridSize=  3.56e-03, gridCFL*dt=c*dt/gridSize=  2.81e+02

>>>>>>>> REDO ALL WITH -amp=-50 

G16 O4  max=?? TO-DO 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=1.0 -y0=1.0 -nf=1 -amp=-50 -beta=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG16O4EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G16Order4X1Y1 -show=darkCornerRoomFreq10Np8G16Order4X1Y1.show -go=dfks > darkCornerRoomFreq10p8G16O4X1Y1.out


G8 O4  max=.468
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=1.0 -y0=1.0 -nf=1 -amp=-50 -beta=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G8Order4X1Y1 -show=darkCornerRoomFreq10Np8G8Order4X1Y1.show -go=dfks > darkCornerRoomFreq10p8G8O4X1Y1.out


G4 O4 max =.469 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=1.0 -y0=1.0 -nf=1 -amp=-50 -beta=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G4Order4X1Y1 -show=darkCornerRoomFreq10Np8G4Order4X1Y1.show -go=dfks > darkCornerRoomFreq10p8G4O4X1Y1.out

G2 O4 max=1.106
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride2.order4.hdf -ts=implicit -cfl=1000 -x0=1.0 -y0=1.0 -nf=1 -amp=-50 -beta=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG2O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G2Order4X1Y1 -show=darkCornerRoomFreq10Np8G2Order4X1Y1.show -go=dfks > darkCornerRoomFreq10Np8G2O4X1Y1.out



****************************************************
****** Sun Aug 4 2, 2024

G16 O4 omega=40  gaussian4/ MORE ITERATIONS
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=16 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G16O4X3Y3 -show=darkCornerRoomFreq40G16O4X3Y3.show -solveri=best -restart=500 -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq40G16O4X3Y3.out


****************************************************
****** Wed-Fri July 31 - Aug 2, 2024

TO-DO : REVISIT HIGH FREQ DOUBLE ELLIPSE

PLOTS FOR PAPER: HIGHER RES
plotStuff plotSolution.cmd -show=darkCornerRoomFreq40G16O4X3Y3b -solution=1 -comp=absv -res=2048 -emin=0 -emax=0.8
plotStuff plotSolution.cmd -show=darkCornerRoomFreq40G16O4X3Y3 -solution=1 -comp=absv -res=2048 -emin=0 -emax=0.8
plotStuff plotSolution.cmd -show=darkCornerRoomFreq40G16O4Xm1p4Ym5p6 -solution=1 -comp=absv -res=2048 -emin=0 -emax=1

RESTART, bigger Np: 
G16 O4 omega=40 NP=64 gaussian2/
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=64 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G16O4X3Y3b -show=darkCornerRoomFreq40G16O4X3Y3b.show -solveri=best -restart=200 -rtoli=1e-10 -atoli=1e-10 -icshow=darkCornerRoomFreq40G16O4X3Y3b.show -go=ks > darkCornerRoomFreq40G16O4X3Y3b.out

##### SAVE KRYLOV RESIDUAL: iteration=199: L2h-residual= 9.00e-08 
######## DONE KYRLOV ITERATIONS -- KSP residual=8.37e-08 (max-res=4.09e-07) (tol=1.00e-10) numIts=201 #######


FIXED: 
CgWaveHoltz:read IC from show file: Show file grid DOES NOT match with current grid... will interpolate...

 ##### SAVE KRYLOV RESIDUAL: iteration=15: L2h-residual= 3.68e-06 
##### SAVE KRYLOV RESIDUAL: iteration=24: L2h-residual= 3.40e-06

RESTART: 
G16 O4 omega=40  gaussian3/
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=400 -numPeriods=16 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G16O4X3Y3a -show=darkCornerRoomFreq40G16O4X3Y3a.show -solveri=best -restart=200 -rtoli=1e-10 -atoli=1e-10 -icshow=darkCornerRoomFreq40G16O4X3Y3.show -go=ks > darkCornerRoomFreq40G16O4X3Y3a.out

##### SAVE KRYLOV RESIDUAL: iteration=2: L2h-residual= 3.13e-07 
 ##### SAVE KRYLOV RESIDUAL: iteration=74: L2h-residual= 2.10e-07 
#### SAVE KRYLOV RESIDUAL: iteration=94: L2h-residual= 2.01e-07 
##### SAVE KRYLOV RESIDUAL: iteration=308: L2h-residual= 1.36e-07
##### SAVE KRYLOV RESIDUAL: iteration=371: L2h-residual= 1.16e-07 

RUNNING.... DONE: 
NOTE: Biggest grid-cfl=227
G16 O4 omega=40  gaussian3/
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=16 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G16O4X3Y3 -show=darkCornerRoomFreq40G16O4X3Y3.show -solveri=best -restart=100 -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq40G16O4X3Y3.out

##### SAVE KRYLOV RESIDUAL: iteration=1: L2h-residual= 1.66e-03 
##### SAVE KRYLOV RESIDUAL: iteration=280: L2h-residual= 1.07e-06 
##### SAVE KRYLOV RESIDUAL: iteration=385: L2h-residual= 4.88e-07 
##### SAVE KRYLOV RESIDUAL: iteration=456: L2h-residual= 3.14e-07 
##### SAVE KRYLOV RESIDUAL: iteration=495: L2h-residual= 2.10e-07 
##### SAVE KRYLOV RESIDUAL: iteration=499: L2h-residual= 1.94e-07 
######## DONE KYRLOV ITERATIONS -- KSP residual=1.90e-07 (max-res=1.57e-06) (tol=1.00e-10) numIts=501 #######


RUNNING ... DONE
G8 O4 omega=40  gaussian2/
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=16 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G8O4X3Y3 -show=darkCornerRoomFreq40G8O4X3Y3.show -solveri=best -restart=100 -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq40G8O4X3Y3.out

plotStuff plotSolution.cmd -show=darkCornerRoomFreq40G8O4X3Y3.show -comp=absv -emin=0 -emax=1


----> OLD: 
G16 O4 FREQ=40 gaussian3/
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=400 -numPeriods=16 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G16O4Xm1p4Ym5p6 -show=darkCornerRoomFreq40G16O4Xm1p4Ym5p6.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq40G16O4Xm1p4Ym5p6.out

 ##### SAVE KRYLOV RESIDUAL: iteration=23: L2h-residual= 3.25e-05 
 ##### SAVE KRYLOV RESIDUAL: iteration=39: L2h-residual= 1.69e-05 
##### SAVE KRYLOV RESIDUAL: iteration=59: L2h-residual= 1.03e-05 
##### SAVE KRYLOV RESIDUAL: iteration=176: L2h-residual= 8.11e-07
##### SAVE KRYLOV RESIDUAL: iteration=252: L2h-residual= 2.10e-07
##### SAVE KRYLOV RESIDUAL: iteration=323: L2h-residual= 6.86e-08
##### SAVE KRYLOV RESIDUAL: iteration=399: L2h-residual= 3.11e-08 
######## DONE KYRLOV ITERATIONS -- KSP residual=3.06e-08 (max-res=1.77e-07) (tol=1.00e-10) numIts=401 #######




>>>>>>>>  ADD READ INITIAL CONDITION FROM A SHOW FILE <<<<<<<<<<<


TEST RESTART:
cgwh -noplot gaussian.cmd -g=square128.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=squareG128O4.show -solveri=yale -icshow=squareG128O4.show -go=fk

cgwh -noplot gaussian.cmd -g=square128.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=squareG128O4.show -solveri=yale -icshow=squareG64O4.show -go=fks




READ ON FINER GRID 
cgwh  gaussian.cmd -g=square128.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=squareG128O4.show -solveri=yale -icshow=squareG64O4.show -go=halt



READ ON FINER GRID 
cgwh  gaussian.cmd -g=square64.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=squareG64O4.show -solveri=yale -icshow=squareG32O4.show -go=halt

Read:
cgwh  gaussian.cmd -g=square32.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=squareG32O4.show -solveri=yale -icshow=squareG32O4.show -go=halt


Create a show file
cgwh -noplot gaussian.cmd -g=square32.order4 -ts=implicit -cfl=10000 -x0=0.5 -y0=0.5 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=2 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=squareG32O4.show -solveri=yale -go=og



plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq149 -comp=absv -emin=0 -emax=1

plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq200 -comp=absv -emin=0 -emax=1

tipGridSmallG64Order4EigsEv2048.show

setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=200 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG64Order4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=128 -eigTol=1.0e-5 -matlab=tipGridSmallG64O4Freq200 -show=tipGridSmallG64O4Freq200.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dfks > tipGridSmallG64O4Freq200.out


FOR COMPARISON TO G128 solution
G64 DEFLATE: freq=149 Np=8 !! gaussian2/ .. amp=11000
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-11000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=149 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG64Order4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=tipGridSmallG64O4Freq149Deflate64 -show=tipGridSmallG64O4Freq149.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dfks > tipGridSmallG64O4Freq149Deflate64.out

****************************************************
****** Tues July 30, 2024

TEST HIGHER FREQ: 

plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq300 -comp=absv -emin=0 -emax=1
plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq200 -comp=absv -emin=0 -emax=1

G128: 
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle128.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=200 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG64Order4EigsEv512.show -deflateWaveHoltz=0 -numToDeflate=64  -matlab=tipGridSmallG128O4Freq200 -show=tipGridSmallG128O4Freq200.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dks > tipGridSmallG128O4Freq200.out



FUNNY: solution looks like f ??? ---> NEED TO ITERATE MUCH LONGER
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=300 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG64Order4EigsEv512.show -deflateWaveHoltz=0 -numToDeflate=64  -matlab=tipGridSmallG64O4Freq300 -show=tipGridSmallG64O4Freq300.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dks > tipGridSmallG64O4Freq300.out


freq=200: FUNNY: solution looks like f ???
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=10000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-15000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=200 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG64Order4EigsEv512.show -deflateWaveHoltz=0 -numToDeflate=64  -matlab=tipGridSmallG64O4Freq200 -show=tipGridSmallG64O4Freq200.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dks > tipGridSmallG64O4Freq200.out


****************************************************
****** Fri April 26, 2024

**RE DO GRID --> SMALLER GAP

plotStuff plotSolution.cmd -show=tipGridSmallG128O4Freq149.show -comp=absv -emin=0 -emax=0.7
plotStuff plotSolution.cmd -show=tipGridSmallG128O4Freq112.show -comp=absv -emin=0 -emax=1

plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq120 -solution=1 -comp=absv -emin=0 -emax=1
plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq100 -solution=1 -comp=absv -emin=0 -emax=1
plotStuff plotSolution.cmd -show=tipGridSmallG32O4Freq80 -solution=1 -comp=absv -emin=0 -emax=1



G64 O4 freq=100 : no deflation gaussian2
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-7000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=100 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG64Order4EigsEv512.show -deflateWaveHoltz=0 -numToDeflate=64  -matlab=tipGridSmallG64O4Freq100 -show=tipGridSmallG64O4Freq100.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=fks > tipGridSmallG64O4Freq100.out

--> 
G128 DEFLATE: freq=149 Np=8 !! gaussian/ .. redo amp=11000
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle128.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-11000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=149 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG128Order4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=tipGridSmallG128O4Freq149Deflate64 -show=tipGridSmallG128O4Freq149.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=fks > tipGridSmallG128O4Freq149Deflate64.out



--> MAYBE REDO WITH LOWER NP ? 
G128 DEFLATE: Np=16 gaussian2/
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle128.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-6000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=112 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG128Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=tipGridSmallG128O4Freq112Deflate64 -show=tipGridSmallG128O4Freq112.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dfks > tipGridSmallG128O4Freq112Deflate64.out



DEFLATE:
$cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-2000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=100 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG64Order4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=tipGridSmallG64O4Freq100Deflate64 -show=tipGridSmallG64O4Freq100.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dfks > tipGridSmallG64O4Freq100Deflate64.out


NO DEFLATE:
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-2000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=100 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/tipGridSmallG64Order4EigsEv512.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -matlab=tipGridSmallG64O4Freq100 -show=tipGridSmallG64O4Freq100.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dfks > tipGridSmallG64O4Freq100.out



G64 O4 freq=100 : 
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-7000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=100 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -matlab=tipGridSmallG64O4Freq100 -show=tipGridSmallG64O4Freq100.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dks > tipGridSmallG64O4Freq100.out

G32 O4 freq=80 : 
cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -matlab=tipGridSmallG32O4Freq80 -show=tipGridSmallG32O4Freq80.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dks > tipGridSmallG32O4Freq80.out

****************************************************
****** Thurs April 25, 2024

START knifeEdge example

plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq120 -solution=1 -comp=absv -emin=0 -emax=1
plotStuff plotSolution.cmd -show=tipGridSmallG64O4Freq100 -solution=1 -comp=absv -emin=0 -emax=3.5
plotStuff plotSolution.cmd -show=tipGridSmallG32O4Freq80 -solution=1 -comp=absv -emin=0 -emax=1


ogen -noplot tipGrid -prefix=tipGridSmall -xa=-0.5 -xb=.5 -yb=0.6 -w=.02 -interp=e -order=4 -numGhost=3 -factor=16
ogen -noplot tipGrid -prefix=tipGridSmall -xa=-0.5 -xb=.5 -yb=0.6 -w=.02 -interp=e -order=4 -numGhost=3 -factor=32
ogen -noplot tipGrid -prefix=tipGridSmall -xa=-0.5 -xb=.5 -yb=0.6 -w=.02 -interp=e -order=4 -numGhost=3 -factor=64


++++ SMALLER DOMAIN:



G64 O4 freq=120 : **re do**
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-10000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=120 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -matlab=tipGridSmallG64O4Freq120 -show=tipGridSmallG64O4Freq120.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dks > tipGridSmallG64O4Freq120.out

G64 O4 freq=100 : 
setsid $cgwh -noplot gaussian.cmd -g=tipGridSmalle64.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-10000 -beta=40 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=100 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -matlab=tipGridSmallG64O4Freq100 -show=tipGridSmallG64O4Freq100.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dks > tipGridSmallG64O4Freq100.out



G32 O4 freq=80 : 
cgwh -noplot gaussian.cmd -g=tipGridSmalle32.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.2 -y0=0.2 -nf=1 -amp=-5000 -beta=25 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -matlab=tipGridSmallG32O4Freq80 -show=tipGridSmallG32O4Freq80.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=dks > tipGridSmallG32O4Freq80.out


CgWave::getTimeStep: c=1, cfl=1000, timeSteppingMethod=1
getTimeStep: grid=0 : dx= 3.13e-03, dy= 3.12e-03, gridSize= 2.21e-03, dt=2.210e+00
getTimeStep: grid=1 : dx= 3.13e-03, dy= 3.12e-03, gridSize= 2.21e-03, dt=2.210e+00
getTimeStep: grid=2 : dx= 3.13e-03, dy= 3.12e-03, gridSize= 2.21e-03, dt=2.210e+00
getTimeStep: grid=3, dxMin= 1.16e-04, dxMax= 1.99e-03, gridSize= 1.16e-04, dt=1.159e-01

 >>>>chooseTimeStep: implicit-time-stepping: all grids implicit: choose c*dt/dxMin = cfl, or dt=dtMax: setting dt= 1.00e-01, dtMax= 1.00e+00, cfl=1000

getTimeStep: grid=0: gridSize=  2.21e-03, gridCFL*dt=c*dt/gridSize=  4.54e+01
getTimeStep: grid=1: gridSize=  2.21e-03, gridCFL*dt=c*dt/gridSize=  4.54e+01
getTimeStep: grid=2: gridSize=  2.21e-03, gridCFL*dt=c*dt/gridSize=  4.54e+01
getTimeStep: grid=3: gridSize=  1.16e-04, gridCFL*dt=c*dt/gridSize=  8.66e+02
CgWave::initialize: dt=0.100396





++++ INITIAL DOMAIN

G16 O4 freq=80 : 
cgwh -noplot gaussian.cmd -g=../../cgWave/scattering/tipGride16.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.25 -y0=0.25 -nf=1 -amp=-500 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=16 -freq=80 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=tipGridG16O4Freq80 -show=tipGridG16O4Freq80.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=og 

G16 O4 freq=15 : 
cgwh -noplot gaussian.cmd -g=../../cgWave/scattering/tipGride16.order4.ng3.hdf -ts=implicit -cfl=1000 -x0=-0.25 -y0=0.25 -nf=1 -amp=-500 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=16 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=tipGridG16O4Freq15 -show=tipGridG16O4Freq15.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=og  



G8 O2 : OK 
cgwh -noplot gaussian.cmd -g=../../cgWave/scattering/tipGride8.order2.hdf -ts=implicit -cfl=1000 -x0=-0.25 -y0=0.25 -nf=1 -amp=-500 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=16 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=tipGridG8O2Freq10 -show=tipGridG8O2Freq10.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=og  


****************************************************
****** Tues April 23, 2024

START TEST PARALLEL

mpirun -np 2 $cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=best -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -go=og 




mpiexec -n 2 xterm -e gdb --args $cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=best -rtoli=1e-10 -atoli=1e-10 -orderOfExtrapolation=4 -go=og 

Starts to work -- check maxRes and plot of v0 
mpirun -np 2 $cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=best -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -orderOfExtrapolation=4 -go=og 

np=1: 
*** freq=0: omega=5.1, max residual=1.16e-08, time for direct Helmholtz solve = 3.28e-02 (s) (iterations=10) ***
CgWaveHoltz::residual: grid=0 : maxRes= 5.38e-08
CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=5.376e-08.
CgWaveHoltz: omega=5.100e+00, max-res=5.376e-08 (direct Helmholtz solution)
cgwh: max-err =0.00e+00 (between WaveHoltz and known solution, all frequencies)

np=2: 
*** freq=0: omega=5.1, max residual=6.55e-08, time for direct Helmholtz solve = 5.05e-02 (s) (iterations=21) ***
CgWaveHoltz::residual: grid=0 : maxRes= 7.27e-02
CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=7.271e-02.
CgWaveHoltz: omega=5.100e+00, max-res=7.271e-02 (direct Helmholtz solution)
cgwh: max-err =0.00e+00 (between WaveHoltz and known solution, all frequencies)



mpirun -np 2 $cgwh -noplot gaussian.cmd -g=square16.order2 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=best -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-14 -atolh=1.0e-14 -go=og 

*** freq=0: omega=5.1, max residual=1.24e-12, time for direct Helmholtz solve = 8.68e-03 (s) (iterations=12) ***
CgWaveHoltz::residual: grid=0 : maxRes= 7.49e-10
CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=7.490e-10.
CgWaveHoltz: omega=5.100e+00, max-res=7.490e-10 (direct Helmholtz solution)
cgwh: max-err =0.00e+00 (between WaveHoltz and known solution, all frequencies)



mpirun -np 1 $cgwh -noplot gaussian.cmd -g=square8.order2 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=best -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=og 

np=1
------ grid 0 ------
      (    -2) (    -1) (     0) (     1) (     2) (     3) (     4) (     5) (     6) (     7) (     8) (     9) (    10) 
( -2)   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000 
( -1)   0.0000  -5.1158   0.0000  29.4171  53.3277  67.7953  71.1882  63.8350  47.5764  25.2815   0.0000  -4.2365   0.0000 
(  0)   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000 
(  1)   0.0000  29.4171   0.0000 -24.4491 -43.9303 -54.9606 -56.5205 -49.8643 -37.0228 -19.7519   0.0000  22.2328   0.0000 
(  2)   0.0000  53.3277   0.0000 -43.9303 -78.4633 -97.0864 -98.3734 -85.7578 -63.4921 -33.9741   0.0000  38.4303   0.0000 
(  3)   0.0000  67.7953   0.0000 -54.9606 -97.0864 -117.5040 -115.2876 -97.8879 -72.2429 -39.0659   0.0000  44.9549   0.0000 
(  4)   0.0000  71.1882   0.0000 -56.5205 -98.3734 -115.2876 -107.3963 -87.1587 -64.1880 -35.5009   0.0000  42.3145   0.0000 
(  5)   0.0000  63.8350   0.0000 -49.8643 -85.7578 -97.8879 -87.1587 -67.7009 -49.6304 -27.9961   0.0000  34.3578   0.0000 
(  6)   0.0000  47.5764   0.0000 -37.0228 -63.4921 -72.2429 -64.1880 -49.6304 -35.9962 -20.1201   0.0000  24.3642   0.0000 
(  7)   0.0000  25.2815   0.0000 -19.7519 -33.9741 -39.0659 -35.5009 -27.9961 -20.1201 -10.9996   0.0000  12.8785   0.0000 
(  8)   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000 
(  9)   0.0000  -4.2365   0.0000  22.2328  38.4303  44.9549  42.3145  34.3578  24.3642  12.8785   0.0000  -2.9975   0.0000 
( 10)   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000 

*** freq=0: omega=5.1, max residual=3.86e-10, time for direct Helmholtz solve = 5.91e-03 (s) (iterations=2) ***
CgWaveHoltz::residual: grid=0 : maxRes= 8.54e-09
CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=8.538e-09.



np=2: 
------ grid 0 ------
      (    -2) (    -1) (     0) (     1) (     2) (     3) (     4) (     5) (     6) (     7) (     8) (     9) (    10) 
( -2)   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000 
( -1)   0.0000  -5.1158   0.0000  29.4171  53.3277  67.7953  71.1882  63.8350  47.5764  25.2815   0.0000  -4.2365   0.0000 
(  0)   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000 
(  1)   0.0000  29.4171   0.0000 -24.4491 -43.9303 -54.9606 -56.5205 -49.8643 -37.0228 -19.7519   0.0000  22.2328   0.0000 
(  2)   0.0000  53.3277   0.0000 -43.9303 -78.4633 -97.0864 -98.3734 -85.7578 -63.4921 -33.9741   0.0000  38.4303   0.0000 
(  3)   0.0000  67.7953   0.0000 -54.9606 -97.0864 -117.5040 -115.2876 -97.8879 -72.2429 -39.0659   0.0000  44.9549   0.0000 
(  4)   0.0000  71.1882   0.0000 -56.5205 -98.3734 -115.2876 -107.3963 -87.1587 -64.1880 -35.5009   0.0000  42.3145   0.0000 
(  5)   0.0000  63.8350   0.0000 -49.8643 -85.7578 -97.8879 -87.1587 -67.7009 -49.6304 -27.9961   0.0000  34.3578   0.0000 
(  6)   0.0000  47.5764   0.0000 -37.0228 -63.4921 -72.2429 -64.1880 -49.6304 -35.9962 -20.1201   0.0000  24.3642   0.0000 
(  7)   0.0000  25.2815   0.0000 -19.7519 -33.9741 -39.0659 -35.5009 -27.9961 -20.1201 -10.9996   0.0000  12.8785   0.0000 
(  8)   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000 
(  9)   0.0000  -4.2365   0.0000  22.2328  38.4303  44.9549  42.3145  34.3578  24.3642  12.8785   0.0000  -2.9975   0.0000 
( 10)   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000 

*** freq=0: omega=5.1, max residual=1.36e-09, time for direct Helmholtz solve = 7.72e-03 (s) (iterations=12) ***
CgWaveHoltz::residual: grid=0 : maxRes= 3.09e-08
CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=4.349e-08.
CgWaveHoltz: omega=5.100e+00, max-res=4.349e-08 (direct Helmholtz solution)
**************************************
****** Mon July 22, 2024


plotStuff plotSolution.cmd -show=darkCornerRoomFreq40G16O4Xm1p4Ym5p6 -solution=1 -comp=absv -emin=0 -emax=1



... still running: ... done
G16 O4 FREQ=40 gaussian3/
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=400 -numPeriods=16 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G16O4Xm1p4Ym5p6 -show=darkCornerRoomFreq40G16O4Xm1p4Ym5p6.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq40G16O4Xm1p4Ym5p6.out

 ##### SAVE KRYLOV RESIDUAL: iteration=23: L2h-residual= 3.25e-05 
 ##### SAVE KRYLOV RESIDUAL: iteration=39: L2h-residual= 1.69e-05 
##### SAVE KRYLOV RESIDUAL: iteration=59: L2h-residual= 1.03e-05 
##### SAVE KRYLOV RESIDUAL: iteration=176: L2h-residual= 8.11e-07
##### SAVE KRYLOV RESIDUAL: iteration=252: L2h-residual= 2.10e-07
##### SAVE KRYLOV RESIDUAL: iteration=323: L2h-residual= 6.86e-08
##### SAVE KRYLOV RESIDUAL: iteration=399: L2h-residual= 3.11e-08 
######## DONE KYRLOV ITERATIONS -- KSP residual=3.06e-08 (max-res=1.77e-07) (tol=1.00e-10) numIts=401 #######


**************************************
****** Sun July 21, 2024


>>>> Make a movie of the WaveHoltz solutions as a function of iteration

cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=2 -y0=3 -nf=1 -amp=-1000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=2 -freq=20 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq20 -show=darkCornerRoomFreq20.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=og





TEST OUT MULTIGRID SOLVER

ADD orderOfExtrapolation to : HelmholtzSolver to match MG

OGMG: 
Discrete boundary conditions: B=boundary, G1=ghost-1, G2=ghost-2, extrapN=extrap to order N
  Dirichlet: l=0 : B=D,    G1=extrap4 , G2=extrap4 
           : l>0 : B=D,    G1=extrap4 , G2=extrap4 
  Neumann  : l=0 : B=PDE,  G1=N4      , G2=extrap5 
           : l>0 : B=PDE,  G1=N2      , G2=N2      
 Corner BC: l=0 : taylor4  , l>0 taylor4  


 ++++++++ TEST VARIABLE TOLERANCE +++++++++

 ***THIS DOES NOT SEEM TO WORK -- KYRLOV SEEMS TO NEED ACCURATE Matrix-vector multiplies!!


cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=best -rtoli=1e-10 -atoli=1e-10 -useVariableTolerance=1 -orderOfExtrapolation=4 -go=og 


++++++ BI-CG_STAB

cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=best -rtoli=1e-10 -atoli=1e-10 -orderOfExtrapolation=4 -go=og

solveHelmholtz: rel-max-diff=7.87e-12, |v|_max= 1.23e+02 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


++++++++++ MULTIGRID

MG order=4 : NOW ORDER FOUR MG MATCHES DIRECT HELMHOLTZ
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -orderOfExtrapolation=4 -go=og 

CgWaveHoltz::residual: grid=0 : maxRes= 1.62e-09
CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=1.619e-09.
solveHelmholtz: max-res=1.619e-09 (all frequencies)
solveHelmholtz: rel-max-diff=5.73e-13, |v|_max= 1.23e+02 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

MG order=4 BC's not the same!
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -bcApproach=cbc -go=og  


MG Order=2 matches:
cgwh -noplot gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=multigrid -rtoli=1e-10 -atoli=1e-10  -go=og  

CgWaveHoltz::residual: grid=0 : maxRes= 1.34e-09
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=1.338e-09.
solveHelmholtz: max-res=1.338e-09 (all frequencies)
solveHelmholtz: rel-max-diff=8.91e-15, |v|_max= 2.93e+02 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


++++ YALE: 
cgwh -noplot gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.6 -y0=0.6 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=1 -freq=5.1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=junk -show=junk.show -solveri=yale -rtoli=1e-10 -atoli=1e-10 -go=og ks 


CgWaveHoltz::residual: grid=0 : maxRes= 7.09e-09
CgWaveHoltz::residual: freq= 0, omega=  10.000, max-res=7.090e-09.
solveHelmholtz: max-res=7.090e-09 (all frequencies)
solveHelmholtz: rel-max-diff=2.59e-14, |v|_max= 3.29e+02 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


++++++++++ MULTIGRID
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.ml2.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=1 -freq=20 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq20 -show=darkCornerRoomFreq20.show -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=ks 

CgWave::takeImplicitStep: implicit solve: t= 3.44e-02 max-res= 9.67e-11 (iterations=7) ***
CgWave::takeImplicitStep: implicit solve: t= 6.87e-02 max-res= 1.06e-11 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 1.03e-01 max-res= 3.38e-11 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 1.37e-01 max-res= 2.88e-11 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 1.72e-01 max-res= 7.13e-12 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 2.06e-01 max-res= 9.77e-11 (iterations=7) ***
CgWave::takeImplicitStep: implicit solve: t= 2.40e-01 max-res= 1.02e-10 (iterations=7) ***
CgWave::takeImplicitStep: implicit solve: t= 2.75e-01 max-res= 1.11e-11 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 3.09e-01 max-res= 9.37e-12 (iterations=8) ***
cgWave:FD24 t=3.092e-01 ( 9 steps) dt=3.436e-02 ||u||= 8.23e+00, cpu= 1.15e+01(s)
CgWave::takeImplicitStep: implicit solve: t= 3.44e-01 max-res= 6.61e-11 (iterations=7) ***
cgWave:FD24 t=3.436e-01 (10 steps) dt=3.436e-02 ||u||= 8.63e+00, cpu= 1.22e+01(s)

CgWave::takeImplicitStep: implicit solve: t= 3.44e-02 max-res= 9.66e-11 (iterations=7) ***
CgWave::takeImplicitStep: implicit solve: t= 6.87e-02 max-res= 1.06e-11 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 1.03e-01 max-res= 3.37e-11 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 1.37e-01 max-res= 2.87e-11 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 1.72e-01 max-res= 7.12e-12 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 2.06e-01 max-res= 9.77e-11 (iterations=7) ***
CgWave::takeImplicitStep: implicit solve: t= 2.40e-01 max-res= 1.02e-10 (iterations=7) ***
CgWave::takeImplicitStep: implicit solve: t= 2.75e-01 max-res= 1.11e-11 (iterations=8) ***
CgWave::takeImplicitStep: implicit solve: t= 3.09e-01 max-res= 9.37e-12 (iterations=8) ***
cgWave:FD24 t=3.092e-01 ( 9 steps) dt=3.436e-02 ||u||= 8.23e+00, cpu= 6.34e+00(s)
CgWave::takeImplicitStep: implicit solve: t= 3.44e-01 max-res= 6.61e-11 (iterations=7) ***
cgWave:FD24 t=3.436e-01 (10 steps) dt=3.436e-02 ||u||= 8.63e+00, cpu= 6.98e+00(s)

cgWave:FD24 t=1.254e+00 (73 steps) dt=1.718e-02 ||u||= 7.70e-01, cpu= 1.12e+02(s)
cgWave:FD24 t=1.374e+00 (80 steps) dt=1.718e-02 ||u||= 1.79e+00, cpu= 1.19e+02(s)

cgWave:FD24 t=1.254e+00 (73 steps) dt=1.718e-02 ||u||= 7.70e-01, cpu= 1.04e+02(s)
cgWave:FD24 t=1.374e+00 (80 steps) dt=1.718e-02 ||u||= 1.79e+00, cpu= 1.11e+02(s)


cgWave:FD24 t=1.254e+00 (73 steps) dt=1.718e-02 ||u||= 7.69e-01, cpu= 5.83e+01(s)
cgWave:FD24 t=1.374e+00 (80 steps) dt=1.718e-02 ||u||= 1.79e+00, cpu= 6.35e+01(s)


++++++++++ BI-CG_STAB
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.ml2.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-2000 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=1 -freq=20 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq20 -show=darkCornerRoomFreq20.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks 

CgWave::takeImplicitStep: implicit solve: t= 3.44e-02 max-res= 5.57e-14 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 6.87e-02 max-res= 1.62e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 1.03e-01 max-res= 4.66e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 1.37e-01 max-res= 4.81e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 1.72e-01 max-res= 7.43e-09 (iterations=2) ***
CgWave::takeImplicitStep: implicit solve: t= 2.06e-01 max-res= 6.96e-09 (iterations=2) ***
CgWave::takeImplicitStep: implicit solve: t= 2.40e-01 max-res= 3.47e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 2.75e-01 max-res= 9.54e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 3.09e-01 max-res= 9.29e-13 (iterations=3) ***
cgWave:FD24 t=3.092e-01 ( 9 steps) dt=3.436e-02 ||u||= 8.23e+00, cpu= 7.26e+00(s)
CgWave::takeImplicitStep: implicit solve: t= 3.44e-01 max-res= 1.03e-08 (iterations=2) ***
cgWave:FD24 t=3.436e-01 (10 steps) dt=3.436e-02 ||u||= 8.63e+00, cpu= 7.63e+00(s)


CgWave::takeImplicitStep: implicit solve: t= 3.44e-02 max-res= 5.57e-14 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 6.87e-02 max-res= 1.62e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 1.03e-01 max-res= 4.66e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 1.37e-01 max-res= 4.81e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 1.72e-01 max-res= 7.43e-09 (iterations=2) ***
CgWave::takeImplicitStep: implicit solve: t= 2.06e-01 max-res= 6.96e-09 (iterations=2) ***
CgWave::takeImplicitStep: implicit solve: t= 2.40e-01 max-res= 3.47e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 2.75e-01 max-res= 9.54e-13 (iterations=3) ***
CgWave::takeImplicitStep: implicit solve: t= 3.09e-01 max-res= 9.29e-13 (iterations=3) ***
cgWave:FD24 t=3.092e-01 ( 9 steps) dt=3.436e-02 ||u||= 8.23e+00, cpu= 4.08e+00(s)
CgWave::takeImplicitStep: implicit solve: t= 3.44e-01 max-res= 1.03e-08 (iterations=2) ***
cgWave:FD24 t=3.436e-01 (10 steps) dt=3.436e-02 ||u||= 8.63e+00, cpu= 4.45e+00(s)

**************************************
****** Sat July 20, 2024

plotStuff plotSolution.cmd -show=darkCornerRoomFreq40G8O4Xm1p4Ym5p6 -solution=1 -comp=absv -emin=0 -emax=1


*** FIX FILTER ALPHA FOR FINITE dt

New: a bit faster :)

cgwh -noplot gaussian.cmd -g=square64.order2 -x0=0.4 -y0=0.4 -nf=1 -freq=5.1 -amp=100 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=1000 -minStepsPerPeriod=5 -go=og

++NEW
it=56:  l2Norm( v-vOld )=7.40e-09 (tol=1e-08)
###### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =57 ######

CgWaveHoltz::residual: grid=0 : maxRes= 2.62e-07
CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=2.616e-07.
solveHelmholtz: max-res=2.616e-07 (all frequencies)
solveHelmholtz: rel-max-diff=2.26e-08, |v|_max= 1.85e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




+++ OLD
it=58:  l2Norm( v-vOld )=8.07e-09 (tol=1e-08)
###### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =59 ######


CgWaveHoltz::residual: grid=0 : maxRes= 3.00e-07
CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=2.998e-07.
solveHelmholtz: max-res=2.998e-07 (all frequencies)
solveHelmholtz: rel-max-diff=2.59e-08, |v|_max= 1.85e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





G8 O4 FREQ=40 gaussian3/
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-2000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=400 -numPeriods=16 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G8O4Xm1p4Ym5p6 -show=darkCornerRoomFreq40G8O4Xm1p4Ym5p6.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq40G8O4Xm1p4Ym5p6.out

##### SAVE KRYLOV RESIDUAL: iteration=50: L2h-residual= 1.48e-05 
##### SAVE KRYLOV RESIDUAL: iteration=107: L2h-residual= 2.52e-06
##### SAVE KRYLOV RESIDUAL: iteration=138: L2h-residual= 6.08e-07 
##### SAVE KRYLOV RESIDUAL: iteration=399: L2h-residual= 4.41e-09 

**************************************
****** Fri July 19, 2024

START ON HIGH FREQ PLOT:

plotStuff plotSolution.cmd -show=darkCornerRoomFreq30G8O4X3Y3 -name=darkCornerRoomFreq30G8O4X3Y3 -solution=1 -comp=absv
plotStuff plotSolution.cmd -show=darkCornerRoomFreq30G16O4 -name=darkCornerRoomFreq30G16O4 -solution=1 -comp=absv

+++ INNER SOURCE 

G8 O4 omega=40  maxit=100 **NEXT TIME: INCREASE AMP BY 2 1000 --> 2000 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=400 -numPeriods=16 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq40G8O4X3Y3 -show=darkCornerRoomFreq40G8O4X3Y3.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq40G8O4X3Y3.out

##### SAVE KRYLOV RESIDUAL: iteration=99: L2h-residual= 1.48e-06 

Np=16:
##### SAVE KRYLOV RESIDUAL: iteration=133: L2h-residual= 1.13e-06 
##### SAVE KRYLOV RESIDUAL: iteration=195: L2h-residual= 7.05e-07 
 ##### SAVE KRYLOV RESIDUAL: iteration=251: L2h-residual= 5.99e-07 

##### SAVE KRYLOV RESIDUAL: iteration=365: L2h-residual= 4.29e-07 
 ##### SAVE KRYLOV RESIDUAL: iteration=399: L2h-residual= 4.10e-07 

G8 O4 omega=30  maxit=200 changes from maxit=400 .. still changing
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=3 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=400 -numPeriods=4 -freq=30 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10  -matlab=darkCornerRoomFreq30G8O4X3Y3 -show=darkCornerRoomFreq30G8O4X3Y3.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq30G8O4X3Y3.out


 ##### SAVE KRYLOV RESIDUAL: iteration=99: L2h-residual= 1.01e-05 
 ##### SAVE KRYLOV RESIDUAL: iteration=199: L2h-residual= 3.48e-06 
##### SAVE KRYLOV RESIDUAL: iteration=400: L2h-residual= 1.64e-06 


+++++++
G16 O4 omega=30 increase -> Np=16 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=16 -freq=30 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq30G16O4 -show=darkCornerRoomFreq30G16O4.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq30G16O4.out

##### SAVE KRYLOV RESIDUAL: iteration=190: L2h-residual= 3.08e-06 

##### SAVE KRYLOV RESIDUAL: iteration=200: L2h-residual= 3.05e-06

Np=16:

 ##### SAVE KRYLOV RESIDUAL: iteration=29: L2h-residual= 1.05e-04 
 ##### SAVE KRYLOV RESIDUAL: iteration=39: L2h-residual= 5.84e-05 

Test bicg-stab + bigger ilu
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.ml3.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=8 -freq=30 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -ilui=20 -go=ks

+++ILU=40
cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 1.26e+03(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 1.31e+03(s)

cgWave:FD24 t=0.000e+00 ( 0 steps) dt=2.290e-02 ||u||= 0.00e+00, cpu= 1.00e-06(s)
cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 6.74e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 7.21e+02(s)

++++ ILU(20)
=== Implicit Time-Stepping Solver:
 PETSc, solver=[bi-conjugate gradient stabilized + ILU(20) + reverse Cuthill-McKee ordering]
 =====
CgWave::implicitSolver: A = I -alpha (c*dt)^2 Delta, c=1, dt= 2.29e-02
>>>>cgWave::INFO: impSolver is iterative, we need a separate RHS.
cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 4.80e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 5.05e+02(s)

cgWave:FD24 t=0.000e+00 ( 0 steps) dt=2.290e-02 ||u||= 0.00e+00, cpu= 1.00e-06(s)
cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 3.28e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 3.53e+02(s)

cgWave:FD24 t=0.000e+00 ( 0 steps) dt=2.290e-02 ||u||= 4.13e-02, cpu= 0.00e+00(s)
cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.51e+00, cpu= 2.63e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.05e+00, cpu= 2.88e+02(s)

+++ ILU(10)

cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 3.13e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 3.35e+02(s)

cgWave:FD24 t=0.000e+00 ( 0 steps) dt=2.290e-02 ||u||= 0.00e+00, cpu= 1.00e-06(s)
cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 2.68e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 2.89e+02(s)

+++ ILU(5)
cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 2.26e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 2.43e+02(s)

cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 2.08e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 2.25e+02(s)

++++ ILU(4)

cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 2.36e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 2.55e+02(s)


++++ ILU(3)

cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 2.07e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 2.24e+02(s)

cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 1.95e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 2.12e+02(s)



++++ ILU(2)
cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 2.06e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 2.23e+02(s)

cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 2.02e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 2.20e+02(s)

**************************************
****** Thurs July 18, 2024

+++++++++++++++++++++++++++++++++++++++++++++++++++++
Longer run in runs/gaussian2/

G16 O4 omega=30 increase -> Np=16 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=200 -numPeriods=16 -freq=30 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq30G16O4 -show=darkCornerRoomFreq30G16O4.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq30G16O4.out
++++++++++++++++++++++++++++++++++++++++++++++++++++++


RE-VISIT SOUND PROOF ROOM -- higher frequency

(1) Add multigrid

(2) how big a grid can we do a direct solver?
    G8 : OK for Yale


G16 O4 omega=30 --TRY MG SOLVER
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.ml3.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=8 -freq=30 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq30G16O4 -show=darkCornerRoomFreq30G16O4mg.show -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq30G16O4.out

cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 2.81e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 3.03e+02(s)


----- BUT WHAT TOLERANCE ? See above
 === Implicit Time-Stepping Solver:
 PETSc, solver=[bi-conjugate gradient stabilized + ILU(3) + reverse Cuthill-McKee ordering]
 =====

 >>>>>>> CgWave::implicitSolver: use predfined equations <<<<<<< 

CgWave::implicitSolver: A = I -alpha (c*dt)^2 Delta, c=1, dt= 2.29e-02
>>>>cgWave::INFO: impSolver is iterative, we need a separate RHS.
cgWave:FD24 t=1.672e+00 (73 steps) dt=2.290e-02 ||u||= 1.52e+00, cpu= 1.95e+02(s)
cgWave:FD24 t=1.832e+00 (80 steps) dt=2.290e-02 ||u||= 2.06e+00, cpu= 2.10e+02(s)


G8 O4  force near an eigenmode: 2.903. 5.5604
CAN WE USE A DIRECT SOLVER FOR IMPLICIT?
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-3 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5  -matlab=darkCornerRoomFreq15Np8G8O4X0Y1 -show=darkCornerRoomFreq15Np8G8O44X0Y1.show -go=ks > darkCornerRoomFreq15Np86G8O4X0Y1.out


G4 O4 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-3 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5 -go=ks 



***************************************************
****** Sun July 14, 2024

High freq example

G32 freq=40 ? Np=64 ran 10 iterations OK .. can we use multigrid?

setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride32.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=10 -numPeriods=64 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq40G32O4 -show=darkCornerRoomFreq40G32O4.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq40G32O4.out

##### SAVE KRYLOV RESIDUAL: iteration=5: L2h-residual= 2.54e-04 

 ##### SAVE KRYLOV RESIDUAL: iteration=7: L2h-residual= 1.78e-04 
 ##### SAVE KRYLOV RESIDUAL: iteration=8: L2h-residual= 1.54e-04 
 cgWave:FD24 t=0.000e+00 (  0 steps) dt=1.536e-02 ||u||= 3.75e-03, cpu= 1.00e-06(s)
cgWave:FD24 t=1.006e+01 (655 steps) dt=1.536e-02 ||u||= 8.36e-01, cpu= 7.92e+03(s)
cgWave:FD24 t=1.055e+01 (687 steps) dt=1.536e-02 ||u||= 8.79e-01, cpu= 8.31e+03(s)
cgWave:FD24 t=1.081e+01 (704 steps) dt=1.536e-02 ||u||= 8.92e-01, cpu= 8.51e+03(s)
RESET periodArray
freq=0: periodArray=  1.0053e+01

 ##### SAVE KRYLOV RESIDUAL: iteration=9: L2h-residual= 1.33e-04 

***************************************************
****** Sat July 13, 2024


ADD option for other Krylov solvers and option to set gmres restart length

cgwh -noplot gaussian.cmd -g=sice4.order4.ml2 -x0=-0.2 -y0=-0.3 -nf=1 -freq=10 -amp=-200 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=yale -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -eigenVectorFile=/home/henshw/runs/eig/sice4Order4ml2EigsEv256.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-6 -krylovType=bicgstab -go=og


GMRES: 
------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Real Solution 

 grid=/home/henshw/grids/sice4.order4.ml2.hdf
 Convergence rate CR=0.618, CR-perPeriod=0.786, Time to solve = 1.36e+00(s) : CgWave= 1.33e+00(s) 98.05%, advance= 1.31e+00(s) 96.57%
 max-residual=2.47e-10 (WaveHoltz its), numberOfIterations = 45 (Krylov) (maximumNumberOfIterations=50)

***************************************************
****** Wed Jul 10, 2024

START ON HIGH FREQ EXAMPLE FOR DANIEL


G16 O4 omega=30 -- sort of working, needs more iterations
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=8 -freq=30 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq30G16O4 -show=darkCornerRoomFreq30G16O4.show -solveri="choose best iterative solver" -rtoli=1e-10 -atoli=1e-10 -go=ks > darkCornerRoomFreq30G16O4.out


------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Real Solution 

 grid=/home/henshw/grids/darkCornerRoomGride16.order4.hdf
 Convergence rate CR=0.779, CR-perPeriod=0.939, Time to solve = 1.33e+03(s) : CgWave= 1.32e+03(s) 99.68%, advance= 1.32e+03(s) 99.64%
 max-residual=3.94e-04 (WaveHoltz its), numberOfIterations = 21 (Krylov) (maximumNumberOfIterations=20)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1



G16 : beta=15 freq=30
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=3 -numPeriods=2 -freq=30 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -solveri="choose best iterative solver" -rtoli=1e-5 -atoli=1e-5 -go=og


***************************************************
****** Sat July 6, 2024

# ============ DISK WITH MULTIGRID ===============

$$$$$$$$$$$ Order=4 $$$$$$$$$$$

CHANGES TO MAKE: amp=-400 numToDeflate=16


plotStuff plotSolution.cmd -show=diskFreq20G64O4.show -name=diskFreq20G64O4 -solution=1
plotStuff plotSolution.cmd -show=diskFreq20G32O4.show -name=diskFreq20G32O4 -solution=1
plotStuff plotSolution.cmd -show=diskFreq20G16O4.show -name=diskFreq20G16O4 -solution=1
plotStuff plotSolution.cmd -show=diskFreq20G8O4.show -name=diskFreq20G8O4 -solution=1

-----------------
G8: deflate 16 -- freq=20 
cgwh -noplot gaussian.cmd -g=sice8.order4.ml3 -x0=-0.2 -y0=-0.3 -nf=1 -freq=20 -amp=-400 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=150 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -eigenVectorFile=/home/henshw/runs/eig/sice8Order4ml3EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=32 -eigTol=1.0e-6 -matlab=sice8Freq20Deflate32 -go=dfk > sice8Freq20Deflate32.out



---------------
G32: deflate -- freq=20 
cgwh -noplot gaussian.cmd -g=sice32.order4.ml4 -x0=-0.2 -y0=-0.3 -nf=1 -freq=20 -amp=-200 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -eigenVectorFile=/home/henshw/runs/eig/sice32Order4ml4EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-6 -matlab=sice32Freq20Deflate64 -go=og


---------------
G16: deflate -- freq=20 
setsid $cgwh -noplot gaussian.cmd -g=sice16.order4.ml4 -x0=-0.2 -y0=-0.3 -nf=1 -freq=20 -amp=-200 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=300 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -eigenVectorFile=/home/henshw/runs/eig/sice16Order4ml4EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-6 -matlab=sice16Freq20Deflate64 -go=d 

Convergence rate CR=0.120, CR-perPeriod=0.346, Time to solve = 3.62e+01(s) : CgWave= 3.60e+01(s) 99.38%, advance= 3.60e+01(s) 99.33%
 max-residual=1.20e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=50)

DHS:
iluh=200 : not finished in 43 min

PETSc, solver=[generalized minimal residual iteration + ILU(300) + reverse Cuthill-McKee ordering]
*** freq=0: omega=20, max residual=3.36e-13, time for direct Helmholtz solve = 5.57e+02 (s) (iterations=2) ***

-----------------
G8: deflate -- freq=20 
cgwh -noplot gaussian.cmd -g=sice8.order4.ml3 -x0=-0.2 -y0=-0.3 -nf=1 -freq=20 -amp=-200 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=150 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -eigenVectorFile=/home/henshw/runs/eig/sice8Order4ml3EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-6 -matlab=sice8Freq20Deflate64 -go=og

 Convergence rate CR=0.120, CR-perPeriod=0.347, Time to solve = 8.54e+00(s) : CgWave= 8.48e+00(s) 99.29%, advance= 8.47e+00(s) 99.18%
 max-residual=1.11e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=50)

solveHelmholtz: max-res=1.561e-02 (all frequencies)
solveHelmholtz: rel-max-diff=4.58e-04, |v|_max= 5.66e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

DHS:
  iluh=50 : no 
  iluh=100: no 
  iluh=150:
*** freq=0: omega=20, max residual=1.29e-09, time for direct Helmholtz solve = 3.84e+01 (s) (iterations=1) ***
CgWaveHoltz: omega=2.000e+01, max-res=5.539e-08 (direct Helmholtz solution)  
  iluh=200: 
  *** freq=0: omega=20, max residual=1.29e-09, time for direct Helmholtz solve = 3.91e+01 (s) (iterations=1) ***
  CgWaveHoltz: omega=2.000e+01, max-res=1.953e-08 (direct Helmholtz solution)

-------------------
G4: deflate -- freq=20 
  iluh=5, 10 : no good
  iluh=50 : OK 
cgwh -noplot gaussian.cmd -g=sice4.order4.ml2 -x0=-0.2 -y0=-0.3 -nf=1 -freq=20 -amp=-200 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -eigenVectorFile=/home/henshw/runs/eig/sice4Order4ml2EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-6 -matlab=sice4Freq20Deflate64 -go=og

Convergence rate CR=0.126, CR-perPeriod=0.355, Time to solve = 2.91e+00(s) : CgWave= 2.90e+00(s) 99.60%, advance= 2.89e+00(s) 99.38%
max-residual=1.10e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=50)

solveHelmholtz: rel-max-diff=5.76e-03, |v|_max= 5.65e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

DHS 

iluh=50: 
*** freq=0: omega=20, max residual=2.28e-09, time for direct Helmholtz solve = 2.52e+00 (s) (iterations=61) ***




G16: deflate -- freq=20 freq=25
cgwh -noplot gaussian.cmd -g=sice16.order2.ml4 -x0=-0.2 -y0=-0.3 -nf=1 -freq=20 -amp=-200 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -eigenVectorFile=/home/henshw/runs/eig/sice16Order2ml4EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=sice16Freq20Deflate64 -go=og


omega=25:


######## DONE KYRLOV ITERATIONS -- KSP residual=1.83e-11 (max-res=1.30e-10) (tol=1.00e-10) numIts=5 #######

CgWaveHoltz::residual: grid=0 : maxRes= 2.20e-02
CgWaveHoltz::residual: grid=1 : maxRes= 2.17e-02
CgWaveHoltz::residual: freq= 0, omega=  25.000, max-res=2.203e-02.

***************************************************
****** Fri July 5, 2024

++++ I think the definition of beta changed since sphere was run before -- need to take square roo



# ============ DISK WITH MULTIGRID ===============


G16: deflate -- freq=20
cgwh -noplot gaussian.cmd -g=sice16.order2.ml4 -x0=-0.2 -y0=-0.2 -nf=1 -freq=20 -beta=1 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -eigenVectorFile=/home/henshw/runs/eig/sice16Order2ml4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=sice16Freq20Deflate64 -go=og





G128: 
cgwh -noplot gaussian.cmd -g=sice128.order2.ml5 -x0=-0.2 -y0=-0.2 -nf=1 -freq=8.0 -beta=1 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=k


G64: 
cgwh -noplot gaussian.cmd -g=sice64.order2.ml5 -x0=-0.2 -y0=-0.2 -nf=1 -freq=8.0 -beta=1 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=k

 Convergence rate CR=0.339, CR-perPeriod=0.582, Time to solve = 2.94e+02(s) : CgWave= 2.92e+02(s) 99.32%, advance= 2.91e+02(s) 99.26%
 max-residual=6.70e-10 (WaveHoltz its), numberOfIterations = 19 (Krylov) (maximumNumberOfIterations=100)
solveHelmholtz: max-res=3.288e-07 (all frequencies)

DHS: 
*** freq=0: omega=8, max residual=1.00e-10, time for direct Helmholtz solve = 3.52e+02 (s) (iterations=1774) ***
CgWaveHoltz: omega=8.000e+00, max-res=4.237e-08 (direct Helmholtz solution)



G32: 
cgwh -noplot gaussian.cmd -g=sice32.order2.ml4 -x0=-0.2 -y0=-0.2 -nf=1 -freq=8.0 -beta=1 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=k

Convergence rate CR=0.339, CR-perPeriod=0.582, Time to solve = 7.75e+01(s) : CgWave= 7.70e+01(s) 99.36%, advance= 7.70e+01(s) 99.30%
 max-residual=1.70e-09 (WaveHoltz its), numberOfIterations = 19 (Krylov) (maximumNumberOfIterations=100)
 CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.155e-07.

DHS:
*** freq=0: omega=8, max residual=9.51e-11, time for direct Helmholtz solve = 2.17e+01 (s) (iterations=445) ***
CgWaveHoltz: omega=8.000e+00, max-res=5.113e-08 (direct Helmholtz solution)

DHS: omega=20
*** freq=0: omega=20, max residual=2.69e-09, time for direct Helmholtz solve = 9.56e+02 (s) (iterations=10000) ***
CgWaveHoltz: omega=2.000e+01, max-res=3.192e-07 (direct Helmholtz solution)


G16: 
cgwh -noplot gaussian.cmd -g=sice16.order2.ml4 -x0=-0.2 -y0=-0.2 -nf=1 -freq=8.0 -beta=1 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -minStepsPerPeriod=10 -cfl=10000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=k

Convergence rate CR=0.342, CR-perPeriod=0.585, Time to solve = 2.51e+01(s) : CgWave= 2.50e+01(s) 99.53%, advance= 2.50e+01(s) 99.46%
 max-residual=6.16e-09 (WaveHoltz its), numberOfIterations = 19 (Krylov) (maximumNumberOfIterations=100)
CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.133e-07.

omega=20
Convergence rate CR=0.704, CR-perPeriod=0.839, Time to solve = 3.71e+01(s) : CgWave= 3.68e+01(s) 99.17%, advance= 3.67e+01(s) 99.06%
 max-residual=1.01e-08 (WaveHoltz its), numberOfIterations = 48 (Krylov) (maximumNumberOfIterations=100)



DHS: 
*** freq=0: omega=8, max residual=8.50e-11, time for direct Helmholtz solve = 1.32e+00 (s) (iterations=97) ***
CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.616e-08.

DHS: freq=20
*** freq=0: omega=20, max residual=7.12e-10, time for direct Helmholtz solve = 7.87e+01 (s) (iterations=6982) ***
CgWaveHoltz::residual: grid=0 : maxRes= 8.52e-08
CgWaveHoltz::residual: grid=1 : maxRes= 1.20e-08
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=8.525e-08.
CgWaveHoltz: omega=2.000e+01, max-res=8.525e-08 (direct Helmholtz solution)


# ============ SQUARE WITH MULTIGRID ===============

square512:          MG=15.7(s) ITS=14    max-res=2.49e-08
            DIRECT:    50.3    Its=2818  max-res=6.846e-08.

Square1024:         MG=61.8   Its=14               max-res=1.576e-06.
            DIRECT: 2.03e+03 (s) its=26311 max-res=2.472e-07.

square2048          MG=258    Its=14               max-res=1.596e-06.            

>>>>>>>>>>>>>> square5124DHS.out

============== DIRECT SOLVE OF THE HELMHOLTZ EQUATION =============
    c=1, numberOfFrequencies=1, orderOfAccuracy=2, solveComplex=0
 freq(0) = 11
 useSuperGrid=0, superGrid[grid] = [0,]
 ===================================================================
CgWave::getHelmholtzForcing: ***FILL IN RHS FOR DIRECT HELMHOLTZ SOLVER***
userDefinedForcing: t=0.000e+00 option=[gaussianSources] fSign=-1

 >>> Gaussian source 0, freq=0: setting a=1.00e+02, beta=2.00e+01, omega=1.10e+01, p=1.00e+00, x0=4.00e-01, y0=4.00e-01, z0=0.00e+00, t0=0.00e+00, t=0.00e+00, fSign=-1

solveHelmholtzDirect: OgesParameters found. Changing the direct Helmholtz solver parameters. 

 === Direct Helmholtz Solver:
 PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
 =====

*** freq=0: omega=11, max residual=9.94e-10, time for direct Helmholtz solve = 5.03e+01 (s) (iterations=2818) ***
CgWaveHoltz::residual: grid=0 : maxRes= 6.85e-08
CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=6.846e-08.


>>>>>>>>>>>>>>   square5124MultiGridKrylov.out

 ######## DONE KYRLOV ITERATIONS -- KSP residual=8.28e-09 (max-res=2.49e-08) (tol=1.00e-08) numIts=14 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 grid=/home/henshw/grids/square512.order2.hdf
 Convergence rate CR=0.335, CR-perPeriod=0.579, Time to solve = 1.57e+01(s) : CgWave= 1.55e+01(s) 98.59%, advance= 1.55e+01(s) 98.45%
 max-residual=2.49e-08 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)



@@@@@@@@@@@@@@@@@@@@@@@@ RETURN TO MULTIGRID @@@@@@@@@@@@@@@@@@@@@@

FIXED BUG IN Ogmg.C -> print statitics activeGrids may not be there
cgwh -noplot gaussian.cmd -g=square32.order2 -x0=0.4 -y0=0.4 -nf=1 -freq=11 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=3 -numPeriods=2 -cfl=1600 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k

Program received signal SIGSEGV, Segmentation fault.
0x00007ffff3433a74 in Ogmg::printStatistics (this=0x5555591f4c90, file_=0x5555560ad3b0) at Ogmg.C:3018
3018        aString activeStatus =  parameters.activeGrids(grid) ? "active" : "inactive";
(gdb) where
#0  0x00007ffff3433a74 in Ogmg::printStatistics (this=0x5555591f4c90, file_=0x5555560ad3b0) at Ogmg.C:3018
#1  0x00007ffff4bdd92d in MultigridEquationSolver::printStatistics (this=0x5555591f4c30, file=0x5555560ad3b0) at MultigridEquationSolver.C:36
#2  0x00007ffff4be6967 in Oges::printStatistics (this=0x5555591eeb20, file=0x5555560ad3b0) at Oges.C:1999
#3  0x000055555564fbf6 in CgWave::printStatistics (this=0x55555609d470, file=0x7ffff0a1b780 <_IO_2_1_stdout_>) at src/printStatistics.C:156
#4  0x00005555555830c2 in main (argc=28, argv=0x7fffffffddc8) at src/cgwh.C:190
(gdb) print grid


square1024:
=== Direct Helmholtz Solver:
 PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
 =====

*** freq=0: omega=11, max residual=9.98e-11, time for direct Helmholtz solve = 2.28e+03 (s) (iterations=29680) ***
CgWaveHoltz::residual: grid=0 : maxRes= 1.19e-07
CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=1.195e-07.
CgWaveHoltz: omega=1.100e+01, max-res=1.195e-07 (direct Helmholtz solution)




NITS=5 NP=1 CPU=77
cgwh -noplot gaussian.cmd -g=square1024.order2 -x0=0.4 -y0=0.4 -nf=1 -freq=11 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -minStepsPerPeriod=5 -cfl=100000 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og

Convergence rate CR=0.325, CR-perPeriod=0.755, Time to solve = 7.73e+01(s) : CgWave= 7.63e+01(s) 98.71%, advance= 7.62e+01(s) 98.60%


NITS=5 NP=4 CPU=77
cgwh -noplot gaussian.cmd -g=square1024.order2 -x0=0.4 -y0=0.4 -nf=1 -freq=11 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -minStepsPerPeriod=5 -cfl=100000 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Real Solution 

 grid=/home/henshw/grids/square1024.order2.hdf
 Convergence rate CR=0.325, CR-perPeriod=0.755, Time to solve = 7.69e+01(s) : CgWave= 7.59e+01(s) 98.71%, advance= 7.58e+01(s) 98.60%
 max-residual=2.89e-08 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 solveForScatteredField=0
 Time stepping = implicit, cfl=100000.00, dt=1.922e-01, minStepsPerPeriod=5, numberOfStepsPerSolve=20, totalTimeStepsStaken=340, aveItsPerImplicitSolve=  5.8
  takeImplicitFirstStep=1
 implicitUpwind=0 (1= add upwind diss. to implicit matrix)
 grid-CFL= 2.78e+02 for grid=0 (square)
 c=1, useSuperGrid=0, damp=0
 filterTimeDerivative=0, useFilterWeights=1, viFactor=0
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: grid=0 : maxRes= 4.41e-06
CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=4.410e-06.
solveHelmholtz: max-res=4.410e-06 (all frequencies)

++++++++++++++++++
NITS=10 NP=2 REDUCE MG TOL : CPU=58
cgwh -noplot gaussian.cmd -g=square1024.order2 -x0=0.4 -y0=0.4 -nf=1 -freq=11 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=1600 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-8 -atoli=1e-8 -go=k

 Convergence rate CR=0.335, CR-perPeriod=0.579, Time to solve = 5.80e+01(s) : CgWave= 5.71e+01(s) 98.46%, advance= 5.70e+01(s) 98.33%
CgWaveHoltz::residual: grid=0 : maxRes= 1.58e-06

++++++++++
NITS=10 NP=2 CPU=71 
cgwh -noplot gaussian.cmd -g=square1024.order2 -x0=0.4 -y0=0.4 -nf=1 -freq=11 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=1600 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Real Solution 

 grid=/home/henshw/grids/square1024.order2.hdf
 Convergence rate CR=0.335, CR-perPeriod=0.579, Time to solve = 7.09e+01(s) : CgWave= 6.99e+01(s) 98.69%, advance= 6.99e+01(s) 98.57%
 max-residual=2.50e-08 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 solveForScatteredField=0
 Time stepping = implicit, cfl=1600.00, dt=6.247e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=20, totalTimeStepsStaken=320, aveItsPerImplicitSolve=  5.7
  takeImplicitFirstStep=1
 implicitUpwind=0 (1= add upwind diss. to implicit matrix)
 grid-CFL= 9.05e+01 for grid=0 (square)
 c=1, useSuperGrid=0, damp=0
 filterTimeDerivative=0, useFilterWeights=1, viFactor=0
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=  11.000, (adjusted=  10.059) T= 0.57120, Tbar= 1.14240, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: grid=0 : maxRes= 1.10e-06
CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=1.096e-06.
solveHelmholtz: max-res=1.096e-06 (all frequencies)




NITS=10 NP=4: CPU=104
cgwh -noplot gaussian.cmd -g=square1024.order2 -x0=0.4 -y0=0.4 -nf=1 -freq=11 -amp=100 -beta=20 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=1600 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Real Solution 

 grid=/home/henshw/grids/square1024.order2.hdf
 Convergence rate CR=0.205, CR-perPeriod=0.673, Time to solve = 1.04e+02(s) : CgWave= 1.03e+02(s) 99.37%, advance= 1.03e+02(s) 99.31%
 max-residual=3.14e-08 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 solveForScatteredField=0
 Time stepping = implicit, cfl=1600.00, dt=6.247e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=40, totalTimeStepsStaken=480, aveItsPerImplicitSolve=  5.6
  takeImplicitFirstStep=1
 implicitUpwind=0 (1= add upwind diss. to implicit matrix)
 grid-CFL= 9.05e+01 for grid=0 (square)
 c=1, useSuperGrid=0, damp=0
 filterTimeDerivative=0, useFilterWeights=1, viFactor=0
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=  11.000, (adjusted=  10.059) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: grid=0 : maxRes= 1.34e-06
CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=1.343e-06.
solveHelmholtz: max-res=1.343e-06 (all frequencies)



+++++++ OLD
>>>>>> G1024: increase CFL
cgwh gaussian.cmd -g=square1024.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=1600 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square1024.order2.hdf
 Convergence rate CR=0.313, CR-perPeriod=0.748, Time to solve = 9.18e+01(s)
 max-residual=1.40e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1600.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=360
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00




$$$$$$$$$$$$$$$$$$$ PIPE $$$$$$$$$$$$$$$$$$$$

NOTE ***USE PERIODIC IN Z GRIDS TO MATCH EIGS IN PLOTCONVERGENCE ****


G2 O4 IMP: 

setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4p.ng3 -x0=0.1 -y0=0.1 -z0=0.5 -nf=1 -freq=8.5 -amp=150 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -matlab=pipeFreq8p5Np4G2Order4Imp -go=fk > pipeFreq8p5Np4G2Order4Imp.out

G2 O4 EXP ** 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4p.ng3 -x0=0.1 -y0=0.1 -z0=0.5 -nf=1 -freq=8.5 -amp=150 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=.95 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -matlab=pipeFreq8p5Np4G2O4Exp -go=fk > pipeFreq8p5Np4G2O4Exp.out




OLD: 
cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=og


NP=4 -- not so good(?) --> SOURCE LOCATIONS BAD 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeTwoFreqNp4G2Order4Imp -go=dfk > pipeTwoFreqNp4G2Order4Imp.out


$$$$$$$$$$$$$$$$$$$ SPHERE  $$$$$$$$$$$$$$$$$$


G2 Order 4 NP=4 - IMP TURN OFF upwind OK 
setsid $cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 -y0=0.1 -z0=0.1 -nf=1 -freq=8.5 -amp=150 -beta=10 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=fk > sphereOneFreqNp4G2Order4Imp.out


G2 Order 4 - EXP change beta=10 ADD z0  TURN OFF UPWIND 
setsid $cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 -y0=0.1 -z0=0.1 -nf=1 -freq=8.5 -amp=150 -beta=10 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Exp -go=fk > sphereOneFreqNp4G2Order4Exp.out


>>>>>>>>>>>>>


G2 Order 4 NP=4 - IMP  INCLUDE DIRECT SOLVE: 
setsid $cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=dfk > sphereOneFreqNp4G2Order4Imp.out

G2 Order 4 - EXP change beta=10
cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 -y0=0.1 -z0=0.1 -nf=1 -freq=8.5 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Exp -go=fk > sphereOneFreqNp4G2Order4Exp.out


>>>>>>>>>>>OLD: 
++++ SPHERE -- showfile for plots

FINER GRID: 
$cgwh -noplot gaussian.cmd -g=spheree4.order2 -x0=-0.2 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=1 -freq=18 8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -show=sphereOneG4Freq18.show -go=ks > sphereOneG4Freq18.out



$cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=-0.2 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=1 -freq=18 8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -show=sphereOneFreq18.show -go=ks > sphereOneFreq18.out


omega=8.5
$cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -show=sphereOneFreqNp4G2Order4Imp.show -go=ks



------------------------------------------------
----------------------- SPHERE ------------------
------------------------------------------------


CHOOSE omega=8.5  (should be ok from exact eigs)

G2 Order 4 NP=4 - IMP  INCLUDE DIRECT SOLVE: 
setsid $cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=dfk > sphereOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/spheree2.order4.ng3.hdf
 Convergence rate CR=0.602, CR-perPeriod=0.881, Time to solve = 6.21e+02(s) : CgWave= 1.20e+03(s) 193.41%, advance= 1.20e+03(s) 193.34%
 max-residual=1.59e-10 (WaveHoltz its), numberOfIterations = 47 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.488e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=1980, aveItsPerImplicitSolve=  5.5
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   5.051) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=2.243e-08 (using omega), max-res=2.766e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.243e-08 (all frequencies)

Direct solve Helmholtz: cpu= 2.12e+04(s), iterations=2 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(100) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.488e-01
CgWaveHoltz::saved results in matlab file=[sphereOneFreqNp4G2Order4ImpKrylov.m]
cgwh: rel-max-diff=3.93e-09, |v|_max= 4.05e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


***************************************************
****** Thurs July 4, 2024


plotStuff plotSolution.cmd -show=darkCornerRoomFreq5p568G4Order4X1Y1 -name=darkCornerRoomFreq5p568G4Order4X1Y1 -solution=1



REDO central sources 

G4 O4  force near an eigenmode: 2.903. 5.5604
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-3 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5  -matlab=darkCornerRoomFreq15Np8G4Order4X1Y1 -show=darkCornerRoomFreq15Np8G4Order4X1Y1.show -go=dfks > darkCornerRoomFreq15Np86G4Order4X1Y1.out

GO BACK TO (0,-3) freq=15
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-3 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq15Np8Nit10G4Order4Deflate256 -show=darkCornerRoomFreq15Np8Nit10NG4Order4Deflate256.show -go=dfks > darkCornerRoomFreq15Np8Nit10G4Order4Deflate256.out

G4 O4  force near an eigenmode: 2.903. 5.5604
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=1 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=5.56 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5  -matlab=darkCornerRoomFreq5p568G4Order4X1Y1 -show=darkCornerRoomFreq5p568G4Order4X1Y1.show -go=dfks > darkCornerRoomFreq5p56G4Order4X1Y1.out

setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=3 -y0=0 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=5 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq5Np8G4Order4X3Y0 -show=darkCornerRoomFreq5Np8G4Order4X3Y0.show -go=dfks > darkCornerRoomFreq5p8G4Order4X3Y0.out


plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G2Order2Deflate64 -name=darkCornerRoomFreq10Np8G2Order2Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G4Order2Deflate64 -name=darkCornerRoomFreq10Np8G4Order2Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G8Order2Deflate64 -name=darkCornerRoomFreq10Np8G8Order2Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G2Order4Deflate64 -name=darkCornerRoomFreq10Np8G2Order4Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G4Order4Deflate64 -name=darkCornerRoomFreq10Np8G4Order4Deflate64 -solution=1
plotStuff plotSolution.cmd -show=darkCornerRoomFreq10Np8G8Order4Deflate64 -name=darkCornerRoomFreq10Np8G8Order4Deflate64 -solution=1



G16 O2 Get DHS solution for G16
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG16O2EigsEv1024.show -deflateWaveHoltz=0 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G16Order2Deflate64 -show=darkCornerRoomFreq10Np8G16Order2.show  -go=dfks > darkCornerRoomFreq10Np8G16Order2.out


G16 O4 Get DHS solution for G16 ** TOO BIG FOR YALE **
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride16.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG16O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G16Order4Deflate64 -show=darkCornerRoomFreq10Np8G16Order4Deflate64.show -solverh=gmres -go=og    dfks > darkCornerRoomFreq10Np8G16Order4Deflate64.out

G12 O4 Get DHS solution for G12
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride12.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG12O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G12Order4Deflate64 -show=darkCornerRoomFreq10Np8G12Order4Deflate64.show -go=dfks > darkCornerRoomFreq10Np8G12Order4Deflate64.out

***************************************************
****** Wed July 3, 2024


RE-RUN DOUBLE ELLIPSE FOR CONTOUR PLOTS

G8 O4
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G8Order4Deflate64 -show=darkCornerRoomFreq10Np8G8Order4Deflate64.show -go=dfks > darkCornerRoomFreq10Np8G8Order4Deflate64.out


G4 O4
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G4Order4Deflate64 -show=darkCornerRoomFreq10Np8G4Order4Deflate64.show -go=dfks > darkCornerRoomFreq10p8G4Order4Deflate64.out

G2 O4
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride2.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG2O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G2Order4Deflate64 -show=darkCornerRoomFreq10Np8G2Order4Deflate64.show -go=dfks > darkCornerRoomFreq10Np8G2Order4Deflate64.out

G8 O2 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G8Order2Deflate64 -show=darkCornerRoomFreq10Np8G8Order2Deflate64.show -go=dfks > darkCornerRoomFreq10Np8G8Order2Deflate64.out


G4 O2 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G4Order2Deflate64 -show=darkCornerRoomFreq10Np8G4Order2Deflate64.show -go=dfks > darkCornerRoomFreq10Np8G4Order2Deflate64.out


G2 O2 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride2.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG2O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G2Order2Deflate64 -show=darkCornerRoomFreq10Np8G2Order2Deflate64.show -go=dfks > darkCornerRoomFreq10Np8G2Order2Deflate64.out


***************************************************
****** Tues July 2, 2024

TEST ORDER=4 MULTI-OBJECTS 

COULD COMPARE O2 to O4 for accuracy ?

** REDO WITH AMP=-10


REDO- HIGHER FREQ:
***MULITPLICITY=3 BROKEN HERE *****
G4 O4 NP=4: FREQ=15
setsid $cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order4 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-10 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGridG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=128 -eigTol=1.0e-5 -matlab=multiObjectsFreq15Np4G4Order4Deflate128 -show=multiObjectsFreq15Np4G4Order4Deflate128.show -go=dfks > multiObjectsFreq15Np4G4Order4Deflate128.out

something funny: freq=15
 ==== NORMALIZE EIGENVECTOR eigNumber=832 =====
  deflateWaveHoltz=1, numToDeflate=128, eigenVectorFile=[/home/henshw/runs/eig/multiObjectsGridG4O4EigsEv1024.show]
 >>> Multiple eigenvalue found: i=832, eig= 1.482e+01, will orthogonalize eigenvectors...
Eigenvector 831 is now orthonormal to eigenvector 832.
deflate eig=831: lambda=  1.4820e+01, (multiplicity=3) *** duplicate ***
deflate eig=830: lambda=  1.4820e+01, (multiplicity=3)

 ==== NORMALIZE EIGENVECTOR eigNumber=830 =====
  deflateWaveHoltz=1, numToDeflate=129, eigenVectorFile=[/home/henshw/runs/eig/multiObjectsGridG4O4EigsEv1024.show]
 >>> Multiple eigenvalue found: i=830, eig= 1.482e+01, will orthogonalize eigenvectors...
cgwh: src/deflation.C:718: int CgWave::normalizeEigenvector(int): Assertion `eigenVectorIsNormalized(i) == 0' failed.
 





G4 O4 -- central source freq=10 NO UPWIND deflate 256

G12 O4 NP=4:  just plot Helmholtz solution (maxIts=2)  **TOO BIG FOR YALE**
cgwh -noplot gaussian.cmd -g=multiObjectsGride12.order4 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-10 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=1 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -show=multiObjectsFreq10Np2G12Order4DHS.show -go=dfks > multiObjectsFreq10Np2G12Order4DHS.out


G8 O4 NP=4:  just plot Helmholtz solution (maxIts=2)
cgwh -noplot gaussian.cmd -g=multiObjectsGride8.order4 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-10 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=2 -numPeriods=1 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -show=multiObjectsFreq10Np2G8Order4DHS.show -go=dfks > multiObjectsFreq10Np2G8Order4DHS.out



G4 O4 NP=2: 
setsid $cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order4 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-10 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGridG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=128 -matlab=multiObjectsFreq10Np2G4Order4Deflate128 -show=multiObjectsFreq10Np2G4Order4Deflate128.show -go=dfks > multiObjectsFreq10Np2G4Order4Deflate128.out


G4 O4 NP=4: 
setsid $cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order4 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-10 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGridG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=128 -matlab=multiObjectsFreq10Np4G4Order4Deflate128 -show=multiObjectsFreq10Np4G4Order4Deflate128.show -go=dfks > multiObjectsFreq10Np4G4Order4Deflate128.out

setsid $cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order4 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-10 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGridG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=128 -matlab=multiObjectsFreq10Np8G4Order4Deflate128 -show=multiObjectsFreq10Np8G4Order4Deflate128.show -go=dfks > multiObjectsFreq10Np8G4Order4Deflate128.out

G8 O2 -- central source freq10 NO UPWIND deflate 64
    **TO DO**

setsid $cgwh -noplot gaussian.cmd -g=multiObjectsGride8.order2 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-10 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGridG8O2EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=multiObjectsFreq10Np8G8Order2Deflate64 -show=multiObjectsFreq10Np8G8Order2Deflate64.show -go=dfks > multiObjectsFreq10Np8G8Order2Deflate64.out



G4 O2 -- central source freq10 NO UPWIND deflate 64
cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order2 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-10 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=multiObjectsFreq10Np8G4Order2Deflate64 -show=multiObjectsFreq10Np8G4Order2Deflate64.show -go=dfks > multiObjectsFreq10Np8G4Order2Deflate64.out




G4 O4 freq=5 -- central  NO UPWIND deflate 64
setsid $cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order4 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=5 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGridG4O4EigsEv128.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=multiObjectsFreq5Np8G4Order2Deflate64 -show=multiObjectsFreq5Np8G4Order2Deflate64.show -go=dfks > multiObjectsFreq5Np8G4Order2Deflate64.out


G4 O2 -- central source freq10 NO UPWIND deflate 64
cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order2 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=multiObjectsFreq10Np8G4Order2Deflate64 -show=multiObjectsFreq10Np8G4Order2Deflate64.show -go=dfks > multiObjectsFreq10Np8G4Order2Deflate64.out

IMP G4 O4 deflate
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=implicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=diskG4O4Freq8p1Np1Nits10Deflate8Imp -go=dfks > diskG4O4Freq8p1Np1Nits10Deflate8Imp.out 

 cp diskG4O4Freq8p1Np1Nits10Deflate8Imp*.m $overHoltz/codes


IMP G4 O4 deflate
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=implicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=4 -matlab=diskG4O4Freq8p1Np1Nits10Deflate4Imp -go=dfks > diskG4O4Freq8p1Np1Nits10Deflate4Imp.out 

 cp diskG4O4Freq8p1Np1Nits10Deflate4Imp*.m $overHoltz/codes


IMP G4 O4 Np4
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=implicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000  -matlab=diskG4O4Freq8p1Np4Nits10Imp -go=dfks > diskG4O4Freq8p1Np4Nits10Imp.out 

cp diskG4O4Freq8p1Np4Nits10Imp*.m $overHoltz/codes


IMP G4 O4 
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=implicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000  -matlab=diskG4O4Freq8p1Np1Nits10Imp -go=dfks > diskG4O4Freq8p1Np1Nits10Imp.out 

cp diskG4O4Freq8p1Np1Nits10Imp*.m $overHoltz/codes

EXP G4 O4 
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=explicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1  -matlab=diskG4O4Freq8p1Np1Nits10Exp -go=dfks > diskG4O4Freq8p1Np1Nits10Exp.out

cp diskG4O4Freq8p1Np1Nits10Exp*.m $overHoltz/codes


IMP G4 O2 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=implicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=diskG4O2Freq8p1Np1Nits10Imp -go=dfks > diskG4O2Freq8p1Np1Nits10Imp.out

cp diskG4O2Freq8p1Np1Nits10Imp*.m $overHoltz/codes

EXP G4 O2  upwind needed? apparently not 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=explicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -matlab=diskG4O2Freq8p1Np1Nits10Exp -go=dfks > diskG4O2Freq8p1Np1Nits10Exp.out

cp diskG4O2Freq8p1Np1Nits10Exp*.m $overHoltz/codes

***************************************************
****** Mon July 1, 2024


RETURN TO DISK: REDO COMPUTATIONS FOR overHoltz paper


IMP G4 O4 deflate
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=implicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=4 


IMP G4 O4 
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=implicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000  

EXP G4 O4 
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=explicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1  


IMP G4 O2 
cgwh gaussian.cmd -g=sice4.order2 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=implicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000  

EXP G4 O2  upwind needed?
cgwh gaussian.cmd -g=sice4.order2 -x0=0.25 -y0=0.25 -nf=1 -freq=8.1 -amp=50 -beta=10 -bc=d -adjustOmega=1 -ts=explicit -implicitUpwind=0 -minStepsPerPeriod=10 -orderInTime=2 -solver=none -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1  



***************************************************
****** Sun June 30, 2024


++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
DARK CORNER ROOM -- aka double-ellipse

REDO wiith takeImplicitFirstStep

PUT SOURCE IN NEAR MIDDLE decrease beta, increase freq=15: 
-4, 0 
0 -4 

******** MAYBE THE CONVERGENCE IS LIMITED BY THE ACCURACY OF THE EIGENMODES?? 


$$$$ TURN OFF UPWIND!! ... works 

LOWER FREQ:
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000  -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=5 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -x0=3 -y0=0 -matlab=darkCornerRoomFreq5Np8Nit10G4Order4Deflate64 -show=darkCornerRoomFreq5Np8Nit10NG4Order4Deflat646.show -go=dfks > darkCornerRoomFreq5Np8Nit10G4Order4Deflate64.out


GO BACK TO (0,-3) freq=15
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-3 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq15Np8Nit10G4Order4Deflate256 -show=darkCornerRoomFreq15Np8Nit10NG4Order4Deflate256.show -go=dfks > darkCornerRoomFreq15Np8Nit10G4Order4Deflate256.out

freq=10 : ok 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-2.75 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8Nit10G4Order4Deflate256 -show=darkCornerRoomFreq10Np8Nit10NG4Order4Deflate256.show -go=dfks > darkCornerRoomFreq10Np8Nit10G4Order4Deflate256.out


decrease beta
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-2.5 -nf=1 -amp=-400 -beta=2 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8Nit10G4Order4Deflate64a -show=darkCornerRoomFreq10Np8Nit10NG4Order4Deflate64a.show -go=dfks > darkCornerRoomFreq10Np8Nit10G4Order4Deflate64a.out


Shift position ... same
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-2.75 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8Nit10G4Order4Deflate64b -show=darkCornerRoomFreq10Np8Nit10NG4Order4Deflate64b.show -go=dfks > darkCornerRoomFreq10Np8Nit10G4Order4Deflate64b.out


deflate less
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-3 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8Nit10G4Order4Deflate64 -show=darkCornerRoomFreq10Np8Nit10NG4Order4Deflate64.show -go=dfks > darkCornerRoomFreq10Np8Nit10G4Order4Deflate64.out



LOWER  omega=10: still levels at 6e-7
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-3 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8Nit10G4Order4Deflate256 -show=darkCornerRoomFreq10Np8Nit10NG4Order4Deflate100.show -go=dfks > darkCornerRoomFreq10Np8Nit10G4Order4Deflate256.out



TRY NITS=20 
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-3 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq15Np8Nit20G4Order4Deflate256 -show=darkCornerRoomFreq15Np8Nit20NG4Order4Deflate100.show -go=dfks > darkCornerRoomFreq15Np8Nit20G4Order4Deflate256.out

Iteration stops converging -- levels off at 1e-7
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=0 -y0=-3 -nf=1 -amp=-400 -beta=5 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv2048.show -deflateWaveHoltz=1 -numToDeflate=256 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq15Np8Nit10G4Order4Deflate256 -show=darkCornerRoomFreq15Np8Nit10NG4Order4Deflate100.show -go=dfks > darkCornerRoomFreq15Np8Nit10G4Order4Deflate256.out


G4 ORDER=4 freq=10 deflate 64 NITS=10 (eigTol=1.e-5)  
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8Nit10G4Order4Deflate64 -show=darkCornerRoomFreq10Np8Nit10NG4Order4Deflate64.show -go=dfks > darkCornerRoomFreq10Np8Nit10G4Order4Deflate64.out


G4 ORDER=4 freq=10 deflate 64 NITS=20 (eigTol=1.e-5)  
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8Nit20G4Order4Deflate64 -show=darkCornerRoomFreq10Np8Nit20NG4Order4Deflate64.show -go=dfks > darkCornerRoomFreq10Np8Nit20G4Order4Deflate64.out

G4 O2 freq=10 deflate=64 NITS=10
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8Nit10G4Order2Deflate64 -show=darkCornerRoomFreq10Np8Nit10NG4Order2Deflate64.show -go=dfks > darkCornerRoomFreq10Np8Nit10G4Order2Deflate64.out

G4 O2 freq=10 deflate=64 NITS=20
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8Nit20G4Order2Deflate64 -show=darkCornerRoomFreq10Np8Nit20NG4Order2Deflate64.show -go=dfks > darkCornerRoomFreq10Np8Nit20G4Order2Deflate64.out

***************************************************
****** Sat June 29, 2024

DARK CORNER ROOM -- aka double-ellipse



TAKE IMPLICIT FIRST STEP -- DOES IT WORK FOR WAVE HOLTZ? --> LOOKS LIKE IT WORKS 

cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=0 -y0=0 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=10 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -takeImplicitFirstStep=1 -go=og

PUT SOURCE IN NEAR MIDDLE 
TROUBLE WITH FPI -- mode 0 grows ??
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=0 -y0=0 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=10 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -go=og



Deflate more: 128 -- TROUBLE WITH FPI converging for a while then diverging 
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=128 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G4Order4Deflate128 -show=darkCornerRoomFreq10Np8G4Order4Deflate128.show -go=dfks > darkCornerRoomFreq10Np8G4Order4Deflate128.out

freq=10 G8 O4
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G8Order4Deflate64 -show=darkCornerRoomFreq10Np8G8Order4Deflate64.show -go=dfks > darkCornerRoomFreq10Np8G8Order4Deflate64UW.out


***************************************************
****** Fri June 28, 2024

DARK CORNER ROOM -- aka double-ellipse

**NOTE** cgwh:  need to set eigTol properly or orthogonalization fails 


(1) GENERATE EIGENMODES FOR DEFLATION in runs/eigs:
genEigs -noplot eigs.cmd -problem=laplace -eigCase=none -g=darkCornerRoomGride2.order2.hdf -eigOption=1 -eps_s=largest_magnitude -numEigenValues=258 -numEigenVectors=256 -tol=1.0e-12 -bc1=d -show=darkCornerRoomG2O2EigsEv256.show -go=go > darkCornerRoomG4O2EigsEv256.out

(2) Solve Helmholtz: need to set eigTol properly or orthogonalization fails

+++++++ SOURCE IN bottom left room -- surface mode

NOTE -- files were named wrong FREQ=10 NOT 5

freq=10 G8 O2
setsid $cgwh -noplot gaussian.cmd -g=darkCornerRoomGride8.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=10 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG8O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq10Np8G8Order2Deflate64 -show=darkCornerRoomFreq10Np8G8Order2Deflate64.show -go=dfks > darkCornerRoomFreq10Np8G8Order2Deflate64UW.out

ORDER=4 freq=10 deflate 64 use 20 steps (eigTol=1.e-5)  
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order4.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O4EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq5Np8G4Order4Deflate64 -show=darkCornerRoomFreq10Np8G4Order4Deflate64.show -go=dfks > darkCornerRoomFreq5Np8G4Order4Deflate64.out

cp darkCornerRoomFreq5Np8G4Order4Deflate64*.m $overHoltz/codes/

freq=10 deflate 64 use 20 steps (eigTol=1.e-5)  
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq5Np8G4Order2Deflate64 -show=darkCornerRoomFreq10Np8G4Order2Deflate64.show -go=dfks > darkCornerRoomFreq5Np8G4Order2Deflate64.out


freq=10 deflate 64 (eigTol=1.e-5)  -- add upwinding  -- low mode still grows ?!
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq5Np8G4Order2Deflate64UW -show=darkCornerRoomFreq10Np8G4Order2Deflate64UW.show -go=dfks > darkCornerRoomFreq5Np8G4Order2Deflate64UW.out

cp darkCornerRoomFreq5Np8G4Order2Deflate64UW*.m $overHoltz/codes




CHECK FPI -- 
   10 steps-per-period low eigmode appears and grows: 
   20 steps-per-period : FPI looks ok 
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=10 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -go=og

cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=10 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -go=og



freq=10 deflate 64 (eigTol=1.e-5)  GMRES OK, FPI diverges
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=64 -eigTol=1.0e-5 -matlab=darkCornerRoomFreq5Np8G4Order2Deflate64 -show=darkCornerRoomFreq5Np8G4Order2Deflate64.show -go=dfks > darkCornerRoomFreq5Np8G4Order2Deflate64.out

cp darkCornerRoomFreq5Np8G4Order2Deflate64*.m $overHoltz/codes

freq=10 deflate 32
cgwh -noplot gaussian.cmd -g=darkCornerRoomGride4.order2.hdf -ts=implicit -cfl=1000 -x0=-1.4 -y0=-5.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG4O2EigsEv1024.show -deflateWaveHoltz=1 -numToDeflate=32 -eigTol=1.0e-4 -matlab=darkCornerRoomFreq5Np8G4Order2Deflate32 -show=darkCornerRoomFreq5Np8G4Order2Deflate32.show -go=dfks > darkCornerRoomFreq5Np8G4Order2Deflate32.out





cgwh -noplot gaussian.cmd -g=darkCornerRoomGride2.order2.hdf -ts=implicit -cfl=1000 -x0=0.4 -y0=0.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=5 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG2O2EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=32 -eigTol=5.0e-4 -matlab=darkCornerRoomFreq5Np8G2Order2Deflate32 -go=og

cp darkCornerRoomFreq5Np8G2Order2Deflate32Krylov.m $overHoltz/codes

cgwh -noplot gaussian.cmd -g=darkCornerRoomGride2.order2.hdf -ts=implicit -cfl=1000 -x0=0.4 -y0=0.6 -nf=1 -amp=-400 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -freq=5 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/darkCornerRoomG2O2EigsEv256.show -deflateWaveHoltz=1 -numToDeflate=32 -eigTol=5.0e-4 -matlab=darkCornerRoomFreq5Np4G2Order2Deflate32 -go=og

cp darkCornerRoomFreq5Np4G2Order2Deflate32Krylov.m $overHoltz/codes

(2) Plot results


***************************************************
****** Thurs June 26, 2024

RETURN TO WAVE HOLTZ -- work on overHoltz paper

+++++++++++++++++++++++++++ Simple example 
cgwh gaussian.cmd -g=square128.order4 -ts=implicit -cfl=1000 -x0=0.4 -y0=0.6 -nf=1 -amp=-400 -beta=25 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -freq=40 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 

cgwh gaussian.cmd -g=square128.order4 -ts=implicit -cfl=1000 -x0=0.4 -y0=0.6 -nf=1 -amp=-400 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -freq=30 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 

CgWaveHoltz::residual: grid=0 : maxRes= 2.78e-09
CgWaveHoltz::residual: freq= 0, omega=  30.000, max-res=2.781e-09.
solveHelmholtz: max-res=2.781e-09 (all frequencies)
solveHelmholtz: rel-max-diff=1.97e-10, |v|_max= 1.10e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


+++++++++++++++


cgwh gaussian.cmd -g=square64.order4 -ts=implicit -cfl=1000 -x0=0.4 -y0=0.6 -nf=1 -amp=-100 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=4 -freq=15 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 



G4 -- central source freq10 NO UPWIND deflate 64
cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order2 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=multiObjectsFreq10Np8G4Order2Deflate64 -show=multiObjectsFreq10Np8G4Order2Deflate64.show -go=dfks > multiObjectsFreq10Np8G4Order2Deflate64.out

cp multiObjectsFreq10Np8G4Order2Deflate64*.m $overHoltz/codes

plotStuff plotSolution.cmd -show=multiObjectsFreq10Np8G4Order2Deflate64 -name=multiObjectsFreq10Np8G4Order2Deflate64 -clines=0 -solution=1 


deflate=4
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=1 -freq=22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=8 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=4  



Np=4, 10 steps-per-period
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.55 -y0=0.55 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=4 -freq=20 -damp=0 -adjustHelmholtzForUpwinding=0  -bc=d -implicitUpwind=0 -minStepsPerPeriod=10 -go=halt

 ######## DONE KYRLOV ITERATIONS -- KSP residual=2.79e-13 (max-res=1.07e-12) (tol=1.00e-12) numIts=25 #######



cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.55 -y0=0.55 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -damp=0 -adjustHelmholtzForUpwinding=0  -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -go=halt

######## DONE KYRLOV ITERATIONS -- KSP residual=9.80e-13 (max-res=3.06e-12) (tol=1.00e-12) numIts=60 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Real Solution 

 grid=/home/henshw/grids/square64.order2.hdf
 Convergence rate CR=0.665, CR-perPeriod=0.816, Time to solve = 8.99e-01(s) : CgWave= 8.82e-01(s) 98.06%, advance= 8.64e-01(s) 96.06%
 max-residual=3.06e-12 (WaveHoltz its), numberOfIterations = 60 (Krylov) (maximumNumberOfIterations=1000)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=0
 solveForScatteredField=0
 Time stepping = implicit, cfl=100.00, dt=1.604e-02, minStepsPerPeriod=20, numberOfStepsPerSolve=40, totalTimeStepsStaken=2640, aveItsPerImplicitSolve=  0.0
  takeImplicitFirstStep=0
 implicitUpwind=0 (1= add upwind diss. to implicit matrix)
 grid-CFL= 1.45e+00 for grid=0 (square)
 c=1, useSuperGrid=0, damp=0
 filterTimeDerivative=0, useFilterWeights=1, viFactor=0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=  20.000, (adjusted=  19.585) T= 0.31416, Tbar= 0.62832, numPeriods=  2, Tbar(0)/T=  2.00
Direct solve Helmholtz: cpu= 2.01e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]

CgWaveHoltz::residual: grid=0 : maxRes= 4.24e-10
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=4.243e-10.
solveHelmholtz: max-res=4.243e-10 (all frequencies)
solveHelmholtz: rel-max-diff=5.81e-11, |v|_max= 1.59e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

Wrote results to the check file [cgWaveHoltz.check]
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]


***************************************************
****** Thurs July 20, 2023

ADD ANIMATE OPTION

cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.55 -y0=0.55 -nf=1 -amp=100 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -damp=0 -adjustHelmholtzForUpwinding=0  -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -go=halt

G4 -- central source freq10 NO UPWIND deflate 64
cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order2 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=64 -matlab=multiObjectsFreq10Np8G4Order2Deflate64 -show=multiObjectsFreq10Np8G4Order2Deflate64.show -go=dfks > multiObjectsFreq10Np8G4Order2Deflate64.out

cp multiObjectsFreq10Np8G4Order2Deflate64*.m $waho/codes



TURN OFF upwind : central source OK
cgwh gaussian.cmd -g=multiObjectsGride2.order2 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=8 -freq=8 -adjustHelmholtzForUpwinding=0 -bc=d  -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride2EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=32 -matlab=multiObjectsFreq8Np8G2Order2ImpDeflate32 -go=halt




***************************************************
****** Wed July 19, 2023


G4 -- central source freq10
cgwh -noplot gaussian.cmd -g=multiObjectsGride4.order2 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -adjustHelmholtzForUpwinding=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=16 -matlab=multiObjectsFreq10Np8G4Order2Deflate16 -show=multiObjectsFreq10Np8G4Order2Deflate16.show -go=dfks > multiObjectsFreq10Np8G4Order2Deflate16.out


G4 -- central source freq10
cgwh gaussian.cmd -g=multiObjectsGride4.order2 -ts=implicit -cfl=1000 -x0=1.3 -y0=-.7 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=10 -adjustHelmholtzForUpwinding=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride4EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=16 -matlab=multiObjectsFreq10Np8G4Order2Deflate16 -go=halt

solveHelmholtz: max-res=7.730e+00 (all frequencies)
solveHelmholtz: rel-max-diff=1.28e-03, |v|_max= 8.94e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

GMRES + deflation
 Convergence rate CR=0.607, CR-perPeriod=0.940, Time to solve = 3.28e+02(s) : CgWave= 3.27e+02(s) 99.63%, advance= 3.26e+02(s) 99.55%
GMRES: 
Convergence rate CR=0.880, CR-perPeriod=0.984, Time to solve = 9.85e+01(s) : CgWave= 2.00e+02(s) 202.98%, advance= 2.00e+02(s) 202.78%


cgwh gaussian.cmd -g=multiObjectsGride2.order2 -ts=implicit -cfl=1000 -x0=-2.0 -y0=-2.75 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=8 -adjustHelmholtzForUpwinding=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride2EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=16 -matlab=multiObjectsFreq8Np8G2Order2ImpDeflate16 -go=halt

freq=8 deflate 16  Size=10
cgwh -noplot gaussian.cmd -g=multiObjectsGride2.order2 -ts=implicit -cfl=1000 -x0=-2.0 -y0=-2.75 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=8 -adjustHelmholtzForUpwinding=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride2EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=16 -matlab=multiObjectsFreq8Np8G2Order2ImpDeflate16 -go=dfks


grid=multiObjectsGride2.order2.hdf
 Convergence rate CR=0.568, CR-perPeriod=0.932, Time to solve = 6.72e+01(s) : CgWave= 6.69e+01(s) 99.56%, advance= 6.68e+01(s) 99.44%
 max-residual=4.87e-09 (WaveHoltz its), numberOfIterations = 34 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 solveForScatteredField=0
 Time stepping = implicit, cfl=1000.00, dt=4.010e-02, minStepsPerPeriod=20, numberOfStepsPerSolve=160, totalTimeStepsStaken=13760, aveItsPerImplicitSolve=  0.0
  takeImplicitFirstStep=0
 implicitUpwind=0 (1= add upwind diss. to implicit matrix)
 grid-CFL= 2.27e+00 for grid=0 (innerBackGround)
 grid-CFL= 1.04e+01 for grid=1 (iBeam1)
 grid-CFL= 1.04e+01 for grid=2 (iBeam2)
 grid-CFL= 1.04e+01 for grid=3 (iBeam3)
 grid-CFL= 1.04e+01 for grid=4 (splitRing1)
 grid-CFL= 1.04e+01 for grid=5 (splitRing2)
 grid-CFL= 1.04e+01 for grid=6 (splitRing3)
 grid-CFL= 5.43e+00 for grid=7 (triangle1)
 grid-CFL= 5.43e+00 for grid=8 (triangle2)
 grid-CFL= 5.43e+00 for grid=9 (triangle3)
 grid-CFL= 5.43e+00 for grid=10 (triangle4)
 grid-CFL= 5.43e+00 for grid=11 (triangle5)
 grid-CFL= 5.43e+00 for grid=12 (triangle6)
 c=1, useSuperGrid=0, damp=0
 filterTimeDerivative=0, useFilterWeights=1, viFactor=4.68342e-310
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=1, numToDeflate=16, eigenVectorFile=[/home/henshw/runs/eig/multiObjectsGride2EigsEv512.show]
 Estimated asymptotic convergence rate= 0.892.
 freq= 0, omega=   8.000, (adjusted=   7.834) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00
Direct solve Helmholtz: cpu= 4.92e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]

CgWaveHoltz::residual: grid=0 : maxRes= 2.46e+00
CgWaveHoltz::residual: grid=1 : maxRes= 3.31e-01
CgWaveHoltz::residual: grid=2 : maxRes= 3.78e-01
CgWaveHoltz::residual: grid=3 : maxRes= 3.98e-01
CgWaveHoltz::residual: grid=4 : maxRes= 2.55e-01
CgWaveHoltz::residual: grid=5 : maxRes= 1.61e-01
CgWaveHoltz::residual: grid=6 : maxRes= 2.24e-01
CgWaveHoltz::residual: grid=7 : maxRes= 1.71e-01
CgWaveHoltz::residual: grid=8 : maxRes= 4.01e-01
CgWaveHoltz::residual: grid=9 : maxRes= 5.09e-01
CgWaveHoltz::residual: grid=10 : maxRes= 4.42e-01
CgWaveHoltz::residual: grid=11 : maxRes= 3.83e-01
CgWaveHoltz::residual: grid=12 : maxRes= 4.38e-01
CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.458e+00.
solveHelmholtz: max-res=2.458e+00 (all frequencies)
solveHelmholtz: rel-max-diff=4.65e-02, |v|_max= 9.94e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



FREQ=6 deflate 8
cgwh -noplot gaussian.cmd -g=multiObjectsGride2.order2 -ts=implicit -cfl=1000 -x0=-2.0 -y0=-2.75 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=6 -adjustHelmholtzForUpwinding=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride2EigsEv512.show -deflateWaveHoltz=1 -numToDeflate=8 -matlab=multiObjectsFreq6Np8G2Order2ImpDeflate8 -go=dfk


NO DEFLATION: slow convergence 
cgwh -noplot gaussian.cmd -g=multiObjectsGride2.order2 -ts=implicit -cfl=1000 -x0=-2.0 -y0=-2.75 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=5 -adjustHelmholtzForUpwinding=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride2EigsEv512.show -deflateWaveHoltz=0 -numToDeflate=4 -matlab=multiObjectsFreq5Np8G2Order2Imp -go=dfk



EASIER: CHECK RESIDUALS -- soemthing funny -plot is wrong **FIXED**

cgwh gaussian.cmd -g=multiObjectsGride2.order2 -ts=implicit -cfl=1000 -x0=-2.0 -y0=-2.75 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -freq=2 -adjustHelmholtzForUpwinding=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -eigenVectorFile=/home/henshw/runs/eig/multiObjectsGride2EigsEv512.show -deflateWaveHoltz=0 -numToDeflate=4 -go=halt

Convergence rate CR=0.426, CR-perPeriod=0.899, Time to solve = 7.20e+01(s) : CgWave= 7.18e+01(s) 99.69%, advance= 7.16e+01(s) 99.40%

residual: grid=0 : maxRes= 1.56e-05
residual: grid=1 : maxRes= 6.15e-08
residual: grid=2 : maxRes= 5.89e-07
residual: grid=3 : maxRes= 1.27e-06
residual: grid=4 : maxRes= 1.68e-08
residual: grid=5 : maxRes= 1.41e-07
residual: grid=6 : maxRes= 1.12e-07
residual: grid=7 : maxRes= 5.38e-09
residual: grid=8 : maxRes= 5.97e-08
residual: grid=9 : maxRes= 4.52e-08
residual: grid=10 : maxRes= 1.27e-09
residual: grid=11 : maxRes= 4.18e-08
residual: grid=12 : maxRes= 4.15e-08
residual: grid=0 : maxRes= 1.17e+02
residual: grid=1 : maxRes= 3.92e+00
residual: grid=2 : maxRes= 3.81e+01
residual: grid=3 : maxRes= 3.97e+01
residual: grid=4 : maxRes= 1.01e+01
residual: grid=5 : maxRes= 4.36e+01
residual: grid=6 : maxRes= 3.26e+01
residual: grid=7 : maxRes= 1.02e-01
residual: grid=8 : maxRes= 2.75e+01
residual: grid=9 : maxRes= 1.85e+01
residual: grid=10 : maxRes= 1.13e-01
residual: grid=11 : maxRes= 1.62e+01
residual: grid=12 : maxRes= 2.42e+01
CgWaveHoltz::residual: freq= 0, omega=   2.000, max-res=1.558e-05 (using omega), max-res=1.170e+02 (using omega from discrete symbol)
solveHelmholtz: max-res=1.558e-05 (all frequencies)
solveHelmholtz: rel-max-diff=1.81e-09, |v|_max= 1.06e+02 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



CHECK amp : + or minus ?
freq
cgwh gaussian.cmd -g=multiObjectsGride2.order2 -ts=implicit -cfl=1000 -x0=-2.0 -y0=-2.75 -nf=1 -amp=-200 -beta=7 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-9 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -freq=10 -adjustHelmholtzForUpwinding=1 -bc=d -implicitUpwind=0 -minStepsPerPeriod=20 -go=halt


CGWAVE : MAKE A MOVIE: 
cgWave gaussian.cmd -g=multiObjectsGride2.order2 -beta=10 -x0=-2.2 -y0=-2.2 -omega=10 -amp=-200 -ts=explicit -cfl=.95 -upwind=1 -tf=100 -tp=.05 -orderInTime=-1 -bc=d -debug=0 -implicitUpwind=0 -go=halt


*************************************************
**** Tues July 18, 2023

deflate=4
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=8 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=4  -matlab=diskFourFreqNp8G4Order4ImpDeflate4 -go=dfk > diskFourFreqNp8G4Order4ImpDeflate4.out

DISK FOUR FREQ IMP 
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=40 -numPeriods=8 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=0 -numToDeflate=4  -matlab=diskFourFreqNp8G4Order4Imp -go=dfk > diskFourFreqNp8G4Order4Imp.out

DISK FOUR FREQ Exp
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=40 -numPeriods=8 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=0 -numToDeflate=4  -matlab=diskFourFreqNp8G4Order4Exp -go=dfk > diskFourFreqNp8G4Order4Exp.out


IMPLICIT NF=1, NP=4 *BROKEN* ... FIXED
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=diskOneFreqNp4G4Order4Imp -go=dfk > diskOneFreqNp4G4Order4Imp.out


IMPLICIT NF=1, NP=1 *BROKEN* ... FIXED
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=diskOneFreqNp1G4Order4Imp -go=dfk > diskOneFreqNp1G4Order4Imp.out


*************************************************
**** Wed July 12, 2023

ADD new check's for WaveHoltz


SQUARE: 

cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=halt

BC=d 
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -bc=d -minStepsPerPeriod=20 -go=halt

Convergence rate CR=0.217, CR-perPeriod=0.466, Time to solve = 2.68e-01(s) : CgWave= 2.59e-01(s) 96.75%, advance= 2.53e-01(s) 94.43%
 max-residual=3.76e-12 (WaveHoltz its), numberOfIterations = 17 (Krylov) (maximumNumberOfIterations=1000)
 
CgWaveHoltz::residual: freq= 0, omega=  20.000, max-res=5.439e-11 (using omega), max-res=1.145e+01 (using omega from discrete symbol)
solveHelmholtz: max-res=5.439e-11 (all frequencies)
solveHelmholtz: rel-max-diff=3.41e-13, |v|_max= 8.81e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

*************************************************
**** Tues July 11, 2023


SISE -- do not match yet , WHY??
cgwh gaussian.cmd -g=sise2.order2 -ts=implicit -cfl=1000 -x0=0.0 -y0=0.0 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

Check residual for Cartesian grid + superGrid : grid=0
residual: upwindDissipationCoefficient=    8.8388e-02, betaUpwindOld=-1.768, betaUpwind=-1.768
residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 5.47e-10, 1.12e-08], max|rhs|= 1.32e-45
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 5.47e-10, 1.12e-08], max|rhs|= 1.32e-45
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 5.47e-10, 1.12e-08], max|rhs|= 1.32e-45
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 5.47e-10, 1.12e-08], max|rhs|= 1.32e-45
residual: upwindDissipationCoefficient=    8.8388e-02, betaUpwindOld=-1.768, betaUpwind=-1.768
solveHelmholtz: max-residual [Re,Im]=[4.34e-02,3.08e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[1.56e-02,2.09e-02],  norm [Re,Im]=[2.08e+00,2.91e+00] (between WaveHoltz and Direct Helmholtz)



+++++++++ IMP + SG + IUW  **BROKEN ... FIXED*
**SOLUTIONS MATCH**
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt





FIXED DIRECT HELMHOLTZ SOLVER : WIDE UPWIND STENCIL: UPWIND
  >>> ADDED active point to SparseRep





TROUBLE sise1 for some reason
cgwh gaussian.cmd -g=sise1.order2 -ts=implicit -cfl=1000 -x0=0.0 -y0=0.0 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt



cgwh gaussian.cmd -g=sbs.hdf -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt -debugOges=63

*************************************************
**** Sun July 9, 2023


FIX DIRECT HELMHOLTZ SOLVER : WIDE UPWIND STENCIL: UPWIND


cgwh gaussian.cmd -g=sise2.order2 -ts=implicit -cfl=1000 -x0=0.0 -y0=0.0 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt


>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>.
 ++++ CIC IMP ++++

CIC IMP : why don't solutions match ??

cgwh gaussian.cmd -g=cice4.order2 -ts=implicit -cfl=1000 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -implicitUpwind=1 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -go=halt

cgwh gaussian.cmd -g=cice2.order2 -ts=implicit -cfl=1000 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -implicitUpwind=1 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -go=halt


solveHelmholtz: max-residual [Re,Im]=[1.36e-01,1.28e-01]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[8.12e-02,8.11e-02],  norm [Re,Im]=[2.26e+00,2.76e+00] (between WaveHoltz and Direct Helmholtz)


cgwh gaussian.cmd -g=cice2.order2 -ts=implicit -cfl=1000 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt


RSIS
cgwh gaussian.cmd -g=rsise4.order2 -ts=implicit -cfl=1000 -x0=0.0 -y0=0.0 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt


SIS 
   -- residual zero except near interpolation boundary where special upwind formula is used.
   -- solution looks funny --> use default superGridWidth !!

cgwh gaussian.cmd -g=sise4.order2 -ts=implicit -cfl=1000 -x0=0.0 -y0=0.0 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

Direct: 
residual: upwindDissipationCoefficient=    8.8388e-02, betaUpwindOld=-1.768, betaUpwind=-1.768
CgWaveHoltz: omega=2.000e+01, max-res=2.079e-12 (direct Helmholtz solution)



<<<<<<<<<<<<<<<<<,


IMP + Exp-UW-PC 
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=halt

solveHelmholtz: max-residual [Re,Im]=[2.60e-03,6.42e-03]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.38e-03,1.77e-02],  norm [Re,Im]=[8.04e-01,1.58e+00] (between WaveHoltz and Direct Helmholtz)


+++++++++ IMP + SG + IUW
**SOLUTIONS MATCH**
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

*************************************************
**** Sat July 8, 2023

>>>> residual: check EM2 BC residual

BUG FIXED: direct-Helm : add upwinding on the boundary

BUG FIXED: gridCFL was WRONG -- NOW STORE c/dx instead since dt can change

XXXXXX Increase minStepsPerPeriod

--> BETTER But not matching MATLAB yet

*** CHECK CORRECTION TO UPWIND PARAMETER***

cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -minStepsPerPeriod=20 -go=halt

CgWave: 
 Time stepping = implicit, cfl=100.00, dt=1.604e-02, minStepsPerPeriod=20, numberOfStepsPerSolve=40, totalTimeStepsStaken=1160, aveItsPerImplicitSolve=  0.0
  takeImplicitFirstStep=0
 implicitUpwind=0 (1= add upwind diss. to implicit matrix)
 grid-CFL= 1.45e+00 for grid=0 (square)
 c=1, useSuperGrid=1, damp=0
 filterTimeDerivative=1, useFilterWeights=1, viFactor=1
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=  20.000, (adjusted=  19.585) T= 0.31416, Tbar= 0.62832, numPeriods=  2, Tbar(0)/T=  2.00

solveHelmholtz: max-residual [Re,Im]=[5.78e-02,4.85e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[1.44e-02,1.88e-02],  norm [Re,Im]=[8.04e-01,1.58e+00] (between WaveHoltz and Direct Helmholtz)

INTERIOR ERRORS 
solveHelmholtz: rel-max-diff [Re,Im]=[2.69e-03,1.81e-02],  norm [Re,Im]=[8.04e-01,1.58e+00] (between WaveHoltz and Direct Helmholtz)




MATLAB:
==============================================================================
========================= WaveHoltz SUMMARY ==================================
  ms=gaussian, tol= 1.00e-16, numFixPointIterations=20
  Gaussian parameters: amp=1000, beta=20, [x0,y0]=[0.5,0.5]
  nd=2, [ax,bx]x[ay,by]=[0,1]x[0,1], Nx=64, Ny=64, numGhost=2, cfl=1000
  bc = [EM2,EM2,EM2,EM2]
  damp=0, filterTimeDerivative=1, useFilterWeights=1, viFactor=1 
  isign=-1 : exp( isign*I*omegat), phase=0 : for cos( omega*t + phase*pi ) forcing 
  upwind=1 (WaveHoltz), upwindh=1 (Helmholtz), upwindScaleFactor=0.688772, implicitUpwind=0
  useUpwindCoeff=0 : 1= compute UPW coeff arrays uwx(:,:), uwy(:,:) using getUpwindCoefficients
  superGrid=1, superGridWidth=0.2,  superGridh=1 (HelmHoltz)
  Nf=1, Np=2, adjustOmega=1, useDiscreteBetaFunction=1
  implicit=1, tFinal=  0.6416, minStepsPerPeriod=20, Nt=40, adjustForcingForImplicitTimeStepping=0
  deflateRitz=0, ritzConvergenceTol= 1.00e-08
  freq=1: omega=2.000000e+01, omega(adj)=1.958487e+01, Tbar=6.283185e-01, Tbar(adj)=6.416368e-01, Np=2
  Krylov: average-CR=0.3474, FPI-ACR=0.9999, its=26, ||res||_h= 1.01e-13
==============================================================================
  freq=1: max || H v -f ||/omega^2  = 2.05e-01 (residual in WaveHoltz solution v)
  freq=1: max || v - Helmholtz ||   = 4.18e-03 (error in WaveHoltz - Helmholtz)







>>>>>>>>>>>> TRY EXPLICIT-UW : trouble: 
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

CFL=1 : OK 
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt
solveHelmholtz: max-residual [Re,Im]=[2.05e-02,2.59e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[4.67e-03,4.18e-03],  norm [Re,Im]=[8.05e-01,1.56e+00] (between WaveHoltz and Direct Helmholtz)

<<<<<<<<<<<<<<<<<<<<


FREQ=40
cgwh gaussian.cmd -g=square128.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=40 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -saveShow=squareImpSuperGridIUW.show -go=halt

CURV: 
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

 bcOpt: implicit BC for absorbing/EM2 -- CURVILINEAR : finish me
STOP 4444

+++++++++ IMP + SG + IUW
**SOLUTIONS MATCH**
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

>>>>>>solveHelmholtzDirect: upwindDissipationCoefficient=0.0883883, old-way=0.0883883
 Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 1.85e-14, 2.49e-14], max|rhs|= 2.87e-36
 Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 1.07e-14, 2.13e-14], max|rhs|= 2.87e-36
 Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 1.60e-14, 2.44e-14], max|rhs|= 2.87e-36
 Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 1.24e-14, 1.60e-14], max|rhs|= 2.87e-36

 ^^^^^^ solveHelmholtzDirect: max-rel-res [re,Im]=[1.54e-12,1.08e-12] ^^^^^^^^


residual: upwindDissipationCoefficient=    8.8388e-02, betaUpwindOld=-1.768, betaUpwind=-1.768
residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 5.30e-11, 1.34e-09], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 5.30e-11, 1.34e-09], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 5.30e-11, 1.34e-09], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 5.30e-11, 1.34e-09], max|rhs|= 6.51e-44
Check residual for Cartesian grid + superGrid : grid=0
residual: upwindDissipationCoefficient=    8.8388e-02, betaUpwindOld=-1.768, betaUpwind=-1.768
residual: Absorbing BC: (side,axis,grid)={0,0,0) max-res=[ 5.30e-11, 1.34e-09], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,0,0) max-res=[ 5.30e-11, 1.34e-09], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={0,1,0) max-res=[ 5.30e-11, 1.34e-09], max|rhs|= 6.51e-44
residual: Absorbing BC: (side,axis,grid)={1,1,0) max-res=[ 5.30e-11, 1.34e-09], max|rhs|= 6.51e-44

solveHelmholtz: max-residual [Re,Im]=[3.15e-12,1.44e-12]
solveHelmholtz: rel-max-diff [Re,Im]=[2.28e-12,1.24e-12],  norm [Re,Im]=[8.05e-01,1.55e+00] (between WaveHoltz and Direct Helmholtz)


*************************************************
**** Fri July 7, 2023

>>> CLEAN UP adSosup : NEW function:: getUpwindDissipationCoeff(grid)

>>> ADD EM2 ABC to direct helmholtz solve:

explicit-upwind
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -go=halt

solveHelmholtz: max-residual [Re,Im]=[3.61e-04,1.26e-03]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[3.61e-03,4.08e-03],  norm [Re,Im]=[8.05e-01,1.56e+00] (between WaveHoltz and Direct Helmholtz)

+++++++++++++++++++

cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=100 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=1 -adjustErrorsForSuperGrid=1 -go=halt

 ^^^^^^ solveHelmholtzDirect: max-rel-res [re,Im]=[1.52e-12,1.51e-12] ^^^^^^^^

solveHelmholtz: max-residual [Re,Im]=[4.30e-13,1.11e-12]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[5.33e-05,7.26e-05],  norm [Re,Im]=[8.05e-01,1.55e+00] (between WaveHoltz and Direct Helmholtz)



EM2 + IMP + SG + IUW : MATCH TO MATLAB ( ***CHANGED BETA*** )
>>> FIX RESIDUAL

cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt


cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

RESIDUAL IS NOW ZERO
solveHelmholtz: max-residual [Re,Im]=[1.85e-12,1.40e-12]
solveHelmholtz: rel-max-diff [Re,Im]=[3.98e-03,3.60e-03],  norm [Re,Im]=[1.95e+00,2.91e+00] (between WaveHoltz and Direct Helmholtz)


residual: upwindDissipationCoefficient=    8.7180e-02, betaUpwindOld=-1.768, betaUpwind=-1.744
solveHelmholtz: max-residual [Re,Im]=[4.38e-03,5.42e-03]
solveHelmholtz: rel-max-diff [Re,Im]=[3.98e-03,3.60e-03],  n


solveHelmholtz: max-residual [Re,Im]=[1.95e-02,1.70e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[4.38e-03,4.02e-03],  norm [Re,Im]=[1.95e+00,2.91e+00] (between WaveHoltz and Direct Helmholtz)


EM2 + EXP + SG + IUW : MATCH TO MATLAB ( ***CHANGED BETA*** )
>>> FIX RESIDUAL
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

solveHelmholtz: max-residual [Re,Im]=[3.10e-02,4.10e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[4.62e-03,4.25e-03],  norm [Re,Im]=[1.95e+00,2.92e+00] (between WaveHoltz and Direct Helmholtz)



EM2 + IMP + SG + NO-UW : MATCH TO MATLAB ( ***CHANGED BETA*** )
>>> NOTE: MANY ITERATIONS NEEDED *EXACT**
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=1000 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -adjustPlotsForSuperGrid=0 -adjustErrorsForSuperGrid=0 -go=halt

solveHelmholtz: max-residual [Re,Im]=[2.75e-12,2.48e-12]
solveHelmholtz: rel-max-diff [Re,Im]=[1.85e-11,9.51e-12],  norm [Re,Im]=[8.44e+00,8.02e-11] (between WaveHoltz and Direct Helmholtz)



EM2 + EXPLICIT + SG + Exp-UW:
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -go=halt

solveHelmholtz: max-residual [Re,Im]=[3.61e-04,1.26e-03]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[7.00e-03,4.08e-03],  norm [Re,Im]=[8.05e-01,1.56e+00] (between WaveHoltz and Direct Helmholtz)

EM2 + EXPLICIT + SG + NO-UW:
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=0 -go=halt

solveHelmholtz: max-residual [Re,Im]=[4.65e-08,4.36e-08]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[9.05e-07,1.00e+00],  norm [Re,Im]=[3.27e+00,3.63e-06] (between WaveHoltz and Direct Helmholtz)



EM2 + IMP : **EXACT** after correction to c in EM2
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -go=halt

solveHelmholtz: max-residual [Re,Im]=[1.46e-12,8.48e-13]
solveHelmholtz: rel-max-diff [Re,Im]=[4.84e-12,2.23e-12],  norm [Re,Im]=[8.08e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)


EM2 + EXPLICIT : **EXACT** after correction to c in EM2
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -go=halt

solveHelmholtz: max-residual [Re,Im]=[2.05e-13,3.60e-13]
solveHelmholtz: rel-max-diff [Re,Im]=[4.30e-12,2.45e-12],  norm [Re,Im]=[8.08e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)


TEST EM2: .. starts to work
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -go=halt


solveHelmholtz: max-residual [Re,Im]=[8.31e-13,8.17e-13]
solveHelmholtz: rel-max-diff [Re,Im]=[3.99e-02,1.94e-02],  norm [Re,Im]=[8.09e-01,1.51e+00] (between WaveHoltz and Direct Helmholtz)

*************************************************
**** Thurs July 6, 2023

>>> CLEAN UP adSosup : NEW function:: getUpwindDissipationCoeff(grid)

>>> ADD EM2 ABC to direct helmholtz solve:
TEST EM2: 
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1.e-10 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -bc=a -implicitUpwind=0 -go=halt



RETURN TO WAVEHOLTZ + SUPERGRID + IMP + IMP-Upwind --> THIS SHOULD BE EXACT MATCH AFTER WE ADJUST UPWIND COEFF

UWI
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1.e-10 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -go=halt

AFTER adjust *not working yet**
solveHelmholtz: max-residual [Re,Im]=[1.08e-06,5.68e-07]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.25e-03,8.09e-04],  norm [Re,Im]=[8.05e-04,1.55e-03] (between WaveHoltz and Direct Helmholtz)


Before adjust
solveHelmholtz: max-residual [Re,Im]=[2.05e-07,1.42e-06]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.46e-03,7.97e-04],  norm [Re,Im]=[8.05e-04,1.56e-03] (between WaveHoltz and Direct Helmholtz)



*************************************************
**** Wed July 5, 2023

RETURN TO WAVEHOLTZ + SUPERGRID + IMP + IMP-Upwind --> THIS SHOULD BE EXACT MATCH AFTER WE ADJUST UPWIND COEFF

UWI
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1.e-10 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -implicitUpwind=1 -go=halt

Before adjust
solveHelmholtz: max-residual [Re,Im]=[2.05e-07,1.42e-06]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.46e-03,7.97e-04],  norm [Re,Im]=[8.05e-04,1.56e-03] (between WaveHoltz and Direct Helmholtz)



cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1.e-10 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt


*************************************************
**** Wed June 28, 2023

RETURN TO WAVEHOLTZ + SUPERGRID

SHAPES + Implicit  starts to work?? but off from direct : needs adjustements maybe
cgwh gaussian.cmd -g=shapesBige2.order2 -x0=-1.25 -y0=0.0 -nf=1 -freq=30 -amp=500 -beta=20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -go=halt -minStepsPerPeriod=40


solveHelmholtz: max-residual [Re,Im]=[5.81e-02,5.89e-02]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.54e-01,1.61e-01],  norm [Re,Im]=[3.29e-01,6.09e-01] (between WaveHoltz and Direct Helmholtz)


SHAPES + explicit : dos not match direct ??
cgwh gaussian.cmd -g=shapesBige2.order2 -x0=-1.25 -y0=0.0 -nf=1 -freq=30 -amp=500 -beta=20 -adjustOmega=1 -ts=explicit -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -go=halt -minStepsPerPeriod=40

solveHelmholtz: max-residual [Re,Im]=[2.24e-01,8.85e-02]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[6.58e-01,4.32e-01],  norm [Re,Im]=[2.80e-01,4.65e-01] (between WaveHoltz and Direct Helmholtz)



cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt


*************************************************
**** Sun June 25, 2023

FIX IMP + SUPER GRID + CARTESIAN

TEST: 
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=1.e-10 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt


IMP CART: ***STARTS TO WORK**
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

Convergence rate CR=0.303, CR-perPeriod=0.551, Time to solve = 1.02e+00(s) : CgWave= 1.01e+00(s) 98.48%, advance= 9.98e-01(s) 97.64%
solveHelmholtz: max-residual [Re,Im]=[3.15e-03,1.93e-02]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.06e-02,5.61e-03],  norm [Re,Im]=[8.04e-01,1.56e+00] (between WaveHoltz and Direct Helmholtz)



IMP CURV: 
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

Convergence rate CR=0.454, CR-perPeriod=0.673, Time to solve = 3.43e-01(s) : CgWave= 3.21e-01(s) 93.65%, advance= 3.09e-01(s) 90.11%
solveHelmholtz: max-residual [Re,Im]=[6.59e-03,2.21e-02]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.19e-02,2.79e-02],  norm [Re,Im]=[8.03e-01,1.60e+00] (between WaveHoltz and Direct Helmholtz)



CIC IMP ** trouble ***
  ---> NO SUPER GRID ON IMPLICIT CARTESIAN YET 
cgwh gaussian.cmd -g=cice2.order2 -ts=implicit -cfl=1000 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -go=halt

CIC EXP : OK 
cgwh gaussian.cmd -g=cice4.order2 -ts=explicit -cfl=.95 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -go=halt

solveHelmholtz: max-residual [Re,Im]=[2.81e-02,2.46e-02]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[5.11e-02,5.51e-02],  norm [Re,Im]=[2.77e+00,2.65e+00] (between WaveHoltz and Direct Helmholtz)



IMP : OK
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

New diss
solveHelmholtz: max-residual [Re,Im]=[6.59e-03,2.21e-02]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.19e-02,2.79e-02],  norm [Re,Im]=[8.03e-01,1.60e+00] (between WaveHoltz and Direct Helmholtz)


OLD dissipation: 
solveHelmholtz: max-residual [Re,Im]=[1.84e-02,2.49e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[1.49e-02,5.56e-02],  norm [Re,Im]=[7.99e-01,1.65e+00] (between WaveHoltz and Direct Helmholtz)


EXP : OK 
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt




REVISIT WAVE HOLTZ + UPWIND + IMPLICIT : USE NEW UPWIND DISS COEFF

cgwh gaussian.cmd -g=shapesBige4.order2 -x0=-1.25 -y0=0.0 -nf=1 -freq=30 -amp=500 -beta=20 -adjustOmega=1 -ts=implicit -cfl=10000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -go=halt -minStepsPerPeriod=40

cgwh gaussian.cmd -g=shapesBige2.order2 -x0=-1.25 -y0=0.0 -nf=1 -freq=30 -amp=500 -beta=20 -adjustOmega=1 -ts=explicit -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -go=halt -minStepsPerPeriod=40


TRY SHAPES: -- seems OK 
cgwh gaussian.cmd -g=shapese2.order2 -x0=0.1 -y0=-0.5 -nf=1 -freq=30 -amp=500 -beta=20 -adjustOmega=1 -ts=implicit -cfl=10000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -go=halt


SHAPES NO SUPERGRID ** TROUBLE ***
cgwh gaussian.cmd -g=shapesBige2.order2 -x0=-1.25 -y0=0.0 -nf=1 -freq=30 -amp=500 -beta=20 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=0 -superGridWidth=0.1 -bc=d -go=halt -minStepsPerPeriod=40


cgwh gaussian.cmd -g=nonSquare128.order2 -ts=implicit -cfl=1 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

solveHelmholtz: max-residual [Re,Im]=[3.61e-04,2.60e-03]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[6.73e-04,1.06e-03],  norm [Re,Im]=[7.99e-01,1.54e+00] (between WaveHoltz and Direct Helmholtz)

IMP + SIMP-UPWIND : OK 
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=implicit -cfl=1 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

solveHelmholtz: max-residual [Re,Im]=[3.17e-03,1.93e-02]
INFO: Set errors to zero in the SuperGrid layers
solveHelmholtz: rel-max-diff [Re,Im]=[2.11e-02,5.69e-03],  norm [Re,Im]=[8.03e-01,1.57e+00] (between WaveHoltz and Direct Helmholtz)


*************************************************
**** Sat June 24, 2023

PLOTS FOR DOC: 

SHAPES BIG
cgwh gaussian.cmd -g=shapesBige4.order2 -x0=-1.25 -y0=0.0 -nf=1 -freq=30 -amp=500 -beta=20 -adjustOmega=1 -ts=explicit -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -go=halt

cgwh gaussian.cmd -g=shapesBige2.order2 -x0=-1.25 -y0=0.0 -nf=1 -freq=30 -amp=500 -beta=20 -adjustOmega=1 -ts=explicit -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -go=halt

SHAPES -- explicit needs too many steps
cgwh gaussian.cmd -g=shapese4.order2 -x0=0.1 -y0=-0.5 -nf=1 -freq=40 -amp=500 -beta=20 -adjustOmega=1 -ts=explicit -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -go=halt


cgwh gaussian.cmd -g=shapese2.order2 -x0=0.1 -y0=-0.5 -nf=1 -freq=30 -amp=500 -beta=20 -adjustOmega=1 -ts=explicit -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a -bc3=a -bc4=a -go=halt



cgwh gaussian.cmd -g=cice8.order2 -ts=explicit -cfl=.95 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -go=halt

cgwh gaussian.cmd -g=cice4.order2 -ts=explicit -cfl=.95 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=10 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -go=halt



 ^^^^^^ solveHelmholtzDirect: max-rel-res [re,Im]=[1.01e-11,1.44e-11] ^^^^^^^^


cgwh -noplot gaussian.cmd -g=shapese4.order2 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=30 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=20 -cfl=10000 -matlab=shapesG4O2freq30Np8Deflate20 -eigenVectorFile=shapesG4O2Ev300.show -deflateWaveHoltz=1 -numToDeflate=20 -go=dfk > shapesG4O2freq30Np8Deflate20.out



>> START TEST IMPLICIT

*BUG FOUND: -- advWave was REDUCING THE DISSIPATION COEFF

IMP: USe IMPLICIT UPWIND FOR NOW: **FIX ME** something is wrong 

cgwh gaussian.cmd -g=nonSquare64.order2 -ts=implicit -cfl=1 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -implicitUpwind=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

IMP -- low CFL OK 
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=implicit -cfl=1 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

solveHelmholtz: rel-max-diff [Re,Im]=[8.25e-03,4.22e-03],  norm [Re,Im]=[8.05e-01,1.57e+00] (between WaveHoltz and Direct Helmholtz)



IMP -- converged but not correct
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

TROUBLE: 
advWave: gridIsImplicit: t=  0.69E-01 REDUCE UPWIND DISS COEFF by gridCFL=  0.91E+02

EXP
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt


solveHelmholtz: max-residual [Re,Im]=[3.60e-04,1.26e-03]
INFO: Set errors to zero in the SuperGrid layers
!!!! adjustSolutionForSuperGrid : Adjust plot for SuperGrid
solveHelmholtz: rel-max-diff [Re,Im]=[7.41e-03,4.19e-03],  norm [Re,Im]=[8.05e-01,1.57e+00] (between WaveHoltz and Direct Helmholtz)


*************************************************
**** Fri June 23, 2023



>>> ADD option to NOT PLOT SuperGrid Layers 

cgwh gaussian.cmd -g=square256.order2 -ts=explicit -cfl=.95 -x0=0.55 -y0=0.55 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=40 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -superGridWidth=0.1 -go=halt

ADJUST ERRORS AND RESIDUALS FOR SUPERGRID 
cgwh gaussian.cmd -g=square128.order2 -ts=explicit -cfl=.95 -x0=0.55 -y0=0.55 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=40 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -superGridWidth=0.1 -go=halt

!!!! adjustSolutionForSuperGrid : Adjust plot for SuperGrid
solveHelmholtz: max-residual [Re,Im]=[1.19e-04,6.78e-05]
INFO: Set errors to zero in the SuperGrid layers
!!!! adjustSolutionForSuperGrid : Adjust plot for SuperGrid
solveHelmholtz: rel-max-diff [Re,Im]=[3.34e-03,3.65e-03],  norm [Re,Im]=[4.91e-01,7.19e-01] (between WaveHoltz and Direct Helmholtz)


>> FIX residual for CgWaveHoltz

TRY THIS: CIC GRID 
cgwh gaussian.cmd -g=cice16.order2 -ts=explicit -cfl=.95 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -go=halt

cgwh gaussian.cmd -g=cice8.order2 -ts=explicit -cfl=.95 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -go=halt

!!!! adjustSolutionForSuperGrid : Adjust plot for SuperGrid
solveHelmholtz: max-residual [Re,Im]=[1.72e-04,4.48e-04]
INFO: Set errors to zero in the SuperGrid layers
!!!! adjustSolutionForSuperGrid : Adjust plot for SuperGrid
solveHelmholtz: rel-max-diff [Re,Im]=[1.44e-03,1.07e-03],  norm [Re,Im]=[8.47e+00,9.16e+00] (between WaveHoltz and Direct Helmholtz)


cgwh gaussian.cmd -g=cice4.order2 -ts=explicit -cfl=.95 -x0=0.8 -y0=0.8 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -superGridWidth=0.1 -bc=d -bc1=a -bc2=a  -bc3=a -bc4=a -go=halt

OVERSET:
cgwh gaussian.cmd -g=sise4.order2 -ts=explicit -cfl=.95 -x0=.0 -y0=.0 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt





CARTESIAN : 
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt


solveHelmholtz: max-residual [Re,Im]=[1.65e-02,2.18e-02]
solveHelmholtz: rel-max-diff [Re,Im]=[7.56e-03,4.16e-03],  norm [Re,Im]=[8.05e-01,1.56e+00] (between WaveHoltz and Direct Helmholtz)


*************************************************
**** Thurs June 22, 2023

FIX direct Helmholtz solve + upwinding

FINISH ME: DirectHelmholtz + SuperGrid + Cartesian

CARTESIAN : Direct solve starts to work, residual wrong still ... WORKS NOW 
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

^^^^^^ solveHelmholtzDirect: max-rel-res [re,Im]=[2.10e-13,1.87e-13] ^^^^^^^^
solveHelmholtz: rel-max-diff [Re,Im]=[7.56e-03,4.16e-03],  norm [Re,Im]=[8.05e-01,1.56e+00] (between WaveHoltz and Direct Helmholtz)

solveHelmholtz: rel-max-diff [Re,Im]=[7.56e-03,4.16e-03],  norm [Re,Im]=[8.05e-01,1.56e+00] (between WaveHoltz and Direct Helmholtz)

CURV: THIS works now
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

 ########## ADD UPWIND TO DIRECT HELMHOLTZ SOLVER Upwind-stencil=5 ####### 
 ^^^^^^ solveHelmholtzDirect: max-res [re,Im]=[1.86e-10,1.52e-10] ^^^^^^^^

solveHelmholtz: max-residual [Re,Im]=[7.04e+01,8.39e+01]
solveHelmholtz: rel-max-diff [Re,Im]=[7.51e-03,4.19e-03],  norm [Re,Im]=[8.05e-01,1.57e+00] (between WaveHoltz and Direct Helmholtz)


OLD: 
2nd-order upwinding
 ^^^^^^ solveHelmholtzDirect: max-res [re,Im]=[3.69e-11,8.10e-11] ^^^^^^^^
*************************************************
**** Wed June 21, 2023

START TEST Upwind in direct Helmholtz solve:

TURN OFF adjustHelmholtzForUpwinding 

FIX SUPERGRID FOR CURVILINEAR : need original metrics for upwinding


START TEST: superGrid -- compare to matlab
FLIP SIGN OF AMP

TRY THIS: BROKEN: 
cgwh gaussian.cmd -g=sice2.order2 -ts=explicit -cfl=.95 -x0=0 -y0=0 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=10 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

Higher freq: 
cgwh gaussian.cmd -g=square128.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=40 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt


CURVILINEAR: 
  FIX directSolver: 
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

off center: 
cgwh gaussian.cmd -g=nonSquare64.order2 -ts=explicit -cfl=.95 -x0=0.55 -y0=0.55 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt

CARTESIAN : STARTS TO WORK
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.5 -y0=0.5 -nf=1 -amp=-1000 -beta=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=20 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -useSuperGrid=1 -bc=a -go=halt


cgwh gaussian.cmd -g=nonSquare64.order2 -ts=explicit -cfl=.95 -x0=0.55 -y0=0.55 -nf=1 -amp=500 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=8 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -go=halt

cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.55 -y0=0.55 -nf=1 -amp=500 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=8 -filterTimeDerivative=1 -damp=0 -adjustHelmholtzForUpwinding=0 -go=halt


cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.55 -y0=0.55 -nf=1 -amp=500 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -freq=8 -filterTimeDerivative=0 -damp=0 -adjustHelmholtzForUpwinding=0 -go=halt

*************************************************
**** Tues June 20, 2023

**BUG FOUND WHEN USING viFactor --> boundary terms in the filter for w.t need to be scaled too

COMPARE TO MATLAB --> Looks OK CR=.75 ACR=.76
cgwh gaussian.cmd -g=square64.order2 -ts=explicit -cfl=.95 -x0=0.55 -y0=0.55 -nf=1 -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -freq=8 -filterTimeDerivative=1 -damp=0.5 -go=halt
------------------------ CgWaveHoltz SUMMARY ------------------------------------
                          Complex Solution 

 grid=/home/henshw/grids/square64.order2.hdf
 Convergence rate CR=0.750, CR-perPeriod=0.866, Time to solve = 2.79e+00(s) : CgWave= 2.78e+00(s) 99.65%, advance= 2.75e+00(s) 98.57%
 max-residual=3.16e-15 (WaveHoltz its), numberOfIterations = 100 (FP) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=5.236e-03, minStepsPerPeriod=10, numberOfStepsPerSolve=300, totalTimeStepsStaken=37500, aveItsPerImplicitSolve=  0.0
 c=1, damp=0.5
 filterTimeDerivative=1, useFilterWeights=1
    implicit solver : none
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   8.000, (adjusted=   8.001) T= 0.78540, Tbar= 1.57080, numPeriods=  2, Tbar(0)/T=  2.00
Direct solve Helmholtz: cpu= 6.49e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]

solveHelmholtz: max-residual [Re,Im]=[1.05e-11,3.69e-12]
solveHelmholtz: rel-max-diff [Re,Im]=[2.71e-13,1.62e-12],  norm [Re,Im]=[3.27e-01,6.40e-02] (between WaveHoltz and Direct Helmholtz)




MATLAB
waveHoltz -ms=gaussian -nd=2 -implicit=0 -cfl=.95 -N0=64 -useFixPoint=1 -useGMRES=1 -kx1=1 -adjustOmega=1 -upwind=0 -tol=1e-14 -numFPI=100 -numPer=2 -numFreq=1 -omega1=8 -amp1=100 -beta1=15 -useDiscreteBetaFunction=1 -bc=dddd -x0=.55 -y0=.55 -useFilterWeights=1 -damp=.5
==============================================================================
========================= WaveHoltz SUMMARY ==================================
  ms=gaussian, tol= 1.00e-14, numFixPointIterations=100
  Gaussian parameters: amp=100, beta=15, [x0,y0]=[0.55,0.55]
  nd=2, [ax,bx]x[ay,by]=[0,1]x[0,1], Nx=64, Ny=64, numGhost=0, cfl=0.95
  bc = [dirichlet,dirichlet,dirichlet,dirichlet]
  damp=0.5, filterTimeDerivative=1, useFilterWeights=1, viFactor=7.99298 
  isign=-1 : exp( isign*I*omegat), phase=0 : for cos( omega*t + phase*pi ) forcing 
  upwind=0 (WaveHoltz), upwindh=0 (Helmholtz)
  superGrid=0, superGridWidth=0.2,  superGridh=0 (HelmHoltz)
  Nf=1, Np=2, adjustOmega=1, useDiscreteBetaFunction=1
  implicit=0, tFinal=  1.5703, minStepsPerPeriod=10, Nt=150, adjustForcingForImplicitTimeStepping=0
  deflateRitz=0, ritzConvergenceTol= 1.00e-08
  freq=1: omega=8.000000e+00, omega(adj)=8.002340e+00, Tbar=1.570796e+00, Tbar(adj)=1.570337e+00, Np=2
  FPI:    average-CR=0.7477, ACR(deflate=0)=0.7678
  Krylov: average-CR=0.2583, FPI-ACR=0.7678, its=17, ||res||_h= 1.70e-11
==============================================================================
  freq=1: max || H v -f ||/omega^2  = 2.57e-10 (residual in WaveHoltz solution v)
  freq=1: max || v - Helmholtz ||   = 5.20e-11 (error in WaveHoltz - Helmholtz)
 

*************************************************
**** Mon June 19, 2023

>>> BUG FOUND: WRONG dt used when computing dampTilde

>>> CLEAN UP viFactor : one definition

>>> Start on implicit:

>> CLEAN UP output


########### CHANGE beta to beta^2 in Gaussian source ###################

DAMP + IMP -- increase numPer or numIterations
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=100 -beta=15 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -freq=8 -filterTimeDerivative=1 -damp=0.5 -go=halt

solveHelmholtz: max-residual [Re,Im]=[3.55e-12,2.83e-12]
solveHelmholtz: rel-max-diff [Re,Im]=[1.18e-14,2.44e-14],  norm [Re,Im]=[3.53e-01,4.74e-02] (between WaveHoltz and Direct Helmholtz)


cgwh: rel-max-diff [Re,Im]=[1.18e-14,2.44e-14],  norm [Re,Im]=[3.53e-01,4.74e-02] (between WaveHoltz and Direct Helmholtz)


>>>>> OLD beta def

DAMP + IMP -- increase numPer or numIterations
cgwh gaussian.cmd -g=square64.order2 -ts=implicit -cfl=1000 -x0=0.5 -y0=0.5 -nf=1 -amp=100 -beta=225 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-16 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -freq=8 -filterTimeDerivative=1 -damp=0.5 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------
                            Complex Solution 

 grid=/home/henshw/grids/square64.order2.hdf
 Convergence rate CR=0.370, CR-perPeriod=0.780, Time to solve = 4.64e-01(s) : CgWave= 4.42e-01(s) 95.28%, advance= 4.31e-01(s) 92.77%
 max-residual=2.78e-16 (WaveHoltz its), numberOfIterations = 35 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1000.00, dt=8.589e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=40, totalTimeStepsStaken=1480, aveItsPerImplicitSolve=  0.0
 c=1, damp=0.5
 filterTimeDerivative=1, useFilterWeights=1
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   8.000, (adjusted=   7.315) T= 0.78540, Tbar= 3.14159, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual (complex): omega=   8.000000000, max-res=[Re,Im]=[3.553e-12,2.832e-12].
CgWaveHoltz: max-res=3.553e-12 (all frequencies)

Direct solve Helmholtz: cpu= 6.23e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=8.589e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff [Re,Im]=[1.18e-14,2.44e-14],  norm [Re,Im]=[3.53e-01,4.74e-02] (between WaveHoltz and Direct Helmholtz)



FPI needs larger Np :  Use numPer=4 **CHECK ME : rate seems to match Theory better than matlab version
cgwh gaussian.cmd -g=square64.order2 -x0=0.5 -y0=0.5 -nf=1 -amp=100 -beta=225 -adjustOmega=1 -cfl=.95 -orderInTime=2 -solver=none -tol=1e-16 -upwind=0 -imode=1 -maxIterations=35 -numPeriods=4 -freq=8 -filterTimeDerivative=1 -damp=0.5 -go=halt

Theory: ACR = .4 
Convergence rate CR=0.396, CR-perPeriod=0.793, Time to solve = 3.83e+00(s) : CgWave= 3.82e+00(s) 99.90%, advance= 3.81e+00(s) 99.55%



Convergence rate CR=0.483, CR-perPeriod=0.834, Time to solve = 5.21e+00(s) : CgWave= 5.21e+00(s) 99.91%, advance= 5.19e+00(s) 99.56%
cgwh: rel-max-diff [Re,Im]=[5.76e-13,2.24e-12],  norm [Re,Im]=[3.53e-01,4.74e-02] (between WaveHoltz and Direct Helmholtz)

EXPLICIT:  NOW exact 
cgwh gaussian.cmd -g=square64.order2 -x0=0.5 -y0=0.5 -nf=1 -amp=100 -beta=225 -adjustOmega=1 -cfl=.95 -orderInTime=2 -solver=none -tol=1e-16 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=8 -filterTimeDerivative=1 -damp=0.5 -go=halt

*FIXED* 
cgwh: rel-max-diff [Re,Im]=[8.64e-15,1.36e-14],  norm [Re,Im]=[3.53e-01,4.74e-02] (between WaveHoltz and Direct Helmholtz)


cfl=.1
cgwh: rel-max-diff [Re,Im]=[4.98e-12,6.79e-11],  norm [Re,Im]=[3.53e-01,4.74e-02] (between WaveHoltz and Direct Helmholtz)

cfl=.95:
CgWaveHoltz::residual (complex): omega=   8.000000000, max-res=[Re,Im]=[9.746e-08,7.258e-07].
CgWaveHoltz: max-res=7.258e-07 (all frequencies)

cgwh: rel-max-diff [Re,Im]=[8.36e-09,5.02e-07],  norm [Re,Im]=[3.53e-01,4.74e-02] (between WaveHoltz and Direct Helmholtz)


Matalab: exact: 
waveHoltz -ms=gaussian -nd=2 -implicit=0 -cfl=.9 -N0=50 -useFixPoint=1 -useGMRES=1 -kx1=1 -adjustOmega=1 -upwind=0 -tol=1e-16 -numFPI=50 -numPer=2 -numFreq=1 -omega1=8 -amp1=100 -beta1=15 -useDiscreteBetaFunction=1 -bc=dddd -x0=.5 -damp=.5

  freq=1: max || H v -f ||/omega^2  = 5.51e-13 (residual in WaveHoltz solution v)
  freq=1: max || v - Helmholtz ||   = 4.75e-14 (error in WaveHoltz - Helmholtz)


*************************************************
**** Sun June 18, 2023

CoNT ON FILTER TIME DERIVATIVE

WaveHoltz + damping
EXPLICIT:  starts to work
cgwh gaussian.cmd -g=square64.order2 -x0=0.5 -y0=0.5 -nf=1 -amp=50 -beta=144 -adjustOmega=1 -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=6 -filterTimeDerivative=1 -damp=1 -go=halt

>>> LATEST: fixed omega used in forming complex solution 
CgWaveHoltz::residual (complex): omega=   6.000000000, max-res=[Re,Im]=[9.632e-05,1.131e-03].
CgWaveHoltz: max-res=1.131e-03 (all frequencies)

Direct solve Helmholtz: cpu= 6.43e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.047e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]
cgwh: rel-max-diff [Re,Im]=[4.46e-08,1.29e-07],  norm [Re,Im]=[1.91e-01,9.77e-02] (between WaveHoltz and Direct Helmholtz)




--> residual is not quite correct yet:
CgWaveHoltz::residual (complex): omega=   6.000, max-res=[Re,Im]=[9.632e-05,1.131e-03]. 

cgwh: rel-max-diff [Re,Im]=[4.46e-08,1.64e-04],  norm [Re,Im]=[1.91e-01,9.77e-02] (between WaveHoltz and Direct Helmholtz)


cgwh: rel-max-diff=4.46e-08, |v|_max= 1.91e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************************
**** Sat June 17, 2023

CoNT ON FILTER TIME DERIVATIVE

START WaveHoltz + damping
EXPLICIT:  looks OK with damp=0 
cgwh gaussian.cmd -g=square64.order2 -x0=0.5 -y0=0.5 -nf=1 -amp=50 -beta=144 -adjustOmega=1 -cfl=.95 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=6 -filterTimeDerivative=1 -damp=0 -go=halt



FIX Direct Helmholtz solver : damping

cgwh gaussian.cmd -g=square64.order2 -x0=0.6 -y0=0.45 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=5 -filterTimeDerivative=1 -go=halt

*************************************************
**** Fri June 16, 2023

START ON FILTER TIME DERIVATIVE


EXP NF=1
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 -y0=0.45 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=1 -freq=5 -filterTimeDerivative=1 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.022, CR-perPeriod=0.022, Time to solve = 1.43e-01(s) : CgWave= 1.30e-01(s) 91.04%, advance= 1.26e-01(s) 88.21%
 max-residual=1.01e-12 (WaveHoltz its), numberOfIterations = 7 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1000.00, dt=6.871e-01, minStepsPerPeriod=10, numberOfStepsPerSolve=10, totalTimeStepsStaken=90, aveItsPerImplicitSolve=  0.0
 filterTimeDerivative=0, useFilterWeights=1
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   1.000, (adjusted=   0.914) T= 6.28319, Tbar= 6.28319, numPeriods=  1, Tbar(0)/T=  1.00

CgWaveHoltz::residual: freq= 0, omega=   1.000, max-res=2.707e-10 (using omega), max-res=1.191e-02 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.707e-10 (all frequencies)

Direct solve Helmholtz: cpu= 5.60e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=6.871e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=4.57e-13, |v|_max= 3.67e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



+++++++++ TESTS +++++++++++ 

IMP NF=2
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -amp=50 50 -beta=150 150 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=3 -freq=5 9 -go=dfk


--NEW-- useFilterWeights=1 
cgwh: rel-max-diff=1.97e-13 for freq0 =   5.0000e+00, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.04e-09 for freq1 =   9.0000e+00, |v|_max= 6.20e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.04e-09, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.109, CR-perPeriod=0.477, Time to solve = 8.41e-01(s) : CgWave= 8.12e-01(s) 96.49%, advance= 8.05e-01(s) 95.76%
 max-residual=1.55e-13 (WaveHoltz its), numberOfIterations = 13 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1000.00, dt=7.165e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=54, totalTimeStepsStaken=6210, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   5.000, (adjusted=   4.872) T= 1.25664, Tbar= 3.76991, numPeriods=  3, Tbar(0)/T=  3.00
 freq= 1, omega=   9.000, (adjusted=   8.311) T= 0.69813, Tbar= 3.49066, numPeriods=  5, Tbar(0)/T=  5.40

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=4.269e-11.
CgWaveHoltz::residual: freq= 1, omega=   9.000, max-res=3.968e-11.
CgWaveHoltz: max-res=4.269e-11 (all frequencies)

Direct solve Helmholtz: cpu= 9.43e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=7.165e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=2.06e-13 for freq0 =   5.0000e+00, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.04e-09 for freq1 =   9.0000e+00, |v|_max= 6.20e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.04e-09, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh: rel-max-diff=2.06e-13 for freq0 =   5.0000e+00, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.04e-09 for freq1 =   9.0000e+00, |v|_max= 6.20e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.04e-09, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



EXP NF=2
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -amp=50 50 -beta=150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=3 -cfl=0.95 freq=5 9 -go=halt

cgwh: rel-max-diff=2.80e-13 for freq0 =   5.0000e+00, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.04e-09 for freq1 =   9.0000e+00, |v|_max= 6.20e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.04e-09, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

IMP NF=1
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -amp=50 50 -beta=150 150 -adjustOmega=1 -ts=implicit -cfl=1000 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 freq=5 9 -go=halt

cgwh: rel-max-diff=2.81e-13 for freq0 =   1.0000e+00, |v|_max= 3.67e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.62e-09 for freq1 =   2.0000e+00, |v|_max= 4.08e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.62e-09, |v|_max= 4.08e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************************
**** Thurs May 18, 2023

**CHECK** IS UPWINDING NEEDED??

G4 -- higher freq : OK 
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=0.2 -y0=0.1 -nf=1 -freq=12  -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -cfl=.9 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=2 -go=halt



G8 OK 
cgwh gaussian.cmd -g=sice8.order4.ng3 -x0=0.0 -y0=0.0 -nf=1 -freq=7  -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -cfl=.9 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -go=halt


EXPLICIT: OK TOO
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=0.0 -y0=0.0 -nf=1 -freq=7  -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -cfl=.9 -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2  -eigenVectorFile=diskG4O4Ev64.show -go=halt


IMPLICIT: 
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=0.0 -y0=0.0 -nf=1 -freq=7  -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=50 -numPeriods=2 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -go=halt

FIX-POINT : OK too

NO-UPWIND - OK
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.267, CR-perPeriod=0.517, Time to solve = 5.71e-01(s) : CgWave= 5.57e-01(s) 97.51%, advance= 5.49e-01(s) 96.06%
 max-residual=1.16e-12 (WaveHoltz its), numberOfIterations = 20 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.816e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=20, totalTimeStepsStaken=520, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[diskG4O4Ev64.show]
 freq= 0, omega=   7.000, (adjusted=   6.401) T= 0.89760, Tbar= 1.79520, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=1.556e-10 (using omega), max-res=2.359e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.556e-10 (all frequencies)

Direct solve Helmholtz: cpu= 1.26e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=9.816e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.72e-09, |v|_max= 3.86e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


UPWIND
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.267, CR-perPeriod=0.517, Time to solve = 6.45e-01(s) : CgWave= 6.33e-01(s) 98.13%, advance= 6.25e-01(s) 96.88%
 max-residual=1.10e-12 (WaveHoltz its), numberOfIterations = 20 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.816e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=20, totalTimeStepsStaken=1340, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[diskG4O4Ev64.show]
 freq= 0, omega=   7.000, (adjusted=   6.401) T= 0.89760, Tbar= 1.79520, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=1.759e-10 (using omega), max-res=2.359e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.759e-10 (all frequencies)

Direct solve Helmholtz: cpu= 1.18e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=9.816e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.95e-09, |v|_max= 3.86e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************************
**** Sat April 1, 2023

REORGANIZATION of cgwh ..

TESTS

IMP NP=2
cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 0.5 -y0=0.4 0.5 0.5 -nf=2 -freq=5 9.777 12.34 -amp=100 100 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -cfl=10000 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.239, CR-perPeriod=0.488, Time to solve = 8.11e-01(s) : CgWave= 7.79e-01(s) 95.96%, advance= 7.71e-01(s) 95.06%
 max-residual=1.32e-11 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=6.416e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=40, totalTimeStepsStaken=680, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   5.000, (adjusted=   4.896) T= 1.25664, Tbar= 2.51327, numPeriods=  2, Tbar(0)/T=  2.00
 freq= 1, omega=   9.777, (adjusted=   9.064) T= 0.64265, Tbar= 1.92795, numPeriods=  3, Tbar(0)/T=  3.91

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=2.001e-09.
CgWaveHoltz::residual: freq= 1, omega=   9.777, max-res=4.518e-09.
CgWaveHoltz: max-res=4.518e-09 (all frequencies)

Direct solve Helmholtz: cpu= 9.02e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=6.416e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.96e-11 for freq0 =   5.0000e+00, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=5.83e-10 for freq1 =   9.7770e+00, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=5.83e-10, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





EXP NP=4
cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 0.5 -y0=0.4 0.5 0.5 -nf=2 -freq=5 9.777 12.34 -amp=100 100 50 -beta=400 400 400 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.000, CR-perPeriod=0.111, Time to solve = 6.50e+00(s) : CgWave= 6.48e+00(s) 99.78%, advance= 6.48e+00(s) 99.73%
 max-residual=1.23e-14 (WaveHoltz its), numberOfIterations = 3 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=1.312e-03, minStepsPerPeriod=10, numberOfStepsPerSolve=3832, totalTimeStepsStaken=19160, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   5.000, (adjusted=   5.000) T= 1.25664, Tbar= 5.02655, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=   9.777, (adjusted=   9.777) T= 0.64265, Tbar= 4.49855, numPeriods=  7, Tbar(0)/T=  7.82

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=3.151e-10.
CgWaveHoltz::residual: freq= 1, omega=   9.777, max-res=6.479e-10.
CgWaveHoltz: max-res=6.479e-10 (all frequencies)

Direct solve Helmholtz: cpu= 9.00e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.312e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=6.56e-14 for freq0 =   5.0000e+00, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.53e-13 for freq1 =   9.7770e+00, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.53e-13, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************************
**** Mon March 6, 2023

MATCH TO MATLAB CODE
cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 -y0=0.4 0.5 -nf=2 -freq=5 11 -amp=100 100 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -cfl=10000 -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2  -go=halt


=====
ADJUSTED: 
 freq=0 frequency=  4.914370688310e+00 period=  2.557066084626e+00, numberOfPeriods=2
 freq=1 frequency=  1.017092745063e+01 period=  2.471037312057e+00, numberOfPeriods=4

 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   5.000, (adjusted=   4.914) T= 1.25664, Tbar= 2.51327, numPeriods=  2, Tbar(0)/T=  2.00
 freq= 1, omega=  11.000, (adjusted=  10.171) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.40

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=4.563e-10.
CgWaveHoltz::residual: freq= 1, omega=  11.000, max-res=9.823e-10.
CgWaveHoltz: max-res=9.823e-10 (all frequencies)

Direct solve Helmholtz: cpu= 8.72e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.812e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=2.67e-11 for freq0 =   5.0000e+00, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.50e-10 for freq1 =   1.1000e+01, |v|_max= 1.89e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.50e-10, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



revisit multi-freq:
no adjust: -- looks broken?
cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 0.5 -y0=0.4 0.5 0.5 -nf=2 -freq=5 9.777 12.34 -amp=100 100 50 -beta=400 400 400 -adjustOmega=0 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -go=halt


cgwh gaussian.cmd -g=square128.order2 -x0=0.4 0.5 0.5 -y0=0.4 0.5 0.5 -nf=2 -freq=5 9.777 12.34 -amp=100 100 50 -beta=400 400 400 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -go=halt

 
 freq= 0, omega=   5.000, (adjusted=   5.000) T= 1.25664, Tbar= 5.02655, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=   9.777, (adjusted=   9.777) T= 0.64265, Tbar= 4.49855, numPeriods=  7, Tbar(0)/T=  7.82

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=3.151e-10.
CgWaveHoltz::residual: freq= 1, omega=   9.777, max-res=6.479e-10.
CgWaveHoltz: max-res=6.479e-10 (all frequencies)

Direct solve Helmholtz: cpu= 9.42e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.312e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=6.56e-14 for freq0 =   5.0000e+00, |v|_max= 5.62e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.53e-13 for freq1 =   9.7770e+00, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.53e-13, |v|_max= 2.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

*************************************************
**** Sun Feb 12, 2023


>>>>>>>>>  START TEST DEFLATION ODRER=4

**** DISK: 

cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=0.0 -y0=0.0 -nf=1 -freq=7  -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=4  -matlab=diskFreq7Np2G4Order4ImpDeflate4 -go=dfk > diskFreq7Np2G4Order4ImpDeflate4.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.094, CR-perPeriod=0.307, Time to solve = 3.74e-01(s) : CgWave= 3.66e-01(s) 97.77%, advance= 3.62e-01(s) 96.78%
 max-residual=1.54e-12 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.816e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=20, totalTimeStepsStaken=860, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=1, numToDeflate=8, eigenVectorFile=[diskG4O4Ev64.show]
 Estimated asymptotic convergence rate= 0.313.
 freq= 0, omega=   7.000, (adjusted=   6.401) T= 0.89760, Tbar= 1.79520, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=7.236e-05 (using omega), max-res=2.359e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=7.236e-05 (all frequencies)

Direct solve Helmholtz: cpu= 1.05e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=9.816e-02
CgWaveHoltz::saved results in matlab file=[diskFreq7Np2G4Order4ImpDeflate4Krylov.m]
cgwh: rel-max-diff=2.25e-05, |v|_max= 3.86e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




*********  SQUARE SEEMS TO ROUGHLY WORK

scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/square128O4Ev64.show .

cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=square128O4Ev64.show -matlab=square128Order4Freq9Np2Deflate2Imp -deflateWaveHoltz=1 -numToDeflate=2 -freq=9 -go=dfk > square128Order4Freq9Np3Deflate2Imp.out


cgwh gaussian.cmd -g=square128.order4.ng3 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=square128O4Ev64.show -matlab=square128O4Freq9Np2Deflate2Imp -deflateWaveHoltz=1 -numToDeflate=2 -freq=9 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.123, CR-perPeriod=0.350, Time to solve = 1.46e+00(s) : CgWave= 1.44e+00(s) 98.68%, advance= 1.44e+00(s) 98.29%
 max-residual=2.09e-12 (WaveHoltz its), numberOfIterations = 12 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=7.635e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=20, totalTimeStepsStaken=280, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=1, numToDeflate=3, eigenVectorFile=[square128O4Ev64.show]
 Estimated asymptotic convergence rate= 0.273.
 freq= 0, omega=   9.000, (adjusted=   8.230) T= 0.69813, Tbar= 1.39626, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   9.000, max-res=3.564e-02 (using omega), max-res=6.296e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.564e-02 (all frequencies)

Direct solve Helmholtz: cpu= 2.99e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=7.635e-02
CgWaveHoltz::saved results in matlab file=[square128O4Freq9Np2Deflate2ImpKrylov.m]
cgwh: rel-max-diff=1.16e-05, |v|_max= 6.23e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


-----------------------------------------------



scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/shapesG4O2Ev300.show .
scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/shapesG4O2Ev150.show .

REVIST SHAPES + DEFLATE

FREQ=30 deflate 20
cgwh -noplot gaussian.cmd -g=shapese4.order2 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=30 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=20 -cfl=10000 -matlab=shapesG4O2freq30Np8Deflate20 -eigenVectorFile=shapesG4O2Ev300.show -deflateWaveHoltz=1 -numToDeflate=20 -go=dfk > shapesG4O2freq30Np8Deflate20.out


FREQ=30
cgwh -noplot gaussian.cmd -g=shapese4.order2 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=30 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=20 -cfl=10000 -matlab=shapesG4O2freq30Np8Deflate7 -eigenVectorFile=shapesG4O2Ev300.show -deflateWaveHoltz=1 -numToDeflate=7 -go=dfk > shapesG4O2freq30Np8Deflate7.out


FREQ=15 : OK ACR=.45
cgwh -noplot gaussian.cmd -g=shapese4.order2 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=15 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=20 -cfl=10000 -matlab=shapesG4O2freq15Np8Deflate5 -eigenVectorFile=shapesG4O2Ev150.show -deflateWaveHoltz=1 -numToDeflate=5 -go=dfk > shapesG4O2freq15Np8Deflate5.out



+++++++++++++++ PIPE ++++++++++++++++

plotStuff plotSolution3d -show=pipeOneFreq36G802.show -name=pipe -cf=2

plotStuff plotSolution3d -show=pipeOneFreq35G404.show -name=pipe -cf=2

plotStuff plotSolution3d -show=pipeOneFreq25G4O2.show -name=pipe -cf=2

plotStuff plotSolution3d -show=pipeTwoFreqNp4G4Order2Imp.show -name=pipe -cf=2

plotStuff plotSolution3d -show=pipeTwoFreqNp4G2Order4Imp.show -name=pipe

+++ PIPE: SHOWFILE: G8 O2 NP=8 OMEGA=36
setsid $cgwh -noplot gaussian.cmd -g=pipeze8.order2 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=36 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -matlab=pipeOneFreq36G802 -show=pipeOneFreq36G802.show -go=ks > pipeOneFreq36G802.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze8.order2.hdf
 Convergence rate CR=0.884, CR-perPeriod=0.985, Time to solve = 3.03e+03(s) : CgWave= 3.03e+03(s) 99.92%, advance= 3.03e+03(s) 99.90%
 max-residual=6.94e-05 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.909e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=80, totalTimeStepsStaken=4320, aveItsPerImplicitSolve=  4.8
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]



+++ PIPE: SHOWFILE: G4 O4
$cgwh -noplot gaussian.cmd -g=pipeze4.order4.ng3 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=35 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -matlab=pipeOneFreq35G404 -show=pipeOneFreq35G404.show -go=ks > pipeOneFreq35G404.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze4.order4.ng3.hdf
 Convergence rate CR=0.890, CR-perPeriod=0.971, Time to solve = 8.57e+02(s) : CgWave= 8.57e+02(s) 99.94%, advance= 8.56e+02(s) 99.92%
 max-residual=9.22e-05 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=50)

+++ PIPE: SHOWFILE: G4:
$cgwh -noplot gaussian.cmd -g=pipeze4.order2 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=25 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -show=pipeOneFreq25G4O2.show -go=ks > pipeOneFreq25G4O2.out

Convergence rate CR=0.891, CR-perPeriod=0.972, Time to solve = 1.67e+02(s) : CgWave= 1.66e+02(s) 99.77%, advance= 1.66e+02(s) 99.71%
 max-residual=1.90e-04 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=50)



+++ PIPE: SHOWFILE: G4:
$cgwh -noplot gaussian.cmd -g=pipeze4.order2 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -show=pipeTwoFreqNp4G4Order2Imp.show -go=ks > pipeTwoFreqNp4G4Order2ImpShow.out


++++ SPHERE -- showfile for plots

FINER GRID: 
$cgwh -noplot gaussian.cmd -g=spheree4.order2 -x0=-0.2 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=1 -freq=18 8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -show=sphereOneG4Freq18.show -go=ks > sphereOneG4Freq18.out



$cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=-0.2 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=1 -freq=18 8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -show=sphereOneFreq18.show -go=ks > sphereOneFreq18.out


omega=8.5
$cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -show=sphereOneFreqNp4G2Order4Imp.show -go=ks




+++ REVISIT SHAPES:
IMP NP=4 : OK 
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=shapesG4O4ThreeFreqNp4Imp -go=dfk > shapesG4O4ThreeFreqNp4Imp.out


IMP NP=2 --> ACR=1.1
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=2 -cfl=10000 -matlab=shapesG4O4ThreeFreqNp2Imp -go=dfk > shapesG4O4ThreeFreqNp2Imp.out

+++ revisit pipe

NF=2, NP=4 IMP:  use direct solver: **TO RUN: 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=yale -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -matlab=pipeTwoFreqNp4G2Order4Imp -go=dfk > pipeTwoFreqNp4G2Order4Imp.out


NF=1, NP=4 IMP: 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 -0.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeOneFreqNp4G2Order4Imp -go=fk > pipeOneFreqNp4G2Order4Imp.out


*************************************************
**** Sat Feb 11, 2023



+++++++++++++++++++++++++++++
+++ Revisit sphere

SPHERE2 ODRER=4 EXP: **TO DO**
cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Exp -go=fk > sphereOneFreqNp4G2Order4Exp.out



G2 Order 4 NP=4 - IMP 
setsid $cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=fk > sphereOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/spheree2.order4.ng3.hdf
 Convergence rate CR=0.279, CR-perPeriod=0.727, Time to solve = 3.42e+02(s) : CgWave= 3.42e+02(s) 99.95%, advance= 3.42e+02(s) 99.92%
 max-residual=6.97e-11 (WaveHoltz its), numberOfIterations = 20 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=8.084e-02, minStepsPerPeriod=10, numberOfStepsPerSolve=40, totalTimeStepsStaken=2880, aveItsPerImplicitSolve=  2.4
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   8.500, (adjusted=   7.773) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=6.765e-10 (using omega), max-res=1.250e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.765e-10 (all frequencies)
saveMatlab: dt=8.084e-02
CgWaveHoltz::saved results in matlab file=[sphereOneFreqNp4G2Order4ImpKrylov.m]


+++ REVISIT BOX:

******* CHECK FREQ=2: 

BUG FOUND -- z0 NOT INPUT CORRECTLY  : FIXED: "z0=f{1,}"=>\@z0

cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.5 0.5 -0.2 0.25 -y0=0.5 0.5 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=2 -freq=5.1 8.5  18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -go=halt



cgwh: rel-max-diff=4.05e-11 for freq0 =   1.2000e+01, |v|_max= 1.28e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.04e+02 for freq1 =   2.0000e+01, |v|_max= 6.65e-01 (between WaveHoltz and Direct Helmholtz solution)

cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.45 0.55 -0.2 0.25 -y0=0.55 0.5 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=2 -freq=12.1 19.6 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -go=halt


BOX TWO FREQ NP=8
cgwh -noplot gaussian.cmd -g=box2.order4.ng3 -x0=0.45 0.55 -0.2 0.25 -y0=.6 0.5 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=2 -freq=12.1 19.6 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=boxTwoFreqFreqNp8G2Order4Imp -go=dfk > boxTwoFreqFreqNp8G2Order4Imp.out


BOX TWO FREQ NP=4
cgwh -noplot gaussian.cmd -g=box2.order4.ng3 -x0=0.45 0.55 -0.2 0.25 -y0=.6 0.5 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=2 -freq=12.1 19.6 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=boxTwoFreqFreqNp4G2Order4Imp -go=dfk > boxTwoFreqFreqNp4G2Order4Imp.out




BOX IMP 
cgwh -noplot gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 0.5  -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=boxOneFreqNp4G2Order4Imp -go=dfk > boxOneFreqNp4G2Order4Imp.out

BOX EXP 
cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15  -z0=0.5 0.5 0.5 0.5 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -matlab=boxOneFreqNp4G2Order4Exp -go=dfk



+++++++++ DISK FOUR FREQ + DEFLATE

>>>> TEST ORDER=4:   **TROUBLE**

scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/diskG4O4Ev64.show .
scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/diskG4O2Ev128.show .

cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=8 -cfl=10000 -eigenVectorFile=diskG4O4Ev64.show -deflateWaveHoltz=1 -numToDeflate=4  -matlab=diskFourFreqNp8G4Order4ImpDeflate4 -go=dfk > diskFourFreqNp8G4Order4ImpDeflate4.out


>> DEFLATE=5 ORDER=2
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=8 -cfl=10000 -eigenVectorFile=diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=5  -matlab=diskFourFreqNp8G4Order2ImpDeflate5 -go=dfk > diskFourFreqNp8G4Order2ImpDeflate5.out



>> DEFLATE=4 ORDER=2
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=8 -cfl=10000 -eigenVectorFile=diskG4O2Ev128.show -deflateWaveHoltz=1 -numToDeflate=4  -matlab=diskFourFreqNp8G4Order2ImpDeflate4 -go=dfk > diskFourFreqNp8G4Order2ImpDeflate4.out


EXPLICIT NF=1, NP=1, O4, G8
cgwh -noplot gaussian.cmd -g=sice8.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -matlab=diskOneFreqNp1G8Order4Exp -go=dfk > diskOneFreqNp1G8Order4Exp.out

EXPLICIT NF=1, NP=4
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=0.95 -matlab=diskOneFreqNp4G4Order2Exp -go=dfk

*************************************************
**** Fri Feb 10, 2023


REVISIT DISK:

matlab=
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=diskOneFreqNp4G4Order4Imp -go=dfk > diskOneFreqNp4G4Order4Imp.out



TRY DEFLATION WITH Nf=12
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -eigenVectorFile=square128Ev64.show -deflateWaveHoltz=1 -numToDeflate=5 -matlab=squareFreq12G128O2Np8Deflate5 -go=dfk > squareFreq12G128O2Np8Deflate5.out


cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -eigenVectorFile=square128Ev64.show -deflateWaveHoltz=1 -numToDeflate=9 -matlab=squareFreq12G128O2Np8Deflate9 -go=dfk > squareFreq12G128O2Np8Deflate9.out

REDO -- NITS=10

OLD: NITS=5: NF=12 : IMP NP=8 ECR=.877  its=25, CPU=49.2  
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=squareFreq12G128Np8O4Imp -go=dfk > squareFreq12G128Np8O4Imp.out



*************************************************
**** Sat Feb 4, 2023

DEFLATION FOR A DISK 

scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/diskG4O2Ev64.show .


>>>>>>>> IMP: Deflate 9 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq11Np2Deflate9Imp -deflateWaveHoltz=1 -numToDeflate=9 -freq=11 -go=dfk > diskG4O2Freq11Np2Deflate9Imp.out




>>>>>>>> IMP: Deflate 5 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq11Np2Deflate5Imp -deflateWaveHoltz=1 -numToDeflate=5 -freq=11 -go=dfk > diskG4O2Freq11Np2Deflate5Imp.out


>>>>>>>> IMP: Deflate 3 
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq11Np2Deflate3Imp -deflateWaveHoltz=1 -numToDeflate=3 -freq=11 -go=dfk > diskG4O2Freq11Np2Deflate3Imp.out







EXP: Deflate 3  -- **WORKS**
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq7Deflate3Exp -deflateWaveHoltz=1 -numToDeflate=3 -freq=7 -go=dfk > diskG4O2Freq7Deflate3Exp.out


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order2.hdf
 Convergence rate CR=0.192, CR-perPeriod=0.439, Time to solve = 2.30e-01(s) : CgWave= 2.21e-01(s) 96.02%, advance= 2.16e-01(s) 94.07%
 max-residual=1.80e-12 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.816e-02, numberOfStepsPerSolve=20, totalTimeStepsStaken=1080, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=1, numToDeflate=6, eigenVectorFile=[diskG4O2Ev64.show]
 Estimated asymptotic convergence rate= 0.455.
 freq= 0, omega=   7.000, (adjusted=   6.401) T= 0.89760, Tbar= 1.79520, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=2.816e-02 (using omega), max-res=1.174e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.816e-02 (all frequencies)

Direct solve Helmholtz: cpu= 1.92e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=9.816e-02
CgWaveHoltz::saved results in matlab file=[diskG4O2Freq11Np2Deflate3ImpKrylov.m]
cgwh: rel-max-diff=2.07e-04, |v|_max= 1.92e+01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...


Deflate 2 (2 double)
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=0.2 -y0=-0.15 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=diskG4O2Ev64.show -matlab=diskG4O2Freq7Deflate2Exp -deflateWaveHoltz=1 -numToDeflate=2 -freq=7 -go=dfk > diskG4O2Freq7Deflate2Exp.out


*************************************************
**** Fri Feb 3, 2023

TRY implicit + deflation
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit  -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=3 -cfl=10000 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq9Np3Deflate2Imp -deflateWaveHoltz=1 -numToDeflate=2 -freq=9 -go=dfk > square128O2Freq9Np3Deflate2Imp.out


START ON FINDING PROPER COVERGENCE RATE FOR IMPLICIT TS

INCREASE MIN STEPS PER PERIOD
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000 -minStepsPerPeriod=10 -freq=5 -matlab=square128O2Freq5Np2Imp10 -go=dfk > square128O2Freq5ImpNp2Imp10.out


cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=10000  -freq=5 -matlab=square128O2Freq5Np2Imp -go=dfk > square128O2Freq5ImpNp2.out

----------------------- CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.979, CR-perPeriod=0.979, Time to solve = 5.30e-01(s) : CgWave= 5.15e-01(s) 97.26%, advance= 4.85e-01(s) 91.64%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 100 (FP) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.525e-01, numberOfStepsPerSolve=5, totalTimeStepsStaken=500, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   6.000, (adjusted=   3.565) T= 1.04720, Tbar= 1.04720, numPeriods=  1, Tbar(0)/T=  1.00




CONTINUE ON DEFLATION FOR MULTI-FREQ

Nf=2, Np=3, DEFLATE 2: 
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -amp=50 50 -beta=150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=3 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2TwoFreqNp3Deflate2Exp -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 9 -go=halt

cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=2 -amp=50 50 -beta=150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=3 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2TwoFreqNp3Deflate2Exp -deflateWaveHoltz=1 -numToDeflate=2 -freq=5 9 -go=dfk > square128O2TwoFreqNp3Deflate2Exp.out


 ---- SORTED by beta: freq(0)=  5.0000e+00
 i=   3: lambda=  8.8849e+00, |beta|=  9.9453e-01
 i=   0: lambda=  4.4428e+00, |beta|=  3.6699e-01
 i=   1: lambda=  7.0242e+00, |beta|=  2.0272e-01
 i=   2: lambda=  7.0242e+00, |beta|=  2.0272e-01
 i=   6: lambda=  1.1325e+01, |beta|=  7.4557e-02
 i=   7: lambda=  1.1325e+01, |beta|=  7.4557e-02


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.221, CR-perPeriod=0.605, Time to solve = 1.20e+01(s) : CgWave= 1.20e+01(s) 99.94%, advance= 1.19e+01(s) 99.88%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 17 (FP) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=1.748e-03, numberOfStepsPerSolve=2157, totalTimeStepsStaken=36669, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 deflateWaveHoltz=1, numToDeflate=2, eigenVectorFile=[square128Ev64.show]
 freq= 0, omega=   5.000, (adjusted=   5.000) T= 1.25664, Tbar= 3.76991, numPeriods=  3, Tbar(0)/T=  3.00
 freq= 1, omega=   9.000, (adjusted=   9.000) T= 0.69813, Tbar= 3.49066, numPeriods=  5, Tbar(0)/T=  5.40

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=4.168e-04.
CgWaveHoltz::residual: freq= 1, omega=   9.000, max-res=6.849e-04.
CgWaveHoltz: max-res=6.849e-04 (all frequencies)

Direct solve Helmholtz: cpu= 9.28e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.748e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]
cgwh: rel-max-diff=3.45e-08 for freq0 =   5.0000e+00, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.60e-08 for freq1 =   9.0000e+00, |v|_max= 6.20e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.60e-08, |v|_max= 7.33e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


*************************************************
**** Thurs Feb 2, 2023

START ON DEFLATION FOR MULTI-FREQ

cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -deflateWaveHoltz=1 -numToDeflate=1 -freq=5 -go=halt

>>> NEW:
---- SORTED by beta: freq(0)=  5.0001e+00
 i= 0: lambda=  4.4428e+00, |beta|=  9.2363e-01
 i= 1: lambda=  7.0242e+00, |beta|=  2.2676e-01
 i= 2: lambda=  7.0242e+00, |beta|=  2.2676e-01
 i= 3: lambda=  8.8849e+00, |beta|=  2.1428e-01
 i= 6: lambda=  1.1325e+01, |beta|=  1.3882e-01
 i= 7: lambda=  1.1325e+01, |beta|=  1.3882e-01
 i=11: lambda=  1.4045e+01, |beta|=  9.4575e-02

>>> OLD:

 i=0: omega=  5.0001e+00, lambda=  4.4428e+00, |beta|=  9.2363e-01
 i=1: omega=  5.0001e+00, lambda=  7.0242e+00, |beta|=  2.2676e-01
 i=2: omega=  5.0001e+00, lambda=  7.0242e+00, |beta|=  2.2676e-01
 i=3: omega=  5.0001e+00, lambda=  8.8849e+00, |beta|=  2.1428e-01
 i=4: omega=  5.0001e+00, lambda=  9.9325e+00, |beta|=  1.4843e-02
 i=5: omega=  5.0001e+00, lambda=  9.9325e+00, |beta|=  1.4843e-02
 i=6: omega=  5.0001e+00, lambda=  1.1325e+01, |beta|=  1.3882e-01


*************************************************
**** Wed Feb 1, 2023

CONTINUE ON DEFLATION


FREQ=7 DEFLATE 3
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq7Deflate3Exp -deflateWaveHoltz=1 -numToDeflate=3 -freq=7 -go=dfk > square128O2Freq7Deflate3Exp.out


FREQ=7 DEFLATE 2
cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq7Deflate2Exp -deflateWaveHoltz=1 -numToDeflate=2 -freq=7 -go=dfk > square128O2Freq7Deflate2Exp



FREQ=7 DEFLATE 1
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq7Deflate1Exp -deflateWaveHoltz=1 -numToDeflate=1 -freq=7 -go=dfk > square128O2Freq7Deflate1Exp

 Convergence rate CR=0.573, CR-perPeriod=0.573, Time to solve = 2.26e+00(s) : CgWave= 2.25e+00(s) 99.62%, advance= 2.23e+00(s) 98.99%
 CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=3.289e-04 (using omega), max-res=4.329e-02 (using omega from discrete symbol)
 cgwh: rel-max-diff=4.58e-09, |v|_max= 7.95e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

*************************************************
**** Tues Jan 31, 2023

CONTINUE ON DEFLATION

>>>> DEFLATION: EXPLICIT: **STARTS TO WORK ***


EASIER TEST:
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq5Deflate1Exp -deflateWaveHoltz=1 -numToDeflate=1 -freq=5 -go=halt


cgwh -noplot gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -matlab=square128O2Freq5Deflate1Exp -deflateWaveHoltz=1 -numToDeflate=1 -freq=5 -go=dfk > square128O2Freq5Deflate1Exp.out


 i=0: omega=  5.0001e+00, lambda=  4.4428e+00, |beta|=  9.2363e-01
 i=1: omega=  5.0001e+00, lambda=  7.0242e+00, |beta|=  2.2676e-01
 i=2: omega=  5.0001e+00, lambda=  7.0242e+00, |beta|=  2.2676e-01
 i=3: omega=  5.0001e+00, lambda=  8.8849e+00, |beta|=  2.1428e-01
 i=4: omega=  5.0001e+00, lambda=  9.9325e+00, |beta|=  1.4843e-02
 i=5: omega=  5.0001e+00, lambda=  9.9325e+00, |beta|=  1.4843e-02
 i=6: omega=  5.0001e+00, lambda=  1.1325e+01, |beta|=  1.3882e-01



DEFLATE 3:



DEFLATE 2:
 

 i=0: omega=  7.0004e+00, lambda=  4.4428e+00, |beta|=  3.47e-01
 i=1: omega=  7.0004e+00, lambda=  7.0242e+00, |beta|=  1.00e+00
 i=2: omega=  7.0004e+00, lambda=  7.0242e+00, |beta|=  1.00e+00
 i=3: omega=  7.0004e+00, lambda=  8.8849e+00, |beta|=  5.94e-01
 i=4: omega=  7.0004e+00, lambda=  9.9325e+00, |beta|=  1.90e-01

>>>> freq=7 is close to a double eigenvalue
    VERY SLOW CR with no deflation
cgwh gaussian.cmd -g=square128.order2 -x0=0.6 0.4 -y0=0.45 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -eigenVectorFile=square128Ev64.show -deflateWaveHoltz=1 -numToDeflate=1 -freq=7 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.573, CR-perPeriod=0.573, Time to solve = 2.24e+00(s) : CgWave= 2.23e+00(s) 99.63%, advance= 2.22e+00(s) 99.00%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 45 (FP) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=5.218e-03, numberOfStepsPerSolve=172, totalTimeStepsStaken=7740, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 freq= 0, omega=   7.000, (adjusted=   7.000) T= 0.89760, Tbar= 0.89760, numPeriods=  1, Tbar(0)/T=  1.00

CgWaveHoltz::residual: freq= 0, omega=   7.000, max-res=3.289e-04 (using omega), max-res=4.329e-02 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.289e-04 (all frequencies)

Direct solve Helmholtz: cpu= 5.77e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.218e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]
cgwh: rel-max-diff=4.58e-09, |v|_max= 7.95e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





>>>>>>>> freq=5: 
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=1 -cfl=0.95 -deflateWaveHoltz=1 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -freq=5 -go=halt


 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.100, CR-perPeriod=0.100, Time to solve = 8.17e-01(s) : CgWave= 8.13e-01(s) 99.57%, advance= 8.09e-01(s) 99.06%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 11 (FP) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=5.236e-03, numberOfStepsPerSolve=240, totalTimeStepsStaken=2640, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 freq= 0, omega=   5.000, (adjusted=   5.000) T= 1.25664, Tbar= 1.25664, numPeriods=  1, Tbar(0)/T=  1.00

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=9.479e-05 (using omega), max-res=9.229e-04 (using omega from discrete symbol)
CgWaveHoltz: max-res=9.479e-05 (all frequencies)

Direct solve Helmholtz: cpu= 5.87e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.236e-03
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]
cgwh: rel-max-diff=1.64e-08, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



*************************************************
**** Mon Jan 30, 2023

START ON DEFLATION

scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/square128Ev64.show .

>>>> DEFLATION: EXPLICIT: **STARTS TO WORK ***
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=5 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=1 -cfl=0.95 -deflateWaveHoltz=1 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -go=halt



>>>> DEFLATION: IMPLICIT >> slow to converge ! WHY??
     NOTE: IMP: NO DEFLATE: CR=1 !!! does NOT converge!!
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=5 -amp=50 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=1000 -deflateWaveHoltz=1 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -go=halt

KRYLOV:
Convergence rate CR=0.107, CR-perPeriod=0.107, Time to solve = 9.57e-02(s) : CgWave= 7.78e-02(s) 81.31%, advance= 7.31e-02(s) 76.42%

FPI
 Convergence rate CR=0.885, CR-perPeriod=0.885, Time to solve = 3.53e-01(s) : CgWave= 3.43e-01(s) 97.43%, advance= 3.28e-01(s) 93.11%


>>>> DEFLATION: **STARTS TO WORK ***
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=5 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=1 -cfl=0.95 -deflateWaveHoltz=1 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -go=halt


 Convergence rate CR=0.100, CR-perPeriod=0.100, Time to solve = 9.34e-01(s) : CgWave= 9.30e-01(s) 99.62%, advance= 7.39e-01(s) 79.13%
cgwh: rel-max-diff=1.64e-08, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>> NO DEFLATION
cgwh gaussian.cmd -g=square128.order2 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=5 -amp=50 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=1 -cfl=0.95 -deflateWaveHoltz=0 -numToDeflate=1 -eigenVectorFile=square128Ev64.show -go=halt

 Convergence rate CR=0.917, CR-perPeriod=0.917, Time to solve = 3.39e+00(s) : CgWave= 3.38e+00(s) 99.77%, advance= 3.37e+00(s) 99.31%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 50 (FP) (maximumNumberOfIterations=50)
cgwh: rel-max-diff=2.16e-14, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

**************************************************
**** Sat Jan 28, 2023


>>> TEST 3D DHS WITH Krylov



box 4: freq=15 : GMRES+ILU(20) - failed PETSC error -11

box2 : freq=15 : GMRES+ILU(50) - OK only 1 iteration needed, basically a direct solve

box2 : freq=15 : GMRES+ILU(5) : failed blew up 
                          (10) : PETSC failure -11 : PC failed
                          (20) : OK, 4 iterations

cgwh gaussian.cmd -g=box4.order4.ng3 -x0=0.5 0.5 -y0=0.5 -0.5 -z0=0.5 0.5 0.5 -nf=1 -freq=15 -amp=150 150 -beta=150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=40 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=halt

 
G4: GMRES+ILU(40) cpu=2000s     WH=140s
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box4.order4.ng3.hdf
 Convergence rate CR=0.343, CR-perPeriod=0.875, Time to solve = 1.38e+02(s) : CgWave= 1.38e+02(s) 99.91%, advance= 1.38e+02(s) 99.90%
 max-residual=5.41e-10 (WaveHoltz its), numberOfIterations = 18 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.410e-01, numberOfStepsPerSolve=40, totalTimeStepsStaken=800, aveItsPerImplicitSolve=  5.0
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=  15.000, (adjusted=   8.913) T= 0.41888, Tbar= 3.35103, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=3.864e-08 (using omega), max-res=3.516e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.864e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.96e+03(s), iterations=3 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(40) + reverse Cuthill-McKee ordering]
saveMatlab: dt=1.410e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=2.88e-09, |v|_max= 1.62e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



--------- BOX2 GMRES+ILU(20)  : WH=10s DHS=16s
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order4.ng3.hdf
 Convergence rate CR=0.319, CR-perPeriod=0.867, Time to solve = 1.01e+01(s) : CgWave= 1.01e+01(s) 99.77%, advance= 1.01e+01(s) 99.69%
 max-residual=2.34e-10 (WaveHoltz its), numberOfIterations = 19 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.410e-01, numberOfStepsPerSolve=40, totalTimeStepsStaken=840, aveItsPerImplicitSolve=  3.0
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=  15.000, (adjusted=   8.913) T= 0.41888, Tbar= 3.35103, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=1.606e-08 (using omega), max-res=3.659e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.606e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.57e+01(s), iterations=4 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(20) + reverse Cuthill-McKee ordering]
saveMatlab: dt=1.410e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=8.45e-09, |v|_max= 1.69e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




>>>>>>TRY TWO FREQ CLOSE TOGETHER?


TWO its=27 CPU=7.6
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=18 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -go=dk > squareFreqTwo.out


ONE: its=23, CPU=3.3
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=1 -freq=35 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -go=dk > squareFreqOne.out

TWO its=52 CPU=9.1
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=35 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -go=dk > squareFreqTwo.out

THREE its= CPU= 
  NP=8 *trouble*
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 0.5 -y0=0.5 0.55 0.55 -nf=3 -freq=34 35 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=16 -cfl=10000 -go=dk > squareFreqThree.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.631, CR-perPeriod=0.944, Time to solve = 9.14e+00(s) : CgWave= 9.04e+00(s) 98.91%, advance= 9.02e+00(s) 98.72%
 max-residual=2.54e-12 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=4.041e-02, numberOfStepsPerSolve=48, totalTimeStepsStaken=2592, aveItsPerImplicitSolve=  0.0



THIS CASE IS TOO EASY FOR THE LOWEST FREQ SINC FIRST EIG IS NEAR omega=5


>> KEEP FIRST AND LAST FREQ 
    NP=8 its=11 CPU=19.6 
    NP=4 its=13 CPU=11.6
    NP=2 its=19 CPU=8.2
    NP=1 its=33 CPU=6.9 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=3 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=squareFreq12Keep2G128Np1O4Imp -go=dk > squareFreq12G12Keep28Np1O4Imp.out



NF=12, NP=10 ECR=.89 its=22 CPU=54 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=10 -cfl=10000 -matlab=squareFreq12G128Np10O4Imp -go=dk > squareFreq12G128Np10O4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.311, CR-perPeriod=0.890, Time to solve = 5.41e+01(s) : CgWave= 5.38e+01(s) 99.48%, advance= 5.38e+01(s) 99.44%
 max-residual=4.49e-13 (WaveHoltz its), numberOfIterations = 22 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 12, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.499e-02, numberOfStepsPerSolve=600, totalTimeStepsStaken=14400, aveItsPerImplicitSolve=  0.0


NF=12, NP=4 ECR=.912 its=70, CPU=65.5 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=squareFreq12G128Np4O4Imp -go=dfk > squareFreq12G128Np4O4Imp.out


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.692, CR-perPeriod=0.912, Time to solve = 6.55e+01(s) : CgWave= 6.46e+01(s) 98.65%, advance= 6.45e+01(s) 98.53%
 max-residual=5.93e-13 (WaveHoltz its), numberOfIterations = 70 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 12, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.499e-02, numberOfStepsPerSolve=240, totalTimeStepsStaken=41280, aveItsPerImplicitSolve=  0.0


REDO FOR TIMING:
NF=12 : IMP NP=8 ECR=.877  its=25, CPU=49.2  
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000  -go=dk > squareFreq12G128Np8O4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.349, CR-perPeriod=0.877, Time to solve = 4.92e+01(s) : CgWave= 4.89e+01(s) 99.33%, advance= 4.89e+01(s) 99.26%
 max-residual=5.02e-13 (WaveHoltz its), numberOfIterations = 25 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 12, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.499e-02, numberOfStepsPerSolve=480, totalTimeStepsStaken=12960, aveItsPerImplicitSolve=  0.0


>> KEEP FIRST AND LAST FREQ CPU=19.6 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=3 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=squareFreq12Keep2G128Np8O4Imp -go=dfk > squareFreq12G12Keep28Np8O4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order4.ng3.hdf
 Convergence rate CR=0.084, CR-perPeriod=0.734, Time to solve = 1.96e+01(s) : CgWave= 1.96e+01(s) 99.89%, advance= 1.96e+01(s) 99.87%
 max-residual=6.59e-13 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.499e-02, numberOfStepsPerSolve=480, totalTimeStepsStaken=27360, aveItsPerImplicitSolve=  0.0


**************************************************
**** Fri Jan 27, 2023


>>>>>>> SQUARE WITH MANY FREQ's

>> KEEP FIRST AND LAST FREQ
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.5 -y0=0.5 0.55 -nf=2 -freq=3 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=squareFreq12Keep2G128Np8O4Imp -go=dfk > squareFreq12G12Keep28Np8O4Imp.out


>>>> nf=12
NF=12 : IMP 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=squareFreq12G128Np8O4Imp -go=dfk > squareFreq12G128Np8O4Imp.out

NF=12 EXP 
cgwh -noplot gaussian.cmd -g=square128.order4.ng3 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=0.95 -matlab=squareFreq12G128Np8O4Exp -go=dfk > squareFreq12G128Np8O4Exp.out



>>> Multiple low frequencies on SHAPES -- CHANGE source locations

FORCING:
plotStuff plotForcing.cmd -show=shapesG4O4ThreeFreqNp10 -name=shapesThreeFreqForcing -clines=1 -solution=1 -numFreq=3

plotStuff plotSolution.cmd -show=shapesG4O4ThreeFreqNp10 -name=shapesG4O4ThreeFreqNp10 -clines=1 -solution=1 -numFreq=3

FOR SHOW-FILE:
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=10 -cfl=10000 -show=shapesG4O4ThreeFreqNp10.show -go=dks > shapesG4O4ThreeFreqNp10.out


IMP NP=2  ECR = .948 
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=2 -cfl=10000 -matlab=shapesG4O4ThreeFreqNp2Imp -go=dfk > shapesG4O4ThreeFreqNp2Imp.out


IMP NP=10  
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=10 -cfl=10000 -matlab=shapesG4O4ThreeFreqNp10Imp -go=dfk > shapesG4O4ThreeFreqNp10Imp.out

EXP: (small dt) NP=2 
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=0.95 -matlab=shapesG4O4ThreeFreqNp2Exp -go=dfk > shapesG4O4ThreeFreqNp2Exp.out


NF=3 NP=10 : ECR=.863 its=14 CPU=26
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -0.9 -y0=-0.6 0.6 0.7 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=10 -cfl=10000 -go=halt



**************************************************
**** Thus Jan 26, 2023

TRY Multiple low frequencies on SHAPES -- change source locations

NF=3 NP=12 : ECR=.861 its=13 CPU=34
NF=3 NP=10 : ECR=.863 its=14 CPU=26
NF=3 NP=8  : ECR=.875 its=18 CPU=28
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 0.3 -y0=-0.6 0.6 0.6 -nf=3 -freq=4 8 12 -amp=100 100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=10 -cfl=10000 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.342, CR-perPeriod=0.875, Time to solve = 2.81e+01(s) : CgWave= 2.79e+01(s) 99.37%, advance= 2.78e+01(s) 99.19%
 max-residual=5.10e-10 (WaveHoltz its), numberOfIterations = 19 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.015e-01, numberOfStepsPerSolve=128, totalTimeStepsStaken=2688, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   4.000, (adjusted=   3.870) T= 1.57080, Tbar=12.56637, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   8.000, (adjusted=   7.090) T= 0.78540, Tbar=10.99557, numPeriods= 14, Tbar(0)/T= 16.00
 freq= 2, omega=  12.000, (adjusted=   9.451) T= 0.52360, Tbar= 9.94838, numPeriods= 19, Tbar(0)/T= 24.00

CgWaveHoltz::residual: freq= 0, omega=   4.000, max-res=3.461e-09.
CgWaveHoltz::residual: freq= 1, omega=   8.000, max-res=2.621e-09.
CgWaveHoltz::residual: freq= 2, omega=  12.000, max-res=7.006e-09.
CgWaveHoltz: max-res=7.006e-09 (all frequencies)

Direct solve Helmholtz: cpu= 1.97e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.015e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.18e-10 for freq0 =   4.0000e+00, |v|_max= 6.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.38e-10 for freq1 =   8.0000e+00, |v|_max= 3.14e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.37e-09 for freq2 =   1.2000e+01, |v|_max= 1.69e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.37e-09, |v|_max= 1.69e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



RUNS FOR PAPER -- make show files *** SCALE FORCING down : AMP=100 ***

plotStuff plotSolution.cmd -show=shapesG4O4freq45Np80 -name=shapesG4O4freq45Np80 -solution=1
plotStuff plotSolution.cmd -show=shapesG4O4freq44Np80 -name=shapesG4O4freq44Np80 -solution=1
plotStuff plotSolution.cmd -show=shapesG4O4freq43Np80 -name=shapesG4O4freq43Np80 -solution=1


vmax=1.81
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=45 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000 -matlab=shapesG4O4freq45Np80 -show=shapesG4O4freq45Np80.show -go=dks > shapesG4O4freq45Np80.out

cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=44 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000 -matlab=shapesG4O4freq44Np80 -show=shapesG4O4freq44Np80.show -go=dks > shapesG4O4freq44Np80.out

vmax=.2
cgwh -noplot gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=43 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000 -matlab=shapesG4O4freq43Np80 -show=shapesG4O4freq43Np80.show -go=dks > shapesG4O4freq43Np80.out

--> plot forcing
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=43 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000 -go=halt

TWO AT ONCE:
f=43, 44:  NP=120 ECR=.99 worse
f=43, 44:  NP=100 ECR=.998   KSP residual=6.28e-07 (max-res=2.84e-06) (tol=1.00e-10) numIts=52 #######
f=43, 44:  NP=80  ECR=.998 .. converging ok

cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 0.25 -y0=-0.6 -0.6 -nf=2 -freq=43 44 -amp=100 100 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=halt


>>>>EVEN HIGHER FREQ: freq=44 -------------

TRY NEARBY FREQ:
freq=45 ECR=.992 its=31 CPU=305  cgwh: rel-max-diff=1.69e-10, |v|_max= 9.07e+00
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=45 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=og

freq=43 ECR=.992 its=33 CPU=322  cgwh: rel-max-diff=8.72e-09
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=43 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=og



TRY FINER GRID for paper:
freq=44 : ECR=.990 its=29 cpu=1.19e3 *same its as G4 cgwh: rel-max-diff=3.14e-11,
cgwh gaussian.cmd -g=shapese8.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=44 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=og


freq=44 Np=90  ECR=.991 its=26 CPU=314
freq=44 Np=80  ECR=.994 its=29 CPU=285 *best* cgwh: rel-max-diff=8.25e-11,
freq=44 Np=70  ECR=.994 its=45 CPU=316
freq=44 Np=60  ECR=.997 CPU= 
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=44 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=80 -cfl=10000  -go=og

----------------------------------

>>>>EVEN HIGHER FREQ:
freq=33 Np=60 ECR=.985 better, its=26 CPU=192
freq=33 Np=50 ECR=.986 better, its=30 CPU=155
freq=33 Np=40  ECR=.995 CPU= *better
freq=33 Np=32  ECR=.995 CPU=  *poor*
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=33 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=60 -cfl=10000  -go=og

cgwh: rel-max-diff=2.53e-11, |v|_max= 1.71e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>> HIGHER FREQ:
freq=23 NP=32   *Better* ECR=.974   its=25 CPU=74.8
freq=23 NP=28   *Better* ECR=.973   its=30
freq=23 NP=24   *Better* ECR=.984
freq=23 NP=20   *OK* ECR=.99
freq=22 : NP=16 *bad*

cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=23 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=32 -cfl=10000  -go=og

NP=32: 
Convergence rate CR=0.426, CR-perPeriod=0.974, Time to solve = 7.49e+01(s) : CgWave= 7.48e+01(s) 99.89%, advance= 7.48e+01(s) 99.82%
 max-residual=3.62e-10 (WaveHoltz its), numberOfIterations = 25 (Krylov) (maximumNumberOfIterations=50)


freq=15 : NP=16 OK: ECR=.956 
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=15 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=16 -cfl=10000  -go=og



ORDER=4: LOWER freq, CHANGE POSITION to be further from boundary
    freq=10.9 NP=16 : converges, ECR=.94 **GOOD**
    freq=10.9 NP=20 : converges, ECR=.925 **GOOD**
    freq=10.9 NP=16 : converges, ECR=.91 **GOOD**
    freq=10.9 NP=14 : converges, ECR=.913 **GOOD**
    freq=10.9 NP=8 : converges, ECR=.98
    freq=11.1 NP=8 : converges slowly, ECR=.99
    freq=11  NP=4 : converges to DHS, slowly ECR=.987
cgwh gaussian.cmd -g=shapese4.order4.ng3 -x0=0.25 -0.55 0.5 -y0=-0.6 0.5 0.5 -nf=1 -freq=10.9 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=14 -cfl=10000  -go=og

>>>>NP=32: *GOOD*
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.121, CR-perPeriod=0.936, Time to solve = 7.43e+01(s) : CgWave= 7.43e+01(s) 99.95%, advance= 7.42e+01(s) 99.89%
 max-residual=9.72e-11 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.105e-02, numberOfStepsPerSolve=608, totalTimeStepsStaken=7904, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  10.900, (adjusted=  10.649) T= 0.57644, Tbar=18.44605, numPeriods= 32, Tbar(0)/T= 32.00

CgWaveHoltz::residual: freq= 0, omega=  10.900, max-res=3.566e-10 (using omega), max-res=4.686e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.566e-10 (all frequencies)

Direct solve Helmholtz: cpu= 6.81e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=3.105e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=9.82e-12, |v|_max= 4.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>> NP=16 : ***GOOD**
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.237, CR-perPeriod=0.914, Time to solve = 2.67e+01(s) : CgWave= 2.66e+01(s) 99.82%, advance= 2.66e+01(s) 99.64%
 max-residual=4.22e-10 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=6.304e-02, numberOfStepsPerSolve=160, totalTimeStepsStaken=2720, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  10.900, (adjusted=   9.967) T= 0.57644, Tbar= 9.22302, numPeriods= 16, Tbar(0)/T= 16.00

CgWaveHoltz::residual: freq= 0, omega=  10.900, max-res=1.224e-09 (using omega), max-res=4.635e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.224e-09 (all frequencies)

Direct solve Helmholtz: cpu= 6.76e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=6.304e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.87e-10, |v|_max= 4.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>> omega=10.9, Np=8
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.824, CR-perPeriod=0.976, Time to solve = 1.74e+01(s) : CgWave= 7.83e+01(s) 450.79%, advance= 7.81e+01(s) 449.80%
 max-residual=3.83e-10 (WaveHoltz its), numberOfIterations = 45 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.940e-01, numberOfStepsPerSolve=40, totalTimeStepsStaken=8360, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  10.900, (adjusted=   6.477) T= 0.57644, Tbar= 4.61151, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=  10.900, max-res=6.519e-07 (using omega), max-res=4.635e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.519e-07 (all frequencies)

Direct solve Helmholtz: cpu= 6.72e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.940e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.84e-07, |v|_max= 4.05e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

'

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/shapese4.order4.ng3.hdf
 Convergence rate CR=0.948, CR-perPeriod=0.987, Time to solve = 9.82e+00(s) : CgWave= 6.02e+01(s) 612.60%, advance= 5.99e+01(s) 610.10%
 max-residual=2.19e-08 (WaveHoltz its), numberOfIterations = 52 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.922e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=6480, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=2.483e-05 (using omega), max-res=4.371e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.483e-05 (all frequencies)

Direct solve Helmholtz: cpu= 6.76e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=1.922e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=6.13e-06, |v|_max= 3.82e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





REVISIT SHAPES:

FREQ=67.1 : NP=20 
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67.1 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=250 -numPeriods=20 -cfl=10000  -go=og



FREQ=67 : NP=8 STALLS 
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=250 -numPeriods=8 -cfl=10000  -go=og



FREQ=67 : NP=20
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=20 -numPeriods=20 -cfl=10000  -go=og




FREQ=67 : NP=20 CFL=10
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=20 -cfl=10 -go=og


FREQ=67 : NP=40
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=40 -cfl=10000  -go=og


FREQ=67 : NP=20
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=20 -cfl=10000  -go=og


FREQ=67 : NP=8
cgwh gaussian.cmd -g=shapese8.order2 -x0=0.3 -0.55 0.5 -y0=-0.75 0.5 0.5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=8 -cfl=10000  -go=og




**************************************************
**** Wed Jan 25, 2023


------------------------------------------------
----------------------- PIPE -------------------
------------------------------------------------


>>> TWO FREQ PIPE -- QUESTION: what happeded to 2nd frequency?
    --> change source locations:
NP=8 IMP: 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 -.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeTwoFreqNp8G2Order4Imp -go=dfk > pipeTwoFreqNp8G2Order4Imp.out



------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze2.order4.ng3.hdf
 Convergence rate CR=0.411, CR-perPeriod=0.895, Time to solve = 1.55e+02(s) : CgWave= 4.05e+02(s) 261.96%, advance= 4.05e+02(s) 261.91%
 max-residual=2.16e-09 (WaveHoltz its), numberOfIterations = 29 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=8.084e-02, numberOfStepsPerSolve=80, totalTimeStepsStaken=6480, aveItsPerImplicitSolve=  3.0
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   7.773) T= 0.73920, Tbar= 5.91359, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  17.000, (adjusted=  12.749) T= 0.36960, Tbar= 4.80479, numPeriods= 13, Tbar(0)/T= 16.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=1.327e+02.
CgWaveHoltz::residual: freq= 1, omega=  17.000, max-res=1.327e+02.
CgWaveHoltz: max-res=1.327e+02 (all frequencies)

Direct solve Helmholtz: cpu= 6.31e+02(s), iterations=3 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(50) + reverse Cuthill-McKee ordering]
saveMatlab: dt=8.084e-02
CgWaveHoltz::saved results in matlab file=[pipeTwoFreqNp8G2Order4ImpKrylov.m]
cgwh: rel-max-diff=7.75e-09 for freq0 =   8.5000e+00, |v|_max= 3.55e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.35e-06 for freq1 =   1.7000e+01, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.35e-06, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...


NP=8 EXP: 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 -.1 -0.2 0.25 -y0=0.1 -0.1 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeTwoFreqNp8G2Order4Exp -go=fk > pipeTwoFreqNp8G2Order4Exp.out
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze2.order4.ng3.hdf
 Convergence rate CR=0.207, CR-perPeriod=0.821, Time to solve = 1.48e+02(s) : CgWave= 5.38e+02(s) 362.17%, advance= 5.38e+02(s) 362.12%
 max-residual=4.18e-13 (WaveHoltz its), numberOfIterations = 17 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=1.950e-03, numberOfStepsPerSolve=3032, totalTimeStepsStaken=209208, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 freq= 0, omega=   8.500, (adjusted=   8.500) T= 0.73920, Tbar= 5.91359, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  17.000, (adjusted=  17.001) T= 0.36960, Tbar= 5.91359, numPeriods= 16, Tbar(0)/T= 16.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=1.327e+02.
CgWaveHoltz::residual: freq= 1, omega=  17.000, max-res=1.327e+02.
CgWaveHoltz: max-res=1.327e+02 (all frequencies)







NP=4 -- not so good(?) --> SOURCE LOCATIONS BAD 
setsid $cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeTwoFreqNp4G2Order4Imp -go=dfk > pipeTwoFreqNp4G2Order4Imp.out

cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.2 -0.2 0.25 -y0=0.1 -0.2 -0.3 0.15 -z0=0.45 0.65 0.5 -nf=2 -freq=8.5 17 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeTwoFreqNp4G2Order4Exp -go=fk > pipeTwoFreqNp4G2Order4Exp.out



G2 O4 IMP
cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeOneFreqNp4G2Order4Imp -go=dfk > pipeOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze2.order4.ng3.hdf
 Convergence rate CR=0.378, CR-perPeriod=0.784, Time to solve = 5.32e+01(s) : CgWave= 1.44e+02(s) 269.96%, advance= 1.44e+02(s) 269.84%
 max-residual=7.50e-11 (WaveHoltz its), numberOfIterations = 25 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.488e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=1540, aveItsPerImplicitSolve=  5.4
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   5.051) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=1.327e+02 (using omega), max-res=1.349e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.327e+02 (all frequencies)

Direct solve Helmholtz: cpu= 3.15e+02(s), iterations=1 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(50) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.488e-01
CgWaveHoltz::saved results in matlab file=[pipeOneFreqNp4G2Order4ImpKrylov.m]
cgwh: rel-max-diff=2.86e-10, |v|_max= 3.55e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


G2 O4 EXP
cgwh -noplot gaussian.cmd -g=pipeze2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeOneFreqNp4G2Order4Exp -go=fk > pipeOneFreqNp4G2Order4Exp.out


iluh=20: breakdown 
iluh=50: OK 

cgwh -noplot gaussian.cmd -g=pipeze2.order2 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -z0=0.5 0.5 0.5 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=pipeOneFreqNp4G2Order2Imp -go=dfk > pipeOneFreqNp4G2Order2Imp.out



------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/pipeze2.order2.hdf
 Convergence rate CR=0.357, CR-perPeriod=0.773, Time to solve = 9.36e+00(s) : CgWave= 9.33e+00(s) 99.62%, advance= 9.30e+00(s) 99.35%
 max-residual=1.91e-09 (WaveHoltz its), numberOfIterations = 26 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.488e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=560, aveItsPerImplicitSolve=  7.8
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   5.051) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=1.327e+02 (using omega), max-res=1.372e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.327e+02 (all frequencies)

Direct solve Helmholtz: cpu= 5.56e+01(s), iterations=1 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(50) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.488e-01
CgWaveHoltz::saved results in matlab file=[pipeOneFreqNp4G2Order4ImpKrylov.m]
cgwh: rel-max-diff=2.12e-08, |v|_max= 3.45e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





**************************************************
**** Tues Jan 24, 2023


------------------------------------------------
----------------------- SPHERE ------------------
------------------------------------------------


CHOOSE omega=8.5  (should be ok from exact eigs)

G2 Order 4 NP=4 - IMP  INCLUDE DIRECT SOLVE: 
setsid $cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=dfk > sphereOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/spheree2.order4.ng3.hdf
 Convergence rate CR=0.602, CR-perPeriod=0.881, Time to solve = 6.21e+02(s) : CgWave= 1.20e+03(s) 193.41%, advance= 1.20e+03(s) 193.34%
 max-residual=1.59e-10 (WaveHoltz its), numberOfIterations = 47 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.488e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=1980, aveItsPerImplicitSolve=  5.5
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   5.051) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=2.243e-08 (using omega), max-res=2.766e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.243e-08 (all frequencies)

Direct solve Helmholtz: cpu= 2.12e+04(s), iterations=2 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(100) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.488e-01
CgWaveHoltz::saved results in matlab file=[sphereOneFreqNp4G2Order4ImpKrylov.m]
cgwh: rel-max-diff=3.93e-09, |v|_max= 4.05e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




G2 Order 4 NP=8 - IMP  **QUESTION** WHY 48 STEPS??
cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=8 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp8G2Order4Imp -go=fk > sphereOneFreqNp8G2Order4Imp.out


 grid=/home/henshw/grids/spheree2.order4.ng3.hdf
 Convergence rate CR=0.207, CR-perPeriod=0.822, Time to solve = 4.48e+02(s) : CgWave= 1.35e+03(s) 300.34%, advance= 1.35e+03(s) 300.27%
 max-residual=6.05e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=1.664e-01, numberOfStepsPerSolve=48, totalTimeStepsStaken=3264, aveItsPerImplicitSolve=  3.1
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   6.294) T= 0.73920, Tbar= 5.91359, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=2.755e-07 (using omega), max-res=2.801e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.755e-07 (all frequencies)
saveMatlab: dt=1.664e-01





G2 Order 4 NP=4 - IMP  
cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=fk > sphereOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/spheree2.order4.ng3.hdf
 Convergence rate CR=0.602, CR-perPeriod=0.881, Time to solve = 6.33e+02(s) : CgWave= 1.22e+03(s) 193.33%, advance= 1.22e+03(s) 193.25%
 max-residual=1.59e-10 (WaveHoltz its), numberOfIterations = 47 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.488e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=1980, aveItsPerImplicitSolve=  5.5
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.500, (adjusted=   5.051) T= 0.73920, Tbar= 2.95679, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.500, max-res=2.243e-08 (using omega), max-res=2.766e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.243e-08 (all frequencies)
saveMatlab: dt=2.488e-01



G2 Order 4 - EXP 
cgwh -noplot gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=50 -numPeriods=4 -cfl=0.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Exp -go=fk > sphereOneFreqNp4G2Order4Exp.out



G2 Order 2
cgwh gaussian.cmd -g=spheree2.order2 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order2Imp -go=fk > sphereOneFreqNp4G2Order2Imp.out

G2 Order 2 - EXP 
cgwh gaussian.cmd -g=spheree2.order2 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.5 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -solveri=cgs -rtoli=1e-8 -atoli=1e-8 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order2Exp -go=fk > sphereOneFreqNp4G2Order2Exp.out




SPHERE2 ORDER=4 - IMP 
   DHS --GMRES + ILU(50) 
cgwh gaussian.cmd -g=spheree2.order4.ng3 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=50 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order4Imp -go=halt dfk > sphereOneFreqNp4G2Order4Imp.out




BOX4 ORDER=4 
    ILU(20) -- NO GOOD 
cgwh gaussian.cmd -g=box4.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000  -solveri=cgs -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=20 -maxith=50000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=halt


BOX2 ORDER=4 
cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000  -solveri=cgs -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=20 -maxith=50000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order4.ng3.hdf
 Convergence rate CR=0.178, CR-perPeriod=0.650, Time to solve = 6.34e+00(s) : CgWave= 6.32e+00(s) 99.70%, advance= 6.31e+00(s) 99.60%
 max-residual=1.27e-12 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.611e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=340, aveItsPerImplicitSolve=  5.4
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.100, (adjusted=   4.813) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=3.746e-11 (using omega), max-res=7.882e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.746e-11 (all frequencies)

Direct solve Helmholtz: cpu= 1.57e+01(s), iterations=3 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(20) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.611e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=1.59e-11, |v|_max= 1.27e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



BOX2 IMP -- try GMRES for DHS
  ilu(10) -- break down
  ilu(20) -- OK
  ilu(50) -- OK
cgwh gaussian.cmd -g=box2.order2 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000  -solveri=cgs -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=20 -maxith=50000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order2.hdf
 Convergence rate CR=0.184, CR-perPeriod=0.655, Time to solve = 2.35e+00(s) : CgWave= 2.34e+00(s) 99.37%, advance= 2.33e+00(s) 99.12%
 max-residual=1.67e-12 (WaveHoltz its), numberOfIterations = 15 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.611e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=340, aveItsPerImplicitSolve=  7.6
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.100, (adjusted=   4.813) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=2.916e-10 (using omega), max-res=7.913e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.916e-10 (all frequencies)

Direct solve Helmholtz: cpu= 3.13e+00(s), iterations=229 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(20) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.611e-01
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzKrylov.m]
cgwh: rel-max-diff=2.07e-08, |v|_max= 1.28e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



**************************************************
**** Mon Jan 23, 2023

------------------------------------------------
----------------------- SPHERE ------------------
------------------------------------------------

SPHERE - IMP --> trouble with GMRES for direct solve  --GMRES + ILU(100) OK 
cgwh gaussian.cmd -g=spheree2.order2 -x0=0.1 0.3 -0.2 0.25 -y0=0.1 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -solveri=cgs -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=100 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -matlab=sphereOneFreqNp4G2Order2Imp -go=halt dfk > sphereOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/spheree2.order2.hdf
 Convergence rate CR=0.785, CR-perPeriod=0.941, Time to solve = 1.77e+02(s) : CgWave= 1.76e+02(s) 99.65%, advance= 1.76e+02(s) 99.53%
 max-residual=2.50e-09 (WaveHoltz its), numberOfIterations = 94 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.611e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=1920, aveItsPerImplicitSolve=  7.0
    implicit solver : PETSc, solver=[conjugate gradient squared iteration + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=   8.100, (adjusted=   4.813) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=1.258e-06 (using omega), max-res=1.618e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.258e-06 (all frequencies)

Direct solve Helmholtz: cpu= 1.73e+03(s), iterations=2 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(100) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.611e-01
CgWaveHoltz::saved results in matlab file=[sphereOneFreqNp4G2Order2ImpKrylov.m]
cgwh: rel-max-diff=2.79e-06, |v|_max= 2.61e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


OLD: 
+++ SPHERE : NEED TO FIX ORDER=4 grid : sphere.cmd
cgwh gaussian.cmd -g=spheree4.order2 -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=100 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHSphereO2Omega8p1Krylov -tol=1e-8 -ad4=1 -imode=1 -maxIterations=100 -go=og



------------------------------------------------
------------------------ BOX ------------------
------------------------------------------------

BOX EXP 
cgwh gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=.95 -matlab=boxOneFreqNp4G2Order4Exp -go=dfk

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order4.ng3.hdf
 Convergence rate CR=0.090, CR-perPeriod=0.547, Time to solve = 2.63e+00(s) : CgWave= 1.93e+01(s) 733.97%, advance= 1.93e+01(s) 732.70%
 max-residual=1.04e-12 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=5.921e-03, numberOfStepsPerSolve=524, totalTimeStepsStaken=50304, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 freq= 0, omega=   8.100, (adjusted=   8.101) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=3.830e-12 (using omega), max-res=2.554e-02 (using omega from discrete symbol)
CgWaveHoltz: max-res=3.830e-12 (all frequencies)

Direct solve Helmholtz: cpu= 1.46e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.921e-03
CgWaveHoltz::saved results in matlab file=[boxOneFreqNp4G2Order4ExpKrylov.m]
cgwh: rel-max-diff=7.66e-13, |v|_max= 1.27e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


BOX IMP 
cgwh -noplot gaussian.cmd -g=box2.order4.ng3 -x0=0.4 0.3 -0.2 0.25 -y0=0.6 0.25 -0.3 0.15 -nf=1 -freq=8.1 3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=boxOneFreqNp4G2Order4Imp -go=dfk > boxOneFreqNp4G2Order4Imp.out

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/box2.order4.ng3.hdf
 Convergence rate CR=0.191, CR-perPeriod=0.661, Time to solve = 3.57e+00(s) : CgWave= 3.55e+00(s) 99.34%, advance= 3.54e+00(s) 99.15%
 max-residual=1.33e-12 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=2.611e-01, numberOfStepsPerSolve=20, totalTimeStepsStaken=360, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   8.100, (adjusted=   4.813) T= 0.77570, Tbar= 3.10281, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   8.100, max-res=6.845e-11 (using omega), max-res=7.882e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.845e-11 (all frequencies)

Direct solve Helmholtz: cpu= 1.46e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=2.611e-01
CgWaveHoltz::saved results in matlab file=[boxOneFreqNp4G2Order4ImpKrylov.m]
cgwh: rel-max-diff=1.35e-11, |v|_max= 1.27e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


------------------------------------------------
------------------------ DISK ------------------
------------------------------------------------

FIVE FREQ< NP=6
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=6 -cfl=10000 -matlab=diskFourFreqNp4G4Order4Imp -go=halt dfk > diskFourFreqNp4G4Order4Imp.out


NF=1 COMPUTED HIGHEST FREQ:

NP=64 CPU=32.2
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=1 -freq=22 3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=10000 -numPeriods=64 -cfl=10000 -matlab=diskOneFreqNp8G4Order4Imp -go=halt 



NP=32 CPU=12
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=1 -freq=22 3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=10000 -numPeriods=32 -cfl=10000 -matlab=diskOneFreqNp8G4Order4Imp -go=halt dfk > diskOneFreqNp8G4Order4Imp.out


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.334, CR-perPeriod=0.966, Time to solve = 1.22e+01(s) : CgWave= 1.21e+01(s) 99.86%, advance= 1.21e+01(s) 99.77%
 max-residual=1.88e-12 (WaveHoltz its), numberOfIterations = 24 (Krylov) (maximumNumberOfIterations=10000)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=3.123e-02, numberOfStepsPerSolve=320, totalTimeStepsStaken=8320, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  22.000, (adjusted=  20.117) T= 0.28560, Tbar= 9.13918, numPeriods= 32, Tbar(0)/T= 32.00

CgWaveHoltz::residual: freq= 0, omega=  22.000, max-res=1.360e-11 (using omega), max-res=3.130e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.360e-11 (all frequencies)

Direct solve Helmholtz: cpu= 1.22e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=3.123e-02
CgWaveHoltz::saved results in matlab file=[diskOneFreqNp8G4Order4ImpKrylov.m]
cgwh: rel-max-diff=2.21e-12, |v|_max= 6.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




NP=16 *much faster than NP=8 CPU=14.6
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=1 -freq=22 3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=10000 -numPeriods=16 -cfl=10000 -matlab=diskOneFreqNp8G4Order4Imp -go=halt dfk > diskOneFreqNp8G4Order4Imp.out
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.809, CR-perPeriod=0.987, Time to solve = 1.46e+01(s) : CgWave= 1.45e+01(s) 99.57%, advance= 1.45e+01(s) 99.29%
 max-residual=2.75e-12 (WaveHoltz its), numberOfIterations = 117 (Krylov) (maximumNumberOfIterations=10000)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.612e-02, numberOfStepsPerSolve=80, totalTimeStepsStaken=9520, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  22.000, (adjusted=  13.073) T= 0.28560, Tbar= 4.56959, numPeriods= 16, Tbar(0)/T= 16.00

CgWaveHoltz::residual: freq= 0, omega=  22.000, max-res=2.564e-09 (using omega), max-res=3.130e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.564e-09 (all frequencies)

Direct solve Helmholtz: cpu= 1.24e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=9.612e-02
CgWaveHoltz::saved results in matlab file=[diskOneFreqNp8G4Order4ImpKrylov.m]
cgwh: rel-max-diff=2.05e-09, |v|_max= 6.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



NP=8
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=1 -freq=22 3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=10000 -numPeriods=8 -cfl=10000 -matlab=diskOneFreqNp8G4Order4Imp -go=halt dfk > diskFiveFreqNp8G4Order4Imp.out
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.987, CR-perPeriod=0.998, Time to solve = 1.06e+02(s) : CgWave= 1.05e+02(s) 99.16%, advance= 1.04e+02(s) 98.61%
 max-residual=3.12e-12 (WaveHoltz its), numberOfIterations = 1816 (Krylov) (maximumNumberOfIterations=10000)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=9.612e-02, numberOfStepsPerSolve=40, totalTimeStepsStaken=72720, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=  22.000, (adjusted=  13.073) T= 0.28560, Tbar= 2.28479, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=  22.000, max-res=9.532e-08 (using omega), max-res=3.028e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=9.532e-08 (all frequencies)





**************************************************
**** Sun Jan 22, 2023

>>>>> NF=5 ADD an intermediate freq, COMPARE To 4 freq
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -0.3 -y0=-0.2 0.25 -0.3 0.15 0.2 -nf=5 -freq=3 9 12 18 22 -amp=150 150 150 150 150 -beta=150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=diskFiveFreqNp8G4Order4Imp -go=dfk > diskFiveFreqNp8G4Order4Imp.out



PLOTS FOR PAPER

plotStuff plotSolution -show=diskFourFreqNp8G4Order4.show -name=diskFourFreqNp8G4Order4 -solution=1 -numFreq=4

>>>>>>>>>>>>>>>> NF=4
SHOW FILE FOR PLOTS: 
cgwh gaussian.cmd -g=sice8.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -show=diskFourFreqNp8G8Order4.show -go=halt


SHOW FILE FOR PLOTS: 
cgwh gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -show=diskFourFreqNp8G4Order4.show -go=halt


cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=diskFourFreqNp8G4Order4Imp -go=dfk > diskFourFreqNp8G4Order4Imp.out

NF=4 EXP G4 
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=.95 -matlab=diskFourFreqNp8G4Order4Exp -go=dfk > diskFourFreqNp8G4Order4Exp.out

NF=4 EXP G8 
cgwh -noplot gaussian.cmd -g=sice8.order4.ng3 -x0=-0.25 0.3 -0.2 0.25 -y0=-0.2 0.25 -0.3 0.15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=.95 -matlab=diskFourFreqNp8G8Order4Exp -go=dfk > diskFourFreqNp8G8Order4Exp.out


>>>>>>>>>>>>> NF=1
IMPLICIT NF=1
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=diskOneFreqNp4G4Order4Imp -go=dfk > diskOneFreqNp4G4Order4Imp.out

IMPLICIT NF=1, NP=1
cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=diskOneFreqNp1G4Order4Imp -go=dfk > diskOneFreqNp1G4Order4Imp.out

IMPLICIT NF=1, NP=1, G8
cgwh -noplot gaussian.cmd -g=sice8.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=10000 -matlab=diskOneFreqNp1G8Order4Imp -go=dfk > diskOneFreqNp1G8Order4Imp.out


EXPLICIT NF=1, NP=1, O4, G8
cgwh -noplot gaussian.cmd -g=sice8.order4.ng3 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -matlab=diskOneFreqNp1G8Order4Exp -go=dfk > diskOneFreqNp1G8Order4Exp.out

EXPLICIT NF=1, NP=1, O2, G8
cgwh -noplot gaussian.cmd -g=sice8.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -matlab=diskOneFreqNp1G8Order2Exp -go=dfk



EXPLICIT NF=1, NP=1
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=0.95 -matlab=diskOneFreqNp1G4Order2Exp -go=dfk

EXPLICIT NF=1, NP=4
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=0.95 -matlab=diskOneFreqNp4G4Order2Exp -go=dfk



**************************************************
**** Sat Jan 21, 2023

cgwh -noplot gaussian.cmd -g=sice4.order4.ng3 -x0=-.25 .3 -.2 .25 -y0=-.2 .25 -.3 .15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=diskFourFreqNp8G4Order4 -go=dfk

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order4.ng3.hdf
 Convergence rate CR=0.489, CR-perPeriod=0.915, Time to solve = 1.51e+01(s) : CgWave= 4.37e+01(s) 290.14%, advance= 4.37e+01(s) 289.84%
 max-residual=1.43e-10 (WaveHoltz its), numberOfIterations = 31 (Krylov) (maximumNumberOfIterations=30)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, dt=5.695e-02, numberOfStepsPerSolve=296, totalTimeStepsStaken=28416, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.982) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   9.000, (adjusted=   8.546) T= 0.69813, Tbar=15.35890, numPeriods= 22, Tbar(0)/T= 24.00
 freq= 2, omega=  18.000, (adjusted=  15.029) T= 0.34907, Tbar=13.96263, numPeriods= 40, Tbar(0)/T= 48.00
 freq= 3, omega=  22.000, (adjusted=  17.140) T= 0.28560, Tbar=12.85197, numPeriods= 45, Tbar(0)/T= 58.67

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=1.302e-09.
CgWaveHoltz::residual: freq= 1, omega=   9.000, max-res=1.197e-09.
CgWaveHoltz::residual: freq= 2, omega=  18.000, max-res=1.955e-09.
CgWaveHoltz::residual: freq= 3, omega=  22.000, max-res=3.171e-09.
CgWaveHoltz: max-res=3.171e-09 (all frequencies)

Direct solve Helmholtz: cpu= 4.05e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=5.695e-02
CgWaveHoltz::saved results in matlab file=[diskFourFreqNp8G4Order4Krylov.m]
cgwh: rel-max-diff=5.45e-12 for freq0 =   3.0000e+00, |v|_max= 1.35e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.12e-11 for freq1 =   9.0000e+00, |v|_max= 9.51e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=5.00e-11 for freq2 =   1.8000e+01, |v|_max= 4.01e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.26e-09 for freq3 =   2.2000e+01, |v|_max= 5.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.26e-09, |v|_max= 4.01e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...



cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=-.25 .3 -.2 .25 -y0=-.2 .25 -.3 .15 -nf=4 -freq=3 9 18 22 -amp=150 150 150 150 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=-1 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -matlab=diskFourFreqNp8G4Order2 -go=dfk


>>>>>>>>>>>>> NF=1
IMPLICIT NF=1
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -matlab=diskOneFreqNp4G4Order2Imp -go=dfk


EXPLICIT NF=1
cgwh -noplot gaussian.cmd -g=sice4.order2 -x0=.25  -y0=.25 -nf=1 -freq=8.1 -amp=150 -beta=150 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=0.95 -matlab=diskOneFreqNp4G4Order2Exp -go=dfk




**** Thurs Jan 19, 2023

cgwh gaussian.cmd -g=square64.order4.ng3 -x0=0.5 0.5 -y0=0.4 0.45 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=1000 -matlab=squareGaussianOneFreqNp2 -go=og


Np=1
cgwh gaussian.cmd -g=square64.order4.ng3 -x0=0.5 0.5 -y0=0.4 0.45 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=1 -cfl=1000 -matlab=squareGaussianOneFreqNp1 -go=og


**************************************************
**** Sat Jan 14, 2023

REVISIT CONVERGENCE PLOTS FOR PAPER --> plot using cgwave/doc/codes/plotResiduals


+++++++++++ SQUARE

cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWaveHoltzSquare64Order4Krylov -tol=1e-10 -ad4=0 -imode=1 -go=go

FP
cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWaveHoltzSquare64Order4FixedPoint -tol=1e-10 -ad4=0 -imode=1 -maxIterations=400 -go=go


+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



 -- GET MORE DETAILED TIMING:
  HOW MUCH TIME IS SPENT IN CGWAVE ON PROJECTIONS??

Nf=10 Np=32 -- twice as slow
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=500 -numPeriods=32 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og


Nf=10 Decrease -Np=1  -- trouble converging!!
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=500 -numPeriods=1 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og




>>>> nf=10  56/18 = 3.11
  time integral.....................  8.22e+00    1.03e-03    1.56e-08    15.069   8.220e+00   8.220e+00
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.324, CR-perPeriod=0.868, Time to solve = 5.68e+01(s) : CgWave= 5.60e+01(s) 98.69%, advance= 5.60e+01(s) 98.58%
 max-residual=5.13e-12 (WaveHoltz its), numberOfIterations = 18 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 10, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=400, totalTimeStepsStaken=8000, aveItsPerImplicitSolve=  0.0

              -------------------CgWave Summary----------------- 
                       Sat Jan 14 13:24:32 2023
               Grid:   /home/henshw/grids/square256.order2.hdf 
  ==== final time= 1.68e+01, numberOfStepsTaken =     8000, grids=1, gridpts =66049, interp pts=0, processors=1, clock=2.99 GHz ==== 
  ==== memory per-proc: [min=167.598,ave=167.598,max=167.598](Mb), max-recorded=0 (Mb), total=167.598 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  5.45e+01    6.82e-03    1.03e-07   100.000   5.455e+01   5.455e+01
setup and initialize................  9.24e-02    1.15e-05    1.75e-10     0.169   9.239e-02   9.239e-02
initialize BCs......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
initial conditions..................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
advance.............................  5.45e+01    6.81e-03    1.03e-07    99.886   5.448e+01   5.448e+01
  advance rectangular grids.........  5.92e+00    7.40e-04    1.12e-08    10.853   5.920e+00   5.920e+00
  advance curvilinear grids.........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
    implicit solve..................  3.50e+01    4.38e-03    6.63e-08    64.242   3.504e+01   3.504e+01
  add dissipation...................  4.46e+00    5.57e-04    8.44e-09     8.176   4.460e+00   4.460e+00
  boundary conditions...............  3.37e-01    4.21e-05    6.37e-10     0.617   3.367e-01   3.367e-01
  interpolation.....................  5.51e-02    6.88e-06    1.04e-10     0.101   5.507e-02   5.507e-02
  update ghost (parallel)...........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add forcing.......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  time integral.....................  8.22e+00    1.03e-03    1.56e-08    15.069   8.220e+00   8.220e+00
  get errors........................  1.97e-04    2.46e-08    3.73e-13     0.000   1.970e-04   1.970e-04
  plotting..........................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
output results......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
waiting (not counted)...............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
--------------------------------------------------------------------------------------------------------


>>>nf=8  34/14=2.4
  time integral.....................  4.41e+00    8.61e-04    1.30e-08    12.876   4.409e+00   4.409e+00

cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 -nf=8 -freq=3 6 9 12 15 18 21 24 -amp=50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10 -go=og

              -------------------CgWave Summary----------------- 
                       Sat Jan 14 13:28:51 2023
               Grid:   /home/henshw/grids/square256.order2.hdf 
  ==== final time= 1.68e+01, numberOfStepsTaken =     5120, grids=1, gridpts =66049, interp pts=0, processors=1, clock=3.00 GHz ==== 
  ==== memory per-proc: [min=158.062,ave=158.062,max=158.062](Mb), max-recorded=0 (Mb), total=158.062 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  3.43e+01    6.69e-03    1.01e-07   100.000   3.426e+01   3.426e+01
setup and initialize................  8.23e-02    1.61e-05    2.43e-10     0.240   8.229e-02   8.229e-02
initialize BCs......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
initial conditions..................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
advance.............................  3.42e+01    6.68e-03    1.01e-07    99.871   3.421e+01   3.421e+01
  advance rectangular grids.........  3.46e+00    6.75e-04    1.02e-08    10.092   3.457e+00   3.457e+00
  advance curvilinear grids.........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
    implicit solve..................  2.32e+01    4.52e-03    6.85e-08    67.623   2.317e+01   2.317e+01
  add dissipation...................  2.54e+00    4.96e-04    7.51e-09     7.418   2.541e+00   2.541e+00
  boundary conditions...............  2.14e-01    4.18e-05    6.33e-10     0.625   2.142e-01   2.142e-01
  interpolation.....................  3.63e-02    7.09e-06    1.07e-10     0.106   3.630e-02   3.630e-02
  update ghost (parallel)...........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add forcing.......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  time integral.....................  4.51e+00    8.81e-04    1.33e-08    13.161   4.509e+00   4.509e+00
  get errors........................  1.99e-04    3.89e-08    5.88e-13     0.001   1.990e-04   1.990e-04
  plotting..........................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
output results......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
waiting (not counted)...............  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
--------------------------------------------------------------------------------------------------------

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.254, CR-perPeriod=0.843, Time to solve = 3.44e+01(s) : CgWave= 3.39e+01(s) 98.64%, advance= 3.39e+01(s) 98.51%
 max-residual=1.14e-11 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 8, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=320, totalTimeStepsStaken=5120, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]



TRY MORE SOLUTIONS
>>>> nf=10 TRY FP
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=32 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

FIXED POINT -- NP=16
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.627, CR-perPeriod=0.971, Time to solve = 1.24e+02(s)
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 23 (FP) (maximumNumberOfIterations=100)
 numberOfFrequencies= 10, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=800, totalTimeStepsStaken=18400, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.990) T= 2.09440, Tbar=33.51032, numPeriods= 16, Tbar(0)/T= 16.00
 freq= 1, omega=   6.000, (adjusted=   5.922) T= 1.04720, Tbar=32.46312, numPeriods= 31, Tbar(0)/T= 32.00
 freq= 2, omega=   9.000, (adjusted=   8.744) T= 0.69813, Tbar=32.11406, numPeriods= 46, Tbar(0)/T= 48.00
 freq= 3, omega=  12.000, (adjusted=  11.412) T= 0.52360, Tbar=31.93953, numPeriods= 61, Tbar(0)/T= 64.00
 freq= 4, omega=  15.000, (adjusted=  13.897) T= 0.41888, Tbar=30.99705, numPeriods= 74, Tbar(0)/T= 80.00
 freq= 5, omega=  18.000, (adjusted=  16.182) T= 0.34907, Tbar=30.01966, numPeriods= 86, Tbar(0)/T= 96.00
 freq= 6, omega=  21.000, (adjusted=  18.260) T= 0.29920, Tbar=29.02233, numPeriods= 97, Tbar(0)/T=112.00
 freq= 7, omega=  24.000, (adjusted=  20.135) T= 0.26180, Tbar=28.01253, numPeriods=107, Tbar(0)/T=128.00
 freq= 8, omega=  27.000, (adjusted=  21.815) T= 0.23271, Tbar=26.99443, numPeriods=116, Tbar(0)/T=144.00
 freq= 9, omega=  30.000, (adjusted=  23.315) T= 0.20944, Tbar=25.97050, numPeriods=124, Tbar(0)/T=160.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=6.144e-06.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=8.089e-05.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=7.522e-05.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=2.526e-04.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=1.621e-04.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=4.326e-04.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=4.176e-04.
CgWaveHoltz::residual: freq= 7, omega=  24.000, max-res=5.473e-04.
CgWaveHoltz::residual: freq= 8, omega=  27.000, max-res=6.471e-04.
CgWaveHoltz::residual: freq= 9, omega=  30.000, max-res=7.055e-04.
CgWaveHoltz: max-res=7.055e-04 (all frequencies)

Direct solve Helmholtz: cpu= 2.61e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=1.58e-08 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.56e-07 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.50e-07 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.15e-06 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.64e-06 for freq4 =   1.5000e+01, |v|_max= 1.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.72e-06 for freq5 =   1.8000e+01, |v|_max= 3.93e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.75e-06 for freq6 =   2.1000e+01, |v|_max= 8.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.71e-06 for freq7 =   2.4000e+01, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.95e-04 for freq8 =   2.7000e+01, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.57e-05 for freq9 =   3.0000e+01, |v|_max= 1.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.95e-04, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





>> nf=2 omega=33, 36
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=2 -freq=33 36 3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og



>> nf=2 omega=33, 36
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 0.55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=2 -freq=33 36 3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

>>>> nf=12
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 0.5 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 0.45 0.55 -nf=12 -freq=3 6 9 12 15 18 21 24 27 30 33 36 -amp=50 50 50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.372, CR-perPeriod=0.884, Time to solve = 7.97e+01(s)
 max-residual=1.05e-11 (WaveHoltz its), numberOfIterations = 20 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 12, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=480, totalTimeStepsStaken=10560, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.993) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   6.000, (adjusted=   5.946) T= 1.04720, Tbar=15.70796, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=   9.000, (adjusted=   8.820) T= 0.69813, Tbar=16.05703, numPeriods= 23, Tbar(0)/T= 24.00
 freq= 3, omega=  12.000, (adjusted=  11.583) T= 0.52360, Tbar=15.70796, numPeriods= 30, Tbar(0)/T= 32.00
 freq= 4, omega=  15.000, (adjusted=  14.209) T= 0.41888, Tbar=15.49852, numPeriods= 37, Tbar(0)/T= 40.00
 freq= 5, omega=  18.000, (adjusted=  16.679) T= 0.34907, Tbar=15.35890, numPeriods= 44, Tbar(0)/T= 48.00
 freq= 6, omega=  21.000, (adjusted=  18.982) T= 0.29920, Tbar=14.95997, numPeriods= 50, Tbar(0)/T= 56.00
 freq= 7, omega=  24.000, (adjusted=  21.113) T= 0.26180, Tbar=14.66077, numPeriods= 56, Tbar(0)/T= 64.00
 freq= 8, omega=  27.000, (adjusted=  23.073) T= 0.23271, Tbar=14.19534, numPeriods= 61, Tbar(0)/T= 72.00
 freq= 9, omega=  30.000, (adjusted=  24.867) T= 0.20944, Tbar=13.82301, numPeriods= 66, Tbar(0)/T= 80.00
 freq=10, omega=  33.000, (adjusted=  26.502) T= 0.19040, Tbar=13.32797, numPeriods= 70, Tbar(0)/T= 88.00
 freq=11, omega=  36.000, (adjusted=  27.989) T= 0.17453, Tbar=12.91544, numPeriods= 74, Tbar(0)/T= 96.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=3.433e-09.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=4.250e-09.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=4.075e-09.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=5.305e-09.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=4.870e-09.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=6.111e-09.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=5.670e-09.
CgWaveHoltz::residual: freq= 7, omega=  24.000, max-res=5.086e-09.
CgWaveHoltz::residual: freq= 8, omega=  27.000, max-res=5.619e-09.
CgWaveHoltz::residual: freq= 9, omega=  30.000, max-res=7.566e-09.
CgWaveHoltz::residual: freq=10, omega=  33.000, max-res=7.594e-09.
CgWaveHoltz::residual: freq=11, omega=  36.000, max-res=7.576e-09.
CgWaveHoltz: max-res=7.594e-09 (all frequencies)

Direct solve Helmholtz: cpu= 3.13e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=2.70e-12 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=9.82e-12 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=7.22e-12 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.60e-11 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.23e-11 for freq4 =   1.5000e+01, |v|_max= 1.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.55e-11 for freq5 =   1.8000e+01, |v|_max= 3.93e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.91e-11 for freq6 =   2.1000e+01, |v|_max= 8.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.53e-11 for freq7 =   2.4000e+01, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.25e-10 for freq8 =   2.7000e+01, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.90e-10 for freq9 =   3.0000e+01, |v|_max= 1.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=9.94e-11 for freq10 =   3.3000e+01, |v|_max= 8.69e-02 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.13e-10 for freq11 =   3.6000e+01, |v|_max= 9.61e-02 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.25e-10, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




>>>> nf=10
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 0.45 0.55 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 0.55 0.5 -nf=10 -freq=3 6 9 12 15 18 21 24 27 30 -amp=50 50 50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.324, CR-perPeriod=0.868, Time to solve = 5.71e+01(s)
 max-residual=5.13e-12 (WaveHoltz its), numberOfIterations = 18 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 10, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=400, totalTimeStepsStaken=8000, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.990) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   6.000, (adjusted=   5.922) T= 1.04720, Tbar=15.70796, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=   9.000, (adjusted=   8.744) T= 0.69813, Tbar=16.05703, numPeriods= 23, Tbar(0)/T= 24.00
 freq= 3, omega=  12.000, (adjusted=  11.412) T= 0.52360, Tbar=15.70796, numPeriods= 30, Tbar(0)/T= 32.00
 freq= 4, omega=  15.000, (adjusted=  13.897) T= 0.41888, Tbar=15.49852, numPeriods= 37, Tbar(0)/T= 40.00
 freq= 5, omega=  18.000, (adjusted=  16.182) T= 0.34907, Tbar=15.00983, numPeriods= 43, Tbar(0)/T= 48.00
 freq= 6, omega=  21.000, (adjusted=  18.260) T= 0.29920, Tbar=14.36157, numPeriods= 48, Tbar(0)/T= 56.00
 freq= 7, omega=  24.000, (adjusted=  20.135) T= 0.26180, Tbar=13.87537, numPeriods= 53, Tbar(0)/T= 64.00
 freq= 8, omega=  27.000, (adjusted=  21.815) T= 0.23271, Tbar=13.49721, numPeriods= 58, Tbar(0)/T= 72.00
 freq= 9, omega=  30.000, (adjusted=  23.315) T= 0.20944, Tbar=12.98525, numPeriods= 62, Tbar(0)/T= 80.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=2.182e-09.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=1.748e-09.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=3.760e-09.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=4.326e-09.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=4.071e-09.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=5.345e-09.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=5.025e-09.
CgWaveHoltz::residual: freq= 7, omega=  24.000, max-res=4.919e-09.
CgWaveHoltz::residual: freq= 8, omega=  27.000, max-res=5.306e-09.
CgWaveHoltz::residual: freq= 9, omega=  30.000, max-res=7.496e-09.
CgWaveHoltz: max-res=7.496e-09 (all frequencies)

Direct solve Helmholtz: cpu= 2.63e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=1.83e-12 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=9.82e-12 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.01e-11 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.60e-11 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.64e-11 for freq4 =   1.5000e+01, |v|_max= 1.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.82e-11 for freq5 =   1.8000e+01, |v|_max= 3.93e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.53e-11 for freq6 =   2.1000e+01, |v|_max= 8.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.42e-11 for freq7 =   2.4000e+01, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.90e-11 for freq8 =   2.7000e+01, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.88e-10 for freq9 =   3.0000e+01, |v|_max= 1.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.88e-10, |v|_max= 9.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>> nf=8 
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 0.5 0.45 0.55 0.55 0.5 -y0=0.5 0.55 0.45 0.45 0.5 0.55 0.45 0.5 -nf=8 -freq=3 6 9 12 15 18 21 24 -amp=50 50 50 50 50 50 50 50 -beta=150 150 150 150 150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.254, CR-perPeriod=0.843, Time to solve = 3.42e+01(s)
 max-residual=1.14e-11 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 8, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=320, totalTimeStepsStaken=5120, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.985) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   6.000, (adjusted=   5.879) T= 1.04720, Tbar=15.70796, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=   9.000, (adjusted=   8.607) T= 0.69813, Tbar=16.05703, numPeriods= 23, Tbar(0)/T= 24.00
 freq= 3, omega=  12.000, (adjusted=  11.115) T= 0.52360, Tbar=15.18436, numPeriods= 29, Tbar(0)/T= 32.00
 freq= 4, omega=  15.000, (adjusted=  13.372) T= 0.41888, Tbar=14.66077, numPeriods= 35, Tbar(0)/T= 40.00
 freq= 5, omega=  18.000, (adjusted=  15.370) T= 0.34907, Tbar=14.31170, numPeriods= 41, Tbar(0)/T= 48.00
 freq= 6, omega=  21.000, (adjusted=  17.119) T= 0.29920, Tbar=13.46397, numPeriods= 45, Tbar(0)/T= 56.00
 freq= 7, omega=  24.000, (adjusted=  18.638) T= 0.26180, Tbar=12.82817, numPeriods= 49, Tbar(0)/T= 64.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=5.343e-09.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=4.992e-09.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=8.368e-09.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=1.016e-08.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=7.855e-09.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=9.617e-09.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=1.182e-08.
CgWaveHoltz::residual: freq= 7, omega=  24.000, max-res=1.442e-08.
CgWaveHoltz: max-res=1.442e-08 (all frequencies)

Direct solve Helmholtz: cpu= 2.12e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=2.21e-12 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=9.82e-12 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.21e-11 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.23e-11 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.33e-11 for freq4 =   1.5000e+01, |v|_max= 1.96e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.12e-11 for freq5 =   1.8000e+01, |v|_max= 3.93e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.03e-10 for freq6 =   2.1000e+01, |v|_max= 8.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.73e-10 for freq7 =   2.4000e+01, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.73e-10, |v|_max= 9.22e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.156, CR-perPeriod=0.793, Time to solve = 2.96e+01(s)
 max-residual=1.46e-10 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 7, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=280, totalTimeStepsStaken=4480, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   3.000, (adjusted=   2.980) T= 2.09440, Tbar=16.75516, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=   6.000, (adjusted=   5.843) T= 1.04720, Tbar=15.70796, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=   9.000, (adjusted=   8.496) T= 0.69813, Tbar=15.35890, numPeriods= 22, Tbar(0)/T= 24.00
 freq= 3, omega=  12.000, (adjusted=  10.878) T= 0.52360, Tbar=15.18436, numPeriods= 29, Tbar(0)/T= 32.00
 freq= 4, omega=  15.000, (adjusted=  12.967) T= 0.41888, Tbar=14.24189, numPeriods= 34, Tbar(0)/T= 40.00
 freq= 5, omega=  18.000, (adjusted=  14.766) T= 0.34907, Tbar=13.61357, numPeriods= 39, Tbar(0)/T= 48.00
 freq= 6, omega=  21.000, (adjusted=  16.298) T= 0.29920, Tbar=12.86557, numPeriods= 43, Tbar(0)/T= 56.00

CgWaveHoltz::residual: freq= 0, omega=   3.000, max-res=1.456e-08.
CgWaveHoltz::residual: freq= 1, omega=   6.000, max-res=2.291e-08.
CgWaveHoltz::residual: freq= 2, omega=   9.000, max-res=4.020e-08.
CgWaveHoltz::residual: freq= 3, omega=  12.000, max-res=4.182e-08.
CgWaveHoltz::residual: freq= 4, omega=  15.000, max-res=6.766e-08.
CgWaveHoltz::residual: freq= 5, omega=  18.000, max-res=7.547e-08.
CgWaveHoltz::residual: freq= 6, omega=  21.000, max-res=8.346e-08.
CgWaveHoltz: max-res=8.346e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.85e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=1.63e-11 for freq0 =   3.0000e+00, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.69e-11 for freq1 =   6.0000e+00, |v|_max= 3.27e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=2.47e-11 for freq2 =   9.0000e+00, |v|_max= 4.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.65e-11 for freq3 =   1.2000e+01, |v|_max= 2.01e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.34e+03 for freq4 =   1.5000e+01, |v|_max= 3.73e-02 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.09e+02 for freq5 =   1.8000e+01, |v|_max= 6.18e-02 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=7.67e+02 for freq6 =   2.1000e+01, |v|_max= 1.43e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.34e+03, |v|_max= 5.45e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...






>> WHAT HAPPENS WITH frequencies are multiples of f0 ? --> WORKS 
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 .5 -y0=0.5 0.55 0.45 .45 -nf=4 -freq=5.0 10 15 20 -amp=50 50 50 50 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.248, CR-perPeriod=0.840, Time to solve = 1.51e+01(s)
 max-residual=4.42e-11 (WaveHoltz its), numberOfIterations = 14 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=160, totalTimeStepsStaken=2560, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   5.000, (adjusted=   4.896) T= 1.25664, Tbar=10.05310, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  10.000, (adjusted=   9.241) T= 0.62832, Tbar= 9.42478, numPeriods= 15, Tbar(0)/T= 16.00
 freq= 2, omega=  15.000, (adjusted=  12.754) T= 0.41888, Tbar= 8.37758, numPeriods= 20, Tbar(0)/T= 24.00
 freq= 3, omega=  20.000, (adjusted=  15.434) T= 0.31416, Tbar= 7.85398, numPeriods= 25, Tbar(0)/T= 32.00

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=5.406e-09.
CgWaveHoltz::residual: freq= 1, omega=  10.000, max-res=1.942e-08.
CgWaveHoltz::residual: freq= 2, omega=  15.000, max-res=3.652e-08.
CgWaveHoltz::residual: freq= 3, omega=  20.000, max-res=3.702e-08.
CgWaveHoltz: max-res=3.702e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.07e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=1.34e-11 for freq0 =   5.0000e+00, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.24e-11 for freq1 =   1.0000e+01, |v|_max= 4.73e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.06e-11 for freq2 =   1.5000e+01, |v|_max= 2.26e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.50e-10 for freq3 =   2.0000e+01, |v|_max= 3.65e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.50e-10, |v|_max= 4.73e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...





>>>>>> NF=4 : OK 
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 .5 -y0=0.5 0.55 0.45 .45 -nf=4 -freq=5.0 11 17 27 -amp=50 50 50 50 -beta=150 150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.312, CR-perPeriod=0.864, Time to solve = 2.42e+01(s)
 max-residual=2.12e-11 (WaveHoltz its), numberOfIterations = 17 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=216, totalTimeStepsStaken=4104, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   5.000, (adjusted=   4.943) T= 1.25664, Tbar=10.05310, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  11.000, (adjusted=  10.434) T= 0.57120, Tbar= 9.13918, numPeriods= 16, Tbar(0)/T= 17.60
 freq= 2, omega=  17.000, (adjusted=  15.112) T= 0.36960, Tbar= 8.87038, numPeriods= 24, Tbar(0)/T= 27.20
 freq= 3, omega=  27.000, (adjusted=  20.916) T= 0.23271, Tbar= 7.67945, numPeriods= 33, Tbar(0)/T= 43.20

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=1.669e-08.
CgWaveHoltz::residual: freq= 1, omega=  11.000, max-res=2.507e-08.
CgWaveHoltz::residual: freq= 2, omega=  17.000, max-res=9.088e-09.
CgWaveHoltz::residual: freq= 3, omega=  27.000, max-res=5.295e-08.
CgWaveHoltz: max-res=5.295e-08 (all frequencies)

Direct solve Helmholtz: cpu= 1.07e+00(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=3.53e-11 for freq0 =   5.0000e+00, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.89e-11 for freq1 =   1.1000e+01, |v|_max= 4.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.69e-11 for freq2 =   1.7000e+01, |v|_max= 4.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.62e-08 for freq3 =   2.7000e+01, |v|_max= 1.49e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=3.62e-08, |v|_max= 1.49e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




>>>>>> NF=3 : OK 
cgwh gaussian.cmd -g=square256.order2 -x0=0.5 0.45 .55 -y0=0.5 0.55 0.45 -nf=3 -freq=5.0 11 17 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=yale -rtoli=1e-7 -atoli=1e-7 -solverh=yale -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square256.order2.hdf
 Convergence rate CR=0.176, CR-perPeriod=0.805, Time to solve = 1.03e+01(s)
 max-residual=1.23e-11 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=136, totalTimeStepsStaken=1768, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   5.000, (adjusted=   4.856) T= 1.25664, Tbar=10.05310, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  11.000, (adjusted=   9.683) T= 0.57120, Tbar= 8.56798, numPeriods= 15, Tbar(0)/T= 17.60
 freq= 2, omega=  17.000, (adjusted=  13.075) T= 0.36960, Tbar= 7.76158, numPeriods= 21, Tbar(0)/T= 27.20

CgWaveHoltz::residual: freq= 0, omega=   5.000, max-res=1.800e-09.
CgWaveHoltz::residual: freq= 1, omega=  11.000, max-res=8.513e-09.
CgWaveHoltz::residual: freq= 2, omega=  17.000, max-res=2.694e-08.
CgWaveHoltz: max-res=2.694e-08 (all frequencies)

Direct solve Helmholtz: cpu= 8.07e-01(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
cgwh: rel-max-diff=6.37e-12 for freq0 =   5.0000e+00, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=7.42e-12 for freq1 =   1.1000e+01, |v|_max= 4.33e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.99e-10 for freq2 =   1.7000e+01, |v|_max= 4.61e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.99e-10, |v|_max= 6.46e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)







**************************************************
**** Fri Jan 13, 2023

DIRECT HELMHOLTZ : increase ILU levels helps convergence

**CHECK AVERAGE NUMBER OF ITS NEEDED BY MG SOLVER**


G32: 
cgwh gaussian.cmd -g=sice16.order2.ml4 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=1000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice16.order2.ml4.hdf
 Convergence rate CR=0.143, CR-perPeriod=0.784, Time to solve = 4.73e+01(s)
 max-residual=1.26e-09 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1000.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=672, aveItsPerImplicitSolve=  5.6
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.424e-05 (using omega), max-res=2.205e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.424e-05 (all frequencies)

Direct solve Helmholtz: cpu= 1.38e+00(s), iterations=98 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=8.70e-10, |v|_max= 3.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>>>>>>>> G128

cgwh gaussian.cmd -g=sice128.order2.ml6 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=10000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice128.order2.ml6.hdf
 Convergence rate CR=0.149, CR-perPeriod=0.788, Time to solve = 2.44e+03(s)
 max-residual=5.57e-09 (WaveHoltz its), numberOfIterations = 9 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=616, aveItsPerImplicitSolve=  7.1
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=6.533e-03 (using omega), max-res=2.204e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.533e-03 (all frequencies)

Direct solve Helmholtz: cpu= 5.17e+03(s), iterations=6055 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=1.42e-09, |v|_max= 3.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>>>>>>>> G64: 1.4M pts

G64: numPeriods=2 ... about the same solve time as numPeriods=8

cgwh gaussian.cmd -g=sice64.order2.ml5 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=2 -cfl=2000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice64.order2.ml5.hdf
 Convergence rate CR=0.782, CR-perPeriod=0.884, Time to solve = 5.35e+02(s)
 max-residual=4.10e-10 (WaveHoltz its), numberOfIterations = 78 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=2000.00, numberOfStepsPerSolve=10, totalTimeStepsStaken=800, aveItsPerImplicitSolve=  6.3
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   4.754) T= 0.78540, Tbar= 1.57080, numPeriods=  2, Tbar(0)/T=  2.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.960e-06 (using omega), max-res=9.554e+00 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.960e-06 (all frequencies)



G64: numPeriods=8
cgwh gaussian.cmd -g=sice64.order2.ml5 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=2000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice64.order2.ml5.hdf
 Convergence rate CR=0.148, CR-perPeriod=0.787, Time to solve = 5.41e+02(s)
 max-residual=5.80e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=2000.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=672, aveItsPerImplicitSolve=  6.5
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.853e-04 (using omega), max-res=2.204e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.853e-04 (all frequencies)

Direct solve Helmholtz: cpu= 4.65e+02(s), iterations=2348 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.48e-10, |v|_max= 3.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



G32: 
cgwh gaussian.cmd -g=sice32.order2.ml4 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=1000 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice32.order2.ml4.hdf
 Convergence rate CR=0.151, CR-perPeriod=0.789, Time to solve = 1.34e+02(s)
 max-residual=7.68e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1000.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=672, aveItsPerImplicitSolve=  6.1
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=5.975e-05 (using omega), max-res=2.204e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=5.975e-05 (all frequencies)

Direct solve Helmholtz: cpu= 2.91e+01(s), iterations=609 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.70e-10, |v|_max= 3.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




REDUCE MG CONVERGENCE TOL:
cgwh gaussian.cmd -g=sice4.order2.ml3 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-7 -atoli=1e-7 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=728, aveItsPerImplicitSolve=  4.6




>>> Base initial guess on solution being periodic: not much better
  ISSUE COULD BE THAT GMRES ITERATES ARE NOT CONVERGING TO THE PERIODIC SOLUTION

  Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=728, aveItsPerImplicitSolve=  6.4 


>>> START: 6.8 its/solve (MG)

cgwh gaussian.cmd -g=sice4.order2.ml3 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order2.ml3.hdf
 Convergence rate CR=0.159, CR-perPeriod=0.794, Time to solve = 7.86e+00(s)
 max-residual=2.20e-10 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=728, aveItsPerImplicitSolve=  6.8
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.950e-07 (using omega), max-res=2.225e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.950e-07 (all frequencies)

Direct solve Helmholtz: cpu= 1.60e-01(s), iterations=179 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.86e-06, |v|_max= 3.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


TRY MG WITH DISK
>>>>>>>> DISK G16
cgwh gaussian.cmd -g=sice16.order2.ml4 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=800 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice16.order2.ml4.hdf
 Convergence rate CR=0.143, CR-perPeriod=0.784, Time to solve = 8.49e+01(s)
 max-residual=7.16e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=800.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=672
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.425e-05 (using omega), max-res=2.205e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.425e-05 (all frequencies)

Direct solve Helmholtz: cpu= 4.97e+00(s), iterations=520 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=2.37e-10, |v|_max= 3.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>>> DISK G8 -- **TODO** INCREASE CFL
cgwh gaussian.cmd -g=sice8.order2.ml3 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-12 -atolh=1.0e-12  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice8.order2.ml3.hdf
 Convergence rate CR=0.119, CR-perPeriod=0.766, Time to solve = 1.94e+01(s)
 max-residual=1.10e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=64, totalTimeStepsStaken=768
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.903) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=4.584e-07 (using omega), max-res=2.243e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=4.584e-07 (all frequencies)

Direct solve Helmholtz: cpu= 2.05e-01(s), iterations=58 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=2.69e-11, |v|_max= 3.50e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



>>>>>>>> DISK G4
cgwh gaussian.cmd -g=sice4.order2.ml3 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice4.order2.ml3.hdf
 Convergence rate CR=0.159, CR-perPeriod=0.794, Time to solve = 8.05e+00(s)
 max-residual=2.13e-10 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=728
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.949e-07 (using omega), max-res=2.225e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.949e-07 (all frequencies)

Direct solve Helmholtz: cpu= 1.64e-01(s), iterations=179 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.86e-06, |v|_max= 3.53e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

>>>>>>>>>>>>>> DISK G2
cgwh gaussian.cmd -g=sice2.order2.ml2 -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=1 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=8 -cfl=100 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -solverh=gmres -restart=100 -iluh=10 -maxith=1000 -rtolh=1.0e-10 -atolh=1.0e-10  -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/sice2.order2.ml2.hdf
 Convergence rate CR=0.184, CR-perPeriod=0.809, Time to solve = 4.33e+00(s)
 max-residual=4.07e-10 (WaveHoltz its), numberOfIterations = 12 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=784
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=   8.000, (adjusted=   6.534) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.283e-07 (using omega), max-res=2.323e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.283e-07 (all frequencies)

Direct solve Helmholtz: cpu= 6.96e-02(s), iterations=189 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(10) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=9.17e-08, |v|_max= 3.68e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...



**************************************************
**** Tues Jan 10, 2023

>>>>>> G2048: increase CFL
cgwh gaussian.cmd -g=square2048.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=10000 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square2048.order2.hdf
 Convergence rate CR=0.313, CR-perPeriod=0.748, Time to solve = 4.04e+02(s)
 max-residual=1.41e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=10000.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=360
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00




>>>>>> G1024: increase CFL
cgwh gaussian.cmd -g=square1024.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=1600 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og
------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square1024.order2.hdf
 Convergence rate CR=0.313, CR-perPeriod=0.748, Time to solve = 9.18e+01(s)
 max-residual=1.40e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1600.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=360
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00



------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square1024.order2.hdf
 Convergence rate CR=0.313, CR-perPeriod=0.748, Time to solve = 9.18e+01(s)
 max-residual=1.40e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1600.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=360
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=2.158e-07 (using omega), max-res=3.977e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.158e-07 (all frequencies)
cgwh: max-err =0.00e+00 (between WaveHoltz and known solution, all frequencies)



>>>>>> G1024: D=2,300s   WH=105s
cgwh gaussian.cmd -g=square1024.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=800 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=50000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og

 === Direct Helmholtz Solver:
 PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
 =====

*** freq=0: omega=11, max residual=9.98e-11, time for direct Helmholtz solve = 2.31e+03 (s) (iterations=29680) ***
CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=1.195e-07 (using omega), max-res=2.389e+01 (using omega from discrete symbol)
CgWaveHoltz: omega=1.100e+01, max-res=1.195e-07 (direct Helmholtz solution)
cgwh: max-err =0.00e+00 (between WaveHoltz and known solution, all frequencies)
cgwh: rel-max-diff=0.00e+00, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.193, CR-perPeriod=0.663, Time to solve = 1.05e+02(s)
 max-residual=4.39e-09 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=36, totalTimeStepsStaken=468
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   9.826) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=2.186e-07 (using omega), max-res=2.114e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.186e-07 (all frequencies)

Direct solve Helmholtz: cpu= 2.31e+03(s), iterations=29680 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=4.12e-09, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





USE MG to solve IMP equations: Direct=57s WH=24s 
cgwh gaussian.cmd -g=square512.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og


 === Direct Helmholtz Solver:
 PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
 =====

*** freq=0: omega=11, max residual=9.94e-11, time for direct Helmholtz solve = 5.78e+01 (s) (iterations=3189) ***

cgWave:FD22 t=2.307e+00 (12 steps) dt=1.922e-01 ||u||= 2.81e-01, cpu= 7.51e-01(s)
cgWave:FD22 t=2.691e+00 (14 steps) dt=1.922e-01 ||u||= 1.07e-01, cpu= 8.85e-01(s)
cgWave:FD22 t=3.268e+00 (17 steps) dt=1.922e-01 ||u||= 2.81e-01, cpu= 1.09e+00(s)
cgWave:FD22 t=3.845e+00 (20 steps) dt=1.922e-01 ||u||= 3.48e-01, cpu= 1.30e+00(s)
it=-3:  max(residual) = max(|v-vOld|)=1.39e-09, tol=1e-08

 ######## DONE KYRLOV ITERATIONS -- KSP residual=2.58e-10 (max-res=1.39e-09) (tol=1.00e-08) numIts=16 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.313, CR-perPeriod=0.748, Time to solve = 2.35e+01(s)
 max-residual=1.39e-09 (WaveHoltz its), numberOfIterations = 16 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=360
    implicit solver : multigrid, solver=[iterative solver + ]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=2.141e-07 (using omega), max-res=3.978e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=2.141e-07 (all frequencies)

Direct solve Helmholtz: cpu= 5.69e+01(s), iterations=3189 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=1.94e-09, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



OK: MG starts to work:
cgwh gaussian.cmd -g=square64.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=5 -numPeriods=4 -cfl=10 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og


**************************************************
**** Sun Jan 8, 2023

MULTIGRID??  NEED TO FIX MG PARAMETERS

cgwh gaussian.cmd -g=square64.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=0 -imode=1 -maxIterations=5 -numPeriods=4 -cfl=10 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=10000 -solveri=multigrid -rtoli=1e-10 -atoli=1e-10 -go=og



>>> SQUARE512
cgwh gaussian.cmd -g=square512.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-6 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-6 -atolh=1.0e-6 -maxith=10000 -solveri=bcgs -rtoli=1e-4 -atoli=1e-4 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.552, CR-perPeriod=0.862, Time to solve = 2.16e+02(s)
 max-residual=4.67e-05 (WaveHoltz its), numberOfIterations = 11 (Krylov) (maximumNumberOfIterations=150)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=260
    implicit solver : PETSc, solver=[bi-conjugate gradient stabilized + ILU(3) + reverse Cuthill-McKee ordering]
 =====
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=7.726e-02 (using omega), max-res=3.980e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=7.726e-02 (all frequencies)

Direct solve Helmholtz: cpu= 3.09e+01(s), iterations=1727 (sum all freq)
   solver : PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
cgwh: rel-max-diff=3.51e-04, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh gaussian.cmd -g=square128.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-8 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-8 -atolh=1.0e-8 -maxith=1000 -solveri=bcgs -go=og


**************************************************
**** Sat Jan 7, 2023

ADD OPTION TO USE PETSC FOR DIRECT HELMHOLTZ SOLVER


ADD OPTION TO USE PETSC FOR IMPLICIT TIME_STEPPING


cgwh gaussian.cmd -g=square256.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=1000 -solveri=bcgs -go=og



>>>> WH (12s) is faster than GMRES (44s) but slower than Yale (2s)
cgwh gaussian.cmd -g=square512.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-8  -atolh=1.0e-8 -maxith=5000 -go=og

=== Solver:
 PETSc, solver=[generalized minimal residual iteration + ILU(5) + reverse Cuthill-McKee ordering]
 =====

*** freq=0: omega=11, max residual=1.00e-08, time for direct Helmholtz solve = 4.41e+01 (s) (iterations=2446) ***

 ######## DONE KYRLOV ITERATIONS -- KSP residual=2.73e-11 (max-res=1.31e-10) (tol=1.00e-10) numIts=17 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.374, CR-perPeriod=0.782, Time to solve = 1.17e+01(s)
 max-residual=1.31e-10 (WaveHoltz its), numberOfIterations = 17 (Krylov) (maximumNumberOfIterations=150)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=380
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=6.588e-06 (using omega), max-res=3.978e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=6.588e-06 (all frequencies)
cgwh: rel-max-diff=1.74e-07, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




cgwh gaussian.cmd -g=square256.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -solverh=gmres -rtolh=1.0e-10 -atolh=1.0e-10 -maxith=1000 -go=og


cgwh gaussian.cmd -g=square1024.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -go=og

 ######## DONE KYRLOV ITERATIONS -- KSP residual=8.60e-11 (max-res=3.38e-10) (tol=1.00e-10) numIts=10 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.235, CR-perPeriod=0.696, Time to solve = 6.90e+01(s)
 max-residual=3.38e-10 (WaveHoltz its), numberOfIterations = 10 (Krylov) (maximumNumberOfIterations=150)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=36, totalTimeStepsStaken=432
 freq= 0, omega=  11.000, (adjusted=   9.826) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=1.077e-05 (using omega), max-res=2.114e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.077e-05 (all frequencies)
cgwh: rel-max-diff=3.75e-10, |v|_max= 3.48e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





cgwh gaussian.cmd -g=square128.order2 -x0=.4 -.55 .5 -y0=.4 .5 .5 -nf=1 -freq=11 9.777 12.34 -amp=100 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -go=og

--- square 128:
 ######## DONE KYRLOV ITERATIONS -- KSP residual=7.49e-11 (max-res=2.72e-10) (tol=1.00e-10) numIts=17 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.352, CR-perPeriod=0.771, Time to solve = 5.55e-01(s)
 max-residual=2.72e-10 (WaveHoltz its), numberOfIterations = 17 (Krylov) (maximumNumberOfIterations=150)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=400.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=380
 freq= 0, omega=  11.000, (adjusted=   6.536) T= 0.57120, Tbar= 2.28479, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  11.000, max-res=4.490e-08 (using omega), max-res=3.995e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=4.490e-08 (all frequencies)
cgwh: rel-max-diff=4.43e-10, |v|_max= 3.49e-01 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





**************************************************
**** Fri Dec 30, 2022

FREQ=70
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=70 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega70.show -go=og


FREQ=69
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=69 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega69.show -go=og


FREQ=68
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=68 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega68.show -go=og

FREQ=67
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=67 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega67.show -go=og

FREQ=66
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=66 9.777 12.34 -amp=500 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=150 -numPeriods=4 -cfl=400 -show=shapesOmega66.show -go=og




Higher freq: 
cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=33 9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

 ######## DONE KYRLOV ITERATIONS -- KSP residual=8.03e-09 (max-res=2.95e-08) (tol=1.00e-10) numIts=104 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.879, CR-perPeriod=0.968, Time to solve = 6.62e+00(s)
 max-residual=2.95e-08 (WaveHoltz its), numberOfIterations = 104 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=20, totalTimeStepsStaken=4240
 freq= 0, omega=  33.000, (adjusted=  19.609) T= 0.19040, Tbar= 0.76160, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  33.000, max-res=1.950e-03 (using omega), max-res=8.401e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.950e-03 (all frequencies)
cgwh: max-diff=2.38e-04 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


**************************************************
**** Thurs Dec 29, 2022

RETURN TO WAVE-HOLTZ


OK: increase Frequency:
cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=15 9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

 ######## DONE KYRLOV ITERATIONS -- KSP residual=2.49e-08 (max-res=1.22e-07) (tol=1.00e-10) numIts=104 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.866, CR-perPeriod=0.965, Time to solve = 7.77e+00(s)
 max-residual=1.22e-07 (WaveHoltz its), numberOfIterations = 104 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=24, totalTimeStepsStaken=5088
 freq= 0, omega=  15.000, (adjusted=  11.107) T= 0.41888, Tbar= 1.67552, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  15.000, max-res=9.188e-04 (using omega), max-res=3.132e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=9.188e-04 (all frequencies)
cgwh: max-diff=1.63e-03 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




OK: nf=1
cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -.55 .5 -y0=-.75 .5 .5 -nf=1 -freq=9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

 ######## DONE KYRLOV ITERATIONS -- KSP residual=2.43e-11 (max-res=1.40e-10) (tol=1.00e-10) numIts=33 #######

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.534, CR-perPeriod=0.855, Time to solve = 3.48e+00(s)
 max-residual=1.40e-10 (WaveHoltz its), numberOfIterations = 33 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=32, totalTimeStepsStaken=2240
 freq= 0, omega=   9.777, (adjusted=   8.437) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=1.327e-06 (using omega), max-res=3.251e+01 (using omega from discrete symbol)
CgWaveHoltz: max-res=1.327e-06 (all frequencies)
cgwh: max-diff=4.05e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...



Needs upwinding:
cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -y0=-.75 -omega=6.666 -amp=20 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

>>>>>>>>
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.55 -.55 .5 -y0=.5 .5 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.571, CR-perPeriod=0.869, Time to solve = 6.83e+00(s)
 max-residual=2.60e-10 (WaveHoltz its), numberOfIterations = 34 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=28, totalTimeStepsStaken=1008
 freq= 0, omega=   9.777, (adjusted=   7.985) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.216) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=1.221e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=3.154e-08.


**************************************************
**** Sun Jan 16, 2022

--- ANNULUS NOTE : Increase beta so SOURCE TERM IS ZERO AT BOUNDARY (Our current BC's do not support an f)

TWO FREQ IMPLICIT
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.55 -.55 .5 -y0=.5 .5 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=400 400 400 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.623, CR-perPeriod=0.888, Time to solve = 1.82e+01(s)
 max-residual=2.10e-10 (WaveHoltz its), numberOfIterations = 41 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=28, totalTimeStepsStaken=1204
 freq= 0, omega=   9.777, (adjusted=   7.985) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.216) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=2.327e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=4.727e-08.
CgWaveHoltz: max-res=4.727e-08 (all frequencies)
cgwh: max-diff=8.71e-10 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.48e-08 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.48e-08 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

... tighter tol: 
CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=1.623e-10.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=2.388e-10.
CgWaveHoltz: max-res=2.388e-10 (all frequencies)
cgwh: max-diff=8.48e-13 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.62e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.62e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


>>>>>>>>>>>>>>TEST more terms

Nf=5 - close frequencies
cgwh gaussian.cmd -g=square128.order4.ng3.hdf -nf=4 -freq=21 22 23 24 25 -x0=.4 .6 .3 .7 -y0=.4 .6 .7 .3 -amp=150 100 200 400 -beta=200 250 200 300 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=500 -numPeriods=8 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.912, CR-perPeriod=0.989, Time to solve = 2.20e+01(s)
 numberOfIterations = 104 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=48, totalTimeStepsStaken=13440
 freq= 0, omega=  21.000, (adjusted=  15.550) T= 0.29920, Tbar= 2.39359, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  22.000, (adjusted=  15.946) T= 0.28560, Tbar= 2.28479, numPeriods=  8, Tbar(0)/T=  8.38
 freq= 2, omega=  23.000, (adjusted=  16.317) T= 0.27318, Tbar= 2.18546, numPeriods=  8, Tbar(0)/T=  8.76
 freq= 3, omega=  24.000, (adjusted=  16.665) T= 0.26180, Tbar= 2.09440, numPeriods=  8, Tbar(0)/T=  9.14

CgWaveHoltz::residual: freq= 0, omega=  21.000, max-res=6.958e-07.
CgWaveHoltz::residual: freq= 1, omega=  22.000, max-res=1.765e-06.
CgWaveHoltz::residual: freq= 2, omega=  23.000, max-res=1.860e-06.
CgWaveHoltz::residual: freq= 3, omega=  24.000, max-res=7.707e-07.
CgWaveHoltz: max-res=1.860e-06 (all frequencies)
cgwh: max-diff=1.29e-07 for freq0 =   2.1000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.11e-07 for freq1 =   2.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.08e-05 for freq2 =   2.3000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.53e-08 for freq3 =   2.4000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.08e-05 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



Nf=4 
cgwh gaussian.cmd -g=square128.order4.ng3.hdf -nf=4 -freq=9.777 12.34 18.9 21.4 -x0=.4 .6 .3 .7 -y0=.4 .6 .7 .3 -amp=150 100 200 400 -beta=200 250 200 300 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100 -numPeriods=4 -cfl=40 -go=og
------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.687, CR-perPeriod=0.910, Time to solve = 1.44e+01(s)
 numberOfIterations = 56 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl= 40.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=3248
 freq= 0, omega=   9.777, (adjusted=   9.359) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=  11.530) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05
 freq= 2, omega=  18.900, (adjusted=  16.326) T= 0.33244, Tbar= 1.99466, numPeriods=  6, Tbar(0)/T=  7.73
 freq= 3, omega=  21.400, (adjusted=  17.861) T= 0.29361, Tbar= 2.05525, numPeriods=  7, Tbar(0)/T=  8.76

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=1.550e-07.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=3.779e-08.
CgWaveHoltz::residual: freq= 2, omega=  18.900, max-res=3.260e-07.
CgWaveHoltz::residual: freq= 3, omega=  21.400, max-res=2.528e-07.
CgWaveHoltz: max-res=3.260e-07 (all frequencies)
cgwh: max-diff=5.13e-08 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.14e-10 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.38e-06 for freq2 =   1.8900e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.03e-10 for freq3 =   2.1400e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.38e-06 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh gaussian.cmd -g=square64.order4.ng3.hdf -nf=4 -freq=9.777 12.34 17.7 21.4 -x0=.4 .6 .3 .7 -y0=.4 .6 .5 .3 -amp=50 100 200 400 -beta=200 250 200 300 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=20 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.767, CR-perPeriod=0.936, Time to solve = 4.86e+00(s)
 numberOfIterations = 96 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 4, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl= 20.00, numberOfStepsPerSolve=56, totalTimeStepsStaken=5488
 freq= 0, omega=   9.777, (adjusted=   9.359) T= 0.64265, Tbar= 2.57060, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=  11.530) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05
 freq= 2, omega=  17.700, (adjusted=  15.533) T= 0.35498, Tbar= 2.12989, numPeriods=  6, Tbar(0)/T=  7.24
 freq= 3, omega=  21.400, (adjusted=  17.861) T= 0.29361, Tbar= 2.05525, numPeriods=  7, Tbar(0)/T=  8.76

CgWaveHoltz::residual: freq= 0, omega=   9.777, max-res=4.598e-10.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=8.631e-10.
CgWaveHoltz::residual: freq= 2, omega=  17.700, max-res=6.351e-09.
CgWaveHoltz::residual: freq= 3, omega=  21.400, max-res=6.627e-09.
CgWaveHoltz: max-res=6.627e-09 (all frequencies)
cgwh: max-diff=2.49e-11 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.25e-11 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.05e-06 for freq2 =   1.7700e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=7.50e-10 for freq3 =   2.1400e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.05e-06 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
plot contours...



Nf=2
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.4 .6 .5 -y0=.4 .6 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og

**************************************************
**** Sat Jan 15, 2022

RUN FOR PLOTS:

G8 IMPLICIT THREE FREQ 
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=3 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=8 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.500, CR-perPeriod=0.917, Time to solve = 4.60e+01(s)
 numberOfIterations = 30 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=88, totalTimeStepsStaken=2816
 freq= 0, omega=   8.000, (adjusted=   7.438) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  13.700, (adjusted=  11.348) T= 0.45863, Tbar= 5.50352, numPeriods= 12, Tbar(0)/T= 13.70
 freq= 2, omega=  17.300, (adjusted=  13.162) T= 0.36319, Tbar= 5.08466, numPeriods= 14, Tbar(0)/T= 17.30

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=5.639e-09.
CgWaveHoltz::residual: freq= 1, omega=  13.700, max-res=1.579e-08.
CgWaveHoltz::residual: freq= 2, omega=  17.300, max-res=2.228e-08.
CgWaveHoltz: max-res=2.228e-08 (all frequencies)
cgwh: max-diff=3.60e-11 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.18e-09 for freq1 =   1.3700e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.93e-09 for freq2 =   1.7300e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.93e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



G4 IMPLICIT THREE FREQ 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=3 -freq=8.0 13.7 17.3 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=8 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.600, CR-perPeriod=0.938, Time to solve = 1.15e+01(s)
 numberOfIterations = 40 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=88, totalTimeStepsStaken=6424
 freq= 0, omega=   8.000, (adjusted=   7.438) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  13.700, (adjusted=  11.348) T= 0.45863, Tbar= 5.50352, numPeriods= 12, Tbar(0)/T= 13.70
 freq= 2, omega=  17.300, (adjusted=  13.162) T= 0.36319, Tbar= 5.08466, numPeriods= 14, Tbar(0)/T= 17.30

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.657e-07.
CgWaveHoltz::residual: freq= 1, omega=  13.700, max-res=5.753e-07.
CgWaveHoltz::residual: freq= 2, omega=  17.300, max-res=7.498e-07.
CgWaveHoltz: max-res=7.498e-07 (all frequencies)
cgwh: max-diff=1.38e-09 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.83e-07 for freq1 =   1.3700e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.16e-09 for freq2 =   1.7300e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.83e-07 (between WaveHoltz and Direct Helmholtz solution, all frequencies)






G4 IMPLICIT THREE FREQ 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 -.2 -y0=-.2 .2 .2 -nf=3 -freq=8.0 12.34 17 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=8 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.797, CR-perPeriod=0.972, Time to solve = 7.45e+00(s)
 numberOfIterations = 25 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=88, totalTimeStepsStaken=5544
 freq= 0, omega=   8.000, (adjusted=   7.438) T= 0.78540, Tbar= 6.28319, numPeriods=  8, Tbar(0)/T=  8.00
 freq= 1, omega=  12.340, (adjusted=  10.536) T= 0.50917, Tbar= 5.60089, numPeriods= 11, Tbar(0)/T= 12.34
 freq= 2, omega=  17.000, (adjusted=  13.028) T= 0.36960, Tbar= 5.17439, numPeriods= 14, Tbar(0)/T= 17.00

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=8.197e-11.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=2.406e-10.
CgWaveHoltz::residual: freq= 2, omega=  17.000, max-res=1.141e-10.
CgWaveHoltz: max-res=2.406e-10 (all frequencies)
cgwh: max-diff=8.20e-13 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.87e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.94e-10 for freq2 =   1.7000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.87e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



G8 IMPLICIT TWO FREQ
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=2 -freq=8.0 12.34 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 Convergence rate CR=0.684, CR-perPeriod=0.909, Time to solve = 3.05e+01(s)
 numberOfIterations = 57 (Krylov) (maximumNumberOfIterations=100)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=100.00, numberOfStepsPerSolve=32, totalTimeStepsStaken=1888
 freq= 0, omega=   8.000, (adjusted=   6.903) T= 0.78540, Tbar= 3.14159, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.167) T= 0.50917, Tbar= 2.54586, numPeriods=  5, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=7.315e-09.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=2.422e-08.
CgWaveHoltz: max-res=2.422e-08 (all frequencies)
cgwh: max-diff=5.73e-10 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.93e-08 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.93e-08 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



IMPLICIT TWO FREQ
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=2 -freq=8.0 12.34 -amp=50 50 50 -beta=150 150 150 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=100 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 52 (maximumNumberOfIterations=100)
 numberOfFrequencies=2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.833, CR-perPeriod=0.955, Time to solve = 5.31e+00(s)
 freq= 0, omega=   8.000, (adjusted=   6.903) T= 0.78540, Tbar= 3.14159, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.167) T= 0.50917, Tbar= 2.54586, numPeriods=  5, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=5.318e-11.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=1.876e-10.
CgWaveHoltz: max-res=1.876e-10 (all frequencies)
cgwh: max-diff=4.25e-13 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.71e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.71e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



IMPLICIT TWO FREQ
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=2 -freq=8.0 12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=10 -go=og


CFL=100
------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 61 (maximumNumberOfIterations=100)
 numberOfFrequencies=2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.722, CR-perPeriod=0.922, Time to solve = 6.50e+00(s)
 freq= 0, omega=   8.000, (adjusted=   6.903) T= 0.78540, Tbar= 3.14159, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.167) T= 0.50917, Tbar= 2.54586, numPeriods=  5, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=2.869e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=9.103e-08.
CgWaveHoltz: max-res=9.103e-08 (all frequencies)
cgwh: max-diff=5.66e-10 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.29e-06 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.29e-06 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

... solve to higher tol: 
cgwh: max-diff=3.24e-13 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.18e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.18e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



CFL=10 AFTER FIX numPeriods
------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 33 (maximumNumberOfIterations=100)
 numberOfFrequencies=2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.545, CR-perPeriod=0.859, Time to solve = 9.57e+00(s)
 freq= 0, omega=   8.000, (adjusted=   7.863) T= 0.78540, Tbar= 3.14159, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=  11.855) T= 0.50917, Tbar= 3.05503, numPeriods=  6, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.438e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=1.794e-08.
CgWaveHoltz: max-res=1.794e-08 (all frequencies)
cgwh: max-diff=2.56e-10 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.25e-08 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.25e-08 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


BEFORE FIX NUMPERIODS
------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 53 (maximumNumberOfIterations=100)
 numberOfFrequencies=2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.680, CR-perPeriod=0.908, Time to solve = 1.44e+01(s)
 freq= 0, omega=   8.000, (adjusted=   7.863) T= 0.78540, Tbar= 3.14159, numPeriods=  4.00, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=  11.855) T= 0.50917, Tbar= 2.03669, numPeriods=  4.00, Tbar(0)/T=  6.17

CgWaveHoltz::residual: freq= 0, omega=   8.000, max-res=1.250e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=1.782e-08.
CgWaveHoltz: max-res=1.782e-08 (all frequencies)
cgwh: max-diff=2.65e-10 for freq0 =   8.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.68e-07 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.68e-07 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




IMPLICIT **WORKS NOW*** -- using adjust. for upwinding 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=1 -freq=12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=10 -go=og

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 49 (maximumNumberOfIterations=100)
 numberOfFrequencies=1, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.668, CR-perPeriod=0.904, Time to solve = 8.78e+00(s)
 freq= 0, omega=  12.340, (adjusted=  11.881) T= 0.50917, Tbar= 2.03669, numPeriods=  4.00, Tbar(0)/T=  4.00

CgWaveHoltz::residual: freq= 0, omega=  12.340, max-res=9.465e-07 (using omega), max-res=2.170e+02 (using omega from discrete symbol)
CgWaveHoltz: max-res=9.465e-07 (all frequencies)
cgwh: max-diff=2.40e-05 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=1 -freq=12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=.9 -go=og


**************************************************
**** Fri Jan 14, 2022

START more examples for waho



cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=1 -freq=12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=explicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=.9 -go=og

EXPLICIT: FD24u 
cgwh: max-diff=5.42e-05 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

IMPLICIT 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=1 -freq=12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=10 -go=og

CFL=1 FD24u

FD24u *TROUBLE** with upwinding

cgwh: max-diff=6.65e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

FD24
cgwh: max-diff=1.50e-08 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


SIC -Np=4 (ok) trouble Np=2
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=-.2 .2 .5 -y0=-.2 .2 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=4 -cfl=10 -go=og


UPWIND: trouble
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=5.917e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12.34, max-res=5.910e-02 (using omega).
cgwh: max-diff=5.11e-02 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.28e+00 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.28e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


NO upwind
cgwh: max-diff=8.10e-12 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.55e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.55e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.4 .6 .5 -y0=.4 .6 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=200 200 200 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-12 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og


TWO FREQ IMPLICIT
  >> RESIDUAL IS VERY SMALL BUT DIFF IS LARGER??
  BETA=100 --> WORKS!!
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.5 .5 .5 -y0=.5 .5 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=100 100 100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og
cgwh: max-diff=4.45e-10 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.89e-10 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.89e-10 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


BTA=50 : 
 ######## DONE KYRLOV ITERATIONS -- KSP residual=7.34e-15 (max-res=1.07e-14) (tol=1.00e-14) numIts=10 #######
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.4520749e+00 (from symbol of D+D-), dt=9.180709e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=8.497e-11 (using omega).
CgWaveHoltz::residual: freq=1, omega=12.34, max-res=4.755e-11 (using omega).
CgWaveHoltz: omega=9.777e+00, max-res=8.497e-11, CR=0.456 CR-perPeriod=0.675, cpu= 3.56e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=7.54e-12 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.24e-04 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.24e-04 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




+++++++++++++++++++++++ ANNULUS:

***CHECK*** residual in freq2 -- works ok for trigHelmholtz 

FREQ=12.34 - OK 
cgwh gaussian.cmd -g=annulus4.order4.ng3.hdf -x0=.5 .5 .5 -y0=.5 .5 .5 -nf=1 -freq=12.34 -amp=50 50 50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og
cgwh: max-diff=1.03e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


TWO FREQ IMPLICIT
cgwh gaussian.cmd -g=annulus4.order4.ng3.hdf -x0=.5 .5 .5 -y0=.5 .5 .5 -nf=2 -freq=9.777 12.34 -amp=50 50 50 -beta=100 100 100 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og



OK -- one freq
cgwh gaussian.cmd -g=annulus8.order2.hdf -x0=.5 -y0=.5 -nf=1 -freq=12.34  -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=20 -go=og

cgwh: max-diff=1.07e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

THREE FREQ -- ***TROUBLE***
cgwh gaussian.cmd -g=annulus8.order2.hdf -x0=.5 -y0=.5 -nf=3 -freq=9.777 12.34 15 -beta=100 100 100 -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=20 -go=og


cgwh gaussian.cmd -g=annulus8.order2.hdf -x0=.5 -y0=.5 -nf=2 -freq=9.777 12.34 -beta=100 100 -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=20 -go=og


ORDER=2 : TWO FREQ IMPLICIT
cgwh gaussian.cmd -g=annulus8.order2.hdf -x0=.5 -y0=.5 -nf=2 -freq=9.777 12.34 -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=20 -go=og
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=5.154e-08 (using omega).
CgWaveHoltz::residual: freq=1, omega=12.34, max-res=6.031e-08 (using omega).
CgWaveHoltz: omega=9.777e+00, max-res=6.031e-08, CR=0.111 CR-perPeriod=0.334, cpu= 8.94e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=9.49e-11 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.12e-03 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=9.49e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


TWO FREQ IMPLICIT
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -nf=2 -freq=9.777 12.34 -amp=50 -adjustOmega=1 -ts=implicit -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -cfl=10 -go=og

CFL=10: steps=51
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=2.170e-10 (using omega).
CgWaveHoltz::residual: freq=1, omega=12.34, max-res=2.300e-10 (using omega).
CgWaveHoltz: omega=9.777e+00, max-res=2.300e-10, CR=0.804 CR-perPeriod=0.897, cpu= 4.02e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=4.08e-12 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.99e-03 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.08e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




TWO FREQ EXPLICIT -- ***CHECK*** residual in freq2
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -nf=2 -freq=9.777 12.34 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -go=og

cgwh: max-diff=2.21e-11 for freq0 =   9.7770e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.99e-03 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.21e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -nf=1 -freq=9.777 -amp=20 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -upwind=0 -imode=1 -maxIterations=100  -numPeriods=2 -go=og

######## DONE KYRLOV ITERATIONS -- KSP residual=4.99e-11 (max-res=1.90e-10) (tol=1.00e-10) numIts=15 #######
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.7761795e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=2.673e-09 (using omega), max-res=3.401e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.673e-09, CR=0.255 CR-perPeriod=0.505, cpu= 1.12e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=3.94e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



OLD:
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega9p777Krylov -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -show=annulusOmega9p777.show -go=og




**************************************************
**** Wed Jan 12, 2022

CHECK after changes to upwind coeff


G8 IMPLICIT 
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -ts=implicit -cfl=1000 -numPeriods=4 -go=og


CFL=1000 steps=20, kits=26
cgwh: max-diff=1.82e-05 (between WaveHoltz and Direct Helmholtz solution)

numPeriods=4:
CFL=100 steps=32 kits=16
cgwh: max-diff=6.60e-06 (between WaveHoltz and Direct Helmholtz solution)

G8 IMPLICIT
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -ts=implicit -cfl=10 -go=og



CFL=10 steps=11, kits=70
cgwh: max-diff=2.30e-05 (between WaveHoltz and Direct Helmholtz solution)

CFL=1 steps=104, kits=30
cgwh: max-diff=1.76e-05 (between WaveHoltz and Direct Helmholtz solution)



G8 IMPLICIT
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -ts=implicit -cfl=1 -go=og

CFL=20 steps=6 kits=190!!
cgwh: max-diff=2.64e-05 (between WaveHoltz and Direct Helmholtz solution)

CFL-10 steps=11 kits=70
cgwh: max-diff=2.30e-05 (between WaveHoltz and Direct Helmholtz solution)

CFL=1 steps=104m kits=30
cgwh: max-diff=1.76e-05 (between WaveHoltz and Direct Helmholtz solution)

IMPLICIT
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -ts=implicit -cfl=1 -go=og

CFL=10 steps=6
cgwh: max-diff=7.71e-04 (between WaveHoltz and Direct Helmholtz solution)

CFL=1
cgwh: max-diff=5.44e-04 (between WaveHoltz and Direct Helmholtz solution)

EXPLICIT: 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-9 -upwind=1 -imode=1 -maxIterations=100 -go=og


 ######## DONE KYRLOV ITERATIONS -- KSP residual=8.15e-10 (max-res=3.47e-09) (tol=1.00e-09) numIts=29 #######

CgWaveHoltz::residual: freq=0, omega=8.1, max-res=2.298e-06 (using omega), max-res=6.627e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=2.298e-06, CR=0.539 CR-perPeriod=0.539, cpu= 9.16e-01(s)
cgwh: max-diff=1.34e-06 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Fri Dec 31, 2021

Multi-freq results for proposal



**************************************************
**** Thurs Dec 30, 2021

generate plots for OverHoltz proposal


NON ZERO INITIAL CONDITION IS BROKEN (RANDOM)

>>> GMRES -- converges fast to a TOLERANCE = 1e-9 
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-9 -ad4=1 -imode=1 -maxIterations=100 -go=og


>>> GMRES -- converges fast to a TOLERANCE = 1e-9 
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-9 -ad4=1 -imode=1 -maxIterations=100 -go=og

it=-3:  max(residual) = max(|v-vOld|)=5.51e-06, tol=1e-09

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.02e-10 (max-res=5.51e-06) (tol=1.00e-09) numberOfIterations=29 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=1.769e-02 (using omega), max-res=4.729e-08 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.769e-02, CR=0.531 CR-perPeriod=0.531, cpu= 2.35e+00(s)
CgWaveHoltz::Results saved to file junk.m
cgwh: max-diff=3.24e-03 (between WaveHoltz and Direct Helmholtz solution)




>>> GMRES -- BROKEN: slow to converge
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -show=junk.show -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=4.67e-10 (max-res=3.88e-02) (tol=1.00e-12) numberOfIterations=207 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=1.769e-02 (using omega), max-res=1.099e-08 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.769e-02, CR=0.914 CR-perPeriod=0.914, cpu= 1.52e+01(s)
CgWaveHoltz::Results saved to file jumk.m
cgwh: max-diff=3.24e-03 (between WaveHoltz and Direct Helmholtz solution)



>>> FP : may be OK
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=jumk -tol=1e-10 -ad4=1 -imode=1 -maxIterations=200 -go=og


CgWave::advance: c=1, numberOfFrequencies=1, omega=8.1, Tperiod=0.775702, numPeriods=1, tFinal=0.775702, plotOptions=0
cgWave:FD24 t=0.000e+00 (  0 steps) dt=6.687e-03 ||u||= 9.77e-01, cpu= 0.00e+00(s)
cgWave:FD24 t=7.757e-01 (116 steps) dt=6.687e-03 ||u||= 9.77e-01, cpu= 6.91e-02(s)
it=199:  l2Norm( v-vOld )=1.43e-11 (tol=1e-12)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 200 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =200 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=1.769e-02 (using omega), max-res=2.064e-08 (using omega from discrete symbol)

 >>>> cgwh: omega=8.100e+00, max-res=1.769e-02, CR=0.991 CR-perPeriod=0.991, cpu= 1.40e+01(s)
CgWaveHoltz::Results saved to file jumk.m
cgwh: max-diff=3.24e-03 (between WaveHoltz and Direct Helmholtz solution)

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=1.769e-02 (using omega), max-res=3.295e-08 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.769e-02, CR=0.949 CR-perPeriod=0.949, cpu= 1.52e+01(s)
CgWaveHoltz::Results saved to file jumk.m
cgwh: max-diff=1.04e-02 (between WaveHoltz and Direct Helmholtz solution)








>>> OLD: ++++++++++++++++ DISK 

SOMETHING WRONG WITH direct solve order=4 ??

>>>>>>>>>SIC ORDER=4
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHDiskO4Omega8p1Krylov -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -show=gaussianDiskOmega8p1.show -go=og

cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHDiskO4Omega8p1FPI -tol=1e-10 -ad4=1 -imode=1 -maxIterations=400 -go=og

it=399:  l2Norm( v-vOld )=6.26e-05 (tol=1e-10)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 400 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =400 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09901e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.054e-01 (using omega), max-res=8.808e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.054e-01, CR=0.983 CR-perPeriod=0.983, cpu= 4.00e+01(s)
CgWaveHoltz::Results saved to file gaussianWHDiskO4Omega8p1FPI.m



cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=none -matlab=test -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.41e-11 (tol=1.00e-10) numberOfIterations=26 #############
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09901e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.776e-02 (using omega), max-res=9.749e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.776e-02, CR=0.476 CR-perPeriod=0.476, cpu= 2.97e+00(s)
CgWaveHoltz::Results saved to file test.m
CgWaveHoltz: max-diff=3.25e-03 (between WaveHoltz and Direct Helmholtz solution)







**************************************************
**** Wed Dec 15, 2021

FIXED: solveHelmholtz : ignore bc<=0 



REVISIT GAUSSIAN SOURCE -- TRY fancier geometries

*trouble*
cgwh gaussian.cmd -g=sice4.order4.ng3.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-10 -upwind=1 -imode=1 -maxIterations=100 -go=og


TEST SIS -- slow convergence  **CHECK ME --> BIG ERRORS  **SOMETHING IS WRONG ****
cgwh gaussian.cmd -g=sise4.order2.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-14 -upwind=1 -imode=1 -maxIterations=100 -go=og


RESIDUAL IS LARGE NEAR INTERP POINTS -- 
errors look OK
cgwh gaussian.cmd -g=sice4.order2.hdf -x0=.25 -y0=.25 -freq=8.1 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-14 -upwind=1 -imode=1 -maxIterations=100 -go=og



 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.87e-15 (tol=1.00e-14) numberOfIterations=93 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0948783e+00 (from symbol of D+D-), dt=1.520984e-02, adjustOmega=1, upwind=1
 **** WARNING: upwinding is ON! Correcting omega for the discrete-time-symbol will not fully work to give a small residual ! *****
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.094878339772e+00
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.094878339772e+00
CgWaveHoltz::residual: freq=0, omega=8.1, max-res=2.712e+00 (using omega), max-res=2.646e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=2.712e+00, CR=0.734 CR-perPeriod=0.734, cpu= 4.16e+00(s)
CgWaveHoltz::Results saved to file junk.m
cgwh: max-diff=6.60e-02 (between WaveHoltz and Direct Helmholtz solution)



OK
cgwh gaussian.cmd -g=square64.order2 -nf=2 -freq=5.1 12 -x0=.7 .3 -y0=.7 .3 -omega=5.1 -amp=100 100 -beta=100 100 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -ad4=0 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=7.64e-09 (tol=1.00e-08) numberOfIterations=14 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=8.421e-03 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.501e-01 (using omega).
CgWaveHoltz: omega=5.100e+00, max-res=1.501e-01, CR=0.411 CR-perPeriod=0.411, cpu= 5.83e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=1.13e-03 (between WaveHoltz and Direct Helmholtz solution)

**************************************************
**** Sun Oct 31, 2021

START ON multi-freq

TRY TWO FREQUENCIES: starts to work (use same frequencies as for boxHelmholtz)
cgwh gaussian.cmd -g=square64.order2 -nf=2 -freq=5.1 12 -x0=.7 .3 -y0=.7 .3 -omega=5.1 -amp=100 100 -beta=100 100 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -ad4=0 -imode=1 -go=halt


cgWave:FD22 t=1.232e+00 (124 steps) dt=9.935e-03 ||u||= 2.84e+00, cpu= 3.75e-02(s)
it=-3:  max(|v-vOld|)=7.36e-09, tol=1e-08

 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.24e-09 (tol=1.00e-08) numberOfIterations=16 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=2.594e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=2.145e-01 (using omega).
CgWaveHoltz: omega=5.100e+00, max-res=2.145e-01, CR=0.304 CR-perPeriod=0.304, cpu= 7.15e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=3.94e-03 (between WaveHoltz and Direct Helmholtz solution)




cgwh gaussian.cmd -g=square64.order2 -nf=1 -freq=17.17 -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=0 -imode=1 -go=halt


 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.31e-13 (tol=1.00e-12) numberOfIterations=30 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 1.7170000e+01, omegas= 1.7149377e+01 (from symbol of D+D-), dt=9.890263e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  1.714937666998e+01
CgWaveHoltz::residual: freq=0, omega=17.17, max-res=1.009e-08 (using omega), max-res=1.063e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=1.717e+01, max-res=1.009e-08, CR=0.870 CR-perPeriod=0.870, cpu= 3.45e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=9.84e-10 (between WaveHoltz and Direct Helmholtz solution)




cgwh gaussian.cmd -g=square32.order2  -nf=1 -freq=9.777 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=1 -solver=none -tol=1e-10 -ad4=1 -go=halt


 ################ DONE KYRLOV ITERATIONS -- KSP residual=5.50e-16 (tol=1.00e-10) numberOfIterations=2 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.7622385e+00 (from symbol of D+D-), dt=1.947423e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  9.762238536132e+00
CgWaveHoltz::residual: freq=0, omega=9.777, max-res=6.441e-12 (using omega), max-res=7.193e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=6.441e-12, CR=0.000 CR-perPeriod=0.000, cpu= 2.85e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
cgwh: max-diff=6.66e-15 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Tues July 27, 2021

Save figure for doc's

cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega9p777Krylov -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -show=annulusOmega9p777.show -go=og


 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.27e-15 (tol=1.00e-14) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.7761795e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  9.776179483905e+00
CgWaveHoltz::residual: max-res=1.414e-11 (using omega), max-res=3.401e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=1.414e-11, CR=0.385 CR-perPeriod=0.385, cpu= 5.42e+00(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega9p777Krylov.m



**************************************************
**** Mon July 26, 2021


REVISIT DISK: --> RESIDUALS small with adjustOmega, DIRECT solve seems to work
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=junk -tol=1e-14 -ad4=1 -imode=1 -maxIterations=400 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=8.41e-15 (tol=1.00e-10) numberOfIterations=1 #############
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.099009848595e+00
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.099009848595e+00
CgWaveHoltz::residual: max-res=3.521e-11 (using omega), max-res=1.773e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=3.521e-11, CR=1.000 CR-perPeriod=1.000, cpu= 2.44e-01(s)
CgWaveHoltz::Results saved to file junk.m
CgWaveHoltz: max-diff=3.53e-14 (between WaveHoltz and Direct Helmholtz solution)



 ################ DONE KYRLOV ITERATIONS -- KSP residual=4.56e-15 (tol=1.00e-14) numberOfIterations=24 #############
CgWaveHoltz::residual: c=1, omega= 8.1000000e+00, omegas= 8.0990098e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.099009848595e+00
CgWaveHoltz::residual: compute residual with adjusted omegas=  8.099009848595e+00
CgWaveHoltz::residual: max-res=3.007e-11 (using omega), max-res=1.773e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=3.007e-11, CR=0.710 CR-perPeriod=0.710, cpu= 1.79e+00(s)
CgWaveHoltz::Results saved to file junk.m



REVISIT ANNULUS  --> RESIDUALS small with adjustOmega : (NOTE TURN OFF UPWINDING) 

cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega9p777Krylov -tol=1e-14 -upwind=0 -imode=1 -maxIterations=100 -go=og


 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.27e-15 (tol=1.00e-14) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 9.7770000e+00, omegas= 9.7761795e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  9.776179483905e+00
CgWaveHoltz::residual: max-res=1.414e-11 (using omega), max-res=3.401e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=1.414e-11, CR=0.385 CR-perPeriod=0.385, cpu= 5.42e+00(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega9p777Krylov.m





**************************************************
**** Fri July 23, 2021


++++ SPHERE : NEED TO FIX ORDER=4 grid : sphere.cmd
cgwh gaussian.cmd -g=spheree4.order2 -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=100 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHSphereO2Omega8p1Krylov -tol=1e-8 -ad4=1 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.14e-09 (tol=1.00e-08) numberOfIterations=64 #############
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09720e+00 (from symbol of D+D-), dt=1.124206e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=1.650e+00 (using omega), max-res=1.634e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.650e+00, CR=0.790 CR-perPeriod=0.790, cpu= 9.67e+01(s)
CgWaveHoltz::Results saved to file gaussianWHSphereO4Omega8p1Krylov.m





cgwh gaussian.cmd -g=spheree4.order2 -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=100 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHSphereO2Omega8p1FPI -tol=1e-8 -ad4=1 -imode=1 -maxIterations=100 -go=og

it=99:  l2Norm( v-vOld )=4.72e-04 (tol=1e-08)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 100 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =100 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09720e+00 (from symbol of D+D-), dt=1.124206e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.559e+00 (using omega), max-res=2.564e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=2.559e+00, CR=0.958 CR-perPeriod=0.958, cpu= 1.42e+02(s)
CgWaveHoltz::Results saved to file gaussianWHSphereO4Omega8p1Krylov.m


++++ BOX 
cgwh gaussian.cmd -g=box4.order4.ng3.hdf -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHBoxO4Omega8p1FPI -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

it=99:  l2Norm( v-vOld )=7.23e-04 (tol=1e-10)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 100 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =100 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09720e+00 (from symbol of D+D-), dt=1.124206e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=9.514e-01 (using omega), max-res=9.631e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=9.514e-01, CR=0.963 CR-perPeriod=0.963, cpu= 2.07e+01(s)
CgWaveHoltz::Results saved to file gaussianWHBoxO4Omega8p1FPI.m


cgwh gaussian.cmd -g=box4.order4.ng3.hdf -x0=.25 -y0=.25 -z0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHBoxO4Omega8p1Krylov -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.10e-11 (tol=1.00e-10) numberOfIterations=16 #############
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09720e+00 (from symbol of D+D-), dt=1.124206e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=4.019e-02 (using omega), max-res=7.963e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=4.019e-02, CR=0.270 CR-perPeriod=0.270, cpu= 3.91e+00(s)
CgWaveHoltz::Results saved to file gaussianWHBoxO4Omega8p1Krylov.m





++++++++++++++++ DISK 

SOMETHING WRONG WITH direct solve order=4 ??

>>>>>>>>>SIC ORDER=4
cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHDiskO4Omega8p1Krylov -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -show=gaussianDiskOmega8p1.show -go=og

cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHDiskO4Omega8p1FPI -tol=1e-10 -ad4=1 -imode=1 -maxIterations=400 -go=og

it=399:  l2Norm( v-vOld )=6.26e-05 (tol=1e-10)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 400 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =400 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09901e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.054e-01 (using omega), max-res=8.808e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.054e-01, CR=0.983 CR-perPeriod=0.983, cpu= 4.00e+01(s)
CgWaveHoltz::Results saved to file gaussianWHDiskO4Omega8p1FPI.m



cgwh gaussian.cmd -g=sice8.order4.ng3.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=none -matlab=test -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.41e-11 (tol=1.00e-10) numberOfIterations=26 #############
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09901e+00 (from symbol of D+D-), dt=6.687085e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.776e-02 (using omega), max-res=9.749e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.776e-02, CR=0.476 CR-perPeriod=0.476, cpu= 2.97e+00(s)
CgWaveHoltz::Results saved to file test.m
CgWaveHoltz: max-diff=3.25e-03 (between WaveHoltz and Direct Helmholtz solution)





SIC ORDER=2
cgwh gaussian.cmd -g=sice8.order2.hdf -x0=.25 -y0=.25 -omega=8.1 -amp=50 -adjustOmega=0 -orderInTime=2 -solver=none -matlab=test -tol=1e-10 -ad4=1 -imode=1 -maxIterations=100 -go=og

it=99:  l2Norm( v-vOld )=3.88e-06 (tol=1e-10)
$$$$$$$$ CgWaveHoltz:ERROR -- number of iterations reached the maximum allowed = 100 $$$$$$$$
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =100 #########################
CgWaveHoltz::residual: c=1, omega= 8.10000e+00, omegas= 8.09867e+00 (from symbol of D+D-), dt=7.757019e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.158e-01 (using omega), max-res=9.883e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=8.100e+00, max-res=1.158e-01, CR=0.990 CR-perPeriod=0.990, cpu= 6.54e+00(s)
CgWaveHoltz::Results saved to file test.m
CgWaveHoltz: max-diff=2.00e-02 (between WaveHoltz and Direct Helmholtz solution)



++++++++++ ANNULUS

>>> omeg=18.4
cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=18.4 -amp=20 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega18p4Krylov -tol=1e-10 -ad4=0 -imode=1 -maxIterations=100 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=8.03e-09 (tol=1.00e-10) numberOfIterations=104 #############
CgWaveHoltz::residual: c=1, omega= 1.84000e+01, omegas= 1.83946e+01 (from symbol of D+D-), dt=4.553033e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=2.082e-02 (using omega), max-res=1.824e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=1.840e+01, max-res=2.082e-02, CR=0.870 CR-perPeriod=0.870, cpu= 1.34e+01(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega18p4.m


cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=18.4 -amp=20 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHAnnulusO4Omega18p4FPI -tol=1e-10 -ad4=0 -imode=1 -maxIterations=400 -go=og





cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=0 -orderInTime=2 -solver=krylov -matlab=gaussianWHAnnulusO4Omega9p777Krylov -tol=1e-10 -ad4=0 -imode=1 -maxIterations=100 -go=og


 ################ DONE KYRLOV ITERATIONS -- KSP residual=4.13e-11 (tol=1.00e-10) numberOfIterations=27 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77618e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=3.417e-03 (using omega), max-res=4.099e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=3.417e-03, CR=0.476 CR-perPeriod=0.476, cpu= 6.79e+00(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega9p777Krylov.m

cgwh gaussian.cmd -g=annulus8.order4.ng3.hdf -x0=.5 -y0=.5 -omega=9.777 -amp=20 -adjustOmega=0 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHAnnulusO4Omega9p777FPI -tol=1e-10 -ad4=0 -imode=1 -maxIterations=300 -go=og

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =200 #########################
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77618e+00 (from symbol of D+D-), dt=4.590354e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=1.351e-01 (using omega), max-res=1.355e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=1.351e-01, CR=0.974 CR-perPeriod=0.974, cpu= 4.60e+01(s)
CgWaveHoltz::Results saved to file gaussianWHAnnulusO4Omega9p777FPI.m





cgwh gaussian.cmd -g=annulus4.order2 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=0 -solver=none -tol=1e-10 -ad4=1 -go=halt


+++++++++++ SQUARE

cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWaveHoltzSquare64Order4Krylov -tol=1e-10 -ad4=0 -imode=1 -go=go

FP
cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWaveHoltzSquare64Order4FixedPoint -tol=1e-10 -ad4=0 -imode=1 -maxIterations=400 -go=go


cgwh gaussian.cmd -g=square128.order4.ng3.hdf -x0=.7 -y0=.7 -omega=15 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWHSquare128O4Omega15FPI -tol=1e-10 -ad4=0 -imode=1 -maxIterations=500 -go=og

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =500 #########################
CgWaveHoltz::residual: c=1, omega= 1.50000e+01, omegas= 1.49974e+01 (from symbol of D+D-), dt=4.273544e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=2.374e-03 (using omega), max-res=4.870e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=1.500e+01, max-res=2.374e-03, CR=0.976 CR-perPeriod=0.976, cpu= 2.16e+01(s)
CgWaveHoltz::Results saved to file gaussianWHSquare128O4Omega15FPI.m



cgwh gaussian.cmd -g=square128.order4.ng3.hdf -x0=.7 -y0=.7 -omega=15 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHSquare128O4Omega15Krylov -tol=1e-10 -ad4=0 -imode=1 -go=og

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.54e-11 (tol=1.00e-10) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 1.50000e+01, omegas= 1.49974e+01 (from symbol of D+D-), dt=4.273544e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=4.010e-04 (using omega), max-res=5.004e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=1.500e+01, max-res=4.010e-04, CR=0.492 CR-perPeriod=0.492, cpu= 1.58e+00(s)
CgWaveHoltz::Results saved to file gaussianWHSquare128O4Omega15Krylov.m





cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=15 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWHSquare64O4Omega15Krylov -tol=1e-10 -ad4=0 -imode=1 -go=og


 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.52e-11 (tol=1.00e-10) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 1.50000e+01, omegas= 1.49897e+01 (from symbol of D+D-), dt=8.542696e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=1.195e-02 (using omega), max-res=1.977e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=1.500e+01, max-res=1.195e-02, CR=0.493 CR-perPeriod=0.493, cpu= 3.91e-01(s)
CgWaveHoltz::Results saved to file gaussianWHSquare64O4Omega15Krylov.m


**************************************************
**** Fri July 16, 2021


QUESTION -- why doesn't adjustOmega=1 work ??

cgwh gaussian.cmd -g=square32.order2 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=1 -solver=none -tol=1e-10 -ad4=1 -go=halt


REVISIT test annulus for Cassandra

cgwh gaussian.cmd -g=annulus4.order2 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=0 -solver=none -tol=1e-10 -ad4=1 -go=halt

--- random initial condition
 ################ DONE KYRLOV ITERATIONS -- KSP residual=5.16e-11 (tol=1.00e-10) numberOfIterations=48 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.446e-01 (using omega), max-res=2.520e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.446e-01, CR=0.618 CR-perPeriod=0.618, cpu= 1.28e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=2.43e-02 (between WaveHoltz and Direct Helmholtz solution)



--- zero initial condition
 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.92e-11 (tol=1.00e-10) numberOfIterations=47 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.446e-01 (using omega), max-res=2.520e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.446e-01, CR=0.668 CR-perPeriod=0.668, cpu= 1.15e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m



**************************************************
**** Fri June 11, 2021

Test annulus for Cassandra

cgwh gaussian.cmd -g=annulus4.order4.ng3 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=1 -go=halt


cgwh gaussian.cmd -g=annulus4.order4.ng3 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=0 -solver=none -tol=1e-10 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.83e-11 (tol=1.00e-10) numberOfIterations=37 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.795e-03 (using omega), max-res=1.822e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.795e-03, CR=0.561 CR-perPeriod=0.561, cpu= 2.04e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=9.09e-05 (between WaveHoltz and Direct Helmholtz solution)




cgwh gaussian.cmd -g=annulus4.order2 -x0=.5 -y0=.5 -omega=9.777 -amp=20 -beta=50 -adjustOmega=0 -solver=none -tol=1e-10 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.51e-11 (tol=1.00e-10) numberOfIterations=33 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.446e-01 (using omega), max-res=2.520e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.446e-01, CR=0.559 CR-perPeriod=0.559, cpu= 8.62e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=2.43e-02 (between WaveHoltz and Direct Helmholtz solution)
plot contours...




 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.62e-12 (tol=1.00e-11) numberOfIterations=52 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77268e+00 (from symbol of D+D-), dt=1.053524e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.446e-01 (using omega), max-res=2.520e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=2.446e-01, CR=0.664 CR-perPeriod=0.664, cpu= 1.31e+00(s)


cgwh gaussian.cmd -g=cice4.order4.ng3.hdf -x0=.9 -y0=.9 -omega=3.555 -amp=10 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

**************************************************
**** Mon May 24, 2021


TEST on more interesting grid

Make sharper peak
cgwh gaussian.cmd -g=shapese8.order2 -x0=.3 -y0=-.75 -omega=9.777 -amp=20 -beta=100 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-8 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.71e-09 (tol=1.00e-08) numberOfIterations=93 #############
CgWaveHoltz::residual: c=1, omega= 9.77700e+00, omegas= 9.77691e+00 (from symbol of D+D-), dt=1.501518e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=3.500e-02 (using omega), max-res=3.382e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=9.777e+00, max-res=3.500e-02, CR=0.872 CR-perPeriod=0.872, cpu= 9.54e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=1.16e-02 (between WaveHoltz and Direct Helmholtz solution)


cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -y0=-.75 -omega=6.666 -amp=20 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.35e-11 (tol=1.00e-10) numberOfIterations=31 #############
CgWaveHoltz::residual: c=1, omega= 6.66600e+00, omegas= 6.66589e+00 (from symbol of D+D-), dt=3.001822e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=5.318e-03 (using omega), max-res=4.653e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=6.666e+00, max-res=5.318e-03, CR=0.557 CR-perPeriod=0.557, cpu= 9.19e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=1.25e-03 (between WaveHoltz and Direct Helmholtz solution)


cgwh gaussian.cmd -g=shapese4.order2 -x0=.3 -y0=-.75 -omega=3.555 -amp=10 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

################ DONE KYRLOV ITERATIONS -- KSP residual=5.46e-11 (tol=1.00e-10) numberOfIterations=6 #############
CgWaveHoltz::residual: c=1, omega= 3.55500e+00, omegas= 3.55498e+00 (from symbol of D+D-), dt=3.000717e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=8.900e-05 (using omega), max-res=9.157e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=3.555e+00, max-res=8.900e-05, CR=0.061 CR-perPeriod=0.061, cpu= 4.14e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=2.49e-06 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Sun May 23, 2021


ADD OPTION TO PLOT MOVIE OF CGWAVE

Small omega: WH and H agree
cgwh gaussian.cmd -g=cice4.order4.ng3.hdf -x0=.9 -y0=.9 -omega=3.555 -amp=10 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -ad4=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.22e-11 (tol=1.00e-10) numberOfIterations=26 #############
CgWaveHoltz::residual: c=1, omega= 3.55500e+00, omegas= 3.55464e+00 (from symbol of D+D-), dt=1.380798e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=1.441e-03 (using omega), max-res=2.616e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.555e+00, max-res=1.441e-03, CR=0.482 CR-perPeriod=0.482, cpu= 3.86e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=4.56e-05 (between WaveHoltz and Direct Helmholtz solution)



cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=0 -go=halt


ADD SHOW FILE OPTION

plotStuff plotSolution.cmd -show=gaussianSquare.show -name=gaussianSquareOmega17p17 -solution=1

show file for doc's 
cgwh gaussian.cmd -g=square128.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=0 -show=gaussianSquare.show -go=halt


**************************************************
**** Sat May 22, 2021

Generate results for the documentation


FD24 + orderinTime=2 + adjustOmega + ad4=0 -- MATCHES
cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=krylov -matlab=gaussianWaveHoltzSquare64Order4Krylov -tol=1e-10 -ad4=0 -imode=1 -go=go

FP
cgwh -noplot gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=fixedPoint -matlab=gaussianWaveHoltzSquare64Order4FixedPoint -tol=1e-10 -ad4=0 -imode=1 -go=go


cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -ad4=0 -imode=1 -go=halt





cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=0 -solver=none -tol=1e-8 -ad4=1 -imode=1 -go=halt


BUG FIXED -- userDefinedForcing: SET fLocal=0 

cgwh gaussian.cmd -g=square64.order2.hdf -x0=.7 -y0=.7 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-12 -tp=1 -ad4=0 -imode=1 -go=halt


cgwh gaussian.cmd -g=square64.order2.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=0 -solver=none -tol=1e-8 -ad4=1 -imode=1 -go=halt

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>> FLIPPED SIGN ON GAUSSIAN SOURCE so source term is a positive Gaussian by default for Helmholtz
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

BIGGER omega
FP has trouble converging
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=17.17 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -ad4=0 -imode=1 -go=halt


FD24 + orderinTime=2 + adjustOmega + ad4=0 -- MATCHES
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=3.333 -amp=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -ad4=0 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=8.93e-14 (tol=1.00e-12) numberOfIterations=2 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33289e+00 (from symbol of D+D-), dt=8.607669e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=4.900e-11 (using omega), max-res=1.705e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=4.900e-11, CR=0.000 CR-perPeriod=0.000, cpu= 1.27e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=6.76e-13 (between WaveHoltz and Direct Helmholtz solution)

FD24s
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.40e-13 (tol=1.00e-12) numberOfIterations=5 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33289e+00 (from symbol of D+D-), dt=8.607669e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=1.985e-06 (using omega), max-res=1.704e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=1.985e-06, CR=0.005 CR-perPeriod=0.005, cpu= 3.16e-01(s)



FD44 
cgwh gaussian.cmd -g=square64.order4.ng3.hdf -x0=.7 -y0=.7 -omega=3.333 -amp=100 -adjustOmega=0 -solver=none -tol=1e-12 -ad4=1 -imode=1 -go=halt
 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.56e-13 (tol=1.00e-12) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33285e+00 (from symbol of D+D-), dt=9.921811e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=2.525e-03 (using omega), max-res=2.393e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=2.525e-03, CR=0.028 CR-perPeriod=0.028, cpu= 3.73e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-diff=2.27e-06 (between WaveHoltz and Direct Helmholtz solution)


>> ad4:
cgwh gaussian.cmd -g=square64.order2.hdf -x0=.7 -y0=.7 -omega=3.333 -amp=100 -adjustOmega=1 -solver=none -tol=1e-12 -ad4=1 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.26e-14 (tol=1.00e-12) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33295e+00 (from symbol of D+D-), dt=5.401486e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=5.467e-04 (using omega), max-res=1.717e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=5.467e-04, CR=0.017 CR-perPeriod=0.017, cpu= 4.69e-01(s)
CgWaveHoltz: max-diff=5.66e-05 (between WaveHoltz and Direct Helmholtz solution)


>>> NO AD4
cgwh gaussian.cmd -g=square64.order2.hdf -x0=.7 -y0=.7 -omega=3.333 -amp=100 -adjustOmega=1 -solver=none -tol=1e-12 -ad4=0 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=5.41e-13 (tol=1.00e-12) numberOfIterations=10 #############
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33291e+00 (from symbol of D+D-), dt=7.725787e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=7.352e-11 (using omega), max-res=1.375e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=3.333e+00, max-res=7.352e-11, CR=0.061 CR-perPeriod=0.061, cpu= 3.33e-01(s)

DIRECT SOLVER:
CgWaveHoltz::residual: c=1, omega= 3.33300e+00, omegas= 3.33291e+00 (from symbol of D+D-), dt=7.733980e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=3.327e-11 (using omega).
CgWaveHoltz: omega=3.333e+00, max-res=3.327e-11, cpu= 2.19e-02 (Direct solution of Helmholtz).
