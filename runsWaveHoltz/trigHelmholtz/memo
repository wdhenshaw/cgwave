
set cgwh = /home/henshw/codes/cgwaveSerial/bin/cgwh  : serial cgwh



***********************************************
********** Tues Sept 2, 2025

CHECK MAX NORM ERRORS 

ORDER=4:
runsCases.p -grid=square -freq=50 -beta=1 -order=4 -numRes=5

   m=m+1; 
    % known = modulatedGaussian;
    order{m}=4;
    omega{m}=50;
    amp{m}=1;
    L{m}=1;
    x0{m}=0.55; y0{m}=0.55;
    dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03   9.7656e-04 ];
    errv{m}   = [  2.5700e-01   1.8900e-02   1.7730e-03   1.4620e-04   1.0230e-05   6.6960e-07 ];
    errPPW{m} = [  1.6557e+00   1.0348e-01   6.4675e-03   4.0422e-04   2.5264e-05   1.5790e-06 ];
    errRE{m}  = [  4.2100e-01   2.9600e-02   2.0800e-03   1.4600e-04   1.0300e-05   7.2100e-07 ];
    maxErrv{m}= [  3.6690e+00   1.1310e-01   6.3420e-03   4.9500e-04   3.4380e-05   2.2560e-06 ];
    
 


ORDER=2:
runsCases.p -grid=square -freq=50 -beta=1 -order=2 -numRes=7

    m=m+1; 
    % known = modulatedGaussian;
    order{m}=2;
    omega{m}=50;
    amp{m}=1;
    L{m}=1;
    x0{m}=0.55; y0{m}=0.55;
    dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03   9.7656e-04   4.8828e-04 ];
    errv{m}   = [  2.7040e-01   3.0490e-01   2.2320e-01   3.4810e-02   8.9550e-03   2.2640e-03   5.6760e-04 ];
    errPPW{m} = [  5.0863e+00   1.2716e+00   3.1789e-01   7.9473e-02   1.9868e-02   4.9671e-03   1.2418e-03 ];
    errRE{m}  = [  2.4600e+00   6.0700e-01   1.5000e-01   3.7100e-02   9.1800e-03   2.2700e-03   5.6100e-04 ];
    maxErrv{m}= [  1.1490e+01   5.2400e+00   2.3640e+00   1.4230e-01   3.1210e-02   7.6520e-03   1.9040e-03 ];



***********************************************
********** Mon Sept 1, 2025


TEST DISK

plotStuff plotSolution.cmd -show=modGaussFreq30sicFixede32order4 -solution=1

sicFixede

O4 freq=30
runsCases.p -grid=sicFixede -freq=30 -beta=0 -x0=0.2 -y0=0.1 -order=4 -numRes=5

    SUMMARY: known=modulatedGaussian, grid=sicFixede64.order4, L=2
 i=0: l2RelErr=1.539e-01
 i=1: l2RelErr=1.141e-02 (theory= 6.59e-03, theory/comp= 0.58) ratio=13.49, rate= 3.75, PPW=  16.8 (ds= 1.25e-02, lambda= 0.21, Nlambda=  9.5)
 i=2: l2RelErr=1.007e-03 (theory= 4.12e-04, theory/comp= 0.41) ratio=11.33, rate= 3.50, PPW=  33.5 (ds= 6.25e-03, lambda= 0.21, Nlambda=  9.5)
 i=3: l2RelErr=7.225e-05 (theory= 2.57e-05, theory/comp= 0.36) ratio=13.94, rate= 3.80, PPW=  67.0 (ds= 3.13e-03, lambda= 0.21, Nlambda=  9.5)
 i=4: l2RelErr=4.780e-06 (theory= 1.61e-06, theory/comp= 0.34) ratio=15.12, rate= 3.92, PPW= 134.0 (ds= 1.56e-03, lambda= 0.21, Nlambda=  9.5)
Format for plotErrorVersusPPW.m
    m=m+1; 
    % known = modulatedGaussian;
    order{m}=4;
    omega{m}=30;
    amp{m}=1;
    L{m}=2;
    x0{m}=0.2; y0{m}=0.1;
    dsv{m}    = [  2.5000e-02   1.2500e-02   6.2500e-03   3.1250e-03   1.5625e-03 ];
    errv{m}   = [  1.5390e-01   1.1410e-02   1.0070e-03   7.2250e-05   4.7800e-06 ];
    errPPW{m} = [  1.0547e-01   6.5918e-03   4.1199e-04   2.5749e-05   1.6093e-06 ];
    errRE{m}  = [  1.9500e-01   1.4000e-02   1.0100e-03   7.2700e-05   5.2300e-06 ];





O2 freq=30
runsCases.p -grid=sicFixede -freq=30 -beta=0 -x0=0.2 -y0=0.1 -order=2 -numRes=6

 ====================================
     SUMMARY: known=modulatedGaussian, grid=sicFixede128.order2, L=2
 i=0: l2RelErr=1.999e-01
 i=1: l2RelErr=1.656e-01 (theory= 3.52e-01, theory/comp= 2.12) ratio= 1.21, rate= 0.27, PPW=  16.8 (ds= 1.25e-02, lambda= 0.21, Nlambda=  9.5)
 i=2: l2RelErr=2.813e-01 (theory= 8.79e-02, theory/comp= 0.31) ratio= 0.59, rate=-0.76, PPW=  33.5 (ds= 6.25e-03, lambda= 0.21, Nlambda=  9.5)
 i=3: l2RelErr=7.146e-02 (theory= 2.20e-02, theory/comp= 0.31) ratio= 3.94, rate= 1.98, PPW=  67.0 (ds= 3.13e-03, lambda= 0.21, Nlambda=  9.5)
 i=4: l2RelErr=1.776e-02 (theory= 5.49e-03, theory/comp= 0.31) ratio= 4.02, rate= 2.01, PPW= 134.0 (ds= 1.56e-03, lambda= 0.21, Nlambda=  9.5)
 i=5: l2RelErr=4.443e-03 (theory= 1.37e-03, theory/comp= 0.31) ratio= 4.00, rate= 2.00, PPW= 268.1 (ds= 7.81e-04, lambda= 0.21, Nlambda=  9.5)
Format for plotErrorVersusPPW.m
    m=m+1; 
    % known = modulatedGaussian;
    order{m}=2;
    omega{m}=30;
    amp{m}=1;
    L{m}=2;
    x0{m}=0.2; y0{m}=0.1;
    dsv{m}    = [  2.5000e-02   1.2500e-02   6.2500e-03   3.1250e-03   1.5625e-03   7.8125e-04 ];
    errv{m}   = [  1.9990e-01   1.6560e-01   2.8130e-01   7.1460e-02   1.7760e-02   4.4430e-03 ];
    errPPW{m} = [  1.4062e+00   3.5156e-01   8.7891e-02   2.1973e-02   5.4932e-03   1.3733e-03 ];
    errRE{m}  = [  1.4000e+01   2.6500e+00   5.0000e-01   9.4400e-02   1.7800e-02   3.3700e-03 ];



  


runsCases.p -grid=sicFixede -freq=10 -beta=0 -x0=0.2 -y0=0.1 -order=2 -numRes=3

    SUMMARY: known=modulatedGaussian, grid=sicFixede16.order2, L=1
 i=0: l2RelErr=6.295e-02
 i=1: l2RelErr=1.699e-02 (theory= 6.51e-03, theory/comp= 0.38) ratio= 3.71, rate= 1.89, PPW=  50.3 (ds= 1.25e-02, lambda= 0.63, Nlambda=  1.6)
 i=2: l2RelErr=4.360e-03 (theory= 1.63e-03, theory/comp= 0.37) ratio= 3.90, rate= 1.96, PPW= 100.5 (ds= 6.25e-03, lambda= 0.63, Nlambda=  1.6)


***********************************************
********** Sun Aug 31, 2025


TEST BOX HELMHOLTZ



runsCases.p -grid=square -known=boxHelmholtz -freq=40 -beta=1 -order=4 -numRes=4

CLOSE TO FORCING RESONANCE
kx=omega/sqrt{2}
    m=m+1; 
    % known = boxHelmholtz;
    order{m}=4;
    omega{m}=40;
    amp{m}=1;
    L{m}=1;
    x0{m}=0.55; y0{m}=0.55;
    dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03 ];
    errv{m}   = [  3.1650e+00   1.6200e-01   1.3510e-02   1.0030e-03   6.8090e-05 ];
    errPPW{m} = [  5.4253e-01   3.3908e-02   2.1193e-03   1.3245e-04   8.2784e-06 ];
    errRE{m}  = [  2.2300e+00   1.7100e-01   1.3200e-02   1.0100e-03   7.7600e-05 ];

kx=omega
    m=m+1; 
    % known = boxHelmholtz;
    order{m}=4;
    omega{m}=40;
    amp{m}=1;
    L{m}=1;
    x0{m}=0.55; y0{m}=0.55;
    dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03 ];
    errv{m}   = [  9.3510e-02   1.2010e-02   1.2980e-03   6.3160e-05   2.9240e-06 ];
    errPPW{m} = [  5.4253e-01   3.3908e-02   2.1193e-03   1.3245e-04   8.2784e-06 ];
    errRE{m}  = [  5.4700e-01   2.6700e-02   1.3000e-03   6.3300e-05   3.0900e-06 ];

runsCases.p -grid=square -known=boxHelmholtz -freq=40 -beta=1 -order=2 -numRes=6



COMPUTE ERRORS BY RICHARDSON TOO


plotStuff plotSolution.cmd -show=modGaussFreq50square512order4 -solution=1


>>>>>  RUNS FOR PAPER:



8x1 ffreq=30 Order=4
runsCases.p -grid=rectangle8By1SpacingRatio1Grid -freq=30 -beta=0 -x0=4.1 -y0=.55 -order=4 -numRes=4

runsCases.p -grid=rectangle8By1SpacingRatio1p5Grid -freq=30 -beta=0 -x0=4.1 -y0=.55 -order=4 -numRes=4
runsCases.p -grid=rectangle8By1SpacingRatio1p5Grid -freq=30 -beta=0 -x0=4.1 -y0=.55 -order=2 -numRes=5



runsCases.p -grid=rectangle8By1SpacingRatio1Grid -freq=20 -beta=0 -x0=4.1 -y0=.55 -order=4 -numRes=4
runsCases.p -grid=rectangle8By1SpacingRatio1Grid -freq=20 -beta=0 -x0=4.1 -y0=.55 -order=2 -numRes=5

runsCases.p -grid=rectangle4By1SpacingRatio1Grid -freq=40 -beta=0 -x0=1.9 -y0=.55 -order=4 -numRes=5
runsCases.p -grid=rectangle4By1SpacingRatio1Grid -freq=40 -beta=0 -x0=1.9 -y0=.55 -order=2 -numRes=6

to do:
runsCases.p -grid=rectangle2By1SpacingRatio1Grid -freq=40 -beta=0 -x0=1.1 -y0=.55 -order=4 -numRes=5
runsCases.p -grid=rectangle2By1SpacingRatio1Grid -freq=40 -beta=0 -x0=1.1 -y0=.55 -order=2 -numRes=6

++++++++ FREQ=50
ORDER=4:
runsCases.p -grid=square -freq=50 -beta=1 -order=4 -numRes=5

    m=m+1; 
    order{m}=4;
    omega{m}=50;
    amp{m}=1;
    L{m}=1;
    dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03   9.7656e-04 ];
    errv{m}   = [  2.5700e-01   1.8900e-02   1.7730e-03   1.4620e-04   1.0230e-05   6.6960e-07 ];
    errPPW{m} = [  1.6557e+00   1.0348e-01   6.4675e-03   4.0422e-04   2.5264e-05   1.5790e-06 ];
    errRE{m}  = [  4.2100e-01   2.9600e-02   2.0800e-03   1.4600e-04   1.0300e-05   7.2100e-07 ];

ORDER=2:
runsCases.p -grid=square -freq=50 -beta=1 -order=2 -numRes=7



m=m+1; 
order{m}=2;
omega{m}=50;
amp{m}=1;
L{m}=1;
dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03   9.7656e-04   4.8828e-04 ];
errv{m}   = [  2.7040e-01   3.0490e-01   2.2320e-01   3.4810e-02   8.9550e-03   2.2640e-03   5.6760e-04 ];
errPPW{m} = [  5.0863e+00   1.2716e+00   3.1789e-01   7.9473e-02   1.9868e-02   4.9671e-03   1.2418e-03 ];
errRE{m}  = [  2.4600e+00   6.0700e-01   1.5000e-01   3.7100e-02   9.1800e-03   2.2700e-03   5.6100e-04 ];



+++++++++++ FREQ=40 
ORDER=4:
runsCases.p -grid=square -freq=40 -beta=1 -order=4 -numRes=5

 ====================================
     SUMMARY: grid=square512.order4, L=1
 i=0: l2RelErr=1.311e-01
 i=1: l2RelErr=7.484e-03 (theory= 3.39e-02, theory/comp= 4.53) ratio=17.52, rate= 4.13, PPW=  10.1 (ds= 1.56e-02, lambda= 0.16, Nlambda=  6.4)
 i=2: l2RelErr=8.246e-04 (theory= 2.12e-03, theory/comp= 2.57) ratio= 9.08, rate= 3.18, PPW=  20.1 (ds= 7.81e-03, lambda= 0.16, Nlambda=  6.4)
 i=3: l2RelErr=6.403e-05 (theory= 1.32e-04, theory/comp= 2.07) ratio=12.88, rate= 3.69, PPW=  40.2 (ds= 3.91e-03, lambda= 0.16, Nlambda=  6.4)
 i=4: l2RelErr=4.354e-06 (theory= 8.28e-06, theory/comp= 1.90) ratio=14.71, rate= 3.88, PPW=  80.4 (ds= 1.95e-03, lambda= 0.16, Nlambda=  6.4)
Format for plotErrorVersusPPW.m
order{m}=4;
omega{m}=40;
amp{m}=1;
dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03 ];
errv{m}   = [  1.3110e-01   7.4840e-03   8.2460e-04   6.4030e-05   4.3540e-06 ];
errPPW{m} = [  5.4253e-01   3.3908e-02   2.1193e-03   1.3245e-04   8.2784e-06 ];
errRE{m}  = [  1.3200e-01   1.0400e-02   8.2100e-04   6.4700e-05   5.1100e-06 ];


ORDER=2:
runsCases.p -grid=square -freq=40 -beta=1 -order=2 -numRes=5


 ====================================
     SUMMARY: grid=square512.order2, L=1
 i=0: l2RelErr=3.028e-01
 i=1: l2RelErr=2.760e-01 (theory= 6.51e-01, theory/comp= 2.36) ratio= 1.10, rate= 0.13, PPW=  10.1 (ds= 1.56e-02, lambda= 0.16, Nlambda=  6.4)
 i=2: l2RelErr=1.143e-01 (theory= 1.63e-01, theory/comp= 1.42) ratio= 2.41, rate= 1.27, PPW=  20.1 (ds= 7.81e-03, lambda= 0.16, Nlambda=  6.4)
 i=3: l2RelErr=2.951e-02 (theory= 4.07e-02, theory/comp= 1.38) ratio= 3.87, rate= 1.95, PPW=  40.2 (ds= 3.91e-03, lambda= 0.16, Nlambda=  6.4)
 i=4: l2RelErr=7.554e-03 (theory= 1.02e-02, theory/comp= 1.35) ratio= 3.91, rate= 1.97, PPW=  80.4 (ds= 1.95e-03, lambda= 0.16, Nlambda=  6.4)
Format for plotErrorVersusPPW.m
order{m}=2;
omega{m}=40;
amp{m}=1;
dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03 ];
errv{m}   = [  3.0280e-01   2.7600e-01   1.1430e-01   2.9510e-02   7.5540e-03 ];
errPPW{m} = [  2.6042e+00   6.5104e-01   1.6276e-01   4.0690e-02   1.0173e-02 ];
errRE{m}  = [  5.5600e+00   9.7100e-01   1.7000e-01   2.9600e-02   5.1700e-03 ];


RECTANGLE:

runsCases.p -grid=rectangle4By1SpacingRatio1p5Grid -freq=40 -beta=0 -x0=1.9 -y0=.55 -order=4 -numRes=4 

 ====================================
     SUMMARY: grid=rectangle4By1SpacingRatio1p5Grid32.order4, L=4
 i=0: l2RelErr=2.996e-01
 i=1: l2RelErr=1.951e-02 (theory= 5.56e-02, theory/comp= 2.85) ratio=15.36, rate= 3.94, PPW=  12.6 (ds= 1.25e-02, lambda= 0.16, Nlambda= 25.5)
 i=2: l2RelErr=2.219e-03 (theory= 3.47e-03, theory/comp= 1.56) ratio= 8.79, rate= 3.14, PPW=  25.1 (ds= 6.25e-03, lambda= 0.16, Nlambda= 25.5)
 i=3: l2RelErr=2.520e-04 (theory= 2.17e-04, theory/comp= 0.86) ratio= 8.81, rate= 3.14, PPW=  50.3 (ds= 3.13e-03, lambda= 0.16, Nlambda= 25.5)
Format for plotErrorVersusPPW.m
order{m}=4;
omega{m}=40;
amp{m}=1;
dsv{m}    = [  2.5000e-02   1.2500e-02   6.2500e-03   3.1250e-03 ];
errv{m}   = [  2.9960e-01   1.9510e-02   2.2190e-03   2.5200e-04 ];
errPPW{m} = [  8.8889e-01   5.5556e-02   3.4722e-03   2.1701e-04 ];
errRE{m}  = [  2.0900e-01   2.1600e-02   2.2200e-03   2.2900e-04 ];


runsCases.p -grid=rectangle4By1SpacingRatio1Grid -freq=40 -beta=0 -x0=1.9 -y0=.55 -order=4 -numRes=4 

 ====================================
     SUMMARY: grid=rectangle4By1SpacingRatio1Grid32.order4, L=4
 i=0: l2RelErr=3.209e-01
 i=1: l2RelErr=1.965e-02 (theory= 5.56e-02, theory/comp= 2.83) ratio=16.33, rate= 4.03, PPW=  12.6 (ds= 1.25e-02, lambda= 0.16, Nlambda= 25.5)
 i=2: l2RelErr=1.437e-03 (theory= 3.47e-03, theory/comp= 2.42) ratio=13.67, rate= 3.77, PPW=  25.1 (ds= 6.25e-03, lambda= 0.16, Nlambda= 25.5)
 i=3: l2RelErr=9.897e-05 (theory= 2.17e-04, theory/comp= 2.19) ratio=14.52, rate= 3.86, PPW=  50.3 (ds= 3.13e-03, lambda= 0.16, Nlambda= 25.5)
Format for plotErrorVersusPPW.m
order{m}=4;
omega{m}=40;
amp{m}=1;
dsv{m}    = [  2.5000e-02   1.2500e-02   6.2500e-03   3.1250e-03 ];
errv{m}   = [  3.2090e-01   1.9650e-02   1.4370e-03   9.8970e-05 ];
errPPW{m} = [  8.8889e-01   5.5556e-02   3.4722e-03   2.1701e-04 ];
errRE{m}  = [  3.0400e-01   2.1000e-02   1.4500e-03   9.9600e-05 ];



runsCases.p -grid=square -freq=20 -beta=1 -order=4 -numRes=4 -runCodes=1


runsCases.p -grid=square -freq=15 -beta=1 -order=2 -numRes=4 -runCodes=1



runsCases.p -grid=square -freq=20 -beta=1 -order=2 -numRes=5 -runCodes=1

 ====================================
     SUMMARY:
 i=0: l2RelErr=2.915e-01
 i=1: l2RelErr=9.654e-02 (theory= 8.14e-02, theory/comp= 0.84) ratio= 3.02, rate= 1.59, PPW=  20.1 (ds= 1.56e-02, lambda= 0.31, Nlambda=  3.2)
 i=2: l2RelErr=2.270e-02 (theory= 2.03e-02, theory/comp= 0.90) ratio= 4.25, rate= 2.09, PPW=  40.2 (ds= 7.81e-03, lambda= 0.31, Nlambda=  3.2)
 i=3: l2RelErr=5.649e-03 (theory= 5.09e-03, theory/comp= 0.90) ratio= 4.02, rate= 2.01, PPW=  80.4 (ds= 3.91e-03, lambda= 0.31, Nlambda=  3.2)
 i=4: l2RelErr=1.412e-03 (theory= 1.27e-03, theory/comp= 0.90) ratio= 4.00, rate= 2.00, PPW= 160.8 (ds= 1.95e-03, lambda= 0.31, Nlambda=  3.2)
Format for plotErrorVersusPPW.m
order{m}=2;
omega{m}=20;
amp{m}=1;
dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03 ];
errv{m}   = [  2.9150e-01   9.6540e-02   2.2700e-02   5.6490e-03   1.4120e-03 ];
errPPW{m} = [  3.2552e-01   8.1380e-02   2.0345e-02   5.0863e-03   1.2716e-03 ];
errRE{m}  = [  3.9800e-01   9.6200e-02   2.3200e-02   5.6200e-03   1.3600e-03 ];


***********************************************
********** Sat Aug 3021, 2025

NEW RADIAL MODULATED GAUSSIAN HELMHOLTZ SOLUTION


ORDER=4:
runsCases.p -grid=square -freq=60 -beta=1 -order=4 -numRes=5



ORDER=4:
runsCases.p -grid=square -freq=40 -beta=1 -order=4 -numRes=5


====================================
     SUMMARY:
 i=0: l2RelErr=1.311e-01
 i=1: l2RelErr=7.484e-03 (theory= 3.39e-02, theory/comp= 4.53) ratio=17.52, rate= 4.13, PPW=  10.1 (ds= 1.56e-02, lambda= 0.16, Nlambda=  6.4)
 i=2: l2RelErr=8.246e-04 (theory= 2.12e-03, theory/comp= 2.57) ratio= 9.08, rate= 3.18, PPW=  20.1 (ds= 7.81e-03, lambda= 0.16, Nlambda=  6.4)
 i=3: l2RelErr=6.403e-05 (theory= 1.32e-04, theory/comp= 2.07) ratio=12.88, rate= 3.69, PPW=  40.2 (ds= 3.91e-03, lambda= 0.16, Nlambda=  6.4)
 i=4: l2RelErr=4.354e-06 (theory= 8.28e-06, theory/comp= 1.90) ratio=14.71, rate= 3.88, PPW=  80.4 (ds= 1.95e-03, lambda= 0.16, Nlambda=  6.4)
Format for plotErrorVersusPPW.m
order{m}=4;
omega{m}=40;
amp{m}=1;
dsv{m}    = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03 ];
errv{m}   = [  1.3110e-01   7.4840e-03   8.2460e-04   6.4030e-05   4.3540e-06 ];
errPPW{m} = [  5.4253e-01   3.3908e-02   2.1193e-03   1.3245e-04   8.2784e-06 ];




ORDER=2:
runsCases.p -grid=square -freq=40 -beta=1 -order=2 -numRes=6

 ====================================
     SUMMARY:
 i=0: l2RelErr=3.028e-01
 i=1: l2RelErr=2.760e-01 ratio= 1.10, rate= 0.13
 i=2: l2RelErr=1.143e-01 ratio= 2.41, rate= 1.27
 i=3: l2RelErr=2.951e-02 ratio= 3.87, rate= 1.95
 i=4: l2RelErr=7.554e-03 ratio= 3.91, rate= 1.97
 i=5: l2RelErr=1.901e-03 ratio= 3.97, rate= 1.99
Format for plotErrorVersusPPW.m
order{m}=2;
omega{m}=40;
amp{m}=1;
dsv{m} = [  3.1250e-02   1.5625e-02   7.8125e-03   3.9062e-03   1.9531e-03   9.7656e-04 ];
errv{m} = [  3.0280e-01   2.7600e-01   1.1430e-01   2.9510e-02   7.5540e-03   1.9010e-03 ];



runsCases.p -grid=square -freq=10 -beta=3 -numRes=1


JUST USE DIRECT SOLVER: 

*** Set k0 < 0 ==? k0 -> -k0/(2*pi)

cgwh -noplot trigHelmholtz.cmd -known=modulatedGaussian -g=square512.order4 -nf=1 -freq=40 -k0=-40 -beta=2 -x0=0.55 -y0=0.55 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og

cgwh: max-err =1.39e-05 (between WaveHoltz and known solution, all frequencies)


cgwh -noplot trigHelmholtz.cmd -known=modulatedGaussian -g=square256.order4 -nf=1 -freq=80 -k0=-80 -beta=2 -x0=0.55 -y0=0.55 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og

O4
cgwh: max-err =9.19e-03 (between WaveHoltz and known solution, all frequencies)


O2
cgwh -noplot trigHelmholtz.cmd -known=modulatedGaussian -g=square256.order2 -nf=1 -freq=80 -k0=-80 -beta=2 -x0=0.55 -y0=0.55 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og

G1024:
cgwh: max-err =7.92e-02 (between WaveHoltz and known solution, all frequencies)

G256:
cgwh: max-err =1.18e+00 (between WaveHoltz and known solution, all frequencies)

$cgwh -noplot trigHelmholtz.cmd -known=modulatedGaussian -g=square128.order4 -nf=1 -freq=20 -k0=-20 -beta=2 -x0=0.55 -y0=0.55 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og

cgwh: max-err =1.60e-04 (between WaveHoltz and known solution, all frequencies)

O4: 
$cgwh -noplot trigHelmholtz.cmd -known=modulatedGaussian -g=square128.order4 -nf=1 -freq=5 -k0=5 -beta=2 -x0=0.5 -y0=0.5 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og

cgwh: max-err =1.81e-04 (between WaveHoltz and known solution, all frequencies)

O2 
$cgwh -noplot trigHelmholtz.cmd -known=modulatedGaussian -g=square128.order2 -nf=1 -freq=5 -k0=5 -beta=2 -x0=0.5 -y0=0.5 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og

cgwh: max-err =1.16e-02 (between WaveHoltz and known solution, all frequencies)

$cgwh -noplot trigHelmholtz.cmd -known=modulatedGaussian -g=square64.order2 -nf=1 -freq=5 -k0=2 -beta=0 -x0=0.5 -y0=0.5 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og


$cgwh -noplot trigHelmholtz.cmd -known=modulatedGaussian -g=square16.order2 -nf=1 -freq=5 -k0=0 -beta=0 -x0=0.5 -y0=0.5 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og


***********************************************
********** Fri Aug 29, 2025

MANUFACTURED SOLUTION FOR POLLUTION ERRORS ON A SQUARE

ORDER=4
$cgwh -noplot trigHelmholtz.cmd -g=square256.order4 -nf=1 -freq=50 -kx=5.6 -ky=5.6 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og 

G512:
CgWave::getErrors: t=0.000e+00, freq=  0, omega=  50.000, maxRelErr=7.268e-06, l2RelErr=2.356e-06

G256
CgWave::getErrors: t=0.000e+00, freq=  0, omega=  50.000, maxRelErr=1.103e-04, l2RelErr=3.489e-05

ORDER=2
$cgwh -noplot trigHelmholtz.cmd -g=square1024.order2 -nf=1 -freq=50 -kx=5.6 -ky=5.6 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og 

CgWave::getErrors: t=0.000e+00, freq=  0, omega=  50.000, maxRelErr=3.041e-03, l2RelErr=1.003e-03



$cgwh -noplot trigHelmholtz.cmd -g=square1024.order2 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=og 



************************************************
********** Thurs Aug 21, 2025

SAVE ERRORS TO SHOW FILE ** FIXED **

cgwh -noplot trigHelmholtz.cmd -g=sice16.order2 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -show=diskG16O2Freq30.show -go=ds


SAVE A SHOW FILE FOR PLOTTING 

plotStuff plotSolution.cmd -show=diskG32O2Freq30 -res=2048 -solution=1

cgwh -noplot trigHelmholtz.cmd -g=sice32.order2 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -show=diskG32O2Freq30.show -go=ds



************************************************
********** Wed Aug 20, 2025

MANUFACTURED SOLUTION FOR POLLUTION ERRORS ? 

FIX ME -- USE L2H errors instead of MAX 

ORDER=4 L2 ERRORS from tail -100 diskG32O4Freq30.out etc.
G2  omega=  30.000, maxRelErr=6.605e+00, l2RelErr=3.848e-01
G4  omega=  30.000, maxRelErr=1.021e-01, l2RelErr=2.711e-02
G8  omega=  30.000, maxRelErr=7.142e-03, l2RelErr=2.005e-03
G16 omega=  30.000, maxRelErr=7.043e-04, l2RelErr=1.972e-04
G32 omega=  30.000, maxRelErr=5.633e-05, l2RelErr=1.580e-05
G64 omega=  30.000, maxRelErr=3.972e-06, l2RelErr=1.119e-06

ORDER=2: L2 ERRORS
G4   omega=  30.000, maxRelErr=6.348e+00, l2RelErr=2.679e-01
G8   omega=  30.000, maxRelErr=7.447e-01, l2RelErr=1.593e-01
G16  omega=  30.000, maxRelErr=3.362e+01, l2RelErr=2.798e-01
G32  omega=  30.000, maxRelErr=1.579e-01, l2RelErr=3.901e-02
G64  omega=  30.000, maxRelErr=3.179e-02, l2RelErr=8.742e-03
G128 omega=  30.000, maxRelErr=7.579e-03, l2RelErr=2.133e-03

CHECK TRUE ERRORS WITH RICHARDSON

 comp compDisk

*** ORDER=2
% -------------- l2 norm results -------------
\begin{table}[hbt]\tableFont % you should set \tableFont to \footnotesize or other size
% \newcommand{\num}[2]{#1e{#2}} % use this command to set the format of numbers in the table.
% \newcommand{\errFormat}[1]{#1}} % use this command to set the format of the error label.
\begin{center}
\begin{tabular}{|l|c|c|c|c|} \hline 
   show file         & \errFormat{uDHS0} &  r   & \errFormat{f0} &  r  \\ \hline
 diskG4O2Freq30.show & \num{6.2}{0} &      & \num{2.8}{-5} &      \\ \hline
 diskG8O2Freq30.show & \num{1.2}{0} &  5.2 & \num{2.8}{-5} &  1.0 \\ \hline
 diskG16O2Freq30.show & \num{2.3}{-1} &  5.2 & \num{2.7}{-5} &  1.0 \\ \hline
 diskG32O2Freq30.show & \num{4.4}{-2} &  5.2 & \num{2.7}{-5} &  1.0 \\ \hline
 diskG64O2Freq30.show & \num{8.5}{-3} &  5.2 & \num{2.7}{-5} &  1.0 \\ \hline
 diskG128O2Freq30.show & \num{1.6}{-3} &  5.2 & \num{2.7}{-5} &  1.0 \\ \hline
                      &     2.38      &      &     0.01      &     \\ \hline
\end{tabular}
\caption{comp. L2-norm self convergence results, absolute-errors, t=0.000000e+00, Wed Aug 20 18:25:15 2025. }
\end{center}
\end{table}




*** ORDER=4
% -------------- l2 norm results -------------
\begin{table}[hbt]\tableFont % you should set \tableFont to \footnotesize or other size
% \newcommand{\num}[2]{#1e{#2}} % use this command to set the format of numbers in the table.
% \newcommand{\errFormat}[1]{#1}} % use this command to set the format of the error label.
\begin{center}
\begin{tabular}{|l|c|c|c|c|} \hline 
   show file         & \errFormat{uDHS0} &  r   & \errFormat{f0} &  r  \\ \hline
 diskG2O4Freq30.show & \num{3.7}{-1} &      & \num{-inf}{-2147483648} &      \\ \hline
 diskG4O4Freq30.show & \num{3.0}{-2} & 12.3 & \num{-inf}{-2147483648} &  0.5 \\ \hline
 diskG8O4Freq30.show & \num{2.4}{-3} & 12.3 & \num{-inf}{-2147483648} &  0.5 \\ \hline
 diskG16O4Freq30.show & \num{2.0}{-4} & 12.3 & \num{-inf}{-2147483648} &  0.5 \\ \hline
 diskG32O4Freq30.show & \num{1.6}{-5} & 12.3 & \num{-inf}{-2147483648} &  0.5 \\ \hline
 diskG64O4Freq30.show & \num{1.3}{-6} & 12.3 & \num{-inf}{-2147483648} &  0.5 \\ \hline
                      &     3.63      &      &    -1.00      &     \\ \hline
\end{tabular}
\caption{comp. L2-norm self convergence results, absolute-errors, t=0.000000e+00, Wed Aug 20 18:27:59 2025. }
\end{center}
\end{table}




NOTE: MAX ERR
G64: cgwh: max-err =3.97e-06 
G32: cgwh: max-err =5.63e-05 
G16 cgwh: max-err =7.04e-04
G8 cgwh: max-err =7.14e-03
G4 cgwh: max-err =1.02e-01 
G2 cgwh: max-err =6.60e+00 


ADD TO MAKE FILE 




SAVE A SHOW FILE FOR PLOTTING 

plotStuff plotSolution.cmd -show=diskG32O2Freq30 -res=2048 -solution=1

cgwh -noplot trigHelmholtz.cmd -g=sice32.order2 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -show=diskG32O2Freq30.show -go=ds


SIC - ORDER=4:
cgwh -noplot trigHelmholtz.cmd -g=sice64.order4 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice32.order4 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice16.order4 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice8.order4 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice4.order4 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice2.order4 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d

G64: cgwh: max-err =3.97e-06 
G32: cgwh: max-err =5.63e-05 
G16 cgwh: max-err =7.04e-04
G8 cgwh: max-err =7.14e-03
G4 cgwh: max-err =1.02e-01 
G2 cgwh: max-err =6.60e+00 


SIC - ORDER=2:
cgwh -noplot trigHelmholtz.cmd -g=sice128.order2 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice64.order2 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice32.order2 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice16.order2 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice8.order2 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=sice4.order2 -numPeriods=4 -nf=1 -freq=30 -kx=3.4 -ky=3.4 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d

G128
cgwh: max-err =7.58e-03 (between WaveHoltz and known solution, all frequencies)

G64:
cgwh: max-err =3.18e-02 (between WaveHoltz and known solution, all frequencies)

G32
cgwh: max-err =1.58e-01 (between WaveHoltz and known solution, all frequencies)

G16
cgwh: max-err =3.36e+01 (between WaveHoltz and known solution, all frequencies)

G8
cgwh: max-err =7.45e-01 (between WaveHoltz and known solution, all frequencies)

G4
cgwh: max-err =6.35e+00 (between WaveHoltz and known solution, all frequencies)

CIC: 
cgwh -noplot trigHelmholtz.cmd -g=cice16.order2 -numPeriods=4 -nf=1 -freq=15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=cice8.order2 -numPeriods=4 -nf=1 -freq=15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d
cgwh -noplot trigHelmholtz.cmd -g=cice4.order2 -numPeriods=4 -nf=1 -freq=15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d

G16
cgwh: max-err =3.45e-02 (between WaveHoltz and known solution, all frequencies)
G8
cgwh: max-err =1.48e-01 (between WaveHoltz and known solution, all frequencies)
G4:
cgwh: max-err =8.95e-01 (between WaveHoltz and known solution, all frequencies)


SQUARE
cgwh -noplot trigHelmholtz.cmd -g=square128.order2 -numPeriods=4 -nf=1 -freq=15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=0 -go=d

G128
cgwh: max-err =1.82e-02 (between WaveHoltz and known solution, all frequencies)


G64
cgwh: max-err =7.87e-02 (between WaveHoltz and known solution, all frequencies)


*************************************************
********** Mon June 9, 2025

This example is broken after fixes for parallel -- check INHOMOGENEOUS  boundary conditions

# MULTI-FREQ
square64ImpFreq3Krylov.check ../runsWaveHoltz/trigHelmholtz/trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=1 -go=dk


cgwh -noplot trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=1 -go=dk

set cgwhs = /home/henshw/codes/cgwaveSerial/bin/cgwh  : serial cgwh

$cgwhs -noplot trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=1 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=1 -go=dk

*************************************************
********** Wed Jul 24, 2024

++++++++++++ REVISIT POLY PERIODIC SOLUTION FOR PARALLEL

>>>>>>LINEAR IN SPACE

FPI does not converge to correct solution ?!? (serial fails too)

mpirun -np 1 $cgwh trigHelmholtz.cmd -g=square16.order2.hdf -known=polyPeriodic -omega=5 -freq=5 -adjustOmega=1 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -degreeInSpaceForPolyPeriodic=1 -solveri=best -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-16 -atolh=1.0e-16 -go=halt

np=1
CgWaveHoltz::residual: grid=0 : maxRes= 1.36e-12
CgWaveHoltz::residual: freq= 0, omega=   1.000, max-res=1.357e-12.
CgWaveHoltz: omega=1.000e+00, max-res=1.357e-12 (direct Helmholtz solution)
userDefinedKnownSolution: eval polyPeriodic omega=1, a0=1, a1=1, b1=1, c1=1 at t=0.000e+00
cgwh: max-err =1.20e-14 (between WaveHoltz and known solution, all frequencies)

np=2
CgWaveHoltz::residual: grid=0 : maxRes= 1.75e-05
CgWaveHoltz::residual: freq= 0, omega=   1.000, max-res=3.422e-04.
CgWaveHoltz: omega=1.000e+00, max-res=3.422e-04 (direct Helmholtz solution)
userDefinedKnownSolution: eval polyPeriodic omega=1, a0=1, a1=1, b1=1, c1=1 at t=0.000e+00
cgwh: max-err =1.07e-06 (between WaveHoltz and known solution, all frequencies)



mpirun -np 1 $cgwh trigHelmholtz.cmd -g=square8.order2.hdf -known=polyPeriodic -omega=1 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -degreeInSpaceForPolyPeriodic=1 -solveri=best -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-16 -atolh=1.0e-16 -go=halt

np=4: 
CgWaveHoltz::residual: grid=0 : maxRes= 1.55e-13
CgWaveHoltz::residual: freq= 0, omega=   1.000, max-res=2.824e-13.
CgWaveHoltz: omega=1.000e+00, max-res=2.824e-13 (direct Helmholtz solution)
userDefinedKnownSolution: eval polyPeriodic omega=1, a0=1, a1=1, b1=1, c1=1 at t=0.000e+00
cgwh: max-err =2.22e-15 (between WaveHoltz and known solution, all frequencies)


np=2
CgWaveHoltz::residual: grid=0 : maxRes= 1.27e-13
CgWaveHoltz::residual: freq= 0, omega=   1.000, max-res=3.388e-13.
CgWaveHoltz: omega=1.000e+00, max-res=3.388e-13 (direct Helmholtz solution)
userDefinedKnownSolution: eval polyPeriodic omega=1, a0=1, a1=1, b1=1, c1=1 at t=0.000e+00
cgwh: max-err =2.22e-15 (between WaveHoltz and known solution, all frequencies)

np=1:
CgWaveHoltz::residual: grid=0 : maxRes= 3.11e-13
CgWaveHoltz::residual: freq= 0, omega=   1.000, max-res=3.113e-13.
CgWaveHoltz: omega=1.000e+00, max-res=3.113e-13 (direct Helmholtz solution)
userDefinedKnownSolution: eval polyPeriodic omega=1, a0=1, a1=1, b1=1, c1=1 at t=0.000e+00
cgwh: max-err =1.33e-15 (between WaveHoltz and known solution, all frequencies)


mpirun -np 1 $cgwh trigHelmholtz.cmd -g=square32.order2.hdf -known=polyPeriodic -omega=1 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -degreeInSpaceForPolyPeriodic=1 -solveri=best -rtoli=1e-12 -atoli=1e-12 -solverh=gmres -restart=100 -iluh=10 -maxith=10000 -rtolh=1.0e-12 -atolh=1.0e-12 -go=halt

-np=2
*** freq=0: omega=1, max residual=2.31e-11, time for direct Helmholtz solve = 2.13e-02 (s) (iterations=28) ***

 @@@@@@@ CgWaveHoltz::residual WARNING: omega=30.1 is NOT EQUAL TO frequencyArray(0)=1 @@@@@@@

CgWaveHoltz::residual: grid=0 : maxRes= 6.07e-03
CgWaveHoltz::residual: freq= 0, omega=   1.000, max-res=6.067e-03.
CgWaveHoltz: omega=1.000e+00, max-res=6.067e-03 (direct Helmholtz solution)
userDefinedKnownSolution: eval polyPeriodic omega=1, a0=1, a1=1, b1=1, c1=1 at t=0.000e+00
cgwh: max-err =7.36e-06 (between WaveHoltz and known solution, all frequencies)



-np=1
CgWaveHoltz::residual: grid=0 : maxRes= 5.53e-10
CgWaveHoltz::residual: freq= 0, omega=   1.000, max-res=5.528e-10.
CgWaveHoltz: omega=1.000e+00, max-res=5.528e-10 (direct Helmholtz solution)
userDefinedKnownSolution: eval polyPeriodic omega=1, a0=1, a1=1, b1=1, c1=1 at t=0.000e+00
cgwh: max-err =4.68e-12 (between WaveHoltz and known solution, all frequencies)


*************************************************
********** Wed Jul 12, 2023

REVISIT MULTI-FREQ for CHECKS
cgwh -noplot trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=1 -matlab=square64o2ImpThreeFreqNp4 -go=dk


*************************************************
********** Mon May 15, 2023

START TEST PARALLEL

** compute fixed point : np=1: OK 
mpirun -np 1 $cgwh trigHelmholtz.cmd -g=square128.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -kx=1.75 -ky=1.75 -ts=explicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -solverh=petsc -rtolh=1e-12 -atolh=1e-12 -tp=1000 -maxIterations=70 -cfl=.95 -upwind=1  -matlab=junk -go=halt


------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square128.order2.hdf
 Convergence rate CR=0.699, CR-perPeriod=0.836, Time to solve = 2.95e+01(s) : CgWave= 2.95e+01(s) 99.94%, advance= 2.94e+01(s) 99.83%
 max-residual=-1.00e+00 (WaveHoltz its), numberOfIterations = 63 (FP) (maximumNumberOfIterations=70)
 numberOfFrequencies= 2, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = explicit, cfl=  0.95, dt=2.621e-03, minStepsPerPeriod=10, numberOfStepsPerSolve=940, totalTimeStepsStaken=60160, aveItsPerImplicitSolve=  0.0
    implicit solver : none
 =====
 deflateWaveHoltz=0, numToDeflate=1, eigenVectorFile=[eigenVectors.hdf]
 freq= 0, omega=   5.100, (adjusted=   5.100) T= 1.23200, Tbar= 2.46399, numPeriods=  2, Tbar(0)/T=  2.00
 freq= 1, omega=  12.000, (adjusted=  12.000) T= 0.52360, Tbar= 2.09440, numPeriods=  4, Tbar(0)/T=  4.71

CgWaveHoltz::residual: freq= 0, omega=   5.100, max-res=6.588e-08.
CgWaveHoltz::residual: freq= 1, omega=  12.000, max-res=1.011e-07.
CgWaveHoltz: max-res=1.011e-07 (all frequencies)

Direct solve Helmholtz: cpu= 2.53e-01(s), iterations=149 (sum all freq)
   solver : PETSc, parallel=[bi-conjugate gradient stabilized + block Jacobi preconditioner], local=[ILU(5) + reverse Cuthill-McKee ordering]
saveMatlab: dt=2.621e-03
CgWaveHoltz::saved results in matlab file=[junkFP.m]
getErrors: t=0.000e+00, freq=  0, omega=   5.100, maxErr=8.051e-04
getErrors: t=0.000e+00, freq=  1, omega=  12.000, maxErr=2.538e-03
cgwh: max-err =2.54e-03 (between WaveHoltz and known solution, all frequencies)
cgwh: rel-max-diff=6.47e-10 for freq0 =   5.1000e+00, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.41e-09 for freq1 =   1.2000e+01, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=6.41e-09, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)








*************************************************
********** Mon March 6, 2023

check check's 

cgwh -noplot trigHelmholtz.cmd -g=square16.order4.ng3.hdf -omega=5.4 -nf=1 -freq=5.4 -adjustOmega=1 -orderInTime=2 -tol=1e-12 -maxIterations=100 -go=dfk

CgWaveHoltz: max-res=3.297e-12 (all frequencies)

Direct solve Helmholtz: cpu= 2.38e-03(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
saveMatlab: dt=3.417e-02
CgWaveHoltz::saved results in matlab file=[cgWaveHoltzFP.m]
cgwh: max-err =5.32e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: rel-max-diff=6.70e-14, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

cg66:~/runs/cgWaveHoltz/trigHelmholtz> cat cgWaveHoltz.check
# Check file for CgWaveHoltz
 0.00e+00 1  0  1.00e+00  9.998e-01  
 1.00e+00 1  0  1.00e+00  9.998e-01  
 2.00e+00 1  0  0.00e+00  9.998e-01  
 3.00e+00 1  0  1.00e+00  9.998e-01  
 4.00e+00 1  0  6.70e-14  9.998e-01  
 5.00e+00 1  0  1.00e+00  9.998e-01  
 6.00e+00 1  0  7.77e-15  9.998e-01  

**************************************************
********** Mon March 6, 2023

revisit SSWH

cgwh trigHelmholtz.cmd -g=square128.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -kx=1.75 -ky=1.75 -ts=explicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=.95 -upwind=1  -matlab=junk -go=halt

cgwh trigHelmholtz.cmd -g=square128.order2 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=explicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=.95 -upwind=1 -matlab=square128o2ExpThreeFreqNp4 -go=halt

**************************************************
********** Tues Feb 14, 2023


REDO PLOTS FOR PAPER: CHANGE TO ORDER=4
Np=4 
cgwh -noplot trigHelmholtz.cmd -g=square64.order4 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np4 -go=dfk > square64Freq3Np4.out
Np=2 
cgwh -noplot trigHelmholtz.cmd -g=square64.order4 -numPeriods=2 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np2 -go=dfk > square64Freq3Np2.out
Np=1 
cgwh -noplot trigHelmholtz.cmd -g=square64.order4 -numPeriods=1 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np1 -go=dfk > square64Freq3Np1.out



Np=4 
cgwh -noplot trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np4 -go=dfk > square64Freq3Np4.out
Np=2 
cgwh -noplot trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np2 -go=dfk > square64Freq3Np2.out
Np=1 
cgwh -noplot trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np1 -go=dfk > square64Freq3Np1.out





**************************************************
**** Fri Feb 10, 2023

--- REVISIT THREE FREQ CASE STUDY

--> REDO IMP CASES WITH minStepsPeriod=10

SEE MAKEFILE




**************************************************
**** Sun Jan 29, 2023

START ON DEFLATION

scp henshw@cg6.math.rpi.edu:/home/henshw/runs/eig/square128Ev64.show .

cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=1 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=explicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=0.95 -upwind=1 -deflateWaveHoltz=1 -numToDeflate=2 -eigenVectorFile=square128Ev64.show -go=halt


**************************************************
**** Fri Jan 21, 2023

--- ORDER=2 results


IMPLICIT
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=1  -matlab=square64o2ImpThreeFreqNp4 -go=dfk

EXPLICIT
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=explicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=.95 -upwind=1  -matlab=square64o2ThreeFreqNp4 -go=halt


**************************************************
**** Thurs Jan 19, 2023

IMPLICIT CR RATE FOR FPI -- How do we estimate this



TWO FREQ, NP=1
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=1 -nf=2 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=100 -cfl=1000 -upwind=1  -matlab=square64ImpTwoFreqNp1 -go=halt


ONE FREQ, NP=1
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=1 -nf=1 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=200 -cfl=1000 -upwind=1  -matlab=square64ImpOneFreqNp1 -go=halt


**************************************************
**** Wed Jan 18, 2023

Add quadrature weights to matlab output file

IMPLICIT
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=1  -matlab=square64ImpThreeFreqNp4 -go=halt

EXPLICIT
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=explicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=.95 -upwind=1  -matlab=square64ThreeFreqNp4 -go=halt


**************************************************
**** Tues Jan 17, 2023

REPRODUCE CASE FROM waho/codes

>>> Explicit: matches theory
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=explicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=.95 -upwind=1  -matlab=square64ThreeFreqNp4 -go=halt

cp {square64ThreeFreqNp4FP.m,square64ThreeFreqNp4Krylov.m} $waho/codes


IMPLICIT
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=70 -cfl=1000 -upwind=1  -matlab=square64ImpThreeFreqNp4 -go=halt



ADD OPTION TO SAVE TWO MATLAB FILES IN THE SAME RUN  -- ONE FOR FP AND ONE FOR KRYLOV 
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=50 -cfl=1000 -upwind=1  -matlab=square64ThreeFreq -go=halt


cgwh -noplot trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-14 -tp=1000 -maxIterations=50 -cfl=1000 -upwind=1  -matlab=square64ThreeFreq -go=both

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square64.order4.ng3.hdf
 Convergence rate CR=0.352, CR-perPeriod=0.770, Time to solve = 8.04e-01(s) : CgWave= 7.79e-01(s) 96.89%, advance= 7.70e-01(s) 95.78%
 max-residual=3.75e-14 (WaveHoltz its), numberOfIterations = 29 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1000.00, numberOfStepsPerSolve=32, totalTimeStepsStaken=992, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   9.770, (adjusted=   8.431) T= 0.64311, Tbar= 2.57244, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.925) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05
 freq= 2, omega=  15.500, (adjusted=  11.369) T= 0.40537, Tbar= 2.02683, numPeriods=  5, Tbar(0)/T=  6.35

CgWaveHoltz::residual: freq= 0, omega=   9.770, max-res=4.380e-11.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=6.821e-11.
CgWaveHoltz::residual: freq= 2, omega=  15.500, max-res=6.105e-11.
CgWaveHoltz: max-res=6.821e-11 (all frequencies)

Direct solve Helmholtz: cpu= 8.83e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
getErrors: t=0.000e+00, freq=  0, omega=   9.770, maxErr=2.442e-05
getErrors: t=0.000e+00, freq=  1, omega=  12.340, maxErr=8.592e-05
getErrors: t=0.000e+00, freq=  2, omega=  15.500, maxErr=2.843e-04
cgwh: max-err =2.84e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: rel-max-diff=1.07e-12 for freq0 =   9.7700e+00, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.42e-12 for freq1 =   1.2340e+01, |v|_max= 9.99e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=7.79e-13 for freq2 =   1.5500e+01, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=4.42e-12, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




cgwh -noplot trigHelmholtz.cmd -g=square32.order4.ng3 -numPeriods=4 -nf=3 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=1000 -upwind=1 -go=both

------------------------ CgWaveHoltz SUMMARY ------------------------------------

 grid=/home/henshw/grids/square32.order4.ng3.hdf
 Convergence rate CR=0.363, CR-perPeriod=0.776, Time to solve = 3.02e-01(s) : CgWave= 2.93e-01(s) 96.79%, advance= 2.85e-01(s) 94.38%
 max-residual=6.77e-13 (WaveHoltz its), numberOfIterations = 27 (Krylov) (maximumNumberOfIterations=50)
 numberOfFrequencies= 3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Time stepping = implicit, cfl=1000.00, numberOfStepsPerSolve=32, totalTimeStepsStaken=928, aveItsPerImplicitSolve=  0.0
    implicit solver : yale, solver=[direct sparse solver, no pivoting + ]
 =====
 freq= 0, omega=   9.770, (adjusted=   8.431) T= 0.64311, Tbar= 2.57244, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.925) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05
 freq= 2, omega=  15.500, (adjusted=  11.369) T= 0.40537, Tbar= 2.02683, numPeriods=  5, Tbar(0)/T=  6.35

CgWaveHoltz::residual: freq= 0, omega=   9.770, max-res=5.340e-11.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=8.230e-11.
CgWaveHoltz::residual: freq= 2, omega=  15.500, max-res=5.502e-11.
CgWaveHoltz: max-res=8.230e-11 (all frequencies)

Direct solve Helmholtz: cpu= 1.63e-02(s), iterations=0 (sum all freq)
   solver : yale, solver=[direct sparse solver, no pivoting + ]
getErrors: t=0.000e+00, freq=  0, omega=   9.770, maxErr=1.294e-03
getErrors: t=0.000e+00, freq=  1, omega=  12.340, maxErr=2.542e-03
getErrors: t=0.000e+00, freq=  2, omega=  15.500, maxErr=3.960e-03
cgwh: max-err =3.96e-03 (between WaveHoltz and known solution, all frequencies)
cgwh: rel-max-diff=6.62e-13 for freq0 =   9.7700e+00, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.98e-12 for freq1 =   1.2340e+01, |v|_max= 9.98e-01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=8.99e-13 for freq2 =   1.5500e+01, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: rel-max-diff=1.98e-12, |v|_max= 1.00e+00 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




**************************************************
**** Monday Jan 16, 2023

RESULTS FOR WAHO PAPER

CHECK accuracy of the direct Helmholtz solver.

SOLVE BOTH direct and WH
cgwh -noplot trigHelmholtz.cmd -g=square32.order4.ng3 -numPeriods=4 -nf=1 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=40 -upwind=1 -go=both


cgwh -noplot trigHelmholtz.cmd -g=square256.order4.ng3 -numPeriods=4 -nf=1 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=40 -upwind=1 -go=direct

cgwh -noplot trigHelmholtz.cmd -g=square128.order4.ng3 -numPeriods=4 -nf=1 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=40 -upwind=1 -go=direct

cgwh -noplot trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=1 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=40 -upwind=1 -go=direct

G256
cgwh: max-err =1.56e-07 (between WaveHoltz and known solution, all frequencies)
G128
cgwh: max-err =2.04e-06 (between WaveHoltz and known solution, all frequencies)
G64
cgwh: max-err =2.44e-05 (between WaveHoltz and known solution, all frequencies)



**************************************************
**** Sat Jan 15, 2022

FIXED COMPUTATION OF numPeriodsArray

THREE FREQ IMPLICIT+MULTI-FREQ + UPWIND FIX *WORKS*
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=40 -upwind=1 -go=halt
------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 33 (maximumNumberOfIterations=50)
 numberOfFrequencies=3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.441, CR-perPeriod=0.815, Time to solve = 2.28e+00(s)
 freq= 0, omega=   9.770, (adjusted=   8.431) T= 0.64311, Tbar= 2.57244, numPeriods=  4, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=   9.925) T= 0.50917, Tbar= 2.03669, numPeriods=  4, Tbar(0)/T=  5.05
 freq= 2, omega=  15.500, (adjusted=  11.369) T= 0.40537, Tbar= 2.02683, numPeriods=  5, Tbar(0)/T=  6.35

CgWaveHoltz::residual: freq= 0, omega=   9.770, max-res=2.680e-10.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=4.643e-10.
CgWaveHoltz::residual: freq= 2, omega=  15.500, max-res=3.470e-10.
CgWaveHoltz: max-res=4.643e-10 (all frequencies)
getErrors: t=0.000e+00, freq=  0, omega=   9.770, maxErr=2.442e-05
getErrors: t=0.000e+00, freq=  1, omega=  12.340, maxErr=8.592e-05
getErrors: t=0.000e+00, freq=  2, omega=  15.500, maxErr=2.843e-04
cgwh: max-err =2.84e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=3.53e-11 for freq0 =   9.7700e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=9.18e-12 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.00e-11 for freq2 =   1.5500e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.53e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




THREE FREQ IMPLICIT+MULTI-FREQ + UPWIND FIX *WORKS*
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=5.7 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=40 -upwind=1 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 4 (maximumNumberOfIterations=50)
 numberOfFrequencies=3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.001, CR-perPeriod=0.160, Time to solve = 1.00e+01(s)
 freq= 0, omega=   5.700, (adjusted=   5.699) T= 1.10231, Tbar= 4.40925, numPeriods=  4.00, Tbar(0)/T=  4.00
 freq= 1, omega=  12.340, (adjusted=  12.331) T= 0.50917, Tbar= 4.07338, numPeriods=  8.00, Tbar(0)/T=  8.66
 freq= 2, omega=  15.500, (adjusted=  15.482) T= 0.40537, Tbar= 3.24293, numPeriods=  8.00, Tbar(0)/T= 10.88

CgWaveHoltz::residual: freq= 0, omega=   5.700, max-res=8.416e-11.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=1.052e-10.
CgWaveHoltz::residual: freq= 2, omega=  15.500, max-res=9.095e-11.
CgWaveHoltz: max-res=1.052e-10 (all frequencies)
getErrors: t=0.000e+00, freq=  0, omega=   5.700, maxErr=1.374e-05
getErrors: t=0.000e+00, freq=  1, omega=  12.340, maxErr=8.592e-05
getErrors: t=0.000e+00, freq=  2, omega=  15.500, maxErr=2.843e-04
cgwh: max-err =2.84e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=9.03e-14 for freq0 =   5.7000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.23e-12 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.47e-13 for freq2 =   1.5500e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.23e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


THREE FREQ IMPLICIT+MULTI-FREQ + UPWIND FIX *WORKS*
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=40 -upwind=1 -go=halt

------------------------ CgWaveHoltz SUMMARY ------------------------------------
 numberOfIterations = 4 (maximumNumberOfIterations=50)
 numberOfFrequencies=3, adjustOmega=1, adjustHelmholtzForUpwinding=1
 Convergence rate CR=0.001, CR-perPeriod=0.185, Time to solve = 5.53e-01(s)
 freq= 0, omega=   9.770, (adjusted=   8.431) T= 2.57244, numPeriods= 4
 freq= 1, omega=  12.340, (adjusted=   9.925) T= 2.03669, numPeriods= 4
 freq= 2, omega=  15.500, (adjusted=  11.369) T= 1.62147, numPeriods= 4

CgWaveHoltz::residual: freq= 0, omega=   9.770, max-res=5.451e-11.
CgWaveHoltz::residual: freq= 1, omega=  12.340, max-res=1.256e-10.
CgWaveHoltz::residual: freq= 2, omega=  15.500, max-res=1.666e-10.
CgWaveHoltz: max-res=1.666e-10 (all frequencies)
getErrors: t=0.000e+00, freq=  0, omega=   9.770, maxErr=2.442e-05
getErrors: t=0.000e+00, freq=  1, omega=  12.340, maxErr=8.592e-05
getErrors: t=0.000e+00, freq=  2, omega=  15.500, maxErr=2.843e-04
cgwh: max-err =2.84e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=1.40e-12 for freq0 =   9.7700e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.30e-12 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.90e-12 for freq2 =   1.5500e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.30e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)





**************************************************
**** Fri Jan 14, 2022

START TEST ADJUST FOR UPWIND + IMPLICIT

THREE FREQ IMPLICIT+MULTI-FREQ + UPWIND FIX *WORKS*
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=4 -nf=3 -freq=9.77 12.34 15.5 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=40 -upwind=1 -go=halt


CgWaveHoltz::residual: freq=0, omega=9.77, max-res=2.177e-10 (using omega).
CgWaveHoltz::residual: freq=1, omega=12.34, max-res=1.489e-10 (using omega).
CgWaveHoltz::residual: freq=2, omega=15.5, max-res=3.433e-10 (using omega).
CgWaveHoltz: omega=9.770e+00, max-res=3.433e-10, CR=0.559 CR-perPeriod=0.865, cpu= 3.28e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=   9.77, maxErrFreq=2.442e-05
getErrors: t=0.000e+00, freq=  1, omega=   12.3, maxErrFreq=8.592e-05
getErrors: t=0.000e+00, freq=  2, omega=   15.5, maxErrFreq=2.843e-04
cgwh: max-err =2.84e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=6.49e-11 for freq0 =   9.7700e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=7.13e-12 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.47e-12 for freq2 =   1.5500e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.49e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




EXPLICIT+MULTI-FREQ + UPWIND FIX *WORKS*
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=2 -nf=2 -freq=9.77 12.34 -kx=1.75 -ky=1.75 -ts=explicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -cfl=.9 -upwind=1 -go=halt
cgwh: max-err =8.59e-05 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=3.89e-09 for freq0 =   9.7700e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.73e-09 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.73e-09 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


IMPLICIT+MULTI-FREQ + UPWIND FIX *WORKS*
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=2 -nf=2 -freq=9.77 12.34 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=20 -upwind=1 -go=halt

cgwh: max-err =8.59e-05 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=5.63e-12 for freq0 =   9.7700e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.53e-12 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=6.53e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)






cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=2 -nf=1 -freq=9.77 12.34 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=50 -cfl=20 -upwind=1 -go=halt

FD24u with fix:
cgwh: max-err =2.44e-05 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=1.97e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


FD24u - NO FIX 
cgwh: max-err =2.53e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=2.37e-04 (between WaveHoltz and Direct Helmholtz solution, all frequencies)

FD42
cgwh: max-err =2.44e-05 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=1.43e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




IMPLICIT TWO FREQ - ORDER=4
cgwh trigHelmholtz.cmd -g=square64.order4 -numPeriods=2 -nf=2 -freq=9.77 12.34 -kx=1.75 -ky=1.75 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -cfl=20 -go=halt

cgwh: max-err =8.59e-05 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=1.58e-10 for freq0 =   9.7700e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.83e-10 for freq1 =   1.2340e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.83e-10 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



THREE FREQ
cgwh trigHelmholtz.cmd -g=annulus4.order4 -numPeriods=2 -nf=3 -freq=5.1 12 15 -kx=.5 -ky=.5 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -cfl=20 -go=halt
cgwh: max-err =1.23e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=5.53e-14 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.82e-13 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.30e-13 for freq2 =   1.5000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.30e-13 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh trigHelmholtz.cmd -g=annulus4.order4 -numPeriods=2 -nf=2 -freq=5.1 12 -kx=.5 -ky=.5 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -cfl=20 -go=halt

cgwh: max-err =1.17e-05 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=4.81e-14 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.70e-13 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.70e-13 (between WaveHoltz and Direct Helmholtz solution, all frequencies)
**************************************************
**** Thurs Jan 13, 2022

START on implicit + multi-freq

IMPLICIT TWO FREQ - ORDER=4
cgwh trigHelmholtz.cmd -g=square64.order4 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -cfl=20 -go=halt

CFL=1 steps=516, kits=15
cgwh: max-err =7.61e-07 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=5.88e-12 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.97e-12 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.88e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


CFL=20 steps=26
cgwh: max-err =7.61e-07 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=1.34e-10 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.56e-10 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.34e-10 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


TEST -- take at least 5 steps per min period
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=2 -freq=1 12 -kx=.5 -ky=.5 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -cfl=20 -go=halt

CFL="20"  --> 122 steps : 120 = (5*12)*numPeriods

cgwh: max-err =6.19e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=2.38e-12 for freq0 =   1.0000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.80e-12 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.38e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)




IMPLICIT TWO FREQ
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=implicit -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -cfl=20 -go=halt


CFL=40 steps=12 = 6 steps per largest period --> slow convergence
cgwh: max-err =2.64e-03 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=4.22e-04 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.55e-03 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.22e-04 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


CFL=30 steps = 16 kits=33
cgwh: max-err =6.32e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=2.59e-10 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=5.54e-09 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.59e-10 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



CFL=20 steps=24 kits=30
cgwh: max-err =6.32e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=3.28e-11 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.81e-10 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.28e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


tighter tol:
cgwh: max-err =6.32e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=1.21e-12 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=3.40e-13 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=1.21e-12 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



CFL=10 steps=50 kits=14
cgwh: max-err =6.32e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=2.42e-11 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=4.50e-11 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=2.42e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)


CFL=1 steps=448 kits=14

cgwh: max-err =6.32e-04 (between WaveHoltz and known solution, all frequencies)
cgwh: max-diff=9.05e-11 for freq0 =   5.1000e+00 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=8.36e-11 for freq1 =   1.2000e+01 (between WaveHoltz and Direct Helmholtz solution)
cgwh: max-diff=9.05e-11 (between WaveHoltz and Direct Helmholtz solution, all frequencies)



cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -go=halt


explicit: 
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=6.316e-04
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=6.188e-04
cgwh: max-err =6.32e-04 (between WaveHoltz and known solution)
cgwh: max-diff=9.88e-11 (between WaveHoltz and Direct Helmholtz solution)


cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=implicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -cfl=1 -go=halt

**************************************************
**** Wed Jan 12, 2022

CAN WE RUN WITH more periods? Looks ok

cgwh trigHelmholtz.cmd -g=square128.order4.ng3 -kx=2.25 -ky=2.25 -freq=1 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -cfl=1000 -upwind=1 -numPeriods=4 -go=halt



cgwh trigHelmholtz.cmd -g=square128.order4.ng3 -kx=2.25 -ky=2.25 -freq=1 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -cfl=10 -upwind=1 -numPeriods=2 -go=halt


CFL=100, steps=55, kits=7

cgwh: max-err =1.87e-06 (between WaveHoltz and known solution)
cgwh: max-diff=1.26e-10 (between WaveHoltz and Direct Helmholtz solution)

CFL=10: 
cgwh: max-err =1.87e-06 (between WaveHoltz and known solution)
cgwh: max-diff=2.01e-11 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Mon Jan 10, 2022


Implicit + upwinding 

FD42u 
cgwh trigHelmholtz.cmd -g=square128.order4.ng3 -kx=2.25 -ky=2.25 -freq=1 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -cfl=1 -upwind=1 -go=halt


CFL=400 steps=5 kits=9
cgwh: max-err =1.78e-06 (between WaveHoltz and known solution)
cgwh: max-diff=8.83e-08 (between WaveHoltz and Direct Helmholtz solution)

CFL=200 steps=7 kits=8
cgwh: max-err =1.86e-06 (between WaveHoltz and known solution)
cgwh: max-diff=3.98e-09 (between WaveHoltz and Direct Helmholtz solution)


CFL=100 steps=14 kits=8
cgwh: max-err =1.87e-06 (between WaveHoltz and known solution)
cgwh: max-diff=1.38e-09 (between WaveHoltz and Direct Helmholtz solution)


CFL=1: 1314 steps kits=7
cgwh: max-err =1.87e-06 (between WaveHoltz and known solution)
cgwh: max-diff=2.99e-11 (between WaveHoltz and Direct Helmholtz solution)



TOO EASY WITH THIS kx
cgwh trigHelmholtz.cmd -g=square128.order4.ng3 -kx=2 -ky=2 -freq=1 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -cfl=400 -upwind=1 -go=halt


CFL=400 steps=5 kits=4
cgwh: max-err =1.00e-06 (between WaveHoltz and known solution)
cgwh: max-diff=4.82e-08 (between WaveHoltz and Direct Helmholtz solution)

CFL=200 steps=7 kits=4
cgwh: max-err =1.05e-06 (between WaveHoltz and known solution)
cgwh: max-diff=2.13e-09 (between WaveHoltz and Direct Helmholtz solution)


CFL=100 steps=14 kits=4
cgwh: max-err =1.05e-06 (between WaveHoltz and known solution)
cgwh: max-diff=7.91e-10 (between WaveHoltz and Direct Helmholtz solution)

CFL=1: 1314 steps kits=4
cgwh: max-err =1.05e-06 (between WaveHoltz and known solution)
cgwh: max-diff=9.51e-12 (between WaveHoltz and Direct Helmholtz solution)


RSIS G16
cgwh trigHelmholtz.cmd -g=rsise16.order2 -kx=1 -ky=1 -nf=1 -freq=17.7 -ts=implicit -beta2=0 -dtMax=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=1000 -cfl=1 -upwind=1 -go=halt


CFL=1 :

RSIS
cgwh trigHelmholtz.cmd -g=rsise8.order2 -kx=1 -ky=1 -freq=4 -numPeriods=1 -ts=implicit -beta2=0 -dtMax=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-8 -tp=100 -maxIterations=100 -cfl=1 -upwind=1 -go=halt


CFL+max 5 steps, kits=14
cgwh: max-err =8.74e-04 (between WaveHoltz and known solution)
cgwh: max-diff=5.04e-04 (between WaveHoltz and Direct Helmholtz solution)

CFL=30 6 steps kits=12
cgwh: max-err =1.10e-03 (between WaveHoltz and known solution)
cgwh: max-diff=3.01e-04 (between WaveHoltz and Direct Helmholtz solution)

CFL=20 : 9 steps kits=11
cgwh: max-err =1.24e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.91e-04 (between WaveHoltz and Direct Helmholtz solution)

CFL=10 : 18 steps , kits=9
cgwh: max-err =1.26e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.40e-04 (between WaveHoltz and Direct Helmholtz solution)

CFL=1 178 steps, kits=8
######## DONE KYRLOV ITERATIONS -- KSP residual=7.40e-09 (max-res=2.01e-08) (tol=1.00e-08) numIts=8 #######
cgwh: max-err =9.77e-04 (between WaveHoltz and known solution)
cgwh: max-diff=4.03e-04 (between WaveHoltz and Direct Helmholtz solution)


cgwh trigHelmholtz.cmd -g=rsise4.order2 -kx=1 -ky=1 -freq=8 -ts=implicit -beta2=0 -dtMax=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -cfl=1 -upwind=1 -go=halt


freq=8 : *trouble* why are errosrs so large?

G8: direct solve
cgwh: max-err =9.88e-03 (between WaveHoltz and known solution)

G4: Direct solve: 
cgwh: max-err =1.30e-01 (between WaveHoltz and known solution)


freq=4
cgwh: max-err =3.76e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.84e-03 (between WaveHoltz and Direct Helmholtz solution)

freq=2
cgwh: max-err =2.83e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.03e-03 (between WaveHoltz and Direct Helmholtz solution)

freq=1:
cgwh: max-err =2.59e-03 (between WaveHoltz and known solution)
cgwh: max-diff=9.72e-04 (between WaveHoltz and Direct Helmholtz solution)


RSIS -- NOT omega=20.567
cgwh trigHelmholtz.cmd -g=rsise8.order2 -kx=1 -ky=1 -omega=20.567 -ts=implicit -beta2=0 -dtMax=3 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=1000 -cfl=200 -upwind=1 -go=halt

+++ IMP + UP 

CFL=200: ***trouble with adjusted omega**
 ##### CgWave:adjust omega and dt for Helmholtz: dtAdjusted=  1.8072763681e+08 (dt=  1.5707963268e+00) omegaAdjusted=  8.691511e-09 (omega=  1.000000e+00) ####

CFL=150 5 steps 
cgwh: max-err =8.24e-04 (between WaveHoltz and known solution)
cgwh: max-diff=5.04e-05 (between WaveHoltz and Direct Helmholtz solution)

CFL=100 12 steps 
cgwh: max-err =8.71e-04 (between WaveHoltz and known solution)
cgwh: max-diff=2.47e-06 (between WaveHoltz and Direct Helmholtz solution)


CFL=1 : 711 steps
cgwh: max-err =6.30e-04 (between WaveHoltz and known solution)
cgwh: max-diff=2.46e-04 (between WaveHoltz and Direct Helmholtz solution)





cgwh trigHelmholtz.cmd -g=square128.order2 -kx=2 -ky=2 -omega=20.567 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=1000 -cfl=1 -upwind=1 -go=halt

+++ IMP + UP 

CFL=200 : 6 steps 
cgwh: max-err =7.98e-04 (between WaveHoltz and known solution)
cgwh: max-diff=8.14e-06 (between WaveHoltz and Direct Helmholtz solution)

CFL=100 12 steps 
cgwh: max-err =8.04e-04 (between WaveHoltz and known solution)
cgwh: max-diff=2.50e-06 (between WaveHoltz and Direct Helmholtz solution)

CFL=1 : 1138 steps
cgwh: max-err =5.66e-04 (between WaveHoltz and known solution)
cgwh: max-diff=2.51e-04 (between WaveHoltz and Direct Helmholtz solution)



cgwh trigHelmholtz.cmd -g=square32.order2 -kx=2 -ky=2 -omega=20.567 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=1000 -cfl=10 -upwind=0 -go=halt

IMP + UP CFL=20
cgwh: max-err =1.28e-02 (between WaveHoltz and known solution)
cgwh: max-diff=2.24e-04 (between WaveHoltz and Direct Helmholtz solution)


IMP + UP CFL=10
cgwh: max-err =1.27e-02 (between WaveHoltz and known solution)
cgwh: max-diff=4.12e-04 (between WaveHoltz and Direct Helmholtz solution)



IMP
cgwh: max-err =1.30e-02 (between WaveHoltz and known solution)
cgwh: max-diff=2.00e-15 (between WaveHoltz and Direct Helmholtz solution)

**************************************************
**** Sun Jan 9, 2022

*BUG FIXED* in advance.bC -- set periodArray after adjusting omegas


**NOTE** USE -beta=2=0 for implicit and ADJUST

TEST IMPLICIT

FIX ME: ORDER=4 implicit
cgwh trigHelmholtz.cmd -g=cice4.order4.ng3 -numPeriods=4 -nf=1 -freq=6.1 12 -kx=.25 -ky=.25 -ts=implicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -upwind=1 -adjustOmega=1 -cfl=1 -go=halt

>>>> stenciWidth=5, stencilSize=29, numberOfGhostLines=3, addUpwinding=1
cgwh: src/implicit.C:705: int CgWave::formImplicitTimeSteppingMatrix(): Assertion `extraStencilLocation<stencilDimension' failed.

TRY THIS: upwind: 
cgwh trigHelmholtz.cmd -g=square128.order4.ng3 -kx=4 -ky=4 -omega=20.567 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=1000 -upwind=1 -cfl=10 -go=halt


cgwh trigHelmholtz.cmd -g=square64.order2 -kx=2 -ky=2 -omega=20.567 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=1000 -cfl=10 -go=halt


THIS WORKS: 
cgwh trigHelmholtz.cmd -g=square128.order4 -kx=4 -ky=4 -omega=20.567 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=1000 -cfl=10 -go=halt

cgwh: max-err =1.97e-05 (between WaveHoltz and known solution)
cgwh: max-diff=4.75e-14 (between WaveHoltz and Direct Helmholtz solution)



IMPLICIT + ADJUST 
cgwh trigHelmholtz.cmd -g=square32.order2 -numPeriods=4 -nf=1 -freq=6.1 12 -kx=1 -ky=1 -ts=implicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=50 -upwind=0 -adjustOmega=1 -cfl=.9 -go=halt

cgwh trigHelmholtz.cmd -g=square32.order2 -numPeriods=4 -nf=1 -freq=6.1 12 -kx=1 -ky=1 -ts=implicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=50 -upwind=0 -adjustOmega=1 -cfl=.9 -go=halt

ADJUST is broken for implicit
cgwh: max-err =4.92e-04 (between WaveHoltz and known solution)
cgwh: max-diff=5.57e-04 (between WaveHoltz and Direct Helmholtz solution)



EXPLICIT: + ADJUST 
cgwh trigHelmholtz.cmd -g=square32.order2 -numPeriods=4 -nf=1 -freq=6.1 12 -kx=1 -ky=1 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=50 -upwind=0 -adjustOmega=1 -cfl=.9 -go=halt

cgwh: max-err =6.11e-03 (between WaveHoltz and known solution)
cgwh: max-diff=4.44e-15 (between WaveHoltz and Direct Helmholtz solution)



cgwh trigHelmholtz.cmd -g=cice4.order2 -numPeriods=4 -nf=1 -freq=6.1 12 -kx=.25 -ky=.25 -ts=implicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=50 -upwind=1 -adjustOmega=1 -cfl=1 -go=halt


CFL=10 much faster


CFL=1
CgWaveHoltz: omega=6.100e+00, max-res=6.189e-02, CR=0.479 CR-perPeriod=0.832, cpu= 5.61e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    6.1, maxErrFreq=4.505e-03
cgwh: max-err =4.51e-03 (between WaveHoltz and known solution)
cgwh: max-diff=4.39e-03 (between WaveHoltz and Direct Helmholtz solution)




+++++ EXPLICIT
>>>>>>>>>>>>>>>>> CgWave:advance solve a Helmholz Problem <<<<<<<<<<<<<<<<<<<<<<<
 dt=  1.197443378940e-02, omega=  6.101356903758e+00,  tFinal=  4.119205223552e+00
 freq=0 frequency=  6.101356903758e+00 period=  4.119205223552e+00, numberOfPeriods=4
 nextTimeToPlot=4.120e+00, numPlotSteps=344, new dt=1.197e-02 (dtMax=1.204e-02)
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


CgWaveHoltz::residual: freq=0, omega=6.1, max-res=9.503e-10 (using omega), max-res=1.655e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=6.100e+00, max-res=9.503e-10, CR=0.146 CR-perPeriod=0.618, cpu= 5.40e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    6.1, maxErrFreq=5.951e-08
cgwh: max-err =5.95e-08 (between WaveHoltz and known solution)
cgwh: max-diff=1.04e-09 (between WaveHoltz and Direct Helmholtz solution)



Run for plot : 

cgwh trigHelmholtz.cmd -g=shapesBige4.order4.ng3.hdf -numPeriods=8 -nf=1 -freq=11.5 -kx=1.5 -ky=1.5 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=100 -upwind=1 -adjustOmega=1 -show=shapesHelmholtzFreq11p5.show -go=halt

######## DONE KYRLOV ITERATIONS -- KSP residual=1.93e-09 (max-res=8.67e-09) (tol=1.00e-08) numIts=26 #######

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 1.1500000e+01, omegas= 1.1499571e+01 (from symbol of D+D-), dt=2.601733e-03, adjustOmega=1, upwind=1

 **** WARNING: upwinding is ON! Correcting omega for the discrete-time-symbol will not fully work to give a small residual ! *****

CgWaveHoltz::residual: freq=0, omega=11.5, max-res=1.417e-05 (using omega), max-res=9.871e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=1.150e+01, max-res=1.417e-05, CR=0.475 CR-perPeriod=0.911, cpu= 9.41e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=   11.5, maxErrFreq=6.864e-04
cgwh: max-err =6.86e-04 (between WaveHoltz and known solution)
cgwh: max-diff=3.62e-05 (between WaveHoltz and Direct Helmholtz solution)



**************************************************
**** Thurs Jan 6, 2022


To-do : FIX numPeriods bug

ONE BUG FIXED -- updateTimeIntegral
2nd BUF FIXED -- make numPlotSteps % numPeriods = 0

Run for plot : 
Increase kx,ky
cgwh trigHelmholtz.cmd -g=shapesBige4.order4.ng3.hdf -numPeriods=8 -nf=1 -freq=11.5 -kx=1.5 -ky=1.5 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=100 -upwind=1 -adjustOmega=1 -show=shapesHelmholtzFreq11p5 -go=halt

 ######## DONE KYRLOV ITERATIONS -- KSP residual=1.93e-09 (max-res=8.67e-09) (tol=1.00e-08) numIts=26 #######

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 1.1500000e+01, omegas= 1.1499571e+01 (from symbol of D+D-), dt=2.601733e-03, adjustOmega=1, upwind=1

 **** WARNING: upwinding is ON! Correcting omega for the discrete-time-symbol will not fully work to give a small residual ! *****

CgWaveHoltz::residual: freq=0, omega=11.5, max-res=1.417e-05 (using omega), max-res=9.871e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=1.150e+01, max-res=1.417e-05, CR=0.475 CR-perPeriod=0.911, cpu= 9.51e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=   11.5, maxErrFreq=6.864e-04
cgwh: max-err =6.86e-04 (between WaveHoltz and known solution)
cgwh: max-diff=3.62e-05 (between WaveHoltz and Direct Helmholtz solution)





cgwh trigHelmholtz.cmd -g=cice4.order4.ng3 -numPeriods=4 -nf=1 -freq=6.1 12 -kx=.25 -ky=.25 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -upwind=1 -adjustOmega=1 -go=halt

Np= 1: numIts=27
Np= 2: numIts=17
Np= 4: numIts=12
Np=10: numIts=10


cgwh: max-err =5.95e-08 (between WaveHoltz and known solution)
cgwh: max-diff=1.04e-09 (between WaveHoltz and Direct Helmholtz solution)

Increase kx,ky
cgwh trigHelmholtz.cmd -g=shapesBige4.order4.ng3.hdf -numPeriods=4 -nf=1 -freq=8.8 -kx=1.5 -ky=1.5 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=100 -upwind=1 -adjustOmega=1 -go=halt


cgwh trigHelmholtz.cmd -g=shapesBige4.order4.ng3.hdf -numPeriods=4 -nf=1 -freq=8.8 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=100 -upwind=1 -adjustOmega=1 -go=halt


adjustOmega:
 ######## DONE KYRLOV ITERATIONS -- KSP residual=4.67e-09 (max-res=1.95e-08) (tol=1.00e-08) numIts=26 #######

CgWaveHoltz::residual: freq=0, omega=8.8, max-res=2.515e-06 (using omega), max-res=3.369e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=8.800e+00, max-res=2.515e-06, CR=0.492 CR-perPeriod=0.838, cpu= 6.17e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    8.8, maxErrFreq=7.561e-05
cgwh: max-err =7.56e-05 (between WaveHoltz and known solution)
cgwh: max-diff=6.53e-06 (between WaveHoltz and Direct Helmholtz solution)




adjustOmega=0

 #### DONE KYRLOV ITERATIONS -- KSP residual=4.04e-11 (max-res=1.61e-10) (tol=1.00e-10) numberOfIterations=28 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 8.8000000e+00, omegas= 8.7998079e+00 (from symbol of D+D-), dt=2.601087e-03, adjustOmega=0, upwind=1

 **** WARNING: upwinding is ON! Correcting omega for the discrete-time-symbol will not fully work to give a small residual ! *****

CgWaveHoltz::residual: freq=0, omega=8.8, max-res=3.638e-03 (using omega), max-res=5.433e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=8.800e+00, max-res=3.638e-03, CR=0.437 CR-perPeriod=0.813, cpu= 6.89e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    8.8, maxErrFreq=4.594e-04
cgwh: max-err =4.59e-04 (between WaveHoltz and known solution)
cgwh: max-diff=4.71e-04 (between WaveHoltz and Direct Helmholtz solution)



cgwh trigHelmholtz.cmd -g=sice2.order4.ng3 -numPeriods=2 -nf=1 -freq=6.1 12 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt

Np=1:
######### DONE KYRLOV ITERATIONS -- KSP residual=3.28e-11 (max-res=1.16e-10) (tol=1.00e-10) numberOfIterations=13 #############


Np=4: 
###### DONE KYRLOV ITERATIONS -- KSP residual=2.10e-11 (max-res=7.92e-11) (tol=1.00e-10) numberOfIterations=7 #############
getErrors: t=0.000e+00, freq=  0, omega=    6.1, maxErrFreq=1.181e-04
cgwh: max-err =1.18e-04 (between WaveHoltz and known solution)
cgwh: max-diff=1.48e-06 (between WaveHoltz and Direct Helmholtz solution)




cgwh trigHelmholtz.cmd -g=square32.order4.ng3.hdf -numPeriods=2 -nf=1 -freq=6.1 12 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=200 -upwind=1 -adjustOmega=1 -go=halt

cgwh: max-err =1.00e-06 (between WaveHoltz and known solution)
cgwh: max-diff=2.24e-10 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Wed Jan 5, 2022

WORK ON FIX FOR PETSC

*** FIXED BUG IN solvePETSc.c : do NOT inetrpolate vOld

*** FIXED BUG WITH PETSC --> zero out unused in cgWave, no need to check mask in solvePETSc.C


cgwh trigHelmholtz.cmd -g=square32.order4.ng3.hdf -numPeriods=1 -nf=1 -freq=6.1 12 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=200 -upwind=1 -adjustOmega=1 -go=halt

KSP Object: 1 MPI processes
  type: gmres
    GMRES: restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
    GMRES: happy breakdown tolerance 1e-30
  maximum iterations=2
  tolerances:  relative=6.31643e-10, absolute=1e-50, divergence=10000
  left preconditioning
  using nonzero initial guess
  using PRECONDITIONED norm type for convergence test
PC Object: 1 MPI processes
  type: none
  linear system matrix = precond matrix:
  Matrix Object:   1 MPI processes
    type: shell
    rows=1521, cols=1521





+++++ shapes:

cgwh trigHelmholtz.cmd -g=shapesBige4.order4.ng3.hdf -numPeriods=1 -nf=1 -freq=6.1 12 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=200 -upwind=1 -adjustOmega=1 -go=halt

another run: 
################ DONE KYRLOV ITERATIONS -- KSP residual=9.42e-11 (max-res=4.02e-10) (tol=1.00e-10) numberOfIterations=173 #############

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.07e-11 (max-res=4.32e-10) (tol=1.00e-10) numberOfIterations=97 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 6.1000000e+00, omegas= 6.0999360e+00 (from symbol of D+D-), dt=2.601087e-03, adjustOmega=1, upwind=1

 **** WARNING: upwinding is ON! Correcting omega for the discrete-time-symbol will not fully work to give a small residual ! *****

CgWaveHoltz::residual: freq=0, omega=6.1, max-res=4.541e-06 (using omega), max-res=7.810e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=6.100e+00, max-res=4.541e-06, CR=0.805 CR-perPeriod=0.805, cpu= 7.89e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    6.1, maxErrFreq=1.354e-04
cgwh: max-err =1.35e-04 (between WaveHoltz and known solution)
cgwh: max-diff=6.54e-06 (between WaveHoltz and Direct Helmholtz solution)



+++++++++ CIC
Np=2 ** FIX ME**
cgwh trigHelmholtz.cmd -g=cice4.order4.ng3 -numPeriods=2 -nf=1 -freq=6.1 12 -kx=.25 -ky=.25 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -upwind=1 -adjustOmega=1 -go=halt


cgwh trigHelmholtz.cmd -g=cice4.order4.ng3 -numPeriods=1 -nf=1 -freq=6.1 12 -kx=.25 -ky=.25 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=50 -upwind=1 -adjustOmega=1 -go=halt

>> KRYLOV + adjustForUpwind
 ################ DONE KYRLOV ITERATIONS -- KSP residual=4.61e-11 (max-res=1.58e-10) (tol=1.00e-10) numberOfIterations=27 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 6.1000000e+00, omegas= 6.0986434e+00 (from symbol of D+D-), dt=1.197710e-02, adjustOmega=1, upwind=1

 **** WARNING: upwinding is ON! Correcting omega for the discrete-time-symbol will not fully work to give a small residual ! *****

CgWaveHoltz::residual: freq=0, omega=6.1, max-res=1.605e-08 (using omega), max-res=1.655e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=6.100e+00, max-res=1.605e-08, CR=0.423 CR-perPeriod=0.423, cpu= 2.94e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    6.1, maxErrFreq=6.274e-08
cgwh: max-err =6.27e-08 (between WaveHoltz and known solution)
cgwh: max-diff=3.71e-09 (between WaveHoltz and Direct Helmholtz solution)




cgwh trigHelmholtz.cmd -g=cice4.order4.ng3 -numPeriods=1 -nf=1 -freq=4.5 12 -omega=4.5 -kx=.25 -ky=.25 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt

PETSC:
CgWaveHoltz::residual: freq=0, omega=4.5, max-res=5.394e-07 (using omega), max-res=4.866e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=4.500e+00, max-res=5.394e-07, CR=0.274 CR-perPeriod=0.274, cpu= 2.71e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    4.5, maxErrFreq=5.670e-07
cgwh: max-err =5.67e-07 (between WaveHoltz and known solution)
cgwh: max-diff=6.24e-07 (between WaveHoltz and Direct Helmholtz solution)



FIX-POINT: slow convergence

Not yet converged:
  >>>> cgwh: omega=4.500e+00, max-res=6.345e-06, CR=0.997 CR-perPeriod=0.997, cpu= 1.31e+02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    4.5, maxErrFreq=9.083e-06
cgwh: max-err =9.08e-06 (between WaveHoltz and known solution)
cgwh: max-diff=9.05e-06 (between WaveHoltz and Direct Helmholtz solution)


++++++++ SIC: 
cgwh trigHelmholtz.cmd -g=sice2.order4.ng3 -numPeriods=1 -nf=1 -freq=6.1 12 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt

KRYLOV:
cgwh: max-err =1.39e-04 (between WaveHoltz and known solution)
cgwh: max-diff=7.87e-05 (between WaveHoltz and Direct Helmholtz solution)


FP: 
  >>>> cgwh: omega=6.100e+00, max-res=1.036e-03, CR=0.870 CR-perPeriod=0.870, cpu= 2.72e-01(s)
getErrors: t=0.000e+00, freq=  0, omega=    6.1, maxErrFreq=1.386e-04
cgwh: max-err =1.39e-04 (between WaveHoltz and known solution)
cgwh: max-diff=7.87e-05 (between WaveHoltz and Direct Helmholtz solution)



cgwh trigHelmholtz.cmd -g=sice4.order4.ng3 -numPeriods=1 -nf=1 -freq=6.1 12 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt


PETSC **TROUBLE*** RESIDUAL STAGNATES 
CgWaveHoltz::residual: freq=0, omega=6.1, max-res=1.173e+00 (using omega), max-res=1.182e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=6.100e+00, max-res=1.173e+00, CR=0.929 CR-perPeriod=0.929, cpu= 9.87e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    6.1, maxErrFreq=2.630e-02
cgwh: max-err =2.63e-02 (between WaveHoltz and known solution)
cgwh: max-diff=2.63e-02 (between WaveHoltz and Direct Helmholtz solution)



FP: 
 >>>> cgwh: omega=6.100e+00, max-res=6.895e-08, CR=1.000 CR-perPeriod=1.000, cpu= 5.47e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    6.1, maxErrFreq=5.459e-06
cgwh: max-err =5.46e-06 (between WaveHoltz and known solution)
cgwh: max-diff=9.66e-08 (between WaveHoltz and Direct Helmholtz solution)


++++++++ RSIS
cgwh trigHelmholtz.cmd -g=rsise4.order4.ng3 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt

cgwh: max-err =8.37e-06 (between WaveHoltz and known solution)
cgwh: max-diff=1.43e-09 (between WaveHoltz and Direct Helmholtz solution)


cgwh trigHelmholtz.cmd -g=sise4.order4.ng3 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt

**NEW: with adjust-upwind
cgwh: max-err =4.38e-06 (between WaveHoltz and known solution)
cgwh: max-diff=1.43e-09 (between WaveHoltz and Direct Helmholtz solution)


**NEW**
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=2.284e-05 (using omega), max-res=1.055e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=5.100e+00, max-res=2.284e-05, CR=0.132 CR-perPeriod=0.132, cpu= 6.62e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=6.932e-06
cgwh: max-err =6.93e-06 (between WaveHoltz and known solution)
cgwh: max-diff=3.16e-06 (between WaveHoltz and Direct Helmholtz solution)


CgWaveHoltz::residual: freq=0, omega=5.1, max-res=2.467e-01 (using omega), max-res=2.541e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=5.100e+00, max-res=2.467e-01, CR=0.131 CR-perPeriod=0.131, cpu= 6.32e-01(s)

getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=7.826e-03
cgwh: max-err =7.83e-03 (between WaveHoltz and known solution)
cgwh: max-diff=7.82e-03 (between WaveHoltz and Direct Helmholtz solution)


FIX-POINT
 >>>> cgwh: omega=5.100e+00, max-res=2.287e-05, CR=0.907 CR-perPeriod=0.907, cpu= 8.43e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=6.936e-06
cgwh: max-err =6.94e-06 (between WaveHoltz and known solution)
cgwh: max-diff=3.16e-06 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Tues Jan 4, 2022

Check upwinding + waveHoltz


------- SIS -----------

cgwh trigHelmholtz.cmd -g=sise4.order4.ng3 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt

FD42u + adjust + NO-adjust-upwind **TROUBLE***

GMRES:
cgwh: max-err =7.83e-03 (between WaveHoltz and known solution)
cgwh: max-diff=7.82e-03 (between WaveHoltz and Direct Helmholtz solution)

FP: 
cgwh: max-err =6.93e-06 (between WaveHoltz and known solution)
cgwh: max-diff=3.16e-06 (between WaveHoltz and Direct Helmholtz solution)

FD42u + ADJUST-upwind  **TROUBLE**
cgwh: max-err =4.50e-02 (between WaveHoltz and known solution)
cgwh: max-diff=4.50e-02 (between WaveHoltz and Direct Helmholtz solution)

CgWaveHoltz::residual: freq=0, omega=5.1, max-res=7.318e-01 (using omega), max-res=7.235e-01 (using omega from discrete symbol)


FD42 (NO-UPWIND) + ADJUST **OK**
cgwh: max-err =4.38e-06 (between WaveHoltz and known solution)
cgwh: max-diff=3.58e-12 (between WaveHoltz and Direct Helmholtz solution)



-------- SQUARE : LOOKS OK -----

G128
cgwh trigHelmholtz.cmd -g=square128.order4.ng3 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt

FD42U : UPWIND + ADJUST-UPWIND 
cgwh: max-err =3.60e-08 (between WaveHoltz and known solution)
cgwh: max-diff=6.41e-12 (between WaveHoltz and Direct Helmholtz solution)


FD42 : FOURTH-ORDER
cgwh trigHelmholtz.cmd -g=square64.order4.ng3 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt

FD42U - NO ADJUST
cgwh: max-err =2.07e-04 (between WaveHoltz and known solution)
cgwh: max-diff=2.08e-04 (between WaveHoltz and Direct Helmholtz solution)

FD42U : UPWIND + ADJUST but no Adjust-for-upwind 
cgwh: max-err =6.52e-07 (between WaveHoltz and known solution)
cgwh: max-diff=3.07e-07 (between WaveHoltz and Direct Helmholtz solution)

FD42U : UPWIND + ADJUST-UPWIND 
cgwh: max-err =4.19e-07 (between WaveHoltz and known solution)
cgwh: max-diff=4.64e-10 (between WaveHoltz and Direct Helmholtz solution)

FD42 : NO-UPWIND ADJUST
cgwh: max-err =4.19e-07 (between WaveHoltz and known solution)
cgwh: max-diff=2.30e-12 (between WaveHoltz and Direct Helmholtz solution)

FD42 : NOU-UPWIND NO-ADJUST 
cgwh: max-err =2.08e-04 (between WaveHoltz and known solution)
cgwh: max-diff=2.08e-04 (between WaveHoltz and Direct Helmholtz solution)


++++ HARDER case kx=ky=.75

Adjust omega
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -adjustOmega=1 -go=halt

cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.75 -ky=.75 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=4 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=0 -go=halt

UPWIND + ADJUST + PETSC 
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.011e-03
cgwh: max-err =1.01e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.42e-07 (between WaveHoltz and Direct Helmholtz solution)

UPWIND + NO-ADJUST + PETSC 
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.211e-03
cgwh: max-err =1.21e-03 (between WaveHoltz and known solution)
cgwh: max-diff=4.86e-04 (between WaveHoltz and Direct Helmholtz solution)



NO UPWIND + ADJUST 
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.011e-03
cgwh: max-err =1.01e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.23e-12 (between WaveHoltz and Direct Helmholtz solution)



++++ EASY CASE : kx=ky=.5

Adjust omega
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=4 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=0 -go=halt

cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=0 -go=halt


UPWINDING + ADJUST : FIXED POINT or PETSC
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=6.316e-04
cgwh: max-err =6.32e-04 (between WaveHoltz and known solution)
cgwh: max-diff=1.57e-09 (between WaveHoltz and Direct Helmholtz solution)


NO upwinding + Adjust
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=6.316e-04
cgwh: max-err =6.32e-04 (between WaveHoltz and known solution)
cgwh: max-diff=4.47e-13 (between WaveHoltz and Direct Helmholtz solution)


Upwinding : 6 iteration 
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.623e-04
cgwh: max-err =1.62e-04 (between WaveHoltz and known solution)
cgwh: max-diff=4.69e-04 (between WaveHoltz and Direct Helmholtz solution)


NO UPWINDING : 3 iterations
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.554e-04
cgwh: max-err =2.55e-04 (between WaveHoltz and known solution)
cgwh: max-diff=8.87e-04 (between WaveHoltz and Direct Helmholtz solution)


**************************************************
**** Sun Jan 2, 2022


UPWINDING SEEMS BROKEN ??
cgwh trigHelmholtz.cmd -g=sise4.order4.ng3 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -go=halt

getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.165e-02
cgwh: max-err =1.16e-02 (between WaveHoltz and known solution)
cgwh: max-diff=1.16e-02 (between WaveHoltz and Direct Helmholtz solution)



cgwh trigHelmholtz.cmd -g=sise4.order4.ng3 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=0 -go=halt


NO UPWINDING:
cgwh: max-err =6.98e-07 (between WaveHoltz and known solution)
cgwh: max-diff=7.28e-12 (between WaveHoltz and Direct Helmholtz solution)



BROKEN: 
cgwh trigHelmholtz.cmd -g=cice2.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -go=halt

SIS -- sort of works: 
cgwh trigHelmholtz.cmd -g=sise4.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -go=halt

+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.615e-03
cgwh: max-err =1.62e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.14e-08 (between WaveHoltz and Direct Helmholtz solution)




UPWIND + CORRECTION
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -go=halt



 closer BUT --> un-vh*cos() is not zero at ghost with check, why? 
advOpt: adjust upwinding: check: maxDiff(um-vh*cos)= 0.188E-12 (no ghost)
advOpt: adjust upwinding: check: maxDiff(um-vh*cos)= 0.944E-02 (with ghost)
advOpt: adjust upwinding: check: maxDiff(un-vh*cos)= 0.161E-12 (no ghost)
advOpt: adjust upwinding: check: maxDiff(un-vh*cos)= 0.954E-02 (with ghost)


 
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -go=halt


advOpt: adjust upwinding: check: maxDiff(um-vh*cos)= 0.120E-08
advOpt: adjust upwinding: check: maxDiff(un-vh*cos)= 0.777E-09



 >>> CgWave::getErrors: numberOfFrequencies=1
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=6.316e-04
cgwh: max-err =6.32e-04 (between WaveHoltz and known solution)
cgwh: max-diff=1.14e-09 (between WaveHoltz and Direct Helmholtz solution)





**************************************************
**** Sat Jan 1, 2022

UPWIND PRE-COMPUTE uDOt

CgWaveHoltz::residual: freq=0, omega=5.1, max-res=1.409e-03 (using omega), max-res=6.969e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.100e+00, max-res=1.409e-03, CR=0.014 CR-perPeriod=0.014, cpu= 3.27e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=1
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=8.562e-04
cgwh: max-err =8.56e-04 (between WaveHoltz and known solution)
cgwh: max-diff=2.25e-04 (between WaveHoltz and Direct Helmholtz solution)


UPWIND:
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -upwind=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.66e-11 (max-res=9.38e-11) (tol=1.00e-10) numberOfIterations=6 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=1, upwind=1

 **** WARNING: upwinding is ON! Correcting omega for the discrete-time-symbol will not fully work to give a small residual ! *****

CgWaveHoltz::residual: freq=0, omega=5.1, max-res=2.615e-03 (using omega), max-res=8.174e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.100e+00, max-res=2.615e-03, CR=0.029 CR-perPeriod=0.029, cpu= 3.67e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=1
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.048e-03
cgwh: max-err =1.05e-03 (between WaveHoltz and known solution)
cgwh: max-diff=4.17e-04 (between WaveHoltz and Direct Helmholtz solution)




ADJUST OMEGA
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -go=halt


 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.62e-17 (max-res=5.88e-15) (tol=1.00e-10) numberOfIterations=3 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=1.607e-11 (using omega), max-res=5.561e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.100e+00, max-res=1.607e-11, CR=0.000 CR-perPeriod=0.000, cpu= 1.85e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=1
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=6.316e-04
cgwh: max-err =6.32e-04 (between WaveHoltz and known solution)
cgwh: max-diff=4.47e-13 (between WaveHoltz and Direct Helmholtz solution)




**************************************************
**** Fri Dec 31, 2021

Multi-freq results for proposal


cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=20 -go=halt


++++++++++++++ FOUR DISKS:

ogen -noplot diskArrayGrid -prefix=fourHollowDiskGrid -option=hollow -xa=-1.75 -xb=1.75 -ya=-1.5 -yb=1.5 -nCylx=2 -nCyly=2 -deltaX=1.25 -deltaY=1.25 -order=2 -factor=2 

ogen -noplot diskArrayGrid -prefix=fourHollowDiskGrid -option=hollow -xa=-1.75 -xb=1.75 -ya=-1.5 -yb=1.5 -nCylx=2 -nCyly=2 -deltaX=1.5 -deltaY=1.5 -order=2 -factor=2

cgwh trigHelmholtz.cmd -g=fourHollowDiskGride2.order2 -numPeriods=2 -nf=2 -freq=5.3 11.7 -omega=5.3 -kx=.25 -ky=.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-7 -tp=1000 -maxIterations=10 -go=halt


+++++++++++++++++ CIC ++++++++++++++++

cgwh trigHelmholtz.cmd -g=cicFixede4.order2 -numPeriods=2 -nf=2 -freq=5.3 11.7 -omega=5.3 -kx=.25 -ky=.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-7 -tp=1000 -maxIterations=10 -go=halt

cgwh trigHelmholtz.cmd -g=cicFixede4.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=.25 -ky=.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-7 -tp=1000 -maxIterations=100 -go=halt



+++++++++++++++++ DISK ++++++++++++++++

THREE FREQ -OK 
cgwh trigHelmholtz.cmd -g=sicFixede4.order2 -numPeriods=2 -nf=3 -freq=5.1 12 15 -omega=5.1 -kx=.5 -ky=.5 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -matlab=diskG4Freq3FP -go=halt






>> DISK + 2 frequencies
cgwh trigHelmholtz.cmd -g=sicFixede4.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -go=halt

CgWave:advance:ERROR: need to adjustOmega but numSteps*numPeriods=168  != numPlotSteps=169, numPeriods=2 *fix me Bill*


cgwh trigHelmholtz.cmd -g=sicFixede4.order4 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -go=halt


OK: 
cgwh trigHelmholtz.cmd -g=sicFixede4.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -go=halt

################ DONE KYRLOV ITERATIONS -- KSP residual=5.42e-12 (max-res=2.13e-11) (tol=1.00e-10) numberOfIterations=14 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0988252e+00 (from symbol of D+D-), dt=1.457985e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=1.233e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=3.759e-01 (using omega).
CgWaveHoltz: omega=5.100e+00, max-res=3.759e-01, CR=0.269 CR-perPeriod=0.518, cpu= 1.11e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=5.044e-02
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=5.492e-02
cgwh: max-err =5.49e-02 (between WaveHoltz and known solution)
cgwh: max-diff=5.56e-04 (between WaveHoltz and Direct Helmholtz solution)



++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++=


>>>>> Three frequencies
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np4Krylov -go=halt

Np=4 
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np4FP -go=halt



Np=2 
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np2Krylov -go=halt


cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np2FP -go=halt

 >>>> cgwh: numberOfFrequencies=3, max-res=1.432e-06, CR=0.731 CR-perPeriod=0.925, cpu= 1.08e+01(s)
CgWaveHoltz::Results saved to file squareFreq3Np4FP.m


Np=1 
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np1Krylov -go=halt


cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=3 -freq=5.1 12 15.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=100 -matlab=square64Freq3Np1FP -go=halt





>> adjust omega
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt

################ DONE KYRLOV ITERATIONS -- KSP residual=1.25e-11 (max-res=2.06e-11) (tol=1.00e-10) numberOfIterations=15 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=7.478e-10 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=9.137e-10 (using omega).
CgWaveHoltz: omega=5.100e+00, max-res=9.137e-10, CR=0.197 CR-perPeriod=0.443, cpu= 1.04e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.079e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=9.892e-03
cgwh: max-err =9.89e-03 (between WaveHoltz and known solution)
cgwh: max-diff=3.13e-12 (between WaveHoltz and Direct Helmholtz solution)




>> new:
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt

it=38:  l2Norm( v-vOld )=8.21e-11 (tol=1e-10)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =39 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=5.568e-03 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.717e-01 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=1.717e-01, CR=0.723 CR-perPeriod=0.850, cpu= 2.23e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.004e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=8.847e-03
cgwh: max-err =8.85e-03 (between WaveHoltz and known solution)
cgwh: max-diff=7.47e-05 (between WaveHoltz and Direct Helmholtz solution)



>>> OLD 
ODRER=2
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt


 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.008e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=8.870e-03
cgwh: max-err =8.87e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.08e-04 (between WaveHoltz and Direct Helmholtz solution)

*************************************************
**** Thurs Dec 16, 2021

TRY SHAPES 

shapesBige4.order4.ng3.hdf

Order=4 : trouble --> fix upwinding coefficient
cgwh trigHelmholtz.cmd -g=shapesBige4.order4.ng3.hdf -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=40 -kx=1 -ky=1 -go=halt -upwind=1


Order=2: OK
cgwh trigHelmholtz.cmd -g=shapesBige4.order2.hdf -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=40 -kx=1 -ky=1 -go=halt -upwind=1

CgWaveHoltz::residual: freq=0, omega=5.1, max-res=9.790e+00 (using omega), max-res=9.789e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=5.100e+00, max-res=9.790e+00, CR=0.447 CR-perPeriod=0.447, cpu= 2.13e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=1
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.220e-02
cgwh: max-err =1.22e-02 (between WaveHoltz and known solution)
cgwh: max-diff=1.32e-02 (between WaveHoltz and Direct Helmholtz solution)




START test RPI grid

ogen -noplot rpiGrid -interp=e -order=4 -factor=6 
ogen -noplot rpiGrid -interp=e -order=4 -factor=4 

Probably need upwinding here

cgwh trigHelmholtz.cmd -g=rpiGride6.order4 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=40 -kx=.25 -ky=.25 -go=halt -upwind=1

cgwh trigHelmholtz.cmd -g=rpiGride6.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=40 -kx=.25 -ky=.25 -go=halt

cgwh trigHelmholtz.cmd -g=rpiGride4.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=40 -go=halt


cgwh trigHelmholtz.cmd -g=sise2.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=2 -go=halt  -ksp_monitor_true_residual

solvePETSc: RHS is b: l2-norm(b)=2.383e+01, L2h-norm(b)= 5.01e-01


cgwh trigHelmholtz.cmd -g=sise2.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt


cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt

*************************************************
**** Wed Dec 15, 2021

RETURN TO WAVE-HOLTZ

SIS is broken ?? 
TROUBLE WITH CONVERGENCE CONDITION ??

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>> SIS : error is ok, residual is NOT for GMRES
cgwh trigHelmholtz.cmd -g=sise4.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt

+++++ FIXED-POINT IS OK:

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =157 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0986212e+00 (from symbol of D+D-), dt=1.579483e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=1.113e-08 (using omega), max-res=1.414e-02 (using omega from discrete symbol)

 >>>> cgwh: omega=5.100e+00, max-res=1.113e-08, CR=0.867 CR-perPeriod=0.867, cpu= 5.43e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=1
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=5.330e-03
cgwh: max-err =5.33e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.77e-09 (between WaveHoltz and Direct Helmholtz solution)




+++++++++++ GMRES TROUBLE +++++++++

ZERO IC -- RESIDUAL IS LARGE ??  


it=-3:  max(|v-vOld|)=4.11e-11, tol=1e-10

 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.39e-11 (tol=1.00e-10) numberOfIterations=1 #############


CgWaveHoltz::residual: compute residual with adjusted omegas=  5.098621222335e+00
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.098621222335e+00
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=2.894e+00 (using omega), max-res=2.900e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=5.100e+00, max-res=2.894e+00, CR=1.000 CR-perPeriod=1.000, cpu= 2.40e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m


 >>> CgWave::getErrors: numberOfFrequencies=1
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=8.130e-02
cgwh: max-err =8.13e-02 (between WaveHoltz and known solution)
cgwh: max-diff=8.35e-02 (between WaveHoltz and Direct Helmholtz solution)

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
SQUARE -- residual is small and error is small
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.099454416331e+00
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=1.396e-09 (using omega), max-res=5.569e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.100e+00, max-res=1.396e-09, CR=0.123 CR-perPeriod=0.123, cpu= 5.79e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=1
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.079e-03
cgwh: max-err =2.08e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.45e-12 (between WaveHoltz and Direct Helmholtz solution)







OK 
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=1 -nf=1 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt

 >>> CgWave::getErrors: numberOfFrequencies=1
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.079e-03
cgwh: max-err =2.08e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.45e-12 (between WaveHoltz and Direct Helmholtz solution)


*************************************************
**** Wed Nov 10, 2021

Start test of SSHMS for order=4

Get order=4 quadrature from Cassandra.


ADJUST OMEGA??
FD24 -- numPeriods=1 : OK -->< **TROUBLE** WIth numPeriods=2 *FIX ME*
cgwh trigHelmholtz.cmd -g=square64.order4 -numPeriods=1 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.80e-16 (tol=1.00e-10) numberOfIterations=4 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0995954e+00 (from symbol of D+D-), dt=8.555536e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=2.453e-11 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=2.461e-11 (using omega).
CgWaveHoltz: omega=5.100e+00, max-res=2.461e-11, CR=0.002 CR-perPeriod=0.002, cpu= 3.94e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=3.837e-06
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=6.125e-05
cgwh: max-err =6.13e-05 (between WaveHoltz and known solution)
cgwh: max-diff=4.05e-14 (between WaveHoltz and Direct Helmholtz solution)




ORDER=4
cgwh trigHelmholtz.cmd -g=square128.order4 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt

cgwh trigHelmholtz.cmd -g=square64.order4 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=4 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt


G128: LOOKS SECOND ORDER ---> USE QUADRATURE FOR "A" Matrix --> NOW ORDER 4

QUADRATURE FOR "A"
 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=9.690e-08
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=1.214e-06
cgwh: max-err =1.21e-06 (between WaveHoltz and known solution)
cgwh: max-diff=1.55e-07 (between WaveHoltz and Direct Helmholtz solution)



NO QUADRATURE FOR "A"-Matrix 
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.451e-05
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=3.016e-06
cgwh: max-err =1.45e-05 (between WaveHoltz and known solution)
cgwh: max-diff=1.45e-05 (between WaveHoltz and Direct Helmholtz solution)


G128: Error in direct solve
cgwh: max-err =3.70e-06 (between WaveHoltz and known solution)


G64: USE QUAD
 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.469e-06
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=2.393e-05
cgwh: max-err =2.39e-05 (between WaveHoltz and known solution)
cgwh: max-diff=2.38e-06 (between WaveHoltz and Direct Helmholtz solution)


G64: NO QUAD FOR "A"
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=5.815e-05
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=2.694e-05
cgwh: max-err =5.81e-05 (between WaveHoltz and known solution)
cgwh: max-diff=5.79e-05 (between WaveHoltz and Direct Helmholtz solution)

G64: error in direct solve
cgwh: max-err =6.13e-05 (between WaveHoltz and known solution)



ODRER=2
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -go=halt


 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.008e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=8.870e-03
cgwh: max-err =8.87e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.08e-04 (between WaveHoltz and Direct Helmholtz solution)

*************************************************
**** Tues Nov 2, 2021

CONTINUE ON ADJUST OMEGA -- MULTI-FREQ

G128
cgwh trigHelmholtz.cmd -g=square128.order2 -numPeriods=4 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -matlab=square64TwoFreqFixedPointNp4 -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =11 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0998636e+00 (from symbol of D+D-), dt=4.967730e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=9.453e-10 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.363e-09 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=1.363e-09, CR=0.109 CR-perPeriod=0.575, cpu= 8.49e+00(s)
CgWaveHoltz::Results saved to file square64TwoFreqFixedPointNp4.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=5.206e-04
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=2.467e-03
cgwh: max-err =2.47e-03 (between WaveHoltz and known solution)
cgwh: max-diff=6.43e-12 (between WaveHoltz and Direct Helmholtz solution)




MORE PERIODS --> WORKS WITH ADJUST-OMEGA
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -matlab=square64TwoFreqFixedPointNp4 -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =11 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=1.554e-09 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=2.007e-09 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=2.007e-09, CR=0.115 CR-perPeriod=0.582, cpu= 1.82e+00(s)
CgWaveHoltz::Results saved to file square64TwoFreqFixedPointNp4.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.079e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=9.892e-03
cgwh: max-err =9.89e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.10e-11 (between WaveHoltz and Direct Helmholtz solution)



FIXED:
 >>>>>>>>>>>>> CgWave:advance solve a Helmholz Problem <<<<<<<<<<<<<<<<<<<
 dt=  9.934397769878e-03, omega=  5.100545642041e+00,  tFinal=  4.927461293859e+00
 freq=0 frequency=  5.100545642041e+00 period=  4.927461293859e+00, numberOfPeriods=4
 freq=1 frequency=  1.200711722766e+01 period=  4.186307296279e+00, numberOfPeriods=8
 nextTimeToPlot=4.928e+00, numPlotSteps=496, new dt=9.934e-03 (dtMax=9.944e-03)
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<



DEBUG: 

 >>>>>>>>>>>>> CgWave:advance solve a Helmholz Problem <<<<<<<<<<<<<<<<<<<
 dt=  9.934397769878e-03, omega=  5.100545642041e+00, omegas=  5.100545642041e+00, tFinal=  4.927461293859e+00
 freq=0 frequency=  5.100545642041e+00 period=  4.927461293859e+00
 freq=1 frequency=  1.200711722766e+01 period=  2.093153648140e+00
 nextTimeToPlot=4.928e+00, numPlotSteps=496, new dt=9.934e-03 (dtMax=9.944e-03)
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


  >>>>>>>>>>>>> CgWave:advance solve a Helmholz Problem <<<<<<<<<<<<<<<<<<<
 dt=  9.934397072676e-03, omega=  5.100546000000e+00,  tFinal=  4.927460948047e+00
 freq=0 frequency=  5.100546000000e+00 period=  4.927460948047e+00
 freq=1 frequency=  1.200712000000e+01 period=  4.186306329697e+00
 nextTimeToPlot=4.927e+00, numPlotSteps=496, new dt=9.934e-03 (dtMax=9.944e-03)
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<




MORE PERIODS (** TURN OFF ADJUST : BROKEN ***)
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -matlab=square64TwoFreqFixedPointNp4 -go=halt

run directly with adjusted omega and no adjust : fast
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=2 -freq=5.100546 12.00712 -omega=5.100546 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -matlab=square64TwoFreqFixedPointNp4 -go=halt

+++++++ ADJUST:  **** SLOWER CONVERGENCE ***  WHY????

#### CgWave::advance: freq=0 omega=  5.100000e+00 omegaAdjusted=  5.100546e+00
#### CgWave::advance: freq=1 omega=  1.200000e+01 omegaAdjusted=  1.200712e+01


#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =45 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=4.357e-08 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.320e-07 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=1.320e-07, CR=0.600 CR-perPeriod=0.880, cpu= 7.18e+00(s)
CgWaveHoltz::Results saved to file square64TwoFreqFixedPointNp4.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.079e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=9.892e-03
cgwh: max-err =9.89e-03 (between WaveHoltz and known solution)
cgwh: max-diff=4.27e-10 (between WaveHoltz and Direct Helmholtz solution)




++++++++ NO ADJUST 
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =11 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=1.142e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.717e-01 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=1.717e-01, CR=0.117 CR-perPeriod=0.585, cpu= 1.90e+00(s)
CgWaveHoltz::Results saved to file square64TwoFreqFixedPointNp4.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.007e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=8.846e-03
cgwh: max-err =8.85e-03 (between WaveHoltz and known solution)
cgwh: max-diff=7.68e-05 (between WaveHoltz and Direct Helmholtz solution)



*************************************************
**** Tues Nov 2, 2021

CONTINUE ON ADJUST OMEGA -- MULTI_FREQ


MORE PERIODS KRYLOV (** TURN OFF ADJUST : BROKEN ***)
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -matlab=square64TwoFreqKrylovNp4 -go=halt



MORE PERIODS (** TURN OFF ADJUST : BROKEN ***)
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=4 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-10 -tp=1000 -maxIterations=400 -matlab=square64TwoFreqFixedPointNp4 -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =11 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=1.142e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.717e-01 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=1.717e-01, CR=0.117 CR-perPeriod=0.585, cpu= 1.80e+00(s)
CgWaveHoltz::Results saved to file square64TwoFreqFixedPointNp4.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.007e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=8.846e-03
cgwh: max-err =8.85e-03 (between WaveHoltz and known solution)
cgwh: max-diff=7.68e-05 (between WaveHoltz and Direct Helmholtz solution)





TRY more periods -- seems to work
cgwh trigHelmholtz.cmd -g=square64.order2 -numPeriods=2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=1000 -matlab=square64TwoFreqKrylov -go=halt



>>>> ADJUST omega, use quadrature for beta-function : *** NOW EXACT MATCH ****

cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=1000 -matlab=square64TwoFreqKrylov -go=halt

getMultiFrequencyWaveHoltzMatrix: A(0,0)=    1.0000e+00 (exact)   =     1.0000e+00 (quadrature)  diff=0.00e+00
getMultiFrequencyWaveHoltzMatrix: A(1,0)=   -1.6036e-01 (exact)   =    -1.6041e-01 (quadrature)  diff=5.11e-05
getMultiFrequencyWaveHoltzMatrix: A(0,1)=    1.0412e-01 (exact)   =     1.0402e-01 (quadrature)  diff=9.55e-05
getMultiFrequencyWaveHoltzMatrix: A(1,1)=    1.0000e+00 (exact)   =     9.9999e-01 (quadrature)  diff=6.07e-06

getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.079e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=9.892e-03
cgwh: max-err =9.89e-03 (between WaveHoltz and known solution)
cgwh: max-diff=3.85e-14 (between WaveHoltz and Direct Helmholtz solution)



%%%%%%%%% adjust-omega but NO quadrature for beta: 
 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.151e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=1.044e-02
cgwh: max-err =1.04e-02 (between WaveHoltz and known solution)
cgwh: max-diff=1.37e-04 (between WaveHoltz and Direct Helmholtz solution)

*************************************************
**** Mon Nov 1, 2021

START ON ADJUST OMEGA -- MULTI_FREQ


>>>> ADJUST
cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=1000 -matlab=square64TwoFreqKrylov -go=halt



>>> NO ADJUST 
cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=1000 -matlab=square64TwoFreqKrylov -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.00e-09 (tol=1.00e-08) numberOfIterations=14 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=4.265e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.735e-01 (using omega).
CgWaveHoltz: omega=5.100e+00, max-res=1.735e-01, CR=0.311 CR-perPeriod=0.311, cpu= 7.49e-01(s)
CgWaveHoltz::Results saved to file square64TwoFreqKrylov.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.033e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=9.213e-03
cgwh: max-err =9.21e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.52e-04 (between WaveHoltz and Direct Helmholtz solution)



*************************************************
**** Sun Oct 31, 2021

CONTINUE ON MULTI-FREQ 

eigs for a square: pi*sqrt( z )  z=2,5,8,10,13

pi*sqrt(3.5)=5.88
pi*sqrt(11.5)10.65


CHANGES FOR PETSC:
cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=1000 -matlab=square64TwoFreqKrylov -go=halt


 ################ DONE KYRLOV ITERATIONS -- KSP residual=7.08e-10 (tol=1.00e-08) numberOfIterations=17 #############

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=4.265e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.735e-01 (using omega).
CgWaveHoltz: omega=5.100e+00, max-res=1.735e-01, CR=0.294 CR-perPeriod=0.294, cpu= 9.02e-01(s)
CgWaveHoltz::Results saved to file square64TwoFreqKrylov.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.033e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=9.213e-03
cgwh: max-err =9.21e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.52e-04 (between WaveHoltz and Direct Helmholtz solution)


FIXED POINT
cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=1000 -matlab=square64TwoFreqFixedPoint -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =265 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=4.265e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=1.733e-01 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=1.733e-01, CR=0.934 CR-perPeriod=0.934, cpu= 1.11e+01(s)
CgWaveHoltz::Results saved to file square64TwoFreqFixedPoint.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=2.032e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=9.207e-03
cgwh: max-err =9.21e-03 (between WaveHoltz and known solution)
cgwh: max-diff=1.51e-04 (between WaveHoltz and Direct Helmholtz solution)





cgwh trigHelmholtz.cmd -g=square32.order2 -nf=2 -freq=5.1 12 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=1000 -matlab=square32TwoFreqFixedPoint -go=halt


#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =265 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0978179e+00 (from symbol of D+D-), dt=1.987092e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=1.688e-01 (using omega).
CgWaveHoltz::residual: freq=1, omega=12, max-res=7.205e-01 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=7.205e-01, CR=0.934 CR-perPeriod=0.934, cpu= 4.12e+00(s)
CgWaveHoltz::Results saved to file square64TwoFreqFixedPoint.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=8.113e-03
getErrors: t=0.000e+00, freq=  1, omega=     12, maxErrFreq=3.724e-02
cgwh: max-err =3.72e-02 (between WaveHoltz and known solution)
cgwh: max-diff=6.00e-04 (between WaveHoltz and Direct Helmholtz solution)



CHANGE SOLUTION -- NOT A EIGENFUNCTION
cgwh trigHelmholtz.cmd -g=square32.order2 -nf=2 -freq=5.1 11.5 -omega=5.1 -kx=1.25 -ky=1.25 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=1000 -matlab=square64TwoFreqFixedPoint -go=halt



it=978:  l2Norm( v-vOld )=9.97e-09 (tol=1e-08)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =979 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0978179e+00 (from symbol of D+D-), dt=1.987092e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=2.019e-01 (using omega).
CgWaveHoltz::residual: freq=1, omega=11.5, max-res=6.099e-01 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=6.099e-01, CR=0.982 CR-perPeriod=0.982, cpu= 1.52e+01(s)
CgWaveHoltz::Results saved to file square64TwoFreqFixedPoint.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=8.065e-03
getErrors: t=0.000e+00, freq=  1, omega=   11.5, maxErrFreq=5.952e-02
cgwh: max-err =5.95e-02 (between WaveHoltz and known solution)
cgwh: max-diff=7.41e-04 (between WaveHoltz and Direct Helmholtz solution)




cgwh trigHelmholtz.cmd -g=square32.order2 -nf=2 -freq=5.1 11.5 -omega=5.1 -kx=1 -ky=1 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=200 -matlab=square64TwoFreqFixedPoint -go=halt



FIX WAVE HOLTZ FOR NON-HOMOGENEOUS BCS 
cgwh trigHelmholtz.cmd -g=square32.order2 -nf=1 -freq=5.9 10.7 -omega=5.9 -kx=1.25 -ky=2 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=100 -matlab=square64TwoFreqFixedPoint -go=halt

cgwh trigHelmholtz.cmd -g=square16.order2 -nf=1 -freq=5.9 10.7 -omega=5.9 -kx=1.25 -ky=2 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=1 -matlab=square64TwoFreqFixedPoint -go=halt




*************************************************
**** Sat Oct 30, 2021

CONTINUE ON MULTI-FREQ -->  starts to work!

++++++ G64 CHANGE omega1 -- compare to theory (plotConvergence.m in waho/codes)
cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=5.1 11.5 -omega=5.1 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=200 -matlab=square64TwoFreqFixedPoint -go=halt

+++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.1000000e+00, omegas= 5.0994544e+00 (from symbol of D+D-), dt=9.935461e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.1, max-res=3.932e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=11.5, max-res=1.919e-01 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=1.919e-01, CR=0.931 CR-perPeriod=0.931, cpu= 7.03e+00(s)
CgWaveHoltz::Results saved to file square64TwoFreqFixedPoint.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=    5.1, maxErrFreq=1.116e-03
getErrors: t=0.000e+00, freq=  1, omega=   11.5, maxErrFreq=1.816e-02
cgwh: max-err =1.82e-02 (between WaveHoltz and known solution)
cgwh: max-diff=2.11e-04 (between WaveHoltz and Direct Helmholtz solution)
plot contours...



cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=3.9 11.22 -omega=3.9 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=2000 -matlab=square64TwoFreqFixedPoint -go=halt


cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=5 11.22 -omega=5 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=2000 -matlab=square64TwoFreqFixedPoint -go=halt


CHANGE SOLUTIONS TO BE DIFFERENT FOR DIFFERENT FREQs
++++++ G64
cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=4.11 11.22 -omega=4.11 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=2000 -matlab=square64TwoFreqFixedPoint -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =290 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 4.1100000e+00, omegas= 4.1097149e+00 (from symbol of D+D-), dt=9.926984e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=4.11, max-res=2.958e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=11.22, max-res=1.694e-01 (using omega).

 >>>> cgwh: numberOfFrequencies=2, max-res=1.694e-01, CR=0.940 CR-perPeriod=0.940, cpu= 1.25e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=   4.11, maxErrFreq=1.009e-03
getErrors: t=0.000e+00, freq=  1, omega=   11.2, maxErrFreq=2.471e-02
cgwh: max-err =2.47e-02 (between WaveHoltz and known solution)
cgwh: max-diff=1.12e-04 (between WaveHoltz and Direct Helmholtz solution)


+++++++ G32
cgwh trigHelmholtz.cmd -g=square32.order2 -nf=2 -freq=4.11 11.22 -omega=4.11 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=2000 -go=halt



+++++++ G64
cgwh trigHelmholtz.cmd -g=square64.order2 -nf=2 -freq=4.11 11.22 -omega=4.11 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=2000 -go=halt

cgWave:FD22 t=1.529e+00 (154 steps) dt=9.927e-03 ||u||= 1.00e+00, cpu= 4.21e-02(s)
it=289:  l2Norm( v-vOld )=9.87e-09 (tol=1e-08)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =290 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 4.1100000e+00, omegas= 4.1097149e+00 (from symbol of D+D-), dt=9.926984e-03, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=4.11, max-res=6.035e-03 (using omega).
CgWaveHoltz::residual: freq=1, omega=11.22, max-res=1.753e-01 (using omega).
CgWaveHoltz: omega=4.110e+00, max-res=1.753e-01, CR=0.940 CR-perPeriod=0.940, cpu= 1.25e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=   4.11, maxErrFreq=1.111e-03
getErrors: t=0.000e+00, freq=  1, omega=   11.2, maxErrFreq=2.352e-02
cgwh: max-err =2.35e-02 (between WaveHoltz and known solution)
cgwh: max-diff=8.92e-05 (between WaveHoltz and Direct Helmholtz solution)


+++++++ G32
cgwh trigHelmholtz.cmd -g=square32.order2 -nf=2 -freq=4.11 11.22 -omega=4.11 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-8 -tp=1000 -maxIterations=2000 -go=halt


getMultiFrequencyWaveHoltzMatrix: A:
[ (0,0)   1.0000e+00,  (0,1)  -1.0468e-01, ]
[ (1,0)   1.7491e-01,  (1,1)   1.0000e+00, ]
cgWave:FD22 t=1.529e+00 (77 steps) dt=1.985e-02 ||u||= 1.00e+00, cpu= 1.27e-02(s)
it=276:  l2Norm( v-vOld )=9.81e-09 (tol=1e-08)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =277 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 4.1100000e+00, omegas= 4.1088598e+00 (from symbol of D+D-), dt=1.985397e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=4.11, max-res=2.078e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=11.22, max-res=5.475e-01 (using omega).
CgWaveHoltz: omega=4.110e+00, max-res=5.475e-01, CR=0.937 CR-perPeriod=0.937, cpu= 3.89e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=   4.11, maxErrFreq=4.429e-03
getErrors: t=0.000e+00, freq=  1, omega=   11.2, maxErrFreq=1.724e-02
cgwh: max-err =1.72e-02 (between WaveHoltz and known solution)
cgwh: max-diff=3.30e-04 (between WaveHoltz and Direct Helmholtz solution)




++++++ converges slowly 
cgwh trigHelmholtz.cmd -g=square16.order2 -nf=2 -freq=4.11 11.22 -omega=4.11 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=200 -go=halt

cgWave:FD22 t=3.058e+00 (77 steps) dt=3.971e-02 ||u||= 1.02e+00, cpu= 1.04e-02(s)
it=921:  l2Norm( v-vOld )=9.96e-13 (tol=1e-12)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =922 #########################

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 4.1100000e+00, omegas= 4.1054404e+00 (from symbol of D+D-), dt=3.970794e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=4.11, max-res=5.047e-02 (using omega).
CgWaveHoltz::residual: freq=1, omega=11.22, max-res=2.115e+00 (using omega).
CgWaveHoltz: omega=4.110e+00, max-res=2.115e+00, CR=0.986 CR-perPeriod=0.993, cpu= 1.01e+01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m

 >>> CgWave::getErrors: numberOfFrequencies=2
+++++++++++ getErrors for userDefinedKnownSolution +++++++++++
getErrors: t=0.000e+00, freq=  0, omega=   4.11, maxErrFreq=1.571e-02
getErrors: t=0.000e+00, freq=  1, omega=   11.2, maxErrFreq=2.307e-02
cgwh: max-err =2.31e-02 (between WaveHoltz and known solution)
cgwh: max-diff=8.27e-04 (between WaveHoltz and Direct Helmholtz solution)



>>>>>>>>>>>>>>>>>>>> MATLAB CODE RESULTS <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Revisit multi-frequency waveHoltz for cgWaveHoltz

waveHoltz -ms=multiFreq -N0=200 -useFixPoint=1 -numFreq=2 -numFPI=30 -omega1=4.11 -kx1=11.57 -omega2=11.22 -kx2=15.23 -adjustOmega=0

----- implicit=0 adjustOmega=0 useDiscreteBetaFunction=0 ----
 i=1: omega= 4.110e+00, numPer= 1, Tbar= 1.529e+00, kx= 3.635e+01
 i=2: omega= 1.122e+01, numPer= 2, Tbar= 1.120e+00, kx= 4.785e+01
Solve the second-order wave equation equation, CFL=0.90.
getIntegrationWeights: Nt=340, dt=4.496e-03
getIntegrationWeights: freq i=2 T=1.120e+00, im=250, dt1/dt=9.091e-02, wim/dt=5.868e-01 wip/dt=4.132e-03
getIntegrationWeights: freq i=1, T=1.529e+00, error in integral(1+1*t) = 4.44e-16
getIntegrationWeights: freq i=2, T=1.120e+00, error in integral(1+1*t) = 2.22e-16
---- getMultiFrequencyWaveHoltzMatrix -----

A =

    1.0000   -0.1047
    0.1749    1.0000


 ============== START FIX-POINT ITERATION 1 (numFixPointIterations=1) ==============
 fix-point it=10, i=1: max | vkp1 - vk | = 1.15e-04 (Nx=200) rate=0.7034
 fix-point it=10, i=2: max | vkp1 - vk | = 5.87e-04 (Nx=200) rate=0.7350
 fix-point it=20, i=1: max | vkp1 - vk | = 4.99e-06 (Nx=200) rate=0.7442
 fix-point it=20, i=2: max | vkp1 - vk | = 3.13e-05 (Nx=200) rate=0.7501
 fix-point it=30, i=1: max | vkp1 - vk | = 2.77e-07 (Nx=200) rate=0.7508
 fix-point it=30, i=2: max | vkp1 - vk | = 1.79e-06 (Nx=200) rate=0.7517

 ---- FIXED-POINT ERRORS, numFreq=2, imp=0, cfl=0.9, Nt=340 adjustOmega=0---- 
 fix-point i=1: max | vk - vHelmholtz | = 1.95e-05 (Nx=200)
 fix-point i=2: max | vk - vHelmholtz | = 2.99e-05 (Nx=200)

 freq i=1: Nx=200, equation-residual( omegaSymbol^2 v + c^2 L_h v + f) = 4.339e-02 (max-norm)
 freq i=2: Nx=200, equation-residual( omegaSymbol^2 v + c^2 L_h v + f) = 1.668e-02 (max-norm)
>> average-CR=0.6427, estimated-CR=0.7462
>> 



**************************************************
**** Fri Oct 29, 2021

CONTINUE ON MULTI-FREQ

START TEST TWO FREQ
cgwh trigHelmholtz.cmd -g=square16.order2 -nf=2 -freq=5.4 11.3 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt

getIntegrationWeights: freq i=1 T=5.560e-01, im=14, dt1/dt=3.363e-01, wim/dt=7.797e-01 wip/dt=5.654e-02
getIntegrationWeights: freq i=0, T=1.164e+00, error in integral(1+1*t) = 0.00e+00
getIntegrationWeights: freq i=1, T=5.560e-01, error in integral(1+1*t) = 1.11e-16
cgWave:FD22 t=0.000e+00 ( 0 steps) dt=3.879e-02 ||u||= 1.00e+00, cpu= 1.00e-06(s)
Skip first step since set to exact
advWave: numberOfFrequencies=     2 omega=  5.4000E+00 frequencyArray(0)=  5.4000E+00
 getMultiFrequencyWaveHoltzMatrix 
    (        0) (        1) 
(0)  1.0000e+00 -5.0388e-02 
(1)  8.7428e-02  1.0000e+00 




TEST DIRECT SOLVE 2 freq
cgwh trigHelmholtz.cmd -g=square32.order2 -nf=3 -freq=5.4 21 55.9 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt

cgwh trigHelmholtz.cmd -g=square32.order2 -nf=2 -freq=5.4 55.9 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt

 +++++ ENTERING CgWaveHoltz::residual +++++ 
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974054e+00 (from symbol of D+D-), dt=1.988738e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: freq=0, omega=5.4, max-res=3.027e-12 (using omega).
CgWaveHoltz::residual: freq=1, omega=55.9, max-res=8.049e-11 (using omega).
CgWaveHoltz: omega=5.400e+00, max-res=8.049e-11 (direct Helmholtz solution)

 >>> CgWave::getErrors: numberOfFrequencies=2
getErrors: t=0.000e+00, freq=0, omega=5.4, maxErrFreq=5.114e-03
getErrors: t=0.000e+00, freq=1, omega=55.9, maxErrFreq=8.317e-05
CgWaveHoltz: max-err =5.11e-03 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=0.00e+00 (between WaveHoltz and Direct Helmholtz solution)



cgwh trigHelmholtz.cmd -g=square32.order2 -nf=2 -freq=5.4 5.4 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt


cgwh trigHelmholtz.cmd -g=square32.order2 -nf=1 -freq=5.4 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.40e-17 (tol=1.00e-12) numberOfIterations=3 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974486e+00 (from symbol of D+D-), dt=1.972123e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.397448611087e+00
CgWaveHoltz::residual: max-res=2.767e-02 (using omega), max-res=2.579e-12 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.767e-02, CR=0.000 CR-perPeriod=0.000, cpu= 7.01e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =4.55e-03 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=5.59e-04 (between WaveHoltz and Direct Helmholtz solution)



**************************************************
**** Wed/Thurs Oct 27/28, 2021

CONTINUE ON MULTI-FREQ

NO-ADJUST omega
cgwh trigHelmholtz.cmd -g=square32.order2 -nf=1 -freq=5.4 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt


 ################ DONE KYRLOV ITERATIONS -- KSP residual=8.22e-17 (tol=1.00e-12) numberOfIterations=3 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974486e+00 (from symbol of D+D-), dt=1.972123e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.397448611087e+00
CgWaveHoltz::residual: max-res=2.767e-02 (using omega), max-res=3.027e-12 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.767e-02, CR=0.000 CR-perPeriod=0.000, cpu= 6.01e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =4.55e-03 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=5.59e-04 (between WaveHoltz and Direct Helmholtz solution)

**************************************************
**** Wed Oct 27, 2021

Revisit CG WAVEHOLTZ -- start on multi-frequency algorithm

cgwh trigHelmholtz.cmd -g=square32.order2 -nf=1 -freq=5.4 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt


cgwh trigHelmholtz.cmd -g=square32.order2 -nf=2 -freq=7.1 9.2 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt



EXPLICIT
cgwh trigHelmholtz.cmd -g=square32.order2 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.89e-16 (tol=1.00e-12) numberOfIterations=2 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974486e+00 (from symbol of D+D-), dt=1.972123e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.397448611087e+00
CgWaveHoltz::residual: max-res=2.750e-12 (using omega), max-res=2.769e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.750e-12, CR=0.000 CR-perPeriod=0.000, cpu= 4.62e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =5.11e-03 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=2.44e-15 (between WaveHoltz and Direct Helmholtz solution)

Random IC: 
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =100 #########################
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974486e+00 (from symbol of D+D-), dt=1.972123e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.397448611087e+00
CgWaveHoltz::residual: max-res=4.910e-10 (using omega), max-res=2.769e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=4.910e-10, CR=0.773 CR-perPeriod=0.773, cpu= 9.22e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =5.11e-03 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=5.20e-11 (between WaveHoltz and Direct Helmholtz solution)




**************************************************
**** Mon Aug 9, 2021

cgwh trigHelmholtz.cmd -g=square128.order4 -kx=4 -ky=4 -omega=20.567 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=1000 -cfl=10 -go=halt


 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.74e-15 (tol=1.00e-14) numberOfIterations=1 #############
CgWaveHoltz::residual: c=1, omega= 2.0567000e+01, omegas= 1.9883484e+01 (from symbol of D+D-), dt=4.364263e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  1.988348424664e+01
CgWaveHoltz::residual: max-res=8.642e-10 (using omega), max-res=2.765e+01 (using omega from discrete symbol)
CgWaveHoltz: omega=2.057e+01, max-res=8.642e-10, CR=1.000 CR-perPeriod=1.000, cpu= 1.30e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =2.86e-05 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=3.26e-11 (between WaveHoltz and Direct Helmholtz solution)





cgwh trigHelmholtz.cmd -g=square256.order4 -omega=5.4 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -cfl=80 -go=halt

CgWave::advance: c=1, omega=4.41049, Tperiod=1.4246, numPeriods=1, tFinal=1.4246, plotOptions=0
takeFirstStep: setting  u(dt) = u(0)*cos(omega*(dt)) , dt=  2.035143011071e-01
cgWave:FD24 t=0.000e+00 (0 steps) dt=2.035e-01 maxErr= 5.71e-09, ||u||= 1.00e+00, cpu= 5.05e-03(s)
advWave: ADVANCE IMPLICIT dim=2 order=4 orderInTime=2, grid=rectangular... t=  0.20E+00
cgWave:FD24 t=1.221e+00 (6 steps) dt=2.035e-01 maxErr= 3.29e-01, ||u||= 6.23e-01, cpu= 1.24e-01(s)
cgWave:FD24 t=1.425e+00 (7 steps) dt=2.035e-01 maxErr= 8.40e-01, ||u||= 1.00e+00, cpu= 1.52e-01(s)
it=-3:  max(|v-vOld|)=2.12e-12, tol=1e-12

 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.73e-13 (tol=1.00e-12) numberOfIterations=18 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.2205385e+00 (from symbol of D+D-), dt=1.662218e-01, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.220538480666e+00
CgWaveHoltz::residual: max-res=6.872e-09 (using omega), max-res=1.906e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=6.872e-09, CR=0.206 CR-perPeriod=0.206, cpu= 7.44e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =5.71e-09 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=3.65e-12 (between WaveHoltz and Direct Helmholtz solution)



**************************************************
**** Sun Aug 8, 2021

START ON ADJUST OMEGA FOR IMPLICIT

BUG FOUND -- takeFirstStep -- NO BC's were set 

cgwh trigHelmholtz.cmd -g=square64.order4 -omega=5.4 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -cfl=1 -go=halt


>> cfl=10 - 12 steps
 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.07e-15 (tol=1.00e-12) numberOfIterations=1 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3475932e+00 (from symbol of D+D-), dt=8.950406e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.347593238668e+00
CgWaveHoltz::residual: max-res=2.132e-11 (using omega), max-res=5.632e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.132e-11, CR=1.000 CR-perPeriod=1.000, cpu= 1.12e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =9.86e-07 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=2.15e-14 (between WaveHoltz and Direct Helmholtz solution)


>>> cfl=1
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.29e-13 (tol=1.00e-12) numberOfIterations=13 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3994032e+00 (from symbol of D+D-), dt=9.537318e-03, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.399403228335e+00
CgWaveHoltz::residual: max-res=2.984e-11 (using omega), max-res=6.445e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.984e-11, CR=0.104 CR-perPeriod=0.104, cpu= 1.49e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =9.86e-07 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=1.20e-13 (between WaveHoltz and Direct Helmholtz solution)



+++++++++++   USE DISCRETE HELMHOLTZ AS THE KNOWN SOLUTION


cgwh trigHelmholtz.cmd -g=square16.order4 -omega=5.4 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -known=computedHelmholtz -cfl=1 -go=halt

ORDER=2 works
cgwh trigHelmholtz.cmd -g=square16.order2 -omega=5.4 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -known=computedHelmholtz -cfl=1 -go=halt


cgwh trigHelmholtz.cmd -g=square64.order2 -omega=5.4 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -known=computedHelmholtz -cfl=10 -go=halt


 ################ DONE KYRLOV ITERATIONS -- KSP residual=4.05e-13 (tol=1.00e-12) numberOfIterations=16 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3268885e+00 (from symbol of D+D-), dt=1.057775e-01, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.326888531286e+00
CgWaveHoltz::residual: max-res=1.327e-10 (using omega), max-res=7.853e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=1.327e-10, CR=0.172 CR-perPeriod=0.172, cpu= 1.08e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =6.58e-13 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=6.58e-13 (between WaveHoltz and Direct Helmholtz solution)


FOR NOW WE NEED IMPLICIT WEIGHTS OF .5 0 .5 (default is .25 .5 .25 ) --> NEED beta2=0

IMPLICIT ORDER=4 --> NOT EXCAT
cgwh trigHelmholtz.cmd -g=square64.order4 -omega=5.4 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -cfl=10 -go=halt


>>>> SET implicit time-step based on CFL --> WORKS with 8 time-steps
cgwh trigHelmholtz.cmd -g=square64.order2 -omega=5.4 -ts=implicit -beta2=0 -dtMax=100 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -cfl=15 -go=halt

cgWave:FD22 t=1.348e+00 (8 steps) dt=1.686e-01 maxErr= 4.60e-01, ||u||= 1.00e+00, cpu= 5.15e-03(s)
it=-3:  max(|v-vOld|)=6.66e-15, tol=1e-12

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.50e-15 (tol=1.00e-12) numberOfIterations=2 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.2622749e+00 (from symbol of D+D-), dt=1.454441e-01, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.262274935384e+00
CgWaveHoltz::residual: max-res=7.404e-12 (using omega), max-res=1.470e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=7.404e-12, CR=0.000 CR-perPeriod=0.000, cpu= 3.12e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =1.27e-03 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=2.33e-14 (between WaveHoltz and Direct Helmholtz solution)



cgwh trigHelmholtz.cmd -g=square32.order2 -omega=5.4 -ts=implicit -beta2=0 -dtMax=.1 -adjustOmega=1 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt

>>>> ADJUST:
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.40e-13 (tol=1.00e-12) numberOfIterations=16 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3385260e+00 (from symbol of D+D-), dt=9.696274e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.338526019113e+00
CgWaveHoltz::residual: max-res=2.771e-11 (using omega), max-res=6.635e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.771e-11, CR=0.162 CR-perPeriod=0.162, cpu= 8.06e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =5.11e-03 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=7.84e-14 (between WaveHoltz and Direct Helmholtz solution)


>>> NO ADJUST
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.31e-15 (tol=1.00e-12) numberOfIterations=3 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3385260e+00 (from symbol of D+D-), dt=9.696274e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.338526019113e+00
CgWaveHoltz::residual: max-res=1.433e+00 (using omega), max-res=2.116e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=1.433e+00, CR=0.000 CR-perPeriod=0.000, cpu= 2.32e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =3.40e-02 (between WaveHoltz and known solution)


**************************************************
**** Tues July 27, 2021

>>>> TEST IMPLICIT

IMPLICIT:
cgwh trigHelmholtz.cmd -g=square32.order2 -omega=5.4 -ts=implicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.31e-15 (tol=1.00e-12) numberOfIterations=3 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3385260e+00 (from symbol of D+D-), dt=9.696274e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.338526019113e+00
CgWaveHoltz::residual: max-res=1.433e+00 (using omega), max-res=2.116e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=1.433e+00, CR=0.000 CR-perPeriod=0.000, cpu= 3.10e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =3.40e-02 (between WaveHoltz and known solution)




EXPLICIT
cgwh trigHelmholtz.cmd -g=square32.order2 -omega=5.4 -ts=explicit -dtMax=.1 -adjustOmega=0 -orderInTime=2 -solver=none -tol=1e-12 -tp=1000 -maxIterations=100 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.20e-15 (tol=1.00e-12) numberOfIterations=2 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974486e+00 (from symbol of D+D-), dt=1.972123e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.397448611087e+00
CgWaveHoltz::residual: max-res=2.767e-02 (using omega), max-res=3.759e-12 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.767e-02, CR=0.000 CR-perPeriod=0.000, cpu= 4.57e-02(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =4.55e-03 (between WaveHoltz and known solution)


Run for checks: 

cgwh -noplot trigHelmholtz.cmd -g=square16.order4.ng3.hdf -omega=5.4 -adjustOmega=1 -orderInTime=2 -solver=fixedPoint -matlab=junk -tol=1e-12 -tp=1000 -maxIterations=100 -go=go

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =17 #########################
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3923193e+00 (from symbol of D+D-), dt=3.422214e-02, adjustOmega=1, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.392319331440e+00
CgWaveHoltz::residual: max-res=3.347e-12 (using omega), max-res=8.288e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=3.347e-12, CR=0.186 CR-perPeriod=0.186, cpu= 8.82e-02(s)
CgWaveHoltz::Results saved to file junk.m
CgWaveHoltz: max-err =5.32e-04 (between WaveHoltz and known solution)


**************************************************
**** Mon July 26, 2021

ORDER=4: adjustOmega=1 and UPWIND
cgwh trigHelmholtz.cmd -g=square32.order4.ng3.hdf -omega=5.4 -adjustOmega=1 -orderInTime=2 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -upwind=1 -imode=1 -debug=3 -maxIterations=100 -go=halt

CgWaveHoltz::residual: compute residual with adjusted omegas=  5.398079217984e+00
CgWaveHoltz::residual: max-res=1.173e-04 (using omega), max-res=2.068e-02 (using omega from discrete symbol)
CgWaveHoltz: max-err =2.10e-05 (between WaveHoltz and known solution)

NO-UPWIND: 
CgWaveHoltz::residual: max-res=7.561e-11 (using omega), max-res=2.074e-02 (using omega from discrete symbol)
CgWaveHoltz: max-err =2.08e-05 (between WaveHoltz and known solution)


ORDER=4:
cgwh trigHelmholtz.cmd -g=square32.order4.ng3.hdf -omega=5.4 -adjustOmega=0 -orderInTime=2 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -upwind=0 -imode=1 -debug=3 -maxIterations=100 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=7.44e-13 (tol=1.00e-12) numberOfIterations=5 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3980792e+00 (from symbol of D+D-), dt=1.711107e-02, adjustOmega=0, upwind=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.398079217984e+00
CgWaveHoltz::residual: max-res=2.073e-02 (using omega), max-res=7.792e-11 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.073e-02, CR=0.004 CR-perPeriod=0.004, cpu= 8.61e-02(s)
CgWaveHoltz: max-err =4.12e-04 (between WaveHoltz and known solution)





TEST adjustOmega:
cgwh trigHelmholtz.cmd -g=square32.order2.hdf -omega=5.4 -adjustOmega=1 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -upwind=0 -imode=1 -debug=3 -maxIterations=100 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.87e-15 (tol=1.00e-12) numberOfIterations=2 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974486e+00 (from symbol of D+D-), dt=1.972123e-02, adjustOmega=1
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.397448611087e+00
CgWaveHoltz::residual: max-res=2.487e-12 (using omega), max-res=2.769e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.487e-12, CR=0.000 CR-perPeriod=0.000, cpu= 4.62e-02(s)



**BUG** found : UPWINDING WAS ON !! Messes up waveHoltz convergence

CHANGED CGWAVE -- TAKE A FORWARD FIRST STEP

BUG IN PETSc version fixed --> ZERO OUT u[i] to avoid nan's in 2nd ghost.

PETSc : 
cgwh trigHelmholtz.cmd -g=square32.order2.hdf -omega=5.4 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -upwind=0 -imode=1 -debug=3 -maxIterations=100 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.20e-15 (tol=1.00e-12) numberOfIterations=2 #############
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974486e+00 (from symbol of D+D-), dt=1.972123e-02, adjustOmega=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.397448611087e+00
CgWaveHoltz::residual: max-res=2.767e-02 (using omega), max-res=3.759e-12 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.767e-02, CR=0.000 CR-perPeriod=0.000, cpu= 4.54e-02(s)



cgwh trigHelmholtz.cmd -g=square32.order2.hdf -omega=5.4 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -upwind=0 -imode=1 -debug=3 -maxIterations=100 -go=halt


cgWave:FD22 t=1.164e+00 (59 steps) dt=1.972e-02 maxErr= 4.55e-03, ||u||= 1.00e+00, cpu= 8.97e-03(s)
it=18:  l2Norm( v-vOld )=2.19e-13 (tol=1e-12)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =19 #########################
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974486e+00 (from symbol of D+D-), dt=1.972123e-02, adjustOmega=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.397448611087e+00
CgWaveHoltz::residual: max-res=2.767e-02 (using omega), max-res=4.945e-12 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.767e-02, CR=0.222 CR-perPeriod=0.222, cpu= 2.03e-01(s)


BACKWARD-INITIAL-STEP (NO upwinding)
################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =19 #########################
CgWaveHoltz::residual: c=1, omega= 5.4000000e+00, omegas= 5.3974486e+00 (from symbol of D+D-), dt=1.972123e-02, adjustOmega=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  5.397448611087e+00
CgWaveHoltz::residual: max-res=2.767e-02 (using omega), max-res=5.386e-12 (using omega from discrete symbol)
CgWaveHoltz: omega=5.400e+00, max-res=2.767e-02, CR=0.222 CR-perPeriod=0.222, cpu= 1.90e-01(s)


**************************************************
**** Sun July 25, 2021


COMPARE TO NEW multiFreqWaveHoltz2d.m in research/WaveHoltz

cgwh trigHelmholtz.cmd -g=square32.order2.hdf -omega=5.4 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -go=halt





>>>>>>>>>>>> PERIODIC
cgwh trigHelmholtz.cmd -g=square32p.order2.hdf -x0=.75 -y0=.75 -omega=5 -adjustOmega=1 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -go=halt

##### CgWave:adjust omega and dt for Helmholtz: dts=  1.5321093476e-02 (dt=  1.5324842213e-02) omegas=  5.001223e+00 (omega=  5.000000e+00) ####

CgWaveHoltz::residual: c=1, omega= 5.0000000e+00, omegas= 4.9987769e+00 (from symbol of D+D-), dt=1.532484e-02, adjustOmega=1



++++++++++++TEST new POLY PERIODIC SOLUTION

LINEAR IN SPACE
cgwh trigHelmholtz.cmd -g=square32.order2.hdf -known=polyPeriodic -omega=1 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -degreeInSpaceForPolyPeriodic=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.19e-13 (tol=1.00e-12) numberOfIterations=4 #############
CgWaveHoltz::residual: c=1, omega= 1.0000000e+00, omegas= 9.9999007e-01 (from symbol of D+D-), dt=1.543780e-02, adjustOmega=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  9.999900697911e-01

CgWaveHoltz::residual: max-res=5.836e-05 (using omega), max-res=1.604e-08 (using omega from discrete symbol)
With periodic values for t=-dt
CgWaveHoltz::residual: max-res=5.836e-05 (using omega), max-res=1.878e-08 (using omega from discrete symbol)

G64: FACTOR 8 reduction
CgWaveHoltz::residual: max-res=1.478e-05 (using omega), max-res=2.016e-09 (using omega from discrete symbol)


>>>>>>>>>>>>>>CONST IN SPACE

cgwh trigHelmholtz.cmd -g=square32.order2.hdf -known=polyPeriodic -omega=1 -adjustOmega=1 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -degreeInSpaceForPolyPeriodic=0 -go=halt


cgwh trigHelmholtz.cmd -g=square32.order2.hdf -known=polyPeriodic -omega=1 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -degreeInSpaceForPolyPeriodic=0 -go=halt

RESULTS: 
  residual is off by 1.98657e-5  --> sqrt() = .004457
  dt=1.543780e-02

 ################ DONE KYRLOV ITERATIONS -- KSP residual=4.73e-18 (tol=1.00e-15) numberOfIterations=2 #############
CgWaveHoltz::residual: c=1, omega= 1.0000000e+00, omegas= 9.9999007e-01 (from symbol of D+D-), dt=1.543780e-02, adjustOmega=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  9.999900697911e-01

CgWaveHoltz::residual: max-res=1.987e-05 (using omega), max-res=5.347e-09 (using omega from discrete symbol)

CgWaveHoltz: omega=1.000e+00, max-res=1.987e-05, CR=0.052 CR-perPeriod=0.052, cpu= 2.86e-01(s)

with first step cos(-omega*dt): 
CgWaveHoltz::residual: max-res=1.987e-05 (using omega), max-res=6.279e-09 (using omega from discrete symbol)
G64: FACTOR 8 reduction: 
CgWaveHoltz::residual: max-res=4.978e-06 (using omega), max-res=7.753e-10 (using omega from discrete symbol)



**************************************************
**** Sat July 24, 2021

>>>>>>>>>>>> PERIODIC omega=0 
cgwh trigHelmholtz.cmd -g=square32p.order2.hdf -x0=.75 -y0=.75 -omega=0 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -go=halt


cgwh trigHelmholtz.cmd -g=square32.order2.hdf -x0=.75 -y0=.75 -omega=5 -adjustOmega=1 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=2 -go=halt

##### CgWave:adjust omega and dt for Helmholtz: dts=  1.5321e-02 (dt=  1.5321e-02) omegas=  5.001223e+00 (omega=  5.000000e+00) ####

CgWaveHoltz::residual: c=1, omega= 5.0000000e+00, omegas= 4.9987775e+00 (from symbol of D+D-), dt=1.532109e-02, adjustOmega=1
CgWaveHoltz::residual: max-res=6.663e-03 (using omega), max-res=6.998e-03 (using omega from discrete symbol)




cgwh trigHelmholtz.cmd -g=square32.order2.hdf -x0=.75 -y0=.75 -omega=5 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -go=halt


CgWaveHoltz::residual: c=1, omega= 5.0000000e+00, omegas= 4.9987769e+00 (from symbol of D+D-), dt=1.532484e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=1.791e-02 (using omega), max-res=6.672e-03 (using omega from discrete symbol)

>>>>>>>>>>>> PERIODIC
cgwh trigHelmholtz.cmd -g=square32p.order2.hdf -x0=.75 -y0=.75 -omega=5 -adjustOmega=0 -solver=none -matlab=junk -tol=1e-12 -tp=1000 -ad4=0 -imode=1 -debug=3 -maxIterations=100 -go=halt


takeFirstBackwardStep: setting  u(-dt) = u(0)*cos(omega*(-dt)) , dt=  1.532484221263e-02

CgWaveHoltz::residual: c=1, omega= 5.0000000e+00, omegas= 4.9987769e+00 (from symbol of D+D-), dt=1.532484e-02, adjustOmega=0
CgWaveHoltz::residual: compute residual with adjusted omegas=  4.998776908575e+00
CgWaveHoltz::residual: max-res=1.876e-02 (using omega), max-res=6.476e-03 (using omega from discrete symbol)


**************************************************
**** Sat July 17, 2021


---> new RESID IS NOT SMALL !!

cgwh trigHelmholtz.cmd -g=square64.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-12 -tp=1 -ad4=0 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=5.32e-14 (tol=1.00e-12) numberOfIterations=10 #############
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23365e+00 (from symbol of D+D-), dt=7.694709e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=1.417e-03 (using omega), max-res=2.332e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=1.417e-03, CR=0.050 CR-perPeriod=0.050, cpu= 4.60e-01(s)
CgWaveHoltz::Results saved to file square64Krylov.m
CgWaveHoltz: max-err =1.21e-03 (between WaveHoltz and known solution)


---> OLD: RESIDUAL WAS SMALL!!!  WHAT SOLUTION WAS THIS??

../bin/cgwh waveHoltz.cmd -g=square64.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-12 -tp=1 -ad4=0 -imode=1 -go=halt

++++ PETSc
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.65e-12 (tol=1.00e-12) numberOfIterations=13 #############
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23365e+00 (from symbol of D+D-), dt=7.694709e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=1.100e-11 (using omega), max-res=2.837e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=1.100e-11, CR=0.139 CR-perPeriod=0.139, cpu= 2.58e-01(s)
CgWaveHoltz::Results saved to file square64Krylov.m



**************************************************
**** Sat May 22, 2021

Generate results for the documentation


FIX NORMS TO BE L2h NORMS


cgwh trigHelmholtz.cmd -g=cice4.order2 -omega=6 -solver=none -tol=1e-4 -tp=1 -ad4=1 -go=halt

it=25:  l2Norm( v-vOld )=9.90e-05 (tol=0.0001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =26 #########################
CgWaveHoltz::residual: c=1, omega= 6.00000e+00, omegas= 5.99942e+00 (from symbol of D+D-), dt=7.993874e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=7.817e-02 (using omega), max-res=7.267e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=6.000e+00, max-res=7.817e-02, CR=0.723 CR-perPeriod=0.723, cpu= 3.02e+00(s)

 ################ DONE KYRLOV ITERATIONS -- KSP residual=9.71e-05 (tol=1.00e-04) numberOfIterations=9 #############
CgWaveHoltz::residual: c=1, omega= 6.00000e+00, omegas= 5.99942e+00 (from symbol of D+D-), dt=7.993874e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=7.469e-02 (using omega), max-res=6.885e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=6.000e+00, max-res=7.469e-02, CR=0.391 CR-perPeriod=0.391, cpu= 1.35e+00(s)





CIC grid:

cgwh trigHelmholtz.cmd -g=cice4.order2 -omega=6 -solver=none -tol=1e-4 -tp=1 -ad4=1 -go=halt

cgwh -noplot trigHelmholtz.cmd -g=cice4.order2 -omega=6 -solver=fixedPoint -tol=1e-5 -tp=1 -ad4=1 -matlab=trigHelmholtzCIC4FixedPoint -maxIterations=100 -go=go

cgwh -noplot trigHelmholtz.cmd -g=cice4.order2 -omega=6 -solver=krylov -tol=1e-8 -tp=1 -ad4=1 -matlab=trigHelmholtzCIC4Krylov -go=go

 ################ DONE KYRLOV ITERATIONS -- KSP residual=7.25e-05 (tol=1.00e-06) numberOfIterations=33 #############
CgWaveHoltz::residual: c=1, omega= 6.00000e+00, omegas= 5.99942e+00 (from symbol of D+D-), dt=7.993874e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=7.006e-02 (using omega), max-res=6.497e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=6.000e+00, max-res=7.006e-02, CR=0.657 CR-perPeriod=0.657, cpu= 4.20e+00(s)


TEST RANDOM INITIAL CONDITIONS:

cgwh trigHelmholtz.cmd -g=square64.order2 -omega=6 -solver=none


converges very fast --> TODO: add a random initial condition

cgwh -noplot trigHelmholtz.cmd -g=square64.order2 -omega=6 -solver=fixedPoint -tol=1e-10 -tp=1 -ad4=1 -matlab=trigHelmholtzSquare64FixedPoint -go=go
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =9 #########################
CgWaveHoltz::residual: c=1, omega= 6.00000e+00, omegas= 5.99974e+00 (from symbol of D+D-), dt=5.397926e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=7.198e-03 (using omega), max-res=4.047e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=6.000e+00, max-res=7.198e-03, CR=0.060 CR-perPeriod=0.060, cpu= 4.58e-01(s)

cgwh -noplot trigHelmholtz.cmd -g=square64.order2 -omega=6 -solver=krylov -tol=1e-10 -tp=1 -ad4=1 -matlab=trigHelmholtzSquare64Krylov -go=go

 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.44e-10 (tol=1.00e-10) numberOfIterations=6 #############
CgWaveHoltz::residual: c=1, omega= 6.00000e+00, omegas= 5.99974e+00 (from symbol of D+D-), dt=5.397926e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=7.198e-03 (using omega), max-res=4.047e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=6.000e+00, max-res=7.198e-03, CR=0.013 CR-perPeriod=0.013, cpu= 4.31e-01(s)