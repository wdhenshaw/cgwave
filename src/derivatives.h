#ifndef derivatives_h
#define derivatives_h

#define ind3s(i,j,k,Ngx) (i+(j*Ngx[0])+(k*Ngx[0]*Ngx[1]))
#define ind(I,N) (I[0]+(I[1]*N[0])+(I[2]*N[0]*N[1]))

#define DERIV10(u,i,Ngx,h) ((-u[ind3s((i[0] -1),i[1],i[2],Ngx)] + u[ind3s((i[0] + 1),i[1],i[2],Ngx)])*(0.5/h[0]))
#define DERIV20(u,i,Ngx,h) ((u[ind3s((i[0] -1),i[1],i[2],Ngx)] - 2.0*u[ind3s(i[0],i[1],i[2],Ngx)]+ u[ind3s((i[0] + 1),i[1],i[2],Ngx)])*(1.0/(h[0]*h[0])))
#define DERIV01(u,i,Ngx,h) ((-u[ind3s(i[0],(i[1] -1),i[2],Ngx)] + u[ind3s(i[0],(i[1] + 1),i[2],Ngx)])*(0.5/h[1]))
#define DERIV02(u,i,Ngx,h) ((u[ind3s(i[0],(i[1]-1),i[2],Ngx)] - 2.0*u[ind3s(i[0],i[1],i[2],Ngx)]+ u[ind3s(i[0],(i[1] + 1),i[2],Ngx)])*(1.0/(h[1]*h[1])))
#define DERIV11(u,i,Ngx,h) ((u[ind3s((i[0] -1),(i[1]-1),i[2],Ngx)] - u[ind3s((i[0] + 1),(i[1]-1),i[2],Ngx)]- u[ind3s((i[0] -1),(i[1] + 1),i[2],Ngx)] + u[ind3s((i[0] + 1),(i[1] + 1),i[2],Ngx)])*(1/(4.0*h[0]*h[1])))

#define DERIV100(u,i,Ngx,h) ((-u[ind3s((i[0] -1),i[1],i[2],Ngx)] + u[ind3s((i[0] + 1),i[1],i[2],Ngx)])*(0.5/h[0]))
#define DERIV200(u,i,Ngx,h) ((u[ind3s((i[0] -1),i[1],i[2],Ngx)] - 2.0*u[ind3s(i[0],i[1],i[2],Ngx)]+ u[ind3s((i[0] + 1),i[1],i[2],Ngx)])*(1.0/(h[0]*h[0])))

#define DERIV010(u,i,Ngx,h) ((-u[ind3s(i[0],(i[1] -1),i[2],Ngx)] + u[ind3s(i[0],(i[1] + 1),i[2],Ngx)])*(0.5/h[1]))
#define DERIV020(u,i,Ngx,h) ((u[ind3s(i[0],(i[1]-1),i[2],Ngx)] - 2.0*u[ind3s(i[0],i[1],i[2],Ngx)]+ u[ind3s(i[0],(i[1] + 1),i[2],Ngx)])*(1.0/(h[1]*h[1])))
 
#define DERIV001(u,i,Ngx,h) ((-u[ind3s(i[0],i[1],(i[2]-1),Ngx)] + u[ind3s(i[0],i[1],(i[2]+1),Ngx)])*(0.5/h[2]))
#define DERIV002(u,i,Ngx,h) ((u[ind3s(i[0],i[1],(i[2]-1),Ngx)] - 2.0*u[ind3s(i[0],i[1],i[2],Ngx)]+ u[ind3s(i[0],i[1],(i[2]+1),Ngx)])*(1.0/(h[2]*h[2])))

#define DERIV110(u,i,Ngx,h) ((u[ind3s((i[0] -1),(i[1]-1),i[2],Ngx)] - u[ind3s((i[0] + 1),(i[1]-1),i[2],Ngx)]- u[ind3s((i[0] -1),(i[1] + 1),i[2],Ngx)] + u[ind3s((i[0] + 1),(i[1] + 1),i[2],Ngx)])*(1/(4.0*h[0]*h[1])))
#define DERIV101(u,i,Ngx,h) ((u[ind3s((i[0] -1),i[1],(i[2]-1),Ngx)] - u[ind3s((i[0] + 1),i[1],(i[2]-1),Ngx)]- u[ind3s((i[0] -1),i[1],(i[2]+1),Ngx)] + u[ind3s((i[0] + 1),i[1],(i[2]+1),Ngx)])*(1/(4.0*h[0]*h[2])))
#define DERIV011(u,i,Ngx,h) ((u[ind3s(i[0],(i[1]-1),(i[2]-1),Ngx)] - u[ind3s(i[0],(i[1]+1),(i[2]-1),Ngx)]- u[ind3s(i[0],(i[1]-1),(i[2]+1),Ngx)] + u[ind3s(i[0],(i[1]+1),(i[2]+1),Ngx)])*(1/(4.0*h[1]*h[2])))

/* New derivatives here */

#define DERIV210(u,i,Ngx,h) (((-0.5)*u[ind3s((i[0] + (-1)),(i[1] + (-1)),i[2],Ngx)]+ (1.0)*u[ind3s(i[0],(i[1] + (-1)),i[2],Ngx)]+ (-0.5)*u[ind3s((i[0] + (1)),(i[1] + (-1)),i[2],Ngx)]+ (0.5)*u[ind3s((i[0] + (-1)),(i[1] + (1)),i[2],Ngx)]+ (-1.0)*u[ind3s(i[0],(i[1] + (1)),i[2],Ngx)]+ (0.5)*u[ind3s((i[0] + (1)),(i[1] + (1)),i[2],Ngx)])*(1.0/(h[0]*h[0]))*(1.0/(h[1]))*(1.0/(1.0)))
#define DERIV120(u,i,Ngx,h) (((-0.5)*u[ind3s((i[0] + (-1)),(i[1] + (-1)),i[2],Ngx)]+ (0.5)*u[ind3s((i[0] + (1)),(i[1] + (-1)),i[2],Ngx)]+ (1.0)*u[ind3s((i[0] + (-1)),i[1],i[2],Ngx)]+ (-1.0)*u[ind3s((i[0] + (1)),i[1],i[2],Ngx)]+ (-0.5)*u[ind3s((i[0] + (-1)),(i[1] + (1)),i[2],Ngx)]+ (0.5)*u[ind3s((i[0] + (1)),(i[1] + (1)),i[2],Ngx)])*(1.0/(h[0]))*(1.0/(h[1]*h[1]))*(1.0/(1.0)))
#define DERIV220(u,i,Ngx,h) (((1.0)*u[ind3s((i[0] + (-1)),(i[1] + (-1)),i[2],Ngx)]+ (-2.0)*u[ind3s(i[0],(i[1] + (-1)),i[2],Ngx)]+ (1.0)*u[ind3s((i[0] + (1)),(i[1] + (-1)),i[2],Ngx)]+ (-2.0)*u[ind3s((i[0] + (-1)),i[1],i[2],Ngx)]+ (4.0)*u[ind3s(i[0],i[1],i[2],Ngx)]+ (-2.0)*u[ind3s((i[0] + (1)),i[1],i[2],Ngx)]+ (1.0)*u[ind3s((i[0] + (-1)),(i[1] + (1)),i[2],Ngx)]+ (-2.0)*u[ind3s(i[0],(i[1] + (1)),i[2],Ngx)]+ (1.0)*u[ind3s((i[0] + (1)),(i[1] + (1)),i[2],Ngx)])*(1.0/(h[0]*h[0]))*(1.0/(h[1]*h[1]))*(1.0/(1.0)))
#define DERIV201(u,i,Ngx,h) (((-0.5)*u[ind3s((i[0] + (-1)),i[1],(i[2] + (-1)),Ngx)]+ (1.0)*u[ind3s(i[0],i[1],(i[2] + (-1)),Ngx)]+ (-0.5)*u[ind3s((i[0] + (1)),i[1],(i[2] + (-1)),Ngx)]+ (0.5)*u[ind3s((i[0] + (-1)),i[1],(i[2] + (1)),Ngx)]+ (-1.0)*u[ind3s(i[0],i[1],(i[2] + (1)),Ngx)]+ (0.5)*u[ind3s((i[0] + (1)),i[1],(i[2] + (1)),Ngx)])*(1.0/(h[0]*h[0]))*(1.0/(1.0))*(1.0/(h[2])))
#define DERIV102(u,i,Ngx,h) (((-0.5)*u[ind3s((i[0] + (-1)),i[1],(i[2] + (-1)),Ngx)]+ (0.5)*u[ind3s((i[0] + (1)),i[1],(i[2] + (-1)),Ngx)]+ (1.0)*u[ind3s((i[0] + (-1)),i[1],i[2],Ngx)]+ (-1.0)*u[ind3s((i[0] + (1)),i[1],i[2],Ngx)]+ (-0.5)*u[ind3s((i[0] + (-1)),i[1],(i[2] + (1)),Ngx)]+ (0.5)*u[ind3s((i[0] + (1)),i[1],(i[2] + (1)),Ngx)])*(1.0/(h[0]))*(1.0/(1.0))*(1.0/(h[2]*h[2])))
#define DERIV202(u,i,Ngx,h) (((1.0)*u[ind3s((i[0] + (-1)),i[1],(i[2] + (-1)),Ngx)]+ (-2.0)*u[ind3s(i[0],i[1],(i[2] + (-1)),Ngx)]+ (1.0)*u[ind3s((i[0] + (1)),i[1],(i[2] + (-1)),Ngx)]+ (-2.0)*u[ind3s((i[0] + (-1)),i[1],i[2],Ngx)]+ (4.0)*u[ind3s(i[0],i[1],i[2],Ngx)]+ (-2.0)*u[ind3s((i[0] + (1)),i[1],i[2],Ngx)]+ (1.0)*u[ind3s((i[0] + (-1)),i[1],(i[2] + (1)),Ngx)]+ (-2.0)*u[ind3s(i[0],i[1],(i[2] + (1)),Ngx)]+ (1.0)*u[ind3s((i[0] + (1)),i[1],(i[2] + (1)),Ngx)])*(1.0/(h[0]*h[0]))*(1.0/(1.0))*(1.0/(h[2]*h[2])))
#define DERIV021(u,i,Ngx,h) (((-0.5)*u[ind3s(i[0],(i[1] + (-1)),(i[2] + (-1)),Ngx)]+ (1.0)*u[ind3s(i[0],i[1],(i[2] + (-1)),Ngx)]+ (-0.5)*u[ind3s(i[0],(i[1] + (1)),(i[2] + (-1)),Ngx)]+ (0.5)*u[ind3s(i[0],(i[1] + (-1)),(i[2] + (1)),Ngx)]+ (-1.0)*u[ind3s(i[0],i[1],(i[2] + (1)),Ngx)]+ (0.5)*u[ind3s(i[0],(i[1] + (1)),(i[2] + (1)),Ngx)])*(1.0/(1.0))*(1.0/(h[1]*h[1]))*(1.0/(h[2])))
#define DERIV012(u,i,Ngx,h) (((-0.5)*u[ind3s(i[0],(i[1] + (-1)),(i[2] + (-1)),Ngx)]+ (0.5)*u[ind3s(i[0],(i[1] + (1)),(i[2] + (-1)),Ngx)]+ (1.0)*u[ind3s(i[0],(i[1] + (-1)),i[2],Ngx)]+ (-1.0)*u[ind3s(i[0],(i[1] + (1)),i[2],Ngx)]+ (-0.5)*u[ind3s(i[0],(i[1] + (-1)),(i[2] + (1)),Ngx)]+ (0.5)*u[ind3s(i[0],(i[1] + (1)),(i[2] + (1)),Ngx)])*(1.0/(1.0))*(1.0/(h[1]))*(1.0/(h[2]*h[2])))
#define DERIV022(u,i,Ngx,h) (((1.0)*u[ind3s(i[0],(i[1] + (-1)),(i[2] + (-1)),Ngx)]+ (-2.0)*u[ind3s(i[0],i[1],(i[2] + (-1)),Ngx)]+ (1.0)*u[ind3s(i[0],(i[1] + (1)),(i[2] + (-1)),Ngx)]+ (-2.0)*u[ind3s(i[0],(i[1] + (-1)),i[2],Ngx)]+ (4.0)*u[ind3s(i[0],i[1],i[2],Ngx)]+ (-2.0)*u[ind3s(i[0],(i[1] + (1)),i[2],Ngx)]+ (1.0)*u[ind3s(i[0],(i[1] + (-1)),(i[2] + (1)),Ngx)]+ (-2.0)*u[ind3s(i[0],i[1],(i[2] + (1)),Ngx)]+ (1.0)*u[ind3s(i[0],(i[1] + (1)),(i[2] + (1)),Ngx)])*(1.0/(1.0))*(1.0/(h[1]*h[1]))*(1.0/(h[2]*h[2])))

#endif /* derivatives_h */
