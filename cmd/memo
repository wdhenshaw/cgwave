
THINGS TO FIX:
  (o) 4th-order in time implicit schemes -- finish me 
  (o) Add CBC's to explicit and implicit codes.
  (o) Work on 6th and 8th order codes -- HOA in time and CBC's
  (o) OGPolyfunction: increase degree to 8 ??

Things FIXED:
  (o) Upwind dissipation + implicit -- not working yet
  (o) *fixed* 2nd-order upwind scheme needs cfl=.7 *fix me* (Note: dt is now temporarily adjusted by a factor of .7 in getTimeStep)
      ---> ADJUST SOSUP PARAMETER BY .75 : SEEMS OK !?


************************************************************************
********* Thurs May 27, 2021

REVISIT IMPLICIT TIME STEPPING


CHANGE SPECIFICATION OF IMPLICIT TIME-STEPPING COEFF: Set beta2 and beta4!  *** FIX CMD FILES ***

cgWave known.cmd -g=square32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=50  -ts=implicit  -dt=.1 -known=boxHelmholtz -go=halt


XXX TURN OFF REGULAR UPWIND DISS when doesing implicit!!!

FD44s --> FINISH ME 
cgWave known.cmd -g=rsise4.order4.ng3 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=50 -ts=implicit -dt=.1 -known=boxHelmholtz -go=halt

TEST FD24-IMP
cgWave known.cmd -g=square32.order4.ng3 -bc=d -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=50 -ts=implicit -orderInTime=2 -dt=.1 -known=boxHelmholtz -go=halt

FD22s-IMP RSIS Look ok
cgWave known.cmd -g=rsise4.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=50 -ts=implicit -dt=.1 -known=boxHelmholtz -go=halt


Now is stable: 
cgWave known.cmd -g=square32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=50  -ts=implicit  -dt=.1 -known=boxHelmholtz -go=halt


************************************************************************
********* Wed May 26, 2021


REVISIT IMPLICIT TIME STEPPING

UNSTABLE FOR dt=.1 OK for dt=.01, unstable above cfl=1 !?
cgWave known.cmd -g=square32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=50  -ts=implicit  -dt=.1 -known=boxHelmholtz -go=halt


cgWave tz.cmd -g=square32.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=.2 -tp=.1  -dtMax=.1 -go=og 

cgWave -noplot tz.cmd -g=square5.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=.2 -tp=.1  -dtMax=.1 -go=go 

NOT Exact!
cgWave tz.cmd -g=square64.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=100 -tp=.05  -dtMax=.05 -go=og


EXACT: 
cgWave tz.cmd -g=square64.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=100 -tp=.01  -dtMax=.01 -go=og

EXACT
cgWave -noplot tz.cmd -g=square5.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=.1 -tp=.1  -dtMax=.05 -go=go > junk



ISSUE RESOLVED FOR UPWIND DISSIPATION -- See CgWave documentation


cgWave known.cmd  -g=square32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=50 -debug=3 -known=boxHelmholtz -go=halt -cfl=.999

************************************************************************
********* Tues May 25, 2021


REVISIT FD22s -- why does upwind dissipation require cfl=.7 ???

TEST 3D --> also blows up 
cgWave known.cmd -g=box4.order2 -bc=d -ad4=1 -kx=1 -ky=1 -kz=1 -tp=.5 -tf=10 -debug=3 -known=boxHelmholtz -go=halt -cfl=1.43

3D BoxHelmholtz not working .... FIXED userDefinedForcing was wrong
cgWave known.cmd -g=box4.order2 -bc=d -ad4=0 -kx=1 -ky=1 -kz=1 -tp=.01 -tf=10 -debug=3 -known=boxHelmholtz -go=halt


-------
Order=2 + UPW : cfl=.7 needed --> 1/.7 = 1.4286
cgWave known.cmd  -g=square32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt -cfl=1.43

CgWave::getTimeStep: c=1, cfl=1.43, timeSteppingMethod=0
getTimeStep: grid=0 : dx= 3.12e-02, dy= 3.12e-02, dt=3.160e-02
CgWave::initialize: dt=0.0221192

------
TURN OFF .7 FIX: 

ADJUST SOSUP-DISS BY A FACTOR OF .5 -- OK
ADJUST SOSUP-DISS BY A FACTOR OF .75 -- OK
cgWave known.cmd  -g=square32p.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt -cfl=.9

OK: till t=50
cgWave known.cmd  -g=rsise4.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt

NO-DISS -- blows up by t=10
cgWave known.cmd  -g=rsise4.order2 -bc=d -ad4=0 -kx=1 -ky=1 -tp=1 -tf=50 -debug=3 -known=boxHelmholtz -go=halt

PERIODIC
cgWave known.cmd  -g=square32p.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt -cfl=.9

cgWave known.cmd  -g=nonSquare32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt -cfl=.9

cgWave known.cmd  -g=square32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt -cfl=.9

CgWave::getTimeStep: c=1, cfl=0.9, timeSteppingMethod=0
getTimeStep: grid=0 : dx= 3.12e-02, dy= 3.12e-02, dt=1.989e-02
CgWave::initialize: dt=0.0198874

advMxWave: grid=  0 gridType= 0 orderOfAccuracy= 2 useUpwindDissipation= 0
         : t,dt,adSosup=  0.20E-01  0.20E-01 -0.25E-02 adSosup/(c*dt)= -0.1250E+00
         : useSosupDissipation= 1 sosupParameter=  1.00E+00

############## CGMX
CGMX: cfl=.9
 computeTimeStep: grid=0 dx=3.12e-02 dy=3.12e-02 c=1.00e+00, dtg=1.99e-02
 computeTimeStep: grid=0 c=1.00e+00, dtg=1.99e-02 min-dx=3.12e-02 max-dx=3.12e-02
==== computeTimeStep: deltaT=1.99e-02

>>>> Inside advOptNew... t= 0.196E-01 grid=  0
advOPT: useSosup dissipation, t,dt,adSosup=  0.20E-01  0.20E-01  0.25E-02



************************************************************************
********* Friday May 21, 2021


START ON CONV TESTS

WARNING : UPW WAS OFF FOR BOX HELMHOLTZ


TO-DO : ADD POLY TZ + cos(omega*t) to WAVEHOLTZ TESTS ??


G2 = omega=6 
     Residuals are large near boundaries --> WHY??? --> MAYBE NEED CBC's
     dierct solve followed by PETSc --> BIG RESIDUALS AT INTERP POINTS!! .. FIXED, helmholtzSolve changed the RHS GD "f"
cgwh boxHelmholtz.cmd -g=cice2.order4.ng3 -omega=6 -solver=none -tol=1e-6 -tp=1 -ad4=1 

FD22s --> residuals OK near boundaries
cgwh boxHelmholtz.cmd -g=cice2.order2 -omega=6 -solver=none -tol=1e-6 -tp=1 -ad4=1 
CgWaveHoltz::residual: c=1, omega= 6.00000e+00, omegas= 5.99804e+00 (from symbol of D+D-), dt=1.474926e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=2.746e-01 (using omega), max-res=2.539e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=6.000e+00, max-res=2.746e-01, CR=0.614 CR-perPeriod=0.614, cpu= 1.04e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err =1.07e-01 (between WaveHoltz and known solution)
CgWaveHoltz: max-diff=1.89e-01 (between WaveHoltz and Direct Helmholtz solution)


++++++++++++++++REDO

G4
cgwh boxHelmholtz.cmd -g=cice4.order4.ng3 -omega=2 -solver=none -tol=1e-5 -tp=1 -ad4=1 -imode=1

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.15e-04 (tol=1.00e-05) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99996e+00 (from symbol of D+D-), dt=1.079585e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=6.904e-03 (using omega), max-res=6.822e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=6.904e-03, CR=0.160 CR-perPeriod=0.160, cpu= 3.74e+00(s)
CgWaveHoltz: max-err=2.078e-05


G2
cgwh boxHelmholtz.cmd -g=cice2.order4.ng3 -omega=2 -solver=none -tol=1e-5 -tp=1 -ad4=1 -imode=1

 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.82e-04 (tol=1.00e-05) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99988e+00 (from symbol of D+D-), dt=1.892526e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=3.655e-02 (using omega), max-res=3.635e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=3.655e-02, CR=0.171 CR-perPeriod=0.171, cpu= 1.12e+00(s)
CgWaveHoltz: max-err=4.681e-04


O2 G4
cgwh boxHelmholtz.cmd -g=cice4.order2 -omega=2 -solver=none -tol=1e-5 -tp=1 -ad4=1 -imode=1
 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.13e-04 (tol=1.00e-05) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99998e+00 (from symbol of D+D-), dt=8.014267e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=7.740e-04 (using omega), max-res=6.907e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=7.740e-04, CR=0.161 CR-perPeriod=0.161, cpu= 3.14e+00(s)
CgWaveHoltz: max-err=2.703e-03


O2 G2
cgwh boxHelmholtz.cmd -g=cice2.order2 -omega=2 -solver=none -tol=1e-5 -tp=1 -ad4=1 -imode=1

 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.09e-04 (tol=1.00e-05) numberOfIterations=10 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99993e+00 (from symbol of D+D-), dt=1.488906e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=4.910e-03 (using omega), max-res=4.766e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=4.910e-03, CR=0.295 CR-perPeriod=0.295, cpu= 1.25e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
plot contours...
CgWaveHoltz: max-err=1.953e-02


+++++++++++++++++++++++++++++++++++++
ORDER=2 
cgwh boxHelmholtz.cmd -g=cice2.order2 -omega=2 -solver=none -tol=1e-9 -tp=1 -ad4=1 -adjustOmega=1


ADJUST OMEGA: --> NOT WORKING??
################ DONE KYRLOV ITERATIONS -- KSP residual=3.06e-08 (tol=1.00e-09) numberOfIterations=13 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99985e+00 (from symbol of D+D-), dt=2.122538e-02, adjustOmega=1
CgWaveHoltz::residual: max-res=2.900e-04 (using omega), max-res=7.618e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=2.900e-04, CR=0.199 CR-perPeriod=0.199, cpu= 9.59e-01(s)


NO ADJUST OMEGA -- WHy is the residual so small when we have UPW dissipation??? .. BECAUSE DISSIPATION WAS OFF

################ DONE KYRLOV ITERATIONS -- KSP residual=1.78e-10 (tol=1.00e-11) numberOfIterations=5 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99985e+00 (from symbol of D+D-), dt=2.122698e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=6.116e-04 (using omega), max-res=4.614e-11 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=6.116e-04, CR=0.509 CR-perPeriod=0.509, cpu= 5.08e-01(s)



 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.36e-04 (tol=1.00e-05) numberOfIterations=10 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99985e+00 (from symbol of D+D-), dt=2.122698e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=6.458e-04 (using omega), max-res=4.634e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=6.458e-04, CR=0.300 CR-perPeriod=0.300, cpu= 7.32e-01(s)


cgwh boxHelmholtz.cmd -g=cice2.order4.ng3 -omega=2 -solver=none -tol=1e-5 -tp=1 -ad4=1 -imode=1

--> add final residual to list:
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.43e-04 (tol=1.00e-05) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99988e+00 (from symbol of D+D-), dt=1.892526e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=3.654e-02 (using omega), max-res=3.635e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=3.654e-02, CR=0.166 CR-perPeriod=0.166, cpu= 9.41e-01(s)


 
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.43e-04 (tol=1.00e-05) numberOfIterations=6 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99988e+00 (from symbol of D+D-), dt=1.892526e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=3.654e-02 (using omega), max-res=3.635e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=3.654e-02, CR=0.190 CR-perPeriod=0.190, cpu= 9.82e-01(s)



FOR NOW CHANGE dt for FD22s by a factor of .7

test: Looks ok: 
cgWave known.cmd  -g=square32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=.5 -tf=20 -debug=3 -known=boxHelmholtz -go=halt -cfl=.9
cgWave known.cmd  -g=rsise4.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=20 -debug=3 -known=boxHelmholtz -go=halt -cfl=.9
cgWave known.cmd  -g=sise4.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=1 -tf=20 -debug=3 -known=boxHelmholtz -go=halt -cfl=.9





************************************************************************
********* Thursday May 20, 2021

CONTINUE On CgWave sourceforge git repo.

Build new repo on cg6

cg6 test:


TEST OVERSET:

++++++++++++++++++++++++++ SOURCE TERM ++++++++++++++++++

GMRES FAILS: .. TURN ON DISS!

NOTE -- VERY SMALL SOURCE TERM!! was beta=400!

STILL SOMETHING WRONG -- solution does not match DIRECT!!!

CHECK RESIDUALS AT INTERPOLATION POINTS 

cgwh waveHoltz.cmd -g=cice4.order2.hdf -x0=1.25 -y0=1.25 -omega=2.79345 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-4 -tp=1 -ad4=1 -imode=1 -beta=10 -go=halt


DIRECT SOLVER: ANSWER = [-37.428,27.04]

cgwh waveHoltz.cmd -g=cice8.order2.hdf -x0=1.25 -y0=1.25 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-4 -tp=1 -ad4=1 -imode=1 -beta=10 -go=halt

cgwh waveHoltz.cmd -g=cice4.order2.hdf -x0=1.25 -y0=1.25 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-4 -tp=1 -ad4=1 -imode=1 -beta=10 -go=halt
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.67e-02 (tol=1.00e-04) numberOfIterations=63 #############
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23322e+00 (from symbol of D+D-), dt=1.143121e-02, adjustOmega=1
CgWaveHoltz::residual: max-res=2.410e+00 (using omega), max-res=2.532e+00 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=2.410e+00, CR=0.864 CR-perPeriod=0.864, cpu= 3.82e+00(s)

---> DIRECT SOLVE: 
*** max residual=0.00e+00, time for 1st solve of the Dirichlet problem = 1.20e-01 (iterations=0) ***
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23322e+00 (from symbol of D+D-), dt=1.143121e-02, adjustOmega=1
CgWaveHoltz::residual: max-res=6.128e-06 (using omega), max-res=7.646e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=6.128e-06, cpu= 1.40e-01 (Direct solution of Helmholtz).


cgwh waveHoltz.cmd -g=cice2.order2.hdf -x0=1.25 -y0=1.25 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-4 -tp=1 -ad4=1 -imode=1 -beta=10 -go=halt
 ################ DONE KYRLOV ITERATIONS -- KSP residual=8.18e-03 (tol=1.00e-04) numberOfIterations=56 #############
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23135e+00 (from symbol of D+D-), dt=2.104997e-02, adjustOmega=1
CgWaveHoltz::residual: max-res=9.950e+00 (using omega), max-res=1.014e+01 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=9.950e+00, CR=0.850 CR-perPeriod=0.850, cpu= 1.04e+00(s)



cgwh waveHoltz.cmd -g=sise4.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-12 -tp=1 -ad4=0 -imode=1 -go=halt

 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.06e-12 (tol=1.00e-12) numberOfIterations=22 #############
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23309e+00 (from symbol of D+D-), dt=1.237367e-02, adjustOmega=1
CgWaveHoltz::residual: max-res=1.776e-03 (using omega), max-res=1.163e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=1.776e-03, CR=0.314 CR-perPeriod=0.314, cpu= 5.15e-01(s)



cgwh waveHoltz.cmd -g=square64.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-12 -tp=1 -ad4=0 -imode=1 -go=halt
################ DONE KYRLOV ITERATIONS -- KSP residual=1.65e-12 (tol=1.00e-12) numberOfIterations=12 #############
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23365e+00 (from symbol of D+D-), dt=7.694709e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=1.100e-11 (using omega), max-res=2.837e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=1.100e-11, CR=0.118 CR-perPeriod=0.118, cpu= 2.83e-01(s)




+++++++++++++++++++++ BOX HELMHOLTZ ++++++++++++

cgwh boxHelmholtz.cmd -g=cice2.order4.ng3 -omega=2 -solver=none -tol=1e-5 -tp=1 -ad4=1 -imode=1

TURN ON MASK CHECK in solvePETSc.C
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.43e-04 (tol=1.00e-05) numberOfIterations=6 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99988e+00 (from symbol of D+D-), dt=1.892526e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=3.654e-02 (using omega), max-res=3.635e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=3.654e-02, CR=0.190 CR-perPeriod=0.190, cpu= 1.01e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m


--> FIXED iteration counting in solvePETSc.C

 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.23e-04 (tol=1.00e-05) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99988e+00 (from symbol of D+D-), dt=1.892526e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=3.655e-02 (using omega), max-res=3.635e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=3.655e-02, CR=0.215 CR-perPeriod=0.215, cpu= 1.14e+00(s)




 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.23e-04 (tol=1.00e-05) numberOfIterations=9 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99988e+00 (from symbol of D+D-), dt=1.892526e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=3.655e-02 (using omega), max-res=3.635e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=3.655e-02, CR=  inf CR-perPeriod=  inf, cpu= 1.01e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m.m


 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.23e-04 (tol=1.00e-05) numberOfIterations=8 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99988e+00 (from symbol of D+D-), dt=1.892526e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=3.655e-02 (using omega), max-res=3.635e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=3.655e-02, CR=0.261 CR-perPeriod=0.261, cpu= 9.48e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m.m
CgWaveHoltz: max-err=4.972e-04


cgwh boxHelmholtz.cmd -g=cice2.order2 -omega=2 -solver=none -tol=1e-5 -tp=1 -ad4=1 -imode=1


 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.32e-04 (tol=1.00e-05) numberOfIterations=11 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99985e+00 (from symbol of D+D-), dt=2.122698e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=6.233e-04 (using omega), max-res=2.241e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=6.233e-04, CR=0.354 CR-perPeriod=0.354, cpu= 7.61e-01(s)
CgWaveHoltz: max-err=1.987e-02


#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =48 #########################
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99985e+00 (from symbol of D+D-), dt=2.122698e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=6.917e-04 (using omega), max-res=9.201e-05 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=6.917e-04, CR=0.785 CR-perPeriod=0.785, cpu= 2.77e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m.m


################ DONE KYRLOV ITERATIONS -- KSP residual=3.00e-02 (tol=1.00e-03) numberOfIterations=5 #############
CgWaveHoltz::residual: c=1, omega= 2.00000e+00, omegas= 1.99985e+00 (from symbol of D+D-), dt=2.122698e-02, adjustOmega=0
CgWaveHoltz::residual: max-res=6.129e-03 (using omega), max-res=5.609e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=2.000e+00, max-res=6.129e-03, CR=0.261 CR-perPeriod=0.261, cpu= 3.97e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m.m
CgWaveHoltz: max-err=1.838e-02


cgwh boxHelmholtz.cmd -g=sise4.order2 -omega=2 -solver=krylov -tol=1e-3 -tp=1 -ad4=1 -imode=1


OK -- converges fast: 
../bin/cgwh boxHelmholtz.cmd -g=square64.order2.hdf -omega=2 -solver=krylov -tol=1e-3 -tp=1 -ad4=1 -imode=1


TROUBLE with cice and petsc solve --> *fix me*

../bin/cgwh waveHoltz.cmd -g=square64.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64Krylov -tol=1e-12 -tp=1 -ad4=0 -imode=1 -go=halt

++++ PETSc
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.65e-12 (tol=1.00e-12) numberOfIterations=13 #############
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23365e+00 (from symbol of D+D-), dt=7.694709e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=1.100e-11 (using omega), max-res=2.837e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=1.100e-11, CR=0.139 CR-perPeriod=0.139, cpu= 2.58e-01(s)
CgWaveHoltz::Results saved to file square64Krylov.m




 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.65e-12 (tol=1.00e-12) numberOfIterations=13 #############
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23365e+00 (from symbol of D+D-), dt=7.695229e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=2.838e-03 (using omega), max-res=1.637e-11 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=2.838e-03, CR=  inf CR-perPeriod=  inf, cpu= 2.73e-01(s)
CgWaveHoltz::Results saved to file square64FixedPoint.m



it=170:  max(|v-vOld|)=8.97e-13 (tol=1e-12)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =171 #########################
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23365e+00 (from symbol of D+D-), dt=7.694709e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=5.618e-11 (using omega), max-res=2.837e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=5.618e-11, CR=0.851 CR-perPeriod=0.851, cpu= 3.10e+00(s)
CgWaveHoltz::Results saved to file square64FixedPoint.m


exact: 
../bin/cgWave tz.cmd -g=square16.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -tf=1 -tp=.1 



************************************************************************
********* Wed May 19, 2021

START ON CGWAVE GIT REPO -- see ~/reminders file for setting this up

~/Dropbox/research/cgwave

Copy files ....


************************************************************************
********* Mon May 17, 2021

>> BUGS FIXED

RSIS - STABL AT CFL=1 : dt=.01 But trouble at CFL 2 ??
cgWave tz.cmd -g=rsise4.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=20 -tp=.1  -dtMax=.01 -go=go 


IMPLICIT + UPW ... NOW EXACT
> junk

NO UPW: exact
cgWave -noplot tz.cmd -g=square5.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=.1 -tp=.1  -dtMax=.05 -go=go > junk

explicit + UPW : EXACT
cgWave -noplot tz.cmd -g=square5.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=explicit -tf=.1 -tp=.1  -dtMax=.05 -go=go 
cgWave tz.cmd -g=square5.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=explicit -tf=.1 -tp=.1  -dtMax=.05 -go=halt 


advWave: ADVANCE IMPLICIT dim=2 order=2 orderInTime=2, grid=rectangular... t=  0.50E-01
addUpwindDissImplicit: UPWIND DISS dim=2 order=2 grid=rectangular... t=  0.50E-01
 adxSosup=  0.6944-309  0.6944-309  0.3333E+00
CgWave: applyBC: useOpt=1
cgWave:FD22 t=1.000e-01 ( 2 steps) maxErr= 7.05e-04, ||u||= 2.92e+00, cpu= 3.05e+00(s)



START ON TEST FOR WIDE STENCIL

BUG FOUND "c" 

alias tws /Users/henshaw/Dropbox/CG6backup/codes/cgwh/bin/tcmWideStencil

tws -g=square3.order2 -debug=63 > junk


tws -g=square16.order2


TEST NEW TRIG TZ:

cgWave tz.cmd -g=square64.order4 -ad4=0 -tz=trig -fx=3 -orderInTime=2 -tf=1 -tp=.1 
cgWave tz.cmd -g=square32.order2 -ad4=0 -tz=trig -fx=3 -orderInTime=2 -tf=1 -tp=.1 

************************************************************************
********* Sun May 16, 2021

FIX INITIAL CONDIION OPTION --- IC was a pulse by DEFAULT !!!!

cgWave with sources: 

IMPLICIT -- looks OK CFL=13 BUT DO NOT TAKE TOO BIT A STEP -- NEED TO RESOLVE SOURCE TEM
cgWave source.cmd -g=square64.order2 -ad4=0 -forcing=gaussian -x0=.75 -y0=.75 -omega=5.234 -ts=implicit -orderInTime=2 -tf=2 -tp=.1 -dtMax=.05 -go=halt

cgWave source.cmd -g=square64.order2 -ad4=0 -forcing=gaussian -x0=.75 -y0=.75 -omega=5.234 -ts=explicit -orderInTime=2 -tf=2 -tp=.1 -dtMax=.05 -go=halt


>>>>>>>>>>  RETURN TO WAVE-HOLTZ






IMPLICIT -- NEED TO FIX omega adjustment
*trouble at large CFL ???
cgwh waveHoltz.cmd -g=square64.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64FixedPoint -tol=1e-12 -tp=1 -ad4=0 -imode=1 -ts=implicit -dtMax=.01 -go=halt


#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =170 #########################
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23341e+00 (from symbol of D+D-), dt=9.920007e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=1.448e-02 (using omega), max-res=1.918e-02 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=1.448e-02, CR=0.851 CR-perPeriod=0.851, cpu= 6.30e+00(s)




cgwh waveHoltz.cmd -g=square64.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -adjustOmega=1 -solver=none -matlab=square64FixedPoint -tol=1e-12 -tp=1 -ad4=0 -imode=1 -go=halt

  t=  0.77E-02 dt=  0.77E-02 knownSolutionOption=   0 REAL_MIN=  0.22-307


#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =171 #########################
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23365e+00 (from symbol of D+D-), dt=7.694709e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=5.051e-11 (using omega), max-res=2.837e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=5.051e-11, CR=0.851 CR-perPeriod=0.851, cpu= 2.78e+00(s)





ADJUST OMEGA:
cgwh waveHoltz.cmd -g=square64.order2 -forcing=sine -kx=1 -ky=1 -omega=5.234 -adjustOmega=1 -solver=none -tol=1e-11 -tp=100 -ad4=0 -imode=1 -go=halt

ADJUSTED: 
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =19 #########################
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23365e+00 (from symbol of D+D-), dt=7.694709e-03, adjustOmega=1
CgWaveHoltz::residual: max-res=4.249e-11 (using omega), max-res=3.707e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=4.249e-11, CR=0.246 CR-perPeriod=0.246, cpu= 5.15e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m



cgwh waveHoltz.cmd -g=square64.order2 -forcing=sine -kx=1 -ky=1 -omega=5.234 -solver=none -tol=1e-11 -tp=100 -ad4=0 -imode=1 -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =7 #########################
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23365e+00 (from symbol of D+D-), dt=7.695229e-03, adjustOmega=0
CgWaveHoltz::residual: max-res=3.707e-03 (using omega), max-res=4.940e-11 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=3.707e-03, CR=0.281 CR-perPeriod=0.281, cpu= 1.78e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err=1.159e-03



CIC -- FP converges
cgwh waveHoltz.cmd -g=cice2.order2 -forcing=sine -kx=1 -ky=1 -omega=5.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -go=halt 


#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =500 #########################
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23135e+00 (from symbol of D+D-), dt=2.106063e-02
CgWaveHoltz::residual: max-res=2.832e-02 (using omega), max-res=1.057e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=2.832e-02, CR=0.974 CR-perPeriod=0.974, cpu= 9.38e+00(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err=3.548e-02

cgwh waveHoltz.cmd -g=square64.order2 -forcing=sine -kx=1 -ky=1 -omega=5.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -go=halt 



cgwh waveHoltz.cmd -g=square32.order2 -forcing=sine -kx=3 -ky=2 -omega=5.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -go=halt 


TRY IMPLICIT:
cgwh waveHoltz.cmd -g=square64.order2 -forcing=sine -kx=3 -ky=2 -omega=15.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -ts=implicit -orderInTime=2 -dtMax=.05 -go=halt 


cgwh waveHoltz.cmd -g=square64.order4.hdf -forcing=sine -kx=3 -ky=2 -omega=15.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -go=halt 
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =34 #########################
CgWaveHoltz::residual: c=1, omega= 1.52340e+01, omegas= 1.52254e+01 (from symbol of D+D-), dt=7.637868e-03
CgWaveHoltz::residual: max-res=1.710e-01 (using omega), max-res=2.585e-01 (using omega from discrete symbol)
CgWaveHoltz: omega=1.523e+01, max-res=1.710e-01, CR=0.667 CR-perPeriod=0.667, cpu= 4.41e-01(s)
CgWaveHoltz::Results saved to file cgWaveHoltz.m
CgWaveHoltz: max-err=2.048e-04


cgwh waveHoltz.cmd -g=square64.order4.hdf -forcing=sine -kx=3 -ky=2 -omega=5.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -go=halt 


>>>>> add some timings for implicit:

cgWave -noplot tz.cmd -g=shapese2.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=4 -ts=implicit -orderInTime=2 -tf=2 -tp=.1 -dtMax=.05 -cfl=.7 -go=go


>>>>>>>>  TEMP versions of high-order BC's


O8: Dirichlet + extrap : 
**NOTE: OGPolyfunction has max degree of 6 !!
cgWave tz.cmd -g=square16.order8 -ad4=0 -degreeInTime=2 -degreeInSpace=6 -orderInTime=2 -tf=1 -tp=.1 

O6: Dirichlet + extrap : exact
cgWave tz.cmd -g=square8.order6 -ad4=0 -degreeInTime=2 -degreeInSpace=6 -orderInTime=2 -tf=1 -tp=.1 



************************************************************************
********* Sat May 14, 2021


START ADD ORDER=8

NO BC's yet
cgWave known.cmd -g=square32.order6 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -known=planeWave -orderInTime=2 -cfl=.1


G32 ORDER=6 PERIODIC : 
cgWave known.cmd -g=square32p.order8 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -known=planeWave -orderInTime=2 -cfl=.001
cgWave known.cmd -g=square16p.order8 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -known=planeWave -orderInTime=2 -cfl=.001

G32  Ratio=117
cgWave: t=1.000e-01 ( 11314 steps) maxErr= 7.26e-11, ||u||= 9.96e-01

G16
cgWave: t=1.000e-01 (  5657 steps) maxErr= 6.17e-08, ||u||= 9.95e-01 



START ADD ORDER=6

G16/G32 = 77  (at low CFL)

G32 ORDER=6 PERIODIC : 
cgWave known.cmd -g=square32p.order6 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -known=planeWave -orderInTime=2 -cfl=.1

cfl=.1
cgWave: t=1.000e-01 (  91 steps) maxErr= 2.85e-06, ||u||= 9.96e-01 

cfl=.05
cgWave: t=1.000e-01 ( 182 steps) maxErr= 6.82e-07, ||u||= 9.96e-01

cfl=.02
cgWave: t=1.000e-01 (   453 steps) maxErr= 7.89e-08, ||u||= 9.96e-01  


G32 cfl=.005
cgWave: t=1.000e-01 (  1811 steps) maxErr= 2.94e-08, ||u||= 9.96e-01 


G16
cgWave known.cmd -g=square16p.order6 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -known=planeWave -orderInTime=2 -cfl=.005

cgWave: t=1.000e-01 (   906 steps) maxErr= 2.27e-06, ||u||= 9.95e-01 



SEMI-IMPLICIT TIME-STEPPING

SHAPES:
cgWave tz.cmd -g=shapese2.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=4 -ts=implicit -orderInTime=2 -tf=30 -tp=.1 -dtMax=.05 -cfl=.7

CgWave::getTimeStep: c=1, cfl=0.7, timeSteppingMethod=1
getTimeStep: grid=0 : dx= 2.50e-02, dy= 2.50e-02, dt=1.237e-02
getTimeStep: grid=1, dxMin= 6.68e-03, dxMax= 2.24e-02, dt=4.674e-03
getTimeStep: grid=2, dxMin= 1.33e-02, dxMax= 1.53e-02, dt=9.300e-03
getTimeStep: grid=3, dxMin= 7.86e-03, dxMax= 2.06e-02, dt=5.499e-03
cgWave::getTimeStep: explicit dt= 4.67e-03, implicit dt= 1.24e-02, ratio=  2.65


Look stable with UPW on Cartesina grid only
cgWave tz.cmd -g=cice2.order4.ng3 -ad4=1 -degreeInTime=2 -degreeInSpace=4 -ts=implicit -orderInTime=2 -tf=30 -tp=.1  -dtMax=.05

cgWave tz.cmd -g=cice2.order4.ng3 -ad4=0 -degreeInTime=2 -degreeInSpace=4 -ts=implicit -orderInTime=2 -tf=30 -tp=.1  -dtMax=.05

TURN ON AD 
cgWave tz.cmd -g=sice2.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1  -dtMax=.05 -cfl=.7 


cgWave tz.cmd -g=sice2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1  -dtMax=.05
cgWave tz.cmd -g=cice2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1  -dtMax=.05

exact:
cgWave tz.cmd -g=rsise2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1  -dtMax=.05


>>>> START ON ADDING UPWINDING TO IMPLICIT MATRIX 

TEST: 
cgWave tz.cmd -g=square3.order2 -ad4=1 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1  -dtMax=.05


 (1,1) coeff=-0.00e+00  3.19e-02 -0.00e+00  3.19e-02  9.10e-01  3.19e-02 -0.00e+00  3.19e-02 -0.00e+00 -2.89e+03 -9.38e-03 -9.38e-03 -9.38e-03 
 (2,1) coeff=-0.00e+00  3.19e-02 -0.00e+00  3.19e-02  9.10e-01  3.19e-02 -0.00e+00  3.19e-02 -0.00e+00 -2.23e+212 -9.38e-03 -7.26e+03 -9.38e-03 

TEST: 
 (1,1) coeff=-0.00e+00 -4.00e+00 -0.00e+00 -4.00e+00  6.00e+00 -4.00e+00 -0.00e+00 -4.00e+00 -0.00e+00  1.00e+00  1.00e+00  1.00e+00  1.00e+00 
 (2,1) coeff=-0.00e+00 -4.00e+00 -0.00e+00 -4.00e+00  6.00e+00 -4.00e+00 -0.00e+00 -4.00e+00 -0.00e+00  1.00e+00  1.00e+00  1.00e+00  1.00e+00 


UPWIND: (i1,i2)=(  1,  1) dir=0 ->  ADD entry m=  9, (i1s,i2s)=( -1,  1), adxSosup=-9.375e-03, upwStencilValue = 1.000e+00
UPWIND: (i1,i2)=(  1,  1) dir=0 ->  ADD entry m=  3, (i1s,i2s)=(  0,  1), adxSosup=-9.375e-03, upwStencilValue = -4.000e+00
UPWIND: (i1,i2)=(  1,  1) dir=0 ->  ADD entry m=  4, (i1s,i2s)=(  1,  1), adxSosup=-9.375e-03, upwStencilValue = 6.000e+00
UPWIND: (i1,i2)=(  1,  1) dir=0 ->  ADD entry m=  5, (i1s,i2s)=(  2,  1), adxSosup=-9.375e-03, upwStencilValue = -4.000e+00
UPWIND: (i1,i2)=(  1,  1) dir=0 ->  ADD entry m= 10, (i1s,i2s)=(  3,  1), adxSosup=-9.375e-03, upwStencilValue = 1.000e+00
UPWIND: (i1,i2)=(  1,  1) dir=1 ->  ADD entry m= 11, (i1s,i2s)=(  1, -1), adxSosup=-9.375e-03, upwStencilValue = 1.000e+00
UPWIND: (i1,i2)=(  1,  1) dir=1 ->  ADD entry m=  1, (i1s,i2s)=(  1,  0), adxSosup=-9.375e-03, upwStencilValue = -4.000e+00
UPWIND: (i1,i2)=(  1,  1) dir=1 ->  ADD entry m=  4, (i1s,i2s)=(  1,  1), adxSosup=-9.375e-03, upwStencilValue = 6.000e+00
UPWIND: (i1,i2)=(  1,  1) dir=1 ->  ADD entry m=  7, (i1s,i2s)=(  1,  2), adxSosup=-9.375e-03, upwStencilValue = -4.000e+00
UPWIND: (i1,i2)=(  1,  1) dir=1 ->  ADD entry m= 12, (i1s,i2s)=(  1,  3), adxSosup=-9.375e-03, upwStencilValue = 1.000e+00






cgWave tz.cmd -g=square5.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1  -dtMax=.05

cgWave tz.cmd -g=square8.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1  -dtMax=.05


************************************************************************
********* Fri May 14, 2021

>>>> START ON GENERALIZE IMPLICIT MATRIX 


FD24 IMP - exact
cgWave tz.cmd -g=square8.order4 -ad4=0 -degreeInTime=2 -degreeInSpace=4 -ts=implicit -orderInTime=2 -tf=1 -tp=.1 -dtMax=.05
cgWave tz.cmd -g=square8.order4 -ad4=0 -degreeInTime=2 -degreeInSpace=4 -ts=implicit -orderInTime=2 -tf=1 -tp=.1 -dtMax=.05 -bc=n

O2 Neumann: EXACT 
cgWave tz.cmd -g=square8.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1  -dtMax=.05 -bc=n

O2 D - exact
cgWave tz.cmd -g=square8.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1  -dtMax=.05


>>> START OM SEMI-IMPLICIT 


cgWave tz.cmd -g=cice2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=4 -orderInTime=2 -ts=implicit -tf=1 -tp=.1 -dtMax=.05
cgWave tz.cmd -g=sise2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=4 -orderInTime=2 -ts=implicit -tf=1 -tp=.1 -dtMax=.05




>>>> START TEST 3D

BUGS FIXED WITH TZ FORCING In 3D


>>>>> TZ : these are all EXACT:

F24 IMP
cgWave tz.cmd -g=nonBox2.order4 -ad4=0 -degreeInTime=2 -degreeInSpace=4 -orderInTime=2 -ts=implicit -tf=1 -tp=.1 -dtMax=.05
cgWave tz.cmd -g=box2.order4 -ad4=0 -degreeInTime=2 -degreeInSpace=4 -orderInTime=2 -ts=implicit -tf=1 -tp=.1 -dtMax=.05

cgWave tz.cmd -g=nonBox2.order4.ng3 -ad4=0 -degreeInTime=2 -degreeInSpace=4 -orderInTime=2 -tf=1 -tp=.1
cgWave tz.cmd -g=box2.order4.ng3 -ad4=0 -degreeInTime=2 -degreeInSpace=4 -orderInTime=2 -tf=1 -tp=.1

cgWave tz.cmd -g=nonBox2.order4.ng3 -ad4=0 -degreeInTime=4 -degreeInSpace=4 -tf=1 -tp=.1
cgWave tz.cmd -g=box2.order4.ng3 -ad4=0 -degreeInTime=4 -degreeInSpace=4 -tf=1 -tp=.1
cgWave tz.cmd -g=square16.order4.ng3 -ad4=0 -degreeInTime=4 -degreeInSpace=4 -tf=1 -tp=.1

exact
cgWave tz.cmd -g=nonBox2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1 -dtMax=.05
cgWave tz.cmd -g=box2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -ts=implicit -tf=1 -tp=.1 -dtMax=.05

cgWave tz.cmd -g=nonBox2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -tf=1 -tp=.1 
cgWave tz.cmd -g=box2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 -tf=1 -tp=.1 


************************************************************************
********* Thurs May 13, 2021

>>>> START TEST 3D

cgWave tz.cmd -g=box2.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 tf=1 -tp=.1 


@@@@@@@@@  START TEST IMPLICIT TIME-STEPPING

FIX FORCING FOR IMPLICIT

>>>>>>>>>>>>>>> OVERSET GRIDS:

WHAT HAPPENS IF WE TURN ON UPWINDING AND IMPLICIT?
Blows up: 
cgWave known.cmd -g=square128p.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -ts=implicit -orderInTime=2 -dtMax=.025 -go=halt 

BOX HELMHOLTZ -- errors are quite small:
cgWave known.cmd -g=cice4.order4 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=boxHelmholtz -ts=implicit -orderInTime=2 -dtMax=.025 -go=halt 
cgWave: t=5.000e+00 ( 200 steps) maxErr= 2.44e-04, ||u||= 7.60e-01 


cgWave known.cmd -g=cice4.order4 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -ts=implicit -orderInTime=2 -dtMax=.025 -go=halt 

DOES THIS GO UNSTABLE?  **yes** by t=20 or so
cgWave known.cmd -g=rsise8.order4 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -ts=implicit -orderInTime=2 -dtMax=.025 -go=halt 
cgWave known.cmd -g=rsise4.order4 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -ts=implicit -orderInTime=2 -dtMax=.025 -go=halt 



exact degree=[2,2]
cgWave tz.cmd -g=rsise4.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 tf=1 -tp=.1 -ts=implicit -dtMax=.1
cgWave tz.cmd -g=sise4.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 tf=1 -tp=.1 -ts=implicit -dtMax=.1


TRY FD24 IMP

cgWave known.cmd -g=square128p.order4 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -ts=implicit -orderInTime=2 -dtMax=.025 -go=halt 

FD24 : EXACT degree=(2,4)
cgWave tz.cmd -g=square16.order4 -ad4=0 -degreeInTime=2 -degreeInSpace=2 tf=1 -tp=.1 -orderInTime=2 -ts=implicit -dtMax=.1

cgWave: t=3.000e-01 (   3 steps) maxErr= 1.24e-14, ||u||= 5.14e+00 


--> looks 2nd-order
cgWave known.cmd -g=square128p.order2 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -ts=implicit -dtMax=.025 -go=halt 
cgWave known.cmd -g=square64p.order2 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -ts=implicit -dtMax=.05 -go=halt 

G128: 
cgWave: t=5.000e-01 (  20 steps) maxErr= 1.88e-02, ||u||= 1.00e+00

G64
cgWave: t=5.000e-01 (  10 steps) maxErr= 7.65e-02, ||u||= 1.01e+00

exact degree=[2,2]
cgWave tz.cmd -g=square16.order2 -ad4=0 -degreeInTime=2 -degreeInSpace=2 tf=1 -tp=.1 -ts=implicit -dtMax=.1


************************************************************************
********* Wed May 12, 2021

IMPLEMENT ORDER=4 in space and ORDER=2 in time ... Seems to work

Lower cfl needed as expected --- stability bound fixed
cgWave known.cmd -g=square64p.order4 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -orderInTime=2 -go=halt 

ORDER=24: exact
cgWave tz.cmd -g=square16.order4 -ad4=0 -degreeInSpace=4 -degreeInTime=2 tf=1 -tp=.1 -orderInTime=2



Order=4  
cgWave tz.cmd -g=square16.order4 -ad4=0 -degreeInSpace=4 -degreeInTime=4 tf=1 -tp=.1



WAVE-HOLTZ
cgwh waveHoltz.cmd -g=square64.order4.hdf -forcing=sine -kx=3 -ky=2 -omega=5.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -go=halt -bc=n

CgWaveHoltz: max-err=1.004e-03


>>>> WRITE getHelmholtzForcing to fill RHS for direct Helmholtz solver

FINISH ME -- NEED A ROUTINE TO FILL IN THE RHS FOR THE DIRECT HELMHOLTZ SOLVE
cgwh waveHoltz.cmd -g=square64.order4.hdf -forcing=sine -kx=3 -ky=2 -omega=5.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -go=halt -bc=d

NEUMANN: 
*** max residual=0.00e+00, time for 1st solve of the Dirichlet problem = 4.18e-02 (iterations=0) ***
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23364e+00 (from symbol of D+D-), dt=7.733980e-03
CgWaveHoltz::residual: max-res=4.896e-11 (using omega), max-res=3.743e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=4.896e-11, cpu= 4.95e-02 (Direct solution of Helmholtz).

G64: 
CgWaveHoltz: max-err=7.701e-04

G128: ratio=15.6
CgWaveHoltz: max-err=4.927e-05


DIRICHLET:
*** max residual=0.00e+00, time for 1st solve of the Dirichlet problem = 3.60e-02 (iterations=0) ***
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23364e+00 (from symbol of D+D-), dt=7.733980e-03
CgWaveHoltz::residual: max-res=5.696e-11 (using omega), max-res=3.741e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=5.696e-11, cpu= 4.18e-02 (Direct solution of Helmholtz).
CgWaveHoltz: max-err=1.390e-04



************************************************************************
********* Tues May 11, 2021

CHECK UPW -- periodic
cgWave known.cmd  -g=square64p.order2 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -go=halt 

CGMX: square64: cfl=1
dtg=cfl*1./( c*sqrt( 1./(dx[0]*dx[0])+1./(dx[1]*dx[1]) ) );  
dtg = 1/( sqrt( 1/dx^2 + 1/dx^2)) = .011

 +++++ FD t=1.000e-02 STAGE 0: computeUt=0 updateInterior=0 addDissipation=1 applyBCs=0
 advanceNFDTD:INFO eps,mu,c=1.00e+00 1.00e+00 1.00e+00 for grid=0 (square) 
advMxUp: useSosup dissipation, t,dt,adSosup=  0.00E+00  0.10E-01 -0.13E-02
advMxUp: useSosup dissipation, debug=  7
advMxUp: sosupDissipationOption= 0             sosupParameter=  1.00E+00
advMxUp: updateDissipation= 1
advMxUp: updateSolution= 0
advMxUp: useNewForcingMethod= 0
advMxUp: computeUt= 0 gridType= 0          order= 2
advMxUp>>>FD22r-UP...update-un-with-     dissipation

 +++++ FD t=1.000e-02 STAGE 1: computeUt=0 updateInterior=1 addDissipation=0 applyBCs=1
 advanceNFDTD:INFO eps,mu,c=1.00e+00 1.00e+00 1.00e+00 for grid=0 (square) 

>>>> Inside advOptNew... t= 0.000E+00 grid=  0
advOPT: useSosup dissipation, t,dt,adSosup=  0.00E+00  0.10E-01  0.13E-02
advOPT: sosupDissipationOption= 0
advOPT: updateDissipation= 0
advOPT: updateSolution= 1
advOPT: useNewForcingMethod= 0
 Inside advOptNew rectangular order=2...









CgWave::getTimeStep: c=1, cfl=0.9
getTimeStep: dx= 1.56e-02, dy= 1.56e-02, dt=9.944e-03






TEST DIRECT HELHOMTZ SOLVER FOR NEUMANN BC 

FINISH ME -- NEED A ROUTINE TO FILL IN THE RHS FOR THE DIRECT HELMHOLTZ SOLVE
cgwh waveHoltz.cmd -g=square64.order4.hdf -forcing=sine -kx=3 -ky=2 -omega=5.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -go=halt -bc=n


CONTINUE ON NEW BCOPT ROUTINES

FOR UPWINDING -- extrapolate extra ghost line in BC OPT

TRY CIC -- 
cgWave helmholtz.cmd -g=cice2.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=1 -go=halt 

>> box helmholtz

ORDER=4 NEUMANN -- some wiggles near corners at late times
cgWave known.cmd  -g=square32.order4.ng3 -bc=n -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt 

Order=2 + UPW : cfl=.7 needed
cgWave known.cmd  -g=square32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt -cfl=.7

>>> plane wave

ORDER=4 NEUMANN -- wiggles near corners at later times
cgWave known.cmd  -g=square32.order4.ng3 -bc=n -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -go=halt 


plane-wave NEUMANN -- errors large at corners *CHECK ME*
cgWave known.cmd  -g=square32.order4.ng3 -bc=n -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -go=halt

cgWave known.cmd  -g=square32.order2 -bc=n -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -go=halt -cfl=.7

cgWave known.cmd  -g=square32.order4.ng3 -bc=d -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -go=halt

**FIX ME: Nuemann
cgWave known.cmd  -g=square32.order2 -bc=n -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -go=halt -cfl=.7

cgWave known.cmd  -g=square32.order2 -bc=d -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -go=halt -cfl=.7
cgWave known.cmd  -g=square32.order2 -bc=d -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=planeWave -go=halt

>>>>> TZ:

cgWave -noplot tz.cmd -g=square16.order4.ng3 -degreeInSpace=4 -degreeInTime=4 -tf=.5 -tp=.1 -ad4=0 -bc=n -go=go
cgWave -noplot tz.cmd -g=square16.order4.ng3 -degreeInSpace=4 -degreeInTime=4 -tf=.5 -tp=.1 -ad4=0 -bc=d -go=go


cgWave -noplot tz.cmd -g=square16.order2 -degreeInSpace=2 -degreeInTime=2 -tf=.5 -tp=.1 -ad4=0 -bc=n -go=go
cgWave -noplot tz.cmd -g=square16.order2 -degreeInSpace=2 -degreeInTime=2 -tf=.5 -tp=.1 -ad4=0 -bc=d -go=go

************************************************************************
********* Sun/Mon May 9/10, 2021


START ON NEW BCOPT ROUTINES

**** FIX UPWINDING ****


**NEW* known.cmd

cgWave known.cmd  -g=square32.order4 -bc=d -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt

cgWave: t=1.000e-01 (   6 steps) maxErr= 1.88e-05, ||u||= 9.55e-01 
CgWave:advance: nextTimeToPlot=2.000e-01, numPlotSteps=6, new dt=1.667e-02 (dtMax=1.989e-02) ratio=0.838
it=0: completed step 12, t=2.00e-01, nextTimeToPlot=2.000e-01
cgWave: t=2.000e-01 (  12 steps) maxErr= 2.21e-05, ||u||= 8.25e-01 

cgWave known.cmd  -g=square32.order2 -bc=d -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -known=boxHelmholtz -go=halt

cgWave: t=1.000e-01 (   6 steps) maxErr= 1.17e-03, ||u||= 9.57e-01 
CgWave:advance: nextTimeToPlot=2.000e-01, numPlotSteps=6, new dt=1.667e-02 (dtMax=1.989e-02) ratio=0.838
it=0: completed step 12, t=2.00e-01, nextTimeToPlot=2.000e-01
cgWave: t=2.000e-01 (  12 steps) maxErr= 3.71e-03, ||u||= 8.29e-01 
CgWave:advance: nextTimeToPlot=3.000e-01, numPlotSteps=6, new dt=1.667e-02 (dtMax=1.989e-02) ratio=0.838
it=0: completed step 18, t=3.00e-01, nextTimeToPlot=3.000e-01
cgWave: t=3.000e-01 (  18 steps) maxErr= 5.45e-03, ||u||= 6.27e-01 


cgWave planeWave.cmd -g=square16.order4.ng3 -bc=d -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -cfl=.9 -go=halt





BC=n ****TO-DO**** WITH NEW OPTIMIZED
cgWave planeWave.cmd -g=square128.order4.ng3 -bc=n -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -cfl=.9 -go=halt




CURVILINEAR:


Order=4 exact 
cgWave tz.cmd -g=nonSquare16.order4 -ad4=0 -degreeInSpace=4 -degreeInTime=4 -bc=n

exact
cgWave tz.cmd -g=nonSquare16.order2 -ad4=0 -degreeInSpace=2 -degreeInTime=2 -bc=n




TEST TZ 
--- NEW 
Order=4 exact (use EXTRAP FOR CORNERS)
cgWave tz.cmd -g=square16.order4 -ad4=0 -degreeInSpace=4 -degreeInTime=4 -bc=n


Order=2 Neumann: exact
cgWave tz.cmd -g=square16.order2 -ad4=0 -degreeInSpace=2 -degreeInTime=2 -bc=n

Order=4 exact 
cgWave tz.cmd -g=square16.order4 -ad4=0 -degreeInSpace=4 -degreeInTime=4

Order=2 Looks exact 
cgWave tz.cmd -g=square16.order2 -ad4=0 -degreeInSpace=2 -degreeInTime=2


--- OLD : 
EXACT: 
cgWave tz.cmd -g=square16.order4 -ad4=0 -degreeInSpace=4 -degreeInTime=4

it=0: completed step 6, t=2.00e-01, nextTimeToPlot=2.000e-01
cgWave: t=2.000e-01 (   6 steps) maxErr= 2.66e-15, ||u||= 4.99e+00 


Exact
cgWave tz.cmd -g=square16.order2 -ad4=0 -degreeInSpace=2 -degreeInTime=2

************************************************************************
********* Sun May 9, 2021

CHANGE SIGN OF HELMHOMTZ FORCING IN adWave.bf

ADD option to compute error when solution is known 

ADD option to plot errors  

>>> TEST cgWave 

ORDER=4 + PWD = OK 
cgWave planeWave.cmd -g=square128.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -cfl=.7 -go=halt

TROUBLE: upwing needs CFL=.7 ****
cgWave planeWave.cmd -g=square128.order2 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5 -debug=3 -cfl=.7 -go=halt


cgWave planeWave.cmd -noplot -g=square128.order2 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=5-go=go

cgWave helmholtz.cmd -g=square64.order4 -kx=1 -ky=1 -tp=2

NEW
cgWave: t=1.998e+00 ( 201 steps) maxErr= 4.24e-07, ||u||= 6.56e-01 
 $$$$$$$$ cgWave: plot: plotOptions=1 t=1.998e+00
cgWave:updateTimeIntegral: t=3.142e+00 TIME INTEGRAL v:  maxErr= 4.03e-07
cgWave: t=3.142e+00 ( 316 steps) maxErr= 4.23e-07, ||u||= 1.00e+00 
 $$$$$$$$ cgWave: plot: plotOptions=1 t=3.142e+00
 $$$$$$$$ cgWave: plot: plotOptions=1 t=3.142e+00



OLD: 
cgWave: t=1.998e+00 (201 steps) maxErr= 4.24e-07
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 4.03e-07  ************** TIME INTEGRAL ****
cgWave: t=3.142e+00 (316 steps) maxErr= 4.23e-07




TEST eigemode exact solution 
    ue = sin(kx*x)*sin(ky*y)*cos(omega*t)

>> ORDER=4
cgwh waveHoltz.cmd -g=square128.order4.hdf -forcing=sine -kx=3 -ky=2 -omega=5.234 -solver=none -tol=1e-6 -tp=1000 -ad4=0 -imode=1 -go=halt   
cgwh waveHoltz.cmd -g=square64.order4.hdf -forcing=sine -kx=3 -ky=2 -omega=5.234 -solver=none -tol=1e-6 -tp=100 -ad4=0 -imode=1 -go=halt   
G64 
CgWaveHoltz: max-err=1.014e-04
G128 
CgWaveHoltz: max-err=3.876e-06

>>> ORDER=2
cgwh waveHoltz.cmd -g=square64.order2.hdf -forcing=sine -kx=3 -ky=2 -omega=5.234 -solver=none -tol=1e-6 -tp=1 -ad4=0 -imode=1 -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =5 #########################
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23364e+00 (from symbol of D+D-), dt=7.744876e-03
CgWaveHoltz::residual: max-res=3.988e-03 (using omega), max-res=2.129e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=3.988e-03, CR=0.096 CR-perPeriod=0.096, cpu= 1.95e-01(s)

G64
CgWaveHoltz: max-err=6.346e-03

G128
CgWaveHoltz: max-err=1.582e-03


************************************************************************
********* Sat May 8, 2021


MOVE TO MAC WHILE VPN IS DOWN


TEST DIRECT HELMHOLTZ SOLVER

high-frequency: 
cgwh waveHoltz.cmd -g=annulus8.order2.hdf -x0=.5303 -y0=.5303 -omega=55.234 -solver=none -matlab=square128Order4FixedPoint -numPeriods=10 -tol=1e-3 -tp=1 -ad4=0 -imode=1 -go=halt


cgwh waveHoltz.cmd -g=square64.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -solver=none -matlab=square64FixedPoint -tol=1e-3 -tp=1 -ad4=0 -imode=1 -go=halt

Oges::allocateWorkSpace: numberOfNonzeros=21429 fillinRatio=2.000000e+01
allocateWorkSpace: numberOfEquations=4761, nsp = 428580, fillinRatio= 20, numberOfNonzeros = 21429

*** max residual=0.00e+00, time for 1st solve of the Dirichlet problem = 1.32e-02 (iterations=0) ***
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23364e+00 (from symbol of D+D-), dt=7.744876e-03
CgWaveHoltz::residual: max-res=1.223e-11 (using omega), max-res=2.874e-03 (using omega from discrete symbol)
CgWaveHoltz: omega=5.234e+00, max-res=1.223e-11, cpu= 8.03e-01 (Direct solution of Helmholtz).




TRY ANNULUS .. OK


cgwh waveHoltz.cmd -g=annulus4.order2.hdf -x0=.5303 -y0=.5303 -omega=15.234 -solver=none -matlab=square128Order4FixedPoint -numPeriods=10 -tol=1e-3 -tp=1 -ad4=0 -imode=1 -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =16 #########################
CgWaveHoltz::residual: c=1, omega= 1.52340e+01, omegas= 1.52239e+01 (from symbol of D+D-), dt=8.265428e-03
CgWaveHoltz::residual: max-res=1.305e+00 (using omega), max-res=1.549e-04 (using omega from discrete symbol)
CgWaveHoltz: omega=1.523e+01, max-res=1.305e+00, CR=0.800 CR-perPeriod=0.989, cpu= 1.28e+01(s)


TRY ORDER=4
cgwh waveHoltz.cmd -g=square128.order4.hdf -x0=.75 -y0=.75 -omega=5.234 -solver=none -matlab=square128Order4FixedPoint -numPeriods=10 -tol=1e-3 -tp=1 -ad4=0 -imode=1 -go=halt

CgWaveHoltz::residual: c=1, omega= 1.37600e+01, omegas= 1.37584e+01 (from symbol of D+D-), dt=3.866442e-03
CgWaveHoltz::residual: max-res=5.293e-02 (using omega), max-res=2.426e-01 (using omega from discrete symbol)


cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=13.76 -solver=none -matlab=square64FixedPoint -numPeriods=10 -tol=1e-3 -tp=1 -ad4=0 -imode=1 -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =9 #########################
CgWaveHoltz::residual: c=1, omega= 1.37600e+01, omegas= 1.37584e+01 (from symbol of D+D-), dt=3.866442e-03
CgWaveHoltz::residual: max-res=2.364e-01 (using omega), max-res=5.926e-06 (using omega from discrete symbol)


Run interactively: 
cgwh waveHoltz.cmd -g=square64.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -solver=none -matlab=square64FixedPoint -tol=1e-3 -tp=1 -ad4=0 -imode=1 -go=halt

#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =31 #########################
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23364e+00 (from symbol of D+D-), dt=7.744876e-03
CgWaveHoltz::residual: max-res=2.875e-03 (using omega), max-res=4.594e-08 (using omega from discrete symbol)


cgwh -noplot waveHoltz.cmd -g=square256.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -solver=fixedPoint -matlab=square256FixedPoint -tol=1e-3 -tp=1 -ad4=0 -imode=1 -go=go


cgwh -noplot waveHoltz.cmd -g=square64.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -solver=fixedPoint -matlab=square64FixedPoint -tol=1e-3 -tp=1 -ad4=0 -imode=1 -go=go

cgwh -noplot waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=5.234 -solver=fixedPoint -matlab=square128FixedPoint -tol=1e-3 -tp=1 -ad4=0 -imode=1 -go=go


#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =31 #########################
CgWaveHoltz::residual: c=1, omega= 5.23400e+00, omegas= 5.23391e+00 (from symbol of D+D-)
CgWaveHoltz::residual: max-res=4.280e-02 (using omega), max-res=4.340e-02 (using omega from discrete symbol)
Maximum residual = 4.280e-02, cpu= 3.66e+00(s)


************************************************************************
********* Fri May 7, 2021

Add option to use omega from discrete symbol of D+D-

Larger omega
cgwh waveHoltz.cmd -g=square256.order2.hdf -x0=.75 -y0=.75 -omega=22.3 -solver=krylov -tol=1e-8 -tp=1 -ad4=0 -imode=1 -numPeriods=5

 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.04e-06 (tol=1.00e-08) numberOfIterations=17 #############
CgWaveHoltz::residual: c=1, omega= 2.23000e+01, omegas= 2.22983e+01 (from symbol of D+D-)
CgWaveHoltz::residual: max-res=3.482e+00 (using omega), max-res=1.323e-06 (using omega from discrete symbol)
omega=2.230e+01, Maximum residual = 3.482e+00



G256
cgwh -noplot waveHoltz.cmd -g=square256.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-10 -tp=1 -ad4=0 -imode=1

 ################ DONE KYRLOV ITERATIONS -- KSP residual=7.63e-10 (tol=1.00e-10) numberOfIterations=16 #############
CgWaveHoltz::residual: c=1, omega= 7.00000e+00, omegas= 6.99995e+00 (from symbol of D+D-)
CgWaveHoltz::residual: max-res=3.556e-02 (using omega), max-res=3.892e-08 (using omega from discrete symbol)
omega=7.000e+00, Maximum residual = 3.556e-02




--- G128 
cgwh -noplot waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-10 -tp=1 -ad4=0 -imode=1


 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.95e-10 (tol=1.00e-10) numberOfIterations=16 #############
CgWaveHoltz::residual: c=1, omega= 7.00000e+00, omegas= 6.99979e+00 (from symbol of D+D-)
CgWaveHoltz::residual: max-res=1.439e-01 (using omega), max-res=7.482e-09 (using omega from discrete symbol)



 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.64e-03 (tol=1.00e-03) numberOfIterations=11 #############
CgWaveHoltz::residual: c=1, omega= 7.00000e+00, omegas= 6.99979e+00 (from symbol of D+D-), useOmegaFromDiscreteSymbol=1
omega=7.000e+00, Maximum residual = 4.169e-03



************************************************************************
********* Thurs May 6, 2021


REVISIT waveHoltz again

================  ORDER=2 -- 

imode=1 SHOULD BE DO NOT WAIT IN CGWAVE ** FIX ME 

cgwh waveHoltz.cmd -g=square512.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-5 -tp=1 -ad4=0 -imode=1

cgwh waveHoltz.cmd -g=square256.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-4 -tp=1 -ad4=0 -imode=1
 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.17e-03 (tol=1.00e-04) numberOfIterations=11 #############
omega=7.000e+00, Maximum residual = 3.792e-02

cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1
################ DONE KYRLOV ITERATIONS -- KSP residual=1.64e-03 (tol=1.00e-03) numberOfIterations=11 #############
omega=7.000e+00, Maximum residual = 1.449e-01

FIXED-POINT -omega=7 has trouble, may be close to a resonance!! TRY -omega=6.869 with -numPeriods=5
cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=6.869 -solver=fixedPoint -tol=1e-3 -tp=1 -ad4=0 -imode=1 -maxIt=200 -numPeriods=5


it=75:  max(|v-vOld|)=9.70e-04 (tol=0.001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =76 #########################
Maximum residual = 4.527e-02



*** OLD **** ================  ORDER=2 -- looks OK 

cgwh waveHoltz.cmd -g=square512.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-5 -tp=1 -ad4=0 -imode=1
cgwh waveHoltz.cmd -g=square256.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-4 -tp=1 -ad4=0 -imode=1
cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1

FIXED-POINT -omega=7 has trouble, may be close to a resonance!! TRY -omega=6.869 with -numPeriods=5
cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=6.869 -solver=fixedPoint -tol=1e-3 -tp=1 -ad4=0 -imode=1 -maxIt=200 -numPeriods=5

it=75:  max(|v-vOld|)=9.70e-04 (tol=0.001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =76 #########################
Maximum residual = 4.527e-02




 ################ DONE KYRLOV ITERATIONS -- numberOfIterations=11 #############
CgWaveHoltz::residual: c=1, omega=7

G512
 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.35e-04 (tol=1.00e-05) numberOfIterations=12 #############
CgWaveHoltz::residual: c=1, omega=7
Maximum residual = 8.888e-03

G256
 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.17e-03 (tol=1.00e-04) numberOfIterations=11 #############
CgWaveHoltz::residual: c=1, omega=7
Maximum residual = 3.792e-02

G128
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.64e-03 (tol=1.00e-03) numberOfIterations=11 #############
CgWaveHoltz::residual: c=1, omega=7
Maximum residual = 1.449e-01





************************************************************************
********* Fri April 2, 2021


REVISIT 

cgwh waveHoltz.cmd -g=square64.order4.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1

cgwh waveHoltz.cmd -g=square128.order4.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1


************************************************************************
********* Tues Jan 5, 2021

EXACT : 
../bin/cgWave tz.cmd -g=square16.order4 -ad4=0 -degreeInSpace=4 -degreeInTime=4


************************************************************************
********* Fri Mar 6, 2020


++++++++++ SIS 

RESIDUAL LARGE AT UPPER RIGHT CORNER, interior OK

cgwh waveHoltz.cmd -g=sise16.order4.ng3 -beta=10 -x0=.5 -y0=.5 -omega=2.56 -solver=krylov -tol=1e-5 -tp=1 -ad4=1 -imode=1
 ################ DONE KYRLOV ITERATIONS -- KSP residual=2.73e-03 (tol=1.00e-05) numberOfIterations=8 #############
omega=2.560e+00, Maximum residual = 3.760e-03



cgwh waveHoltz.cmd -g=sise4.order4.ng3 -beta=10 -x0=.5 -y0=.5 -omega=2.56 -solver=krylov -tol=1e-5 -tp=1 -ad4=1 -imode=1


++++++++++++ CIC ORDER=4 -- Helmholtz Gaussian source

WIGGLES IN RESIDUAL NEAR INTERPOLATION POINTS -- CHECK SIS GRID


cgwh waveHoltz.cmd -g=cice8.order4.ng3 -beta=10 -x0=1 -y0=1 -omega=2.56 -solver=krylov -tol=1e-5 -tp=1 -ad4=1 -imode=1

cgwh waveHoltz.cmd -g=cice4.order4.ng3 -beta=10 -x0=1 -y0=1 -omega=2.56 -solver=krylov -tol=1e-4 -tp=1 -ad4=1 -imode=1

G8-Order=4
################ DONE KYRLOV ITERATIONS -- KSP residual=1.50e-03 (tol=1.00e-05) numberOfIterations=14 #############
omega=2.560e+00, Maximum residual = 1.024e-02

G4-Order=4
 ################ DONE KYRLOV ITERATIONS -- KSP residual=7.29e-03 (tol=1.00e-04) numberOfIterations=13 #############
omega=2.560e+00, Maximum residual = 3.676e-03


++++++++++++ CIC ORDER=2 -- Helmholtz Gaussian source

CHECK RESIDUAL -- WIGGLES NEAR INTERPOLATION BOUNDARY ???


CHANGE BETA -- Gaussian was very narrow


cgwh waveHoltz.cmd -g=cice16.order2 -beta=10 -x0=1 -y0=1 -omega=2.56 -solver=krylov -tol=1e-5 -tp=1 -ad4=1 -imode=1
cgwh waveHoltz.cmd -g=cice8.order2 -beta=10 -x0=1 -y0=1 -omega=2.56 -solver=krylov -tol=1e-5 -tp=1 -ad4=1 -imode=1

cgwh waveHoltz.cmd -g=cice4.order2 -beta=10 -x0=1 -y0=1 -omega=2.56 -solver=krylov -tol=1e-3 -tp=1 -ad4=1 -imode=1


G16


G8
################ DONE KYRLOV ITERATIONS -- KSP residual=1.31e-03 (tol=1.00e-05) numberOfIterations=14 #############
omega=2.560e+00, Maximum residual = 7.921e-04

G4
 ################ DONE KYRLOV ITERATIONS -- KSP residual=5.26e-02 (tol=1.00e-03) numberOfIterations=12 #############
omega=2.560e+00, Maximum residual = 3.118e-03


G2 
cgwh waveHoltz.cmd -g=cice2.order2 -beta=10 -x0=1 -y0=1 -omega=2.56 -solver=krylov -tol=1e-3 -tp=1 -ad4=1 -imode=1

################ DONE KYRLOV ITERATIONS -- KSP residual=3.38e-02 (tol=1.00e-03) numberOfIterations=12 #############
omega=2.560e+00, Maximum residual = 1.640e-02



TROUBLE WITH NAN's NOTE -- DISSIPATION IS OFF 
cgwh waveHoltz.cmd -g=cice2.order2 -x0=1 -y0=1 -omega=2.56 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1







++++++++++++++ SQUARE -- Helmholtz Gaussian source

  

================  ORDER=4

cgwh waveHoltz.cmd -g=square512.order4.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-6 -tp=1 -ad4=0 -imode=1
cgwh waveHoltz.cmd -g=square256.order4.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-5 -tp=1 -ad4=0 -imode=1
cgwh waveHoltz.cmd -g=square128.order4.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1
cgwh waveHoltz.cmd -g=square64.order4.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1

G512
################ DONE KYRLOV ITERATIONS -- KSP residual=1.54e-05 (tol=1.00e-06) numberOfIterations=13 #############
Maximum residual = 4.732e-05
################ DONE KYRLOV ITERATIONS -- KSP residual=7.44e-07 (tol=1.00e-07) numberOfIterations=14 #############
Maximum residual = 4.734e-05


G256
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.67e-04 (tol=1.00e-05) numberOfIterations=12 #############
Maximum residual = 5.578e-04

--- tol=1e-4 not enough
################ DONE KYRLOV ITERATIONS -- KSP residual=3.14e-03 (tol=1.00e-04) numberOfIterations=11 #############
Maximum residual = 4.488e-03


G128 
################ DONE KYRLOV ITERATIONS -- KSP residual=1.57e-03 (tol=1.00e-03) numberOfIterations=11 #############
Maximum residual = 1.392e-02


G64 
################ DONE KYRLOV ITERATIONS -- KSP residual=7.93e-04 (tol=1.00e-03) numberOfIterations=11 #############
CgWaveHoltz::residual: c=1, omega=7
Maximum residual = 1.531e-01


================== TRY INCREASING NUM-PERIODS  -- reduces iterations but not clear thsi will be faster

cgwh waveHoltz.cmd -g=square256.order2.hdf -x0=.75 -y0=.75 -omega=7 -numPeriods=5 -solver=krylov -tol=1e-4 -tp=1 -ad4=0 -imode=1
cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=7 -numPeriods=5 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1

G256
 ################ DONE KYRLOV ITERATIONS -- KSP residual=6.53e-04 (tol=1.00e-04) numberOfIterations=7 #############
CgWaveHoltz::residual: c=1, omega=7
Maximum residual = 3.555e-02



G128
################ DONE KYRLOV ITERATIONS -- KSP residual=2.11e-02 (tol=1.00e-03) numberOfIterations=6 #############
CgWaveHoltz::residual: c=1, omega=7
Maximum residual = 1.428e-01


================  ORDER=2 -- looks OK 

cgwh waveHoltz.cmd -g=square512.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-5 -tp=1 -ad4=0 -imode=1
cgwh waveHoltz.cmd -g=square256.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-4 -tp=1 -ad4=0 -imode=1
cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=7 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1

FIXED-POINT -omega=7 has trouble, may be close to a resonance!! TRY -omega=6.869 with -numPeriods=5
cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=6.869 -solver=fixedPoint -tol=1e-3 -tp=1 -ad4=0 -imode=1 -maxIt=200 -numPeriods=5

it=75:  max(|v-vOld|)=9.70e-04 (tol=0.001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =76 #########################
Maximum residual = 4.527e-02




 ################ DONE KYRLOV ITERATIONS -- numberOfIterations=11 #############
CgWaveHoltz::residual: c=1, omega=7

G512
 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.35e-04 (tol=1.00e-05) numberOfIterations=12 #############
CgWaveHoltz::residual: c=1, omega=7
Maximum residual = 8.888e-03

G256
 ################ DONE KYRLOV ITERATIONS -- KSP residual=3.17e-03 (tol=1.00e-04) numberOfIterations=11 #############
CgWaveHoltz::residual: c=1, omega=7
Maximum residual = 3.792e-02

G128
 ################ DONE KYRLOV ITERATIONS -- KSP residual=1.64e-03 (tol=1.00e-03) numberOfIterations=11 #############
CgWaveHoltz::residual: c=1, omega=7
Maximum residual = 1.449e-01



../bin/cgwh waveHoltz.cmd -g=square128.order4.hdf -x0=.75 -y0=.75 -omega=13 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1
../bin/cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=13 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1


../bin/cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.5 -y0=.5 -omega=6 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=1


ORDER=4


ORDER=2
CgWave:advance: new dt=3.867e-03, numberOfTimeSteps=125
CgWave::advance: c=1, omega=13, Tperiod=0.483322, numPeriods=10, tFinal=0.483322, plotSteps=259
*******  CgWave::takeFirstBackwardStep GET SOLUTION at -dt *************
cgWave: t=0.000e+00 (   0 steps) maxErr= 0.00e+00, ||u||= 3.67e+00 
cgWave:updateTimeIntegral: t=4.833e-01 TIME INTEGRAL v:  maxErr= 0.00e+00
cgWave: t=4.833e-01 ( 125 steps) maxErr= 0.00e+00, ||u||= 3.67e+00 
it=-1:  max(|v-vOld|)=2.09e-04, tol=0.001

 ################ DONE KYRLOV ITERATIONS -- numberOfIterations=15 #############
Maximum residual = 1.359e-01



../bin/cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=6 -solver=krylov -tol=1e-3 -tp=1 -ad4=0 -imode=0

../bin/cgwh waveHoltz.cmd -g=square128.order2.hdf -x0=.75 -y0=.75 -omega=6 -tol=1e-3 -tp=1 -ad4=0 -imode=0




CHECK CGWH - RUN WITH NOPLOTTING AND EXIT
../bin/cgwh -noplot boxHelmholtz.cmd -g=cice4.order2.hdf -omega=2 -solver=krylov -tol=1e-3 -tp=1 -ad4=1 -imode=1


 **************** MatVec for PETSc iteration=-1 *************

CgWave:advance: new dt=1.147e-02, numberOfTimeSteps=274
CgWave::advance: c=1, omega=2, Tperiod=3.14159, numPeriods=10, tFinal=3.14159, plotSteps=87
*******  CgWave::takeFirstBackwardStep GET SOLUTION at -dt *************
cgWave: t=0.000e+00 (   0 steps) maxErr= 4.95e-03, ||u||= 1.00e+00 
cgWave: t=9.975e-01 (  87 steps) maxErr= 3.57e-03, ||u||= 4.15e-01 
cgWave: t=1.995e+00 ( 174 steps) maxErr= 2.42e-03, ||u||= 6.63e-01 
cgWave: t=2.993e+00 ( 261 steps) maxErr= 5.01e-03, ||u||= 9.61e-01 
cgWave:updateTimeIntegral: t=3.142e+00 TIME INTEGRAL v:  maxErr= 5.04e-03
cgWave: t=3.142e+00 ( 274 steps) maxErr= 3.84e-03, ||u||= 1.00e+00 
it=-1:  max(|v-vOld|)=1.22e-03, tol=0.001

 ################ DONE KYRLOV ITERATIONS -- numberOfIterations=3 #############
Maximum residual = 6.004e-03




++++++ CHECK MEMORY USAGE 

$cgWave planeWave.cmd -noplot -g=square4096.order2 -ad4=0 -kx=1 -ky=1 -tp=.01 -tf=.01 -go=go

ORDER=2 G4096
Memory usage: reals/grid-point =   4.78.

$cgWave planeWave.cmd -noplot -g=square4096.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.001 -tf=.001 -go=go
$cgWave planeWave.cmd -noplot -g=square1024.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=.1 -go=go

----- NEW ----

ELIMINATE VERTEX 

Count :  3 (time levels) + 1 (error ) + 2 (vertex)  + 2 temp (uDot + lap)  = 8 
Count :  3 (time levels) + 1 (error ) + 0 (vertex)  + 2 temp (uDot + lap)  = 6 


ORDER=4 G4096
Memory usage: reals/grid-point =   4.78.

G2048
Memory usage: reals/grid-point =   5.83.

G1024
Memory usage: reals/grid-point =  10.79.

 ------ OLD -----
G4096
  Memory usage: reals/grid-point =   6.78.

G2048
 Memory usage: reals/grid-point =  12.93.

G1024:
 Memory usage: reals/grid-point =  12.93.


              -------------------CgWave Summary----------------- 
                       Fri Mar  6 07:18:45 2020
               Grid:   /home/henshw/grids/square1024.order4.ng3.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =      161, grids=1, gridpts =1.06296e+06, interp pts=0, processors=1 ==== 
  ==== memory per-proc: [min=104.895,ave=104.895,max=104.895](Mb), max-recorded=104.895 (Mb), total=104.895 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  1.64e+01    1.02e-01    9.57e-08   100.000   1.638e+01   1.638e+01
setup and initialize................  5.60e-03    3.48e-05    3.27e-11     0.034   5.599e-03   5.599e-03
initial conditions..................  1.50e-01    9.33e-04    8.78e-10     0.917   1.502e-01   1.502e-01
advance.............................  1.62e+01    1.01e-01    9.47e-08    99.005   1.621e+01   1.621e+01
  advance rectangular grids.........  9.80e+00    6.09e-02    5.73e-08    59.860   9.802e+00   9.802e+00
  advance curvilinear grids.........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add dissipation...................  6.09e+00    3.78e-02    3.56e-08    37.199   6.092e+00   6.092e+00
  boundary conditions...............  8.52e-02    5.29e-04    4.98e-10     0.520   8.523e-02   8.523e-02
  interpolation.....................  9.55e-03    5.93e-05    5.58e-11     0.058   9.549e-03   9.549e-03
  update ghost (parallel)...........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add forcing.......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  get errors........................  1.95e-01    1.21e-03    1.14e-09     1.190   1.948e-01   1.948e-01
  plotting..........................  2.38e-02    1.48e-04    1.39e-10     0.146   2.383e-02   2.383e-02
output results......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
waiting (not counted)...............  4.67e-04    2.90e-06    2.73e-12     0.003   4.670e-04   4.670e-04
--------------------------------------------------------------------------------------------------------
 Memory usage: reals/grid-point =  12.93.



************************************************************************
********* Thurs Mar 5, 2020

START ON PARALLEL

APPLY DISS AT LEAST 2 STEPS IN A ROW -- better : dissFreq=8  = OK 
mpirun -np 8 $cgWave planeWave.cmd -numParGhost=3 -g=cice16.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=10 -dissFreq=8

mpirun -np 8 $cgWave planeWave.cmd -numParGhost=3 -g=cice16.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=10 -dissFreq=4

ADD DISSIPATION FREQUENCY -- disFreq=4 too large 
mpirun -np 8 $cgWave planeWave.cmd -numParGhost=3 -g=cice16.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=10 -dissFreq=4


mpirun -np 8 $cgWave planeWave.cmd -numParGhost=3 -g=square2048.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=1 

cgWave: t=1.001e-01 ( 322 steps) maxErr= 1.29e-13, ||u||= 1.00e+00 
cgWave: t=2.001e-01 ( 644 steps) maxErr= 1.83e-13, ||u||= 1.00e+00 
cgWave: t=3.002e-01 ( 966 steps) maxErr= 2.11e-13, ||u||= 1.00e+00 


              ---------CgWave Summary------- 
                       Thu Mar  5 20:28:52 2020
               Grid:   /home/henshw/grids/square2048.order4.ng3.hdf 
  ==== final time= 5.00e-01, numberOfStepsTaken =     1610, grids=1, gridpts =4.22302e+06, interp pts=0, processors=8 ==== 
  ==== memory per-proc: [min=109.809,ave=125.785,max=185.375](Mb), max-recorded=182.965 (Mb), total=1006.28 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  9.01e+01    5.59e-02    1.32e-08   100.000   9.032e+01   9.002e+01
setup and initialize................  5.55e-03    3.45e-06    8.17e-13     0.006   6.131e-03   5.301e-03
initial conditions..................  6.55e-02    4.07e-05    9.63e-12     0.073   6.841e-02   6.180e-02
advance.............................  9.00e+01    5.59e-02    1.32e-08    99.881   8.997e+01   8.995e+01
  advance rectangular grids.........  5.25e+01    3.26e-02    7.72e-09    58.293   5.264e+01   5.224e+01
  advance curvilinear grids.........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add dissipation...................  3.32e+01    2.06e-02    4.88e-09    36.870   3.330e+01   3.298e+01
  boundary conditions...............  8.18e-01    5.08e-04    1.20e-10     0.908   9.291e-01   6.817e-01
  interpolation.....................  9.03e-01    5.61e-04    1.33e-10     1.003   1.171e+00   6.656e-01
  update ghost (parallel)...........  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  add forcing.......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
  get errors........................  2.33e-01    1.45e-04    3.43e-11     0.259   2.368e-01   2.291e-01
  plotting..........................  2.30e+00    1.43e-03    3.38e-10     2.551   2.311e+00   2.287e+00
output results......................  0.00e+00    0.00e+00    0.00e+00     0.000   0.000e+00   0.000e+00
waiting (not counted)...............  8.63e+00    5.36e-03    1.27e-09     9.578   8.638e+00   8.613e+00
--------------------------------------------------------------------------------------------------------
 Memory usage: reals/grid-point =  31.23.
--------------------------------------------------------------------------------------------------------
 ======== Parallel Distribution for CgWave (np=8)============
 numberOfGrids=1, gridDistributionList.size()=1l 
  grid=0: procs=8 [0,7], proc-decomp=[4]x[2]x[1], pts=4223025=[2055]x[2055]x[1], pts/proc=526851=[513]x[1027]x[1], ratio=1027/513=  2, ghost=[3,3,0]





ADD AD4
mpirun -np 2 $cgWave planeWave.cmd -numParGhost=3 -g=square32.order4.ng3 -ad4=1 -kx=1 -ky=1 -tp=.1 -tf=1 
cgWave: t=1.000e-01 (   5 steps) maxErr= 2.19e-05, ||u||= 9.96e-01 
cgWave: t=2.000e-01 (  10 steps) maxErr= 2.05e-05, ||u||= 1.00e+00 
cgWave: t=3.000e-01 (  15 steps) maxErr= 3.65e-05, ||u||= 9.97e-01


ORDER=4 -- OK
mpirun -np 2 $cgWave planeWave.cmd -numParGhost=3 -g=square32.order4 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=1 

NP=1
cgWave: t=1.000e-01 (   5 steps) maxErr= 2.65e-05, ||u||= 9.96e-01 
cgWave: t=2.000e-01 (  10 steps) maxErr= 2.33e-05, ||u||= 1.00e+00 
cgWave: t=3.000e-01 (  15 steps) maxErr= 2.77e-05, ||u||= 9.97e-01

LOOKS OK: 
mpirun -np 4 ../bin/cgWave planeWave.cmd -g=sise2.order2 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=1

cgWave: t=9.677e-02 (3 steps) maxErr= 6.11e-04, ||u||= 9.97e-01 
cgWave: t=1.935e-01 (6 steps) maxErr= 1.62e-03, ||u||= 9.90e-01 
cgWave: t=2.903e-01 (9 steps) maxErr= 2.42e-03, ||u||= 9.99e-01 
cgWave: t=3.871e-01 (12 steps) maxErr= 4.28e-03, ||u||= 1.00e+00 
cgWave: t=4.839e-01 (15 steps) maxErr= 4.23e-03, ||u||= 9.97e-01 
cgWave: t=5.806e-01 (18 steps) maxErr= 5.36e-03, ||u||= 9.94e-01 
cgWave: t=6.774e-01 (21 steps) maxErr= 9.35e-03, ||u||= 1.01e+00


.. BUGS FIXED 

Trouble --> ZER UNUSED POINTS BROKEN IN PARALLEL **FIX ME**
mpirun -np 1 ../bin/cgWave planeWave.cmd -g=cice2.order2 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=1 

Trouble at interp points : 
mpirun -np 1 ../bin/cgWave planeWave.cmd -g=sise2.order2 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=1 


WORKS: 
mpirun -np 4 ./bin/cgWave planeWave.cmd -g=square32.order2 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=1 

cgWave: t=1.000e-01 (5 steps) maxErr= 2.48e-04, ||u||= 9.96e-01 
cgWave: t=2.000e-01 (10 steps) maxErr= 6.81e-04, ||u||= 1.00e+00 
cgWave: t=3.000e-01 (15 steps) maxErr= 1.04e-03, ||u||= 9.97e-01 
cgWave: t=4.000e-01 (20 steps) maxErr= 1.82e-03, ||u||= 1.00e+00 
cgWave: t=5.000e-01 (25 steps) maxErr= 1.79e-03, ||u||= 9.98e-01


RE-ORG TIME INTEGRAL


cgWave helmholtz.cmd -g=square64.order4 -kx=1 -ky=1 -tp=2

cgWave: t=1.998e+00 (201 steps) maxErr= 4.24e-07
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 4.03e-07  ************** TIME INTEGRAL ****
cgWave: t=3.142e+00 (316 steps) maxErr= 4.23e-07


RUN WITH NOPLOTTING AND EXIT
../bin/cgwh -noplot boxHelmholtz.cmd -g=cice4.order2.hdf -omega=2 -solver=krylov -tol=1e-3 -tp=1 -ad4=1 -imode=1



Zero out unused ghost points...
../bin/cgwh boxHelmholtz.cmd -g=cice4.order2.hdf -omega=2 -solver=krylov -tol=1e-3 -tp=1 -ad4=1 -imode=1

************************************************************************
********* Tues Mar 3, 2020

WAVE-HOLTZ + cic 

TROUBLE with PETSc and imode=1 -- resid = nan's
../bin/cgwh boxHelmholtz.cmd -g=cice4.order2.hdf -omega=2 -solver=krylov -tol=1e-5 -imode=1

../bin/cgwh boxHelmholtz.cmd -g=cice4.order2.hdf -omega=2 -tol=1e-5 -imode=1



../bin/cgwh boxHelmholtz.cmd -g=cice4.order4.ng3.hdf -omega=2 -solver=krylov -tol=1e-5 -imode=1
../bin/cgwh boxHelmholtz.cmd -g=cice2.order4.ng3.hdf -omega=2 -solver=krylov -tol=1e-5 -imode=1

G4 : ORDER=4
advWave: ADVANCE dim=2 order=4                 grid=curvilinear... t=  0.11E-01
cgWave: t=4.966e-01 (46 steps) maxErr= 1.12e-05, ||u||= 5.46e-01 
cgWave: t=9.932e-01 (92 steps) maxErr= 8.34e-06, ||u||= 4.04e-01 
cgWave: t=1.490e+00 (138 steps) maxErr= 2.00e-05, ||u||= 9.87e-01 
cgWave: t=1.986e+00 (184 steps) maxErr= 1.39e-05, ||u||= 6.74e-01 
cgWave: t=2.483e+00 (230 steps) maxErr= 5.05e-06, ||u||= 2.51e-01 
cgWave: t=2.980e+00 (276 steps) maxErr= 1.97e-05, ||u||= 9.48e-01 
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 2.05e-05
cgWave: t=3.142e+00 (291 steps) maxErr= 2.07e-05, ||u||= 1.00e+00 
it=-1:  max(|v-vOld|)=1.30e-06, tol=1e-05

 **************** DONE KYRLOV ITERATIONS -- numberOfIterations=8 *************

Maximum residual = 6.903e-03

G2  order=4
cgWave: t=4.950e-01 (26 steps) maxErr= 2.82e-04, ||u||= 5.49e-01 
cgWave: t=9.901e-01 (52 steps) maxErr= 2.00e-04, ||u||= 3.98e-01 
cgWave: t=1.485e+00 (78 steps) maxErr= 4.84e-04, ||u||= 9.86e-01 
cgWave: t=1.980e+00 (104 steps) maxErr= 3.73e-04, ||u||= 6.83e-01 
cgWave: t=2.475e+00 (130 steps) maxErr= 1.88e-04, ||u||= 2.36e-01 
cgWave: t=2.970e+00 (156 steps) maxErr= 4.49e-04, ||u||= 9.42e-01 
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 4.98e-04
cgWave: t=3.142e+00 (165 steps) maxErr= 4.97e-04, ||u||= 1.00e+00 
it=-1:  max(|v-vOld|)=3.40e-06, tol=1e-05

 ################ DONE KYRLOV ITERATIONS -- numberOfIterations=8 #############
Maximum residual = 3.699e-02




../bin/cgwh boxHelmholtz.cmd -g=cice4.order2.hdf -omega=2 -solver=krylov -tol=1e-4
ORDER=2
advWave: ADVANCE dim=2 order=2                 grid=curvilinear... t=  0.11E-01
cgWave: t=5.045e-01 (44 steps) maxErr= 1.46e-03, ||u||= 5.34e-01 
cgWave: t=1.009e+00 (88 steps) maxErr= 1.16e-03, ||u||= 4.34e-01 
cgWave: t=1.513e+00 (132 steps) maxErr= 2.72e-03, ||u||= 9.96e-01 
cgWave: t=2.018e+00 (176 steps) maxErr= 1.78e-03, ||u||= 6.28e-01 
cgWave: t=2.522e+00 (220 steps) maxErr= 9.08e-04, ||u||= 3.27e-01 
cgWave: t=3.027e+00 (264 steps) maxErr= 2.66e-03, ||u||= 9.76e-01 
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 2.74e-03
cgWave: t=3.142e+00 (274 steps) maxErr= 2.74e-03, ||u||= 1.00e+00 
plot: finish chosen...
it=-1:  max(|v-vOld|)=9.43e-05, tol=0.0001

 **************** DONE KYRLOV ITERATIONS -- numberOfIterations=6 *************

Maximum residual = 4.955e-04




************************************************************************
********* Sun Mar 1, 2020

*** NEW CALLING SEQUENCE FOR cgwh and cgWave ***


WAVE-HOLTZ + cic 


../bin/cgwh boxHelmholtz.cmd -g=cice4.order4.ng3.hdf -omega=2 -solver=krylov -tol=1e-5

../bin/cgwh boxHelmholtz.cmd -g=cice4.order4.ng3.hdf -omega=2 -tol=1e-4
../bin/cgwh boxHelmholtz.cmd -g=cice4.order2.hdf -omega=2 -tol=1e-3

../bin/cgwh boxHelmholtz.cmd -g=cice2.order4.ng3.hdf -omega=2 -tol=1e-3
../bin/cgwh boxHelmholtz.cmd -g=cice2.order2.hdf -omega=2 -tol=1e-3

G4 - ORDER=4 + KRYLOV   -- tol=1e-6 : tol=1.e-5 and 7-it's were good enough
cgWave: t=4.966e-01 (46 steps) maxErr= 1.12e-05 (max(|u|)= 5.46e-01) 
cgWave: t=9.932e-01 (92 steps) maxErr= 8.38e-06 (max(|u|)= 4.04e-01) 
cgWave: t=1.490e+00 (138 steps) maxErr= 2.01e-05 (max(|u|)= 9.87e-01) 
cgWave: t=1.986e+00 (184 steps) maxErr= 1.39e-05 (max(|u|)= 6.74e-01) 
cgWave: t=2.483e+00 (230 steps) maxErr= 5.05e-06 (max(|u|)= 2.51e-01) 
cgWave: t=2.980e+00 (276 steps) maxErr= 1.95e-05 (max(|u|)= 9.48e-01) 
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 2.05e-05
cgWave: t=3.142e+00 (291 steps) maxErr= 2.06e-05 (max(|u|)= 1.00e+00) 
it=-1:  max(|v-vOld|)=2.25e-07, tol=1e-06

 **************** DONE KYRLOV ITERATIONS -- numberOfIterations=9 *************

Maximum residual = 6.909e-03




G4 - ORDER=4 -- FIXED-POINT may not be converged
cgWave: t=4.966e-01 (46 steps) maxErr= 3.79e-04 (max(|u|)= 5.46e-01) 
cgWave: t=9.932e-01 (92 steps) maxErr= 5.54e-04 (max(|u|)= 4.04e-01) 
cgWave: t=1.490e+00 (138 steps) maxErr= 8.55e-04 (max(|u|)= 9.88e-01) 
cgWave: t=1.986e+00 (184 steps) maxErr= 1.82e-04 (max(|u|)= 6.74e-01) 
cgWave: t=2.483e+00 (230 steps) maxErr= 6.98e-04 (max(|u|)= 2.52e-01) 
cgWave: t=2.980e+00 (276 steps) maxErr= 7.82e-04 (max(|u|)= 9.49e-01) 
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 7.83e-04
cgWave: t=3.142e+00 (291 steps) maxErr= 5.86e-04 (max(|u|)= 1.00e+00) 
it=14:  max(|v-vOld|)=9.74e-05 (tol=0.0001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =14 #########################
Maximum residual = 6.867e-03



G2 - ORDER=4
cgWave: t=4.950e-01 (26 steps) maxErr= 1.30e-03 (max(|u|)= 5.50e-01) 
cgWave: t=9.901e-01 (52 steps) maxErr= 1.96e-03 (max(|u|)= 4.00e-01) 
cgWave: t=1.485e+00 (78 steps) maxErr= 2.91e-03 (max(|u|)= 9.88e-01) 
cgWave: t=1.980e+00 (104 steps) maxErr= 8.61e-04 (max(|u|)= 6.84e-01) 
cgWave: t=2.475e+00 (130 steps) maxErr= 2.48e-03 (max(|u|)= 2.38e-01) 
cgWave: t=2.970e+00 (156 steps) maxErr= 2.75e-03 (max(|u|)= 9.44e-01) 
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 2.66e-03
cgWave: t=3.142e+00 (165 steps) maxErr= 1.99e-03 (max(|u|)= 1.00e+00) 
it=3:  max(|v-vOld|)=3.79e-04 (tol=0.001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =3 #########################
Maximum residual = 3.664e-02


G4  - ORDER=2
cgWave: t=5.045e-01 (44 steps) maxErr= 2.23e-03 (max(|u|)= 5.35e-01) 
cgWave: t=1.009e+00 (88 steps) maxErr= 2.95e-03 (max(|u|)= 4.35e-01) 
cgWave: t=1.513e+00 (132 steps) maxErr= 4.82e-03 (max(|u|)= 9.98e-01) 
cgWave: t=2.018e+00 (176 steps) maxErr= 1.64e-03 (max(|u|)= 6.28e-01) 
cgWave: t=2.522e+00 (220 steps) maxErr= 3.43e-03 (max(|u|)= 3.30e-01) 
cgWave: t=3.027e+00 (264 steps) maxErr= 4.38e-03 (max(|u|)= 9.78e-01) 
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 4.58e-03
cgWave: t=3.142e+00 (274 steps) maxErr= 3.90e-03 (max(|u|)= 1.00e+00) 
it=3:  max(|v-vOld|)=4.52e-04 (tol=0.001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =3 #########################
Maximum residual = 4.049e-03

G2 - ORDER=2
cgWave: t=5.094e-01 (24 steps) maxErr= 9.28e-03 (max(|u|)= 5.33e-01) 
cgWave: t=1.019e+00 (48 steps) maxErr= 7.21e-03 (max(|u|)= 4.57e-01) 
cgWave: t=1.528e+00 (72 steps) maxErr= 1.72e-02 (max(|u|)= 1.01e+00) 
cgWave: t=2.038e+00 (96 steps) maxErr= 1.14e-02 (max(|u|)= 6.05e-01) 
cgWave: t=2.547e+00 (120 steps) maxErr= 6.96e-03 (max(|u|)= 3.80e-01) 
cgWave: t=3.057e+00 (144 steps) maxErr= 1.74e-02 (max(|u|)= 1.00e+00) 
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 1.74e-02
cgWave: t=3.142e+00 (148 steps) maxErr= 1.80e-02 (max(|u|)= 1.02e+00) 
it=5:  max(|v-vOld|)=9.19e-04 (tol=0.001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =5 #########################
Maximum residual = 8.508e-03



++++++ Overset grids

cgWave helmholtz.cmd -g=cice2.order2 -kx=1 -ky=1 -tp=.1 -tf=1


cgWave planeWave.cmd -g=cice2.order2 -ad4=0 -kx=1 -ky=1 -tp=.1 -tf=1 



START ON REGRESSION TESTS -- see conv/memo

*new way* 
cgWave -noplot planeWave.cmd -g=square32.order4 -ad4=0 -kx=1 -ky=1 -tp=.2 -tf=1 -go=go


cgWave -noplot -grid=square32.order4 -cmd=planeWave -ad4=0 -kx=1 -ky=1 -tp=.2 -tf=1 -go=go

# Check file for CgWave. date=Sun Mar  1 09:45:25 2020

 0.00e+00 1  0  0.00e+00  1.000e+00  
 2.00e-01 1  0  2.33e-05  1.000e+00  
 4.00e-01 1  0  2.76e-05  9.998e-01  
 6.00e-01 1  0  3.67e-05  9.996e-01  
 8.00e-01 1  0  3.28e-05  9.992e-01  
 1.00e+00 1  0  4.99e-05  9.988e-01
 

cgWave -grid=square32.order2 -cmd=planeWave -ad4=0 -kx=1 -ky=1 -tp=.2 -tf=1



************************************************************************
********* Sat Feb 29, 2020


+++++++ WAVE HOLTZ 

>>>>>>>>> FOURTH ORDER 
LOOKS BETTER -- residual largest near the boundary -- need to fix ghost 
COMPARE ERRORS IN TIME INTEGRAL ratio= 30 

../bin/cgwh -grid=square64.order4 -cmd=boxHelmholtz.cmd -omega=2 -tol=1e-4
../bin/cgwh -grid=square32.order4 -cmd=boxHelmholtz.cmd -omega=2 -tol=1e-3

G64
cgWave: t=5.030e-01 (65 steps) maxErr= 2.20e-06
cgWave: t=1.006e+00 (130 steps) maxErr= 7.10e-06
cgWave: t=1.509e+00 (195 steps) maxErr= 5.93e-06
cgWave: t=2.012e+00 (260 steps) maxErr= 4.95e-06
cgWave: t=2.515e+00 (325 steps) maxErr= 7.88e-06
cgWave: t=3.018e+00 (390 steps) maxErr= 1.40e-06
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 5.34e-07
cgWave: t=3.142e+00 (406 steps) maxErr= 8.17e-06
it=3:  max(|v-vOld|)=8.09e-06 (tol=0.0001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =3 #########################
Maximum residual = 7.956e-04


G32
cgWave: t=9.905e-01 (64 steps) maxErr= 3.30e-04
cgWave: t=1.486e+00 (96 steps) maxErr= 3.31e-04
cgWave: t=1.981e+00 (128 steps) maxErr= 1.31e-04
cgWave: t=2.476e+00 (160 steps) maxErr= 4.08e-04
cgWave: t=2.971e+00 (192 steps) maxErr= 1.18e-04
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 1.63e-05
cgWave: t=3.142e+00 (203 steps) maxErr= 3.85e-04
it=2:  max(|v-vOld|)=4.00e-04 (tol=0.001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =2 #########################
Maximum residual = 5.925e-03


>>>>>>>>> SECOND-ORDER

RESIDUAL IS SMOOTH

../bin/cgwh -grid=square64.order2 -cmd=boxHelmholtz.cmd -omega=2 -tol=1e-4
../bin/cgwh -grid=square32.order2 -cmd=boxHelmholtz.cmd -omega=2 -tol=1e-3

G64
cgWave: t=5.030e-01 (65 steps) maxErr= 4.55e-04
cgWave: t=1.006e+00 (130 steps) maxErr= 3.53e-04
cgWave: t=1.509e+00 (195 steps) maxErr= 8.45e-04
cgWave: t=2.012e+00 (260 steps) maxErr= 5.42e-04
cgWave: t=2.515e+00 (325 steps) maxErr= 2.72e-04
cgWave: t=3.018e+00 (390 steps) maxErr= 8.21e-04
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 8.45e-04
cgWave: t=3.142e+00 (406 steps) maxErr= 8.54e-04
it=3:  max(|v-vOld|)=8.47e-06 (tol=0.0001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =3 #########################
Maximum residual = 9.319e-05


G32
advWave: sosupParameter=  0.10E+01
cgWave: t=4.952e-01 (32 steps) maxErr= 2.00e-03
cgWave: t=9.905e-01 (64 steps) maxErr= 9.78e-04
cgWave: t=1.486e+00 (96 steps) maxErr= 3.71e-03
cgWave: t=1.981e+00 (128 steps) maxErr= 2.45e-03
cgWave: t=2.476e+00 (160 steps) maxErr= 1.27e-03
cgWave: t=2.971e+00 (192 steps) maxErr= 3.05e-03
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 3.38e-03
cgWave: t=3.142e+00 (203 steps) maxErr= 3.81e-03
it=2:  max(|v-vOld|)=4.51e-04 (tol=0.001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =2 #########################
Maximum residual = 1.058e-03




+++++++  CHECK ACCURACY OF PERIODIC SOLUTION AND INTEGRAL 

MORE bugs fixed ...

Some bugs fixed in integral...

COMPUTE AND PLOT TIME integral 
NOTE Default tf=2*pi/omega

cgWave -grid=square64.order4 -cmd=helmholtz.cmd -kx=1 -ky=1 -tp=2

cgWave: t=1.998e+00 (201 steps) maxErr= 4.24e-07
cgWave: t=3.142e+00 TIME INTEGRAL v:  maxErr= 4.03e-07  ************** TIME INTEGRAL ****
cgWave: t=3.142e+00 (316 steps) maxErr= 4.23e-07


cgWave -grid=square32.order4 -cmd=helmholtz.cmd -kx=1 -ky=1 -tp=.5




cgWave -grid=square32.order4 -cmd=helmholtz.cmd -kx=1 -ky=1 -tf=1 -tp=.1

getErrors: t=1.000e-01, maxErr=1.554e-05
getErrors: t=2.000e-01, maxErr=1.896e-05
getErrors: t=3.000e-01, maxErr=1.562e-05
getErrors: t=4.000e-01, maxErr=1.386e-05
getErrors: t=5.000e-01, maxErr=1.077e-05


../bin/cgWave -grid=square32.order2 -cmd=helmholtz.cmd -kx=1 -ky=1 -tf=1 -tp=.01



************************************************************************
********* Thurs-Fri Feb 27-28, 2020


CHANGE DIRICHLET BC -- extrap ghost 


../bin/cgWave -grid=square32.order4 -cmd=helmholtz.cmd -kx=1 -ky=1 -tf=1 -tp=.01

G128
getErrors: t=9.950e-02, maxErr=1.756e-08
getErrors: t=1.990e-01, maxErr=4.383e-08
getErrors: t=2.985e-01, maxErr=4.997e-08
getErrors: t=3.980e-01, maxErr=3.635e-08
getErrors: t=4.975e-01, maxErr=1.500e-08

G64
getErrors: t=9.901e-02, maxErr=4.846e-07
getErrors: t=1.980e-01, maxErr=6.200e-07
getErrors: t=2.970e-01, maxErr=7.411e-07
getErrors: t=3.960e-01, maxErr=4.493e-07
getErrors: t=4.950e-01, maxErr=3.942e-07


G32
getErrors: t=1.000e-01, maxErr=1.554e-05
getErrors: t=2.000e-01, maxErr=1.896e-05
getErrors: t=3.000e-01, maxErr=1.562e-05
getErrors: t=4.000e-01, maxErr=1.386e-05
getErrors: t=5.000e-01, maxErr=1.077e-05



OLD 
getErrors: t=1.000e-01, maxErr=3.339e-06


TEST WAVE-HOLTZ

../bin/cgwh -grid=square64.order4 -cmd=boxHelmholtz.cmd -omega=2 -tol=1e-4

ORDER=4 ** WHY IS THE RESIDUAL THE SAME AS FOR ORDER=2 ???
getErrors: t=5.030e-01, maxErr=2.076e-04
getErrors: t=1.006e+00, maxErr=7.613e-04
getErrors: t=1.509e+00, maxErr=5.745e-04
getErrors: t=2.012e+00, maxErr=4.853e-04
getErrors: t=2.515e+00, maxErr=8.078e-04
getErrors: t=3.018e+00, maxErr=9.654e-05
getErrors: t=3.142e+00, maxErr=8.069e-04
it=3:  max(|v-vOld|)=2.21e-05 (tol=0.0001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =3 #########################
Maximum residual = 6.294e-02


ORDER=2
../bin/cgwh -grid=square64.order2 -cmd=boxHelmholtz.cmd -omega=2 -tol=1e-4

getErrors: t=5.030e-01, maxErr=6.611e-04
getErrors: t=1.006e+00, maxErr=4.013e-04
getErrors: t=1.509e+00, maxErr=1.416e-03
getErrors: t=2.012e+00, maxErr=1.021e-03
getErrors: t=2.515e+00, maxErr=1.074e-03
getErrors: t=3.018e+00, maxErr=9.112e-04
getErrors: t=3.142e+00, maxErr=1.652e-03
it=3:  max(|v-vOld|)=2.28e-05 (tol=0.0001)
#################### DONE CgWaveHoltz: CALL cgWave : number of WaveHoltz iteration =3 #########################
Maximum residual = 6.301e-02




TEST A SOLUTION TO HELMHOLTZ TO ORDER=4 **LOOKS OK**

TEST BACKWARD STEP
../bin/cgWave -grid=square32.order4 -cmd=helmholtz.cmd -kx=1 -ky=1 -tf=1 -tp=.01

G64
getErrors: t=5.000e-01, maxErr=3.525e-07

G32:
getErrors: t=5.000e-01, maxErr=6.537e-06


Backward Step: 
getErrors: t=2.000e-02, maxErr=8.720e-08

NO backward step 
getErrors: t=2.000e-02, maxErr=2.404e-07


TEST GAUSSIAN PULSE Forcing 
../bin/cgwh -grid=square64.order2 -cmd=waveHoltz.cmd -omega=5


TEST PETSc  -- OK
../bin/cgwh -grid=square64.order2 -cmd=boxHelmholtz.cmd -omega=2 -solver=krylov

../bin/cgwh -grid=square64.order2 -cmd=boxHelmholtz.cmd -omega=2


CONTINUE ON A SOLUTION TO HELMHOLTZ 

$cgWave -grid=square64.order4.ng3 -cmd=helmholtz.cmd -kx=1 -ky=1 -tf=10 -tp=.1 -ad4=1

../bin/cgWave -grid=square32.order4 -cmd=helmholtz.cmd -kx=1 -ky=1 -tf=1 -tp=.01

getErrors: t=1.000e-01, maxErr=3.339e-06

G64 
getErrors: t=1.000e-01, maxErr=1.921e-07

************************************************************************
********* Thurs Feb 27, 2020

START ON A SOLUTION TO HELMHOLTZ 

../bin/cgWave -grid=square32.order2 -cmd=helmholtz.cmd -kx=1 -ky=1 -tf=1 -tp=.01



************************************************************************
********* Tues Feb 25, 2020

FD22 broken ?? 



BUG FOUND -- initial fv(0)=0. if note used


TROUBLE:  NAN's 
../bin/cgWave -grid=cice2.order2 -cmd=pulse.cmd -x0=1 -y0=1 -beta=50 -ad4=1 -bc=d -tf=10 -tp=.1


../bin/cgWave -grid=cice4.order2 -cmd=tz.cmd -ad4=0

../bin/cgWave -grid=cice2.order2 -cmd=tz.cmd -ad4=0

../bin/cgWave -grid=rsise8.order2 -cmd=tz.cmd -ad4=0

../bin/cgWave -grid=nonSquare64.order2 -cmd=tz.cmd -ad4=0
../bin/cgWave -grid=square64.order2 -cmd=tz.cmd -ad4=0


START ON BOUNDARY CONDITIONS

UPWIND -- OK (fixed uDotFactor)
../bin/cgWave -grid=cice4.order4.ng3 -cmd=pulse.cmd -x0=1 -y0=1 -beta=50 -ad4=1 -bc=e -tf=10 -tp=.5

../bin/cgWave -grid=cice4.order4 -cmd=pulse.cmd -x0=1 -y0=1 -beta=50 -ad4=0 -bc=e -tf=10 -tp=.5

../bin/cgWave -grid=rsise4.order4 -cmd=pulse.cmd -ad4=0 -bc=d

../bin/cgWave -grid=nonSquare64.order4 -cmd=pulse.cmd -ad4=0 -bc=d

../bin/cgWave -grid=square64.order4 -cmd=pulse.cmd -ad4=0 -bc=d



************************************************************************
********* Tues Feb 25, 2020

START ON USER DEFINED KNOWN SOLUTION 

../bin/cgWave -grid=sise4.order4 -cmd=planeWave -ad4=0 -kx=1 -ky=1

../bin/cgWave -grid=square64.order4 -cmd=planeWave -ad4=0
--CgWave-- getUserDefinedKnownSolution at t=2.982e-01
getErrors: t=2.982e-01, maxErr=6.592e-07


../bin/cgWave -grid=square16.order2 -cmd=planeWave -ad4=0

************************************************************************
********* Mon Feb 24, 2020



Gaussian pulse IC:


../bin/cgWave -grid=sise4.order4.ng3 -cmd=pulse -ad4=0

../bin/cgWave -grid=square64.order4.ng3 -cmd=pulse -ad4=0

../bin/cgWave -grid=square16.order2 -cmd=pulse.cmd -ad4=0



START FOURTH-ORDER PLUS UPWIND 

EXACT 
../bin/cgWave -grid=square16.order4.ng3 -cmd=tz.cmd -ad4=1 -degreeInSpace=4 -degreeInTime=4


START FOURTH ORDER ME

OK: EXACT
../bin/cgWave -grid=rsise2.order4 -cmd=tz.cmd -ad4=0

OK: EXACT
../bin/cgWave -grid=sise2.order4 -cmd=tz.cmd -ad4=0


EXACT
../bin/cgWave -grid=nonSquare16.order4.ng3 -cmd=tz.cmd -ad4=0 -degreeInSpace=4 -degreeInTime=4

EXACT: 
../bin/cgWave -grid=square16.order4.ng3 -cmd=tz.cmd -ad4=0 -degreeInSpace=4 -degreeInTime=4


../bin/cgWave -grid=square16.order4.ng3 -cmd=tz.cmd -ad4=0 -degreeInSpace=2 -degreeInTime=2


CONTINUE ON UPWIND DISSIPATION 

exact:
../bin/cgWave -grid=rsise2.order2 -cmd=tz.cmd -ad4=1

STARTS TO WORK
../bin/cgWave -grid=sise2.order2 -cmd=tz.cmd -ad4=1


************************************************************************
********* Mon Feb 24, 2020

START ON UPWIND DISSIPATION 

THIS does not yet work: 
../bin/cgWave -grid=sise2.order2 -cmd=tz.cmd -ad4=1



EXACT 
../bin/cgWave -grid=square8.order2 -cmd=tz.cmd -ad4=1 -degreeInSpace=2


exact 
../bin/cgWave -grid=square16.order2 -cmd=tz.cmd -ad4=1

exact 
../bin/cgWave -grid=square16.order2 -cmd=tz.cmd -ad4=0

************************************************************************
********* Sun Feb 23, 2020

START ON CgWave CLASS

../bin/cgWave -grid=square16.order2 -cmd=tz.cmd

../bin/cgWave -grid=nonSquare64.order2 


************************************************************************
********* Fri Feb 21, 2020

CLEAN UP CODE

../bin/cgwh -grid=nonSquare128.order2 -cmd=gaussian.cmd -omega=3.1 -x0=.5 -y0=.5 -ad4=0 -tol=1e-3 -cfl=.9 -numPeriods=10

it=-1:  max(|v-vOld|)=8.13e-07, tol=0.001
Maximum residual = 5.914e-04
Maximum residual = 5.914e-04


../bin/cgwh -grid=nonSquare128.order2 -cmd=gaussian.cmd -omega=3.1 -x0=.5 -y0=.5 -ad4=0.5 -tol=1e-3 -cfl=.9

it=3: completed step 328, t=1.63e+00 (cpu =3.55e-01)
it=3: completed step 369, t=1.83e+00 (cpu =4.07e-01)
  3 KSP Residual norm 1.126863361173e-04 
KSP Object: 1 MPI processes
  type: gmres
    GMRES: restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
    GMRES: happy breakdown tolerance 1e-30
  maximum iterations=10000, initial guess is zero
  tolerances:  relative=0.001, absolute=1e-50, divergence=10000
  left preconditioning
  using PRECONDITIONED norm type for convergence test
PC Object: 1 MPI processes
  type: none
  linear system matrix = precond matrix:
  Matrix Object:   1 MPI processes
    type: shell
    rows=17822, cols=17822
***** DONE KSP SOLVE ******
***** CALL AGAIN TO CHECK SOLUTION ******
+++ usermult called iteration=-1
CgWaveHoltz:advance: numberOfTimeSteps=408
CgWaveHoltz::advance: c=1, omega=3.1, Tperiod=2.02683, numPeriods=1, tFinal=2.02683, plotSteps=41
it=-1: completed step 0, t=0.00e+00 (cpu =6.75e-04)
it=-1: completed step 41, t=2.04e-01 (cpu =4.12e-02)
it=-1: completed step 82, t=4.07e-01 (cpu =8.56e-02)
it=-1: completed step 123, t=6.11e-01 (cpu =1.29e-01)
it=-1: completed step 164, t=8.15e-01 (cpu =1.72e-01)
it=-1: completed step 205, t=1.02e+00 (cpu =2.14e-01)
it=-1: completed step 246, t=1.22e+00 (cpu =2.57e-01)
it=-1: completed step 287, t=1.43e+00 (cpu =3.01e-01)
it=-1: completed step 328, t=1.63e+00 (cpu =3.44e-01)
it=-1: completed step 369, t=1.83e+00 (cpu =3.86e-01)
it=-1:  max(|v-vOld|)=9.78e-06, tol=0.001
Maximum residual = 5.910e-03
Maximum residual = 5.910e-03



**** TROUBLE with overlapping grid and numPeriods=1 :--> increase numPeriods --> better
../bin/cgwh -grid=sise4.order2 -cmd=gaussian.cmd -omega=5.1 -x0=.75 -y0=.5 -ad4=0 -tol=1e-3 -cfl=.9 -numPeriods=20


../bin/cgwh -grid=square128.order2 -cmd=gaussian.cmd -omega=5.1 -x0=.75 -y0=.5 -ad4=0 -tol=1e-3 -cfl=.9

CgWaveHoltz::advance: c=1, omega=5.1, Tperiod=1.232, numPeriods=1, tFinal=1.232, plotSteps=25
it=-1: completed step 0, t=0.00e+00 (cpu =3.94e-04)
it=-1: completed step 25, t=1.24e-01 (cpu =4.03e-02)
it=-1: completed step 50, t=2.49e-01 (cpu =8.63e-02)
it=-1: completed step 75, t=3.73e-01 (cpu =1.12e-01)
it=-1: completed step 100, t=4.97e-01 (cpu =1.35e-01)
it=-1: completed step 125, t=6.21e-01 (cpu =1.59e-01)
it=-1: completed step 150, t=7.46e-01 (cpu =1.81e-01)
it=-1: completed step 175, t=8.70e-01 (cpu =2.04e-01)
it=-1: completed step 200, t=9.94e-01 (cpu =2.27e-01)
it=-1: completed step 225, t=1.12e+00 (cpu =2.52e-01)
it=-1:  max(|v-vOld|)=5.83e-05, tol=0.001
Maximum residual = 5.335e-03
Maximum residual = 5.335e-03



** trouble with omega=3.1 -- resonance??
../bin/cgwh -grid=nonSquare128.order2 -cmd=gaussian.cmd -omega=5.1 -x0=.75 -y0=.5 -ad4=0 -tol=1e-3 -cfl=.9


../bin/cgwh -grid=nonSquare128.order2 -cmd=gaussian.cmd -omega=3.1 -x0=.5 -y0=.5 -ad4=0.5 -tol=1e-3 -cfl=.9

CgWaveHoltz:advance: numberOfTimeSteps=408
CgWaveHoltz::advance: c=1, omega=3.1, Tperiod=2.02683, numPeriods=1, tFinal=2.02683, plotSteps=41
it=-1: completed step 0, t=0.00e+00 (cpu =6.81e-04)
it=-1: completed step 41, t=2.04e-01 (cpu =9.50e-02)
it=-1: completed step 82, t=4.08e-01 (cpu =1.91e-01)
it=-1: completed step 123, t=6.12e-01 (cpu =2.89e-01)
it=-1: completed step 164, t=8.15e-01 (cpu =3.88e-01)
it=-1: completed step 205, t=1.02e+00 (cpu =4.90e-01)
it=-1: completed step 246, t=1.22e+00 (cpu =5.92e-01)
it=-1: completed step 287, t=1.43e+00 (cpu =6.97e-01)
it=-1: completed step 328, t=1.63e+00 (cpu =8.00e-01)
it=-1: completed step 369, t=1.83e+00 (cpu =9.02e-01)
it=-1:  max(|v-vOld|)=4.78e-06, tol=0.001
Maximum residual = 6.038e-03
Maximum residual = 6.038e-03



../bin/cgwh -grid=square128.order4 -cmd=gaussian.cmd -omega=3.1 -x0=.5 -y0=.5 -ad4=0 -tol=1e-3

../bin/cgwh -grid=square64.order2 -cmd=gaussian.cmd -omega=3.1 -x0=.5 -y0=.5 -tol=1e-3


************************************************************************
********* Thurs Feb 20, 2020

../bin/cgwh -grid=cice4.order4 -cmd=gaussian.cmd -omega=13.1 -beta=100 -x0=1 -y0=.25 -numPeriods=40 -tol=1e-8



ORDER=4 -- OK 
../bin/cgwh -grid=cice4.order4 -cmd=gaussian.cmd -omega=13.1 -beta=100 -x0=1 -y0=1 -numPeriods=40 -tol=1e-8


it=17: completed step 4336, t=1.53e+01 (cpu =1.42e+01)
it=17: completed step 4878, t=1.73e+01 (cpu =1.60e+01)
it=17: completed step 5420, t=1.92e+01 (cpu =1.79e+01)
 17 KSP Residual norm 2.363934635604e-08 
KSP Object: 1 MPI processes
  type: gmres
    GMRES: restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
    GMRES: happy breakdown tolerance 1e-30
  maximum iterations=10000, initial guess is zero
  tolerances:  relative=1e-08, absolute=1e-50, divergence=10000
  left preconditioning
  using PRECONDITIONED norm type for convergence test
PC Object: 1 MPI processes
  type: none
  linear system matrix = precond matrix:
  Matrix Object:   1 MPI processes
    type: shell
    rows=29655, cols=29655
***** DONE KSP SOLVE ******
***** CALL AGAIN TO CHECK SOLUTION ******
+++ usermult called iteration=-1
CgWaveHoltz:advance: numberOfTimeSteps=5424
CgWaveHoltz::advance: c=1, omega=13.1, Tperiod=19.1853, numPeriods=40, tFinal=19.1853, plotSteps=542
it=-1: completed step 0, t=0.00e+00 (cpu =6.62e-04)
it=-1: completed step 542, t=1.92e+00 (cpu =1.59e+00)
it=-1: completed step 1084, t=3.83e+00 (cpu =3.44e+00)
it=-1: completed step 1626, t=5.75e+00 (cpu =5.10e+00)
it=-1: completed step 2168, t=7.67e+00 (cpu =6.75e+00)
it=-1: completed step 2710, t=9.59e+00 (cpu =8.41e+00)
it=-1: completed step 3252, t=1.15e+01 (cpu =1.02e+01)
it=-1: completed step 3794, t=1.34e+01 (cpu =1.21e+01)
it=-1: completed step 4336, t=1.53e+01 (cpu =1.37e+01)
it=-1: completed step 4878, t=1.73e+01 (cpu =1.54e+01)
it=-1: completed step 5420, t=1.92e+01 (cpu =1.73e+01)
it=-1:  max(|v-vOld|)=7.18e-08, tol=1e-08




START ON OVERSET GRID

**trouble** -- something funny with ad4 -- may need to extrap extra points?
 TURN OFF ad4 for now : -- looks OK
../bin/cgwh -grid=cice4.order2 -cmd=gaussian.cmd -omega=13.1 -beta=100 -x0=1 -y0=1 -numPeriods=20 -ad4=0 -tol=1e-4

OK:
../bin/cgwh -grid=cice4.order2 -cmd=gaussian.cmd -omega=13.1 -beta=100 -x0=1 -y0=1 -numPeriods=40 -ad4=0 -tol=1e-4

--- KRYLOV: 

it=9: completed step 4509, t=1.73e+01 (cpu =1.07e+01)
it=9: completed step 5010, t=1.92e+01 (cpu =1.19e+01)
  9 KSP Residual norm 1.807663040995e-03 
KSP Object: 1 MPI processes
  type: gmres
    GMRES: restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
    GMRES: happy breakdown tolerance 1e-30
  maximum iterations=10000, initial guess is zero
  tolerances:  relative=0.0001, absolute=1e-50, divergence=10000
  left preconditioning
  using PRECONDITIONED norm type for convergence test
PC Object: 1 MPI processes
  type: none
  linear system matrix = precond matrix:
  Matrix Object:   1 MPI processes
    type: shell
    rows=28875, cols=28875
***** DONE KSP SOLVE ******
***** CALL AGAIN TO CHECK SOLUTION ******
+++ usermult called iteration=-1
CgWaveHoltz:advance: numberOfTimeSteps=5011
CgWaveHoltz::advance: c=1, omega=13.1, Tperiod=19.1853, numPeriods=40, tFinal=19.1853, plotSteps=501
it=-1: completed step 0, t=0.00e+00 (cpu =1.18e-03)
exit
it=-1: completed step 501, t=1.92e+00 (cpu =1.09e+00)
it=-1: completed step 1002, t=3.84e+00 (cpu =2.32e+00)
it=-1: completed step 1503, t=5.75e+00 (cpu =3.58e+00)
it=-1: completed step 2004, t=7.67e+00 (cpu =4.80e+00)
it=-1: completed step 2505, t=9.59e+00 (cpu =6.02e+00)
it=-1: completed step 3006, t=1.15e+01 (cpu =7.25e+00)
it=-1: completed step 3507, t=1.34e+01 (cpu =8.49e+00)
it=-1: completed step 4008, t=1.53e+01 (cpu =9.71e+00)
it=-1: completed step 4509, t=1.73e+01 (cpu =1.09e+01)
it=-1: completed step 5010, t=1.92e+01 (cpu =1.22e+01)
it=-1:  max(|v-vOld|)=3.15e-05, tol=0.0001
exit

---- FIXED POINT

CgWaveHoltz::advance: c=1, omega=13.1, Tperiod=19.1853, numPeriods=40, tFinal=19.1853, plotSteps=501
it=9: completed step 0, t=0.00e+00 (cpu =8.84e-04)
it=9: completed step 501, t=1.92e+00 (cpu =3.39e+00)
it=9: completed step 1002, t=3.84e+00 (cpu =4.48e+00)
it=9: completed step 1503, t=5.75e+00 (cpu =5.73e+00)
it=9: completed step 2004, t=7.67e+00 (cpu =6.83e+00)
it=9: completed step 2505, t=9.59e+00 (cpu =8.19e+00)
it=9: completed step 3006, t=1.15e+01 (cpu =9.29e+00)
it=9: completed step 3507, t=1.34e+01 (cpu =1.06e+01)
it=9: completed step 4008, t=1.53e+01 (cpu =1.18e+01)
it=9: completed step 4509, t=1.73e+01 (cpu =1.31e+01)
it=9: completed step 5010, t=1.92e+01 (cpu =1.43e+01)
it=9:  max(|v-vOld|)=5.43e-02





../bin/cgwh -grid=cice4.order2 -cmd=gaussian.cmd -omega=13.1 -beta=100 -x0=1 -y0=1 -numPeriods=40 -tol=1e-4 

../bin/cgwh -grid=cice2.order2 -cmd=gaussian.cmd -omega=3.1 -beta=100 -x0=1.25 -y0=1.25


../bin/cgwh -grid=square64.order2 -cmd=gaussian.cmd -omega=3.1 -x0=.5 -y0=.5 -tol=1e-5 


Bug found


There is some memory error I think

valgrind works: 

valgrind ../bin/cgwh -grid=square64.order2 -cmd=gaussian.cmd -omega=3.1 -x0=.5 -y0=.5

************************************************************************
********* Wed Feb 19, 2020

START TEST PETSC

../bin/cgwh -grid=square64.order2 -cmd=gaussian.cmd -omega=3.1 -x0=.5 -y0=.5 


START ON LINKING TO PETSc 

../bin/cgwh -grid=square128.order2 -cmd=gaussian.cmd -omega=30.1 -x0=.5 -y0=.5 

************************************************************************
********* Feb 17, 2020

VERSION 1

-- SOR doesn't seem to help 
../bin/cgwh -grid=square128.order2 -cmd=gaussian.cmd -omega=30.1 -x0=.5 -y0=.5 -omegaSOR=1.1


../bin/cgwh -grid=cice4.order2 -cmd=gaussian.cmd -omega=15.1 -x0=.75 -y0=.75 

../bin/cgwh -grid=square128.order2 -cmd=gaussian.cmd -omega=30.1 -x0=.5 -y0=.5 


INITIAL VERSION OF CG WaveHoltz

../bin/cgwh -grid=square128.order2

cg6:~/codes/cgwh/cmd> ../bin/cgwh -grid=square128.order2
Usage: `mpirun -np N cgWaveHoltz [-noplot][-grid=<gridName>][-cmd=<file.cmd>]'
Look for Overture configuration file=[/home/henshw/.overturerc]
Successfully opened /home/henshw/Overture.g/overturerc for reading
User commands are being saved in the file `cgWaveHoltz.cmd'
Searching for grids in locations specified by the `OvertureGridDirectories' environment variable
look for /home/henshw/Overture.g/sampleGrids/square128.order2 
look for /home/henshw/grids/square128.order2 
 ***** Mounting file /home/henshw/grids/square128.order2.hdf****
getFromADataBase: number of CompositeGrid(s) found =1, name[0]=square128.order2
Time to read in the grid is 2.74e-02(s)
This grid has been made for 2nd-order accuracy. I am switching to 2nd-order accuracy.
You can explicitly change the order back to 4 to try it.
create CompositeGridOperators...
Time to build CompositeGridOperators=0.00e+00 (s)
...done create CompositeGridOperators
create grid functions u[] and laplacian...
...done create grid functions u[] and laplacian
After getTimeStep: dt=1.95e-03
get initial conditions
done initial conditions
it=0: completed step 0, t=0.00e+00 (cpu =1.50e-03)
it=0: completed step 107, t=2.09e-01 (cpu =3.91e+00)
it=0: completed step 214, t=4.18e-01 (cpu =4.38e+00)
it=0: completed step 321, t=6.27e-01 (cpu =4.84e+00)
it=0: completed step 428, t=8.36e-01 (cpu =5.31e+00)
it=0: completed step 535, t=1.04e+00 (cpu =5.77e+00)
it=0: completed step 642, t=1.25e+00 (cpu =6.23e+00)
it=0: completed step 749, t=1.46e+00 (cpu =6.69e+00)
it=0: completed step 856, t=1.67e+00 (cpu =7.16e+00)
it=0: completed step 963, t=1.88e+00 (cpu =7.58e+00)
it=0:  max(|v-vOld|)=5.95e-01
it=1: completed step 0, t=0.00e+00 (cpu =8.02e+00)
it=1: completed step 107, t=2.09e-01 (cpu =1.30e+01)
it=1: completed step 214, t=4.18e-01 (cpu =1.35e+01)
it=1: completed step 321, t=6.27e-01 (cpu =1.40e+01)
it=1: completed step 428, t=8.36e-01 (cpu =1.45e+01)
it=1: completed step 535, t=1.04e+00 (cpu =1.49e+01)
it=1: completed step 642, t=1.25e+00 (cpu =1.54e+01)
it=1: completed step 749, t=1.46e+00 (cpu =1.59e+01)
it=1: completed step 856, t=1.67e+00 (cpu =1.63e+01)
it=1: completed step 963, t=1.88e+00 (cpu =1.68e+01)
it=1:  max(|v-vOld|)=1.48e-01
it=2: completed step 0, t=0.00e+00 (cpu =1.73e+01)
it=2: completed step 107, t=2.09e-01 (cpu =2.43e+01)
it=2: completed step 214, t=4.18e-01 (cpu =2.48e+01)
it=2: completed step 321, t=6.27e-01 (cpu =2.52e+01)
it=2: completed step 428, t=8.36e-01 (cpu =2.57e+01)
it=2: completed step 535, t=1.04e+00 (cpu =2.62e+01)
it=2: completed step 642, t=1.25e+00 (cpu =2.66e+01)
it=2: completed step 749, t=1.46e+00 (cpu =2.71e+01)
it=2: completed step 856, t=1.67e+00 (cpu =2.76e+01)
it=2: completed step 963, t=1.88e+00 (cpu =2.80e+01)
it=2:  max(|v-vOld|)=2.76e-02
it=3: completed step 0, t=0.00e+00 (cpu =2.85e+01)
it=3: completed step 107, t=2.09e-01 (cpu =3.27e+01)
it=3: completed step 214, t=4.18e-01 (cpu =3.31e+01)
it=3: completed step 321, t=6.27e-01 (cpu =3.36e+01)
it=3: completed step 428, t=8.36e-01 (cpu =3.41e+01)
it=3: completed step 535, t=1.04e+00 (cpu =3.46e+01)
it=3: completed step 642, t=1.25e+00 (cpu =3.50e+01)
it=3: completed step 749, t=1.46e+00 (cpu =3.55e+01)
it=3: completed step 856, t=1.67e+00 (cpu =3.60e+01)
it=3: completed step 963, t=1.88e+00 (cpu =3.64e+01)
it=3:  max(|v-vOld|)=6.53e-03
it=4: completed step 0, t=0.00e+00 (cpu =3.69e+01)
it=4: completed step 107, t=2.09e-01 (cpu =3.98e+01)
it=4: completed step 214, t=4.18e-01 (cpu =4.03e+01)
it=4: completed step 321, t=6.27e-01 (cpu =4.07e+01)
it=4: completed step 428, t=8.36e-01 (cpu =4.12e+01)
it=4: completed step 535, t=1.04e+00 (cpu =4.17e+01)
it=4: completed step 642, t=1.25e+00 (cpu =4.22e+01)
it=4: completed step 749, t=1.46e+00 (cpu =4.26e+01)
it=4: completed step 856, t=1.67e+00 (cpu =4.31e+01)
it=4: completed step 963, t=1.88e+00 (cpu =4.36e+01)
it=4:  max(|v-vOld|)=1.73e-03
it=5: completed step 0, t=0.00e+00 (cpu =4.40e+01)
it=5: completed step 107, t=2.09e-01 (cpu =4.73e+01)
it=5: completed step 214, t=4.18e-01 (cpu =4.78e+01)
it=5: completed step 321, t=6.27e-01 (cpu =4.83e+01)
it=5: completed step 428, t=8.36e-01 (cpu =4.87e+01)
it=5: completed step 535, t=1.04e+00 (cpu =4.92e+01)
it=5: completed step 642, t=1.25e+00 (cpu =4.97e+01)
it=5: completed step 749, t=1.46e+00 (cpu =5.01e+01)
it=5: completed step 856, t=1.67e+00 (cpu =5.06e+01)
it=5: completed step 963, t=1.88e+00 (cpu =5.11e+01)
it=5:  max(|v-vOld|)=5.68e-04
it=6: completed step 0, t=0.00e+00 (cpu =5.15e+01)

