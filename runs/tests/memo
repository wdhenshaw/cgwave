

*******************************************
***** Fri Dec 22, 2023

TEST NEW HIERARCHICAL LAPSQ

>>>>>>>>>>>>>> 3D >>>>>>>>>>>>

WIGGLEY 3D 
testCoeff -caseName=wiggley3d -numRes=3 -tz=trig

>>> res=0: max relative error in LapSq_{2h}(uExact) =  2.93e+00 (computed with difference operators).
>>> res=0: max relative error in LapSq_{2h}(uExact) =  2.93e+00 (Coeff from DELTA).
>>> res=0: max relative error in LapSq_{2h}(uExact) =  2.93e+00 (Coeff from Hierarchical).

>>> res=1: max relative error in LapSq_{2h}(uExact) =  3.40e-01 (computed with difference operators).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  3.40e-01 (Coeff from DELTA).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  3.40e-01 (Coeff from Hierarchical).

>>> res=2: max relative error in LapSq_{2h}(uExact) =  7.80e-02 (computed with difference operators).
>>> res=2: max relative error in LapSq_{2h}(uExact) =  7.80e-02 (Coeff from DELTA).
>>> res=2: max relative error in LapSq_{2h}(uExact) =  7.80e-02 (Coeff from Hierarchical).

ORTHO SPHERE
testCoeff -caseName=orthoSphere -numRes=2 -tz=trig

>>> res=0: max relative error in LapSq_{2h}(uExact) =  3.37e-02 (computed with difference operators).
>>> res=0: max relative error in LapSq_{2h}(uExact) =  3.37e-02 (Coeff from DELTA).
>>> res=0: max relative error in LapSq_{2h}(uExact) =  3.37e-02 (Coeff from Hierarchical).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  8.92e-03 (computed with difference operators).



QUARTER CYL
testCoeff -caseName=quarterCyl -numRes=2 -tz=trig

>>> res=0: max relative error in LapSq_{2h}(uExact) =  2.87e-02 (computed with difference operators).
>>> res=0: max relative error in LapSq_{2h}(uExact) =  2.87e-02 (Coeff from DELTA).
>>> res=0: max relative error in LapSq_{2h}(uExact) =  2.87e-02 (Coeff from Hierarchical).

>>> res=1: max relative error in LapSq_{2h}(uExact) =  7.36e-03 (computed with difference operators).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  7.36e-03 (Coeff from DELTA).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  7.36e-03 (Coeff from Hierarchical).

NON BOX -- OK 
testCoeff -caseName=nonBox -numRes=2 -tz=trig

>>> res=0: max relative error in LapSq_{2h}(uExact) =  1.63e-02 (computed with difference operators).
>>> res=0: max relative error in LapSq_{2h}(uExact) =  1.63e-02 (Coeff from DELTA).

>>> res=0: max relative error in LapSq_{2h}(uExact) =  1.63e-02 (Coeff from Hierarchical).

>>> res=1: max relative error in LapSq_{2h}(uExact) =  4.10e-03 (computed with difference operators).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  4.10e-03 (Coeff from DELTA).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  4.10e-03 (Coeff from Hierarchical).


>>>>>>>>>>>>>>>>> 2D >>>>>>>>>>>>>>>.
testCoeff -caseName=wiggley -numRes=2 -tz=trig

>>> res=1: max relative error in LapSq_{2h}(uExact) =  6.70e-02 (computed with difference operators).
     grid=0 I1=[0,64] I2=[0,64] I3=[0,0]-----------
lapSqCoeff(m1,m2,m3) (i1,i2,i3)=(  2,  2,  0):
m3= 0
m2=-2, m1=[-2, 2] :    2.49e+04    1.30e+06    1.35e+07   -1.32e+06    3.83e+04 
m2=-1, m1=[-2, 2] :    1.14e+06    2.18e+07   -1.09e+08    3.27e+07   -1.44e+06 
m2= 0, m1=[-2, 2] :    1.30e+07   -1.07e+08    2.74e+08   -1.09e+08    1.34e+07 
m2= 1, m1=[-2, 2] :   -1.12e+06    3.24e+07   -1.13e+08    2.26e+07    1.41e+06 
m2= 2, m1=[-2, 2] :    2.31e+04   -1.30e+06    1.45e+07    1.33e+06    3.62e+04 
... done grid=0
>>> res=1: max relative error in LapSq_{2h}(uExact) =  6.70e-02 (Coeff from DELTA).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  6.70e-02 (Coeff from Hierarchical).


testCoeff -caseName=nonSquare -numRes=2 -tz=trig

>>> res=0: max relative error in LapSq_{2h}(uExact) =  6.41e-03 (computed with difference operators).
>>>> stenciWidth=5, stencilSize=26, numberOfGhostLines=2

 ---------coefficientsByDelta: Eval coefficients of Laplacian-squared by the delta approach -------
     grid=0 I1=[0,16] I2=[0,16] I3=[0,0]-----------
lapSqCoeff(m1,m2,m3) (i1,i2,i3)=(  2,  2,  0):
m3= 0
m2=-2, m1=[-2, 2] :    0.00e+00    0.00e+00    6.55e+04    0.00e+00    0.00e+00 
m2=-1, m1=[-2, 2] :    0.00e+00    1.31e+05   -5.24e+05    1.31e+05    0.00e+00 
m2= 0, m1=[-2, 2] :    6.55e+04   -5.24e+05    1.31e+06   -5.24e+05    6.55e+04 
m2= 1, m1=[-2, 2] :    0.00e+00    1.31e+05   -5.24e+05    1.31e+05    0.00e+00 
m2= 2, m1=[-2, 2] :    0.00e+00    0.00e+00    6.55e+04    0.00e+00    0.00e+00 
... done grid=0
>>> res=0: max relative error in LapSq_{2h}(uExact) =  6.41e-03 (Coeff from DELTA).

 ***ADD Fourth-order in time coefficients to the Implicit Matrix ****

implicit matrix: order=4 CURVLINEAR ADD (Lap_2h)^2

 DONE: Compute LapSq(u) : Max-rel-err= 0.00e+00
>>> res=0: max relative error in LapSq_{2h}(uExact) =  6.41e-03 (Coeff from CHAIN RULE).

*******************************************
***** Thur Dec 21, 2023


test coefficients in Implicit order 4 scheme

>>>>>>>>> WIGGLEY 

testCoeff -caseName=wiggley -numRes=2 -tz=trig


>>> res=0: max relative error in LapSq_{2h}(uExact) =  2.76e-01 (computed with difference operators).
>>> res=0: max relative error in LapSq_{2h}(uExact) =  2.76e-01 (Coeff from DELTA).
>>> res=0: max relative error in LapSq_{2h}(uExact) =  9.01e-01 (Coeff from CHAIN RULE).

>>> res=1: max relative error in LapSq_{2h}(uExact) =  6.70e-02 (computed with difference operators).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  6.70e-02 (Coeff from DELTA).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  8.96e-01 (Coeff from CHAIN RULE).


Diffference approximation to LapSq seems second order
>>> res=0: max relative error in LapSq_{2h}(uExact) =  2.76e-01 (computed with difference operators).
>>> res=1: max relative error in LapSq_{2h}(uExact) =  6.70e-02 (computed with difference operators).


testCoeff -noplot -caseName=wiggley

CHAIN RULE COEFF: 
 DONE: Max-rel-err= 3.99e+01

 ---------coefficientsByDelta: Eval coefficients of Laplacian-squared by the delta approach -------
     grid=0 I1=[2,2] I2=[2,2] I3=[0,0]-----------
lapSqCoeff(m1,m2,m3) (i1,i2,i3)=(  2,  2,  0):
m3= 0
m2=-2, m1=[-2, 2] :    2.58e+03    1.14e+05    9.03e+05   -1.18e+05    4.74e+03 
m2=-1, m1=[-2, 2] :    9.11e+04    1.31e+06   -7.31e+06    2.27e+06   -1.27e+05 
m2= 0, m1=[-2, 2] :    8.08e+05   -6.85e+06    1.81e+07   -7.03e+06    8.44e+05 
m2= 1, m1=[-2, 2] :   -8.83e+04    2.24e+06   -7.69e+06    1.40e+06    1.23e+05 
m2= 2, m1=[-2, 2] :    2.19e+03   -1.14e+05    1.03e+06    1.17e+05    4.22e+03 
... done grid=0

 ***ADD Fourth-order in time coefficients to the Implicit Matrix ****

implicit matrix: order=4 CURVLINEAR : **CHECK ME**
(i1,i2,i3)=(  2,  2,  0) : lapSq =   1.34e+01, lapSqe =   9.61e+00, relErr=  3.97e-01
lapSqCoeff(m1,m2,m3) and relative errors (i1,i2,i3)=(  2,  2,  0):
m3= 0
m2=-2, m1=[-2, 2] :    0.00e+00    1.16e+05    9.07e+05   -1.16e+05    0.00e+00       1.41e-04    1.36e-04    2.15e-04    1.08e-04    2.59e-04 
m2=-1, m1=[-2, 2] :    1.08e+05    1.29e+06   -7.31e+06    2.26e+06   -1.08e+05       9.01e-04    1.42e-03    7.47e-05    7.18e-04    1.04e-03 
m2= 0, m1=[-2, 2] :    8.18e+05   -6.95e+06    1.83e+07   -7.16e+06    8.51e+05       5.38e-04    5.84e-03    1.22e-02    6.93e-03    4.18e-04 
m2= 1, m1=[-2, 2] :   -1.08e+05    2.36e+06   -7.91e+06    1.53e+06    1.08e+05       1.05e-03    6.75e-03    1.22e-02    7.09e-03    8.36e-04 
m2= 2, m1=[-2, 2] :    0.00e+00   -1.16e+05    1.04e+06    1.16e+05    0.00e+00       1.20e-04    1.36e-04    6.33e-04    7.53e-05    2.31e-04 
>>>(i1,i2,i3)=(  2,  2,  0) : maxRelErr in coefficients =  1.22e-02

